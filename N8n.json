{
    "nodes": [
      {
        "parameters": {
          "operation": "download",
          "fileId": {
            "__rl": true,
            "value": "1Hj710gye-M2jPwvyLDWLZuhYuNqJ-byo",
            "mode": "list",
            "cachedResultName": "SOP.pdf",
            "cachedResultUrl": "https://drive.google.com/file/d/1Hj710gye-M2jPwvyLDWLZuhYuNqJ-byo/view?usp=drivesdk"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4224,
          -352
        ],
        "id": "cebef334-7e9a-4e91-8bf4-8b7931d319d8",
        "name": "Download file1",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "llwHWvPGd6xB8Q3F",
            "name": "Google Drive sonu"
          }
        }
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=You are an expert DRHP (Draft Red Herring Prospectus) analyst and validation agent specialized in creating complete, accurate, and data-driven summaries for financial professionals and investors. \n\n## Your Resources\n\n1. **Google Docs Tool**: Contains the complete summary format template with 12 sections ,also check if any section missing from previous agent generated summary or any section data \n2. **Retrieved DRHP Data**: Chunks retrieved based on format of the summary and  if \"data not found\" , \"information not found\" tables and sections from the previous agent\n\nYour task:\nYou will receive:\n1. A **formatted draft summary** of a company's DRHP (may contain missing, incomplete, or inaccurate information or information not found of any sections or tables or data ).\n2. A set of **retrieved DRHP chunks** from Pinecone vector search (these contain the verified ground truth text from the DRHP document).\n\nYour goal:\n- **Validate and correct** the given summary using the retrieved chunks as the only source of truth. \n- **Identify missing sections or empty fields** (e.g., â€œdata not foundâ€, â€œto be updatedâ€, or blank tables).\n- **Fill in all missing or inaccurate details** using information strictly from the Pinecone vectors.\n- **Ensure factual accuracy and full completion** for every section.\n- **Restore all financial tables, figures, and subheadings** exactly as per the DRHP source.\n- **Do not hallucinate** or infer data that isnâ€™t explicitly found in the retrieved text.\n- Maintain the original structured format (sections, subsections, tables, bullet points).\n- If a section truly has no data in any retrieved chunk, clearly mention:  \n  â€œNo data available in the DRHP source for this section.â€\n\nKey Checks:\n1. Cross-verify all numbers, names, and dates against DRHP chunks.  \n2. Fill any missing financial tables completely (Revenue, PAT, Net Worth, EPS, etc.).  \n3. Ensure corporate details, promoter info, capital structure, and risk factors are fully covered.  \n4. Maintain consistent formatting and logical flow across all sections.  \n5. Do not remove any section headers even if empty; instead, update them with verified or â€œno dataâ€ notes.\n\nFinal Output:\nReturn the **final validated and completed DRHP summary** â€” fully accurate, comprehensive, and ready for investor use.\nalways return same format that given in the imput.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          4992,
          -1104
        ],
        "id": "2113cef6-32ab-4778-8c81-dd34f9bf517d",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          4880,
          -880
        ],
        "id": "b340d791-772c-460a-b9ce-6c29e9ee5b1d",
        "name": "OpenAI Chat Model11",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4944,
          -688
        ],
        "id": "088e74e2-8127-422f-acb7-cb3688e35afd",
        "name": "Embeddings OpenAI10",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          4112,
          -880
        ],
        "id": "a8ba4dd9-ca4b-46f3-bb79-dd6bdc20f57d",
        "name": "OpenAI Chat Model12",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join('\\n\\n') }}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DRHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DRHP chunks.\n\n## Your Resources\n\n1. **Google Docs Tool**: Contains the complete summary format template with 12 sections\n2. **Retrieved DRHP Data**: Chunks retrieved based on strategic subqueries from the previous agent\n3. **Fund SOP Knowledge**: Understanding of mandatory requirements and data completeness standards\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the Google Docs format\n- Uses ONLY factual data from retrieved chunks (never fabricate)\n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved DRHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the EXACT format structure from Google Docs template\n- Maintain table formats exactly as specified\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n## Section-by-Section Generation Instructions\n\n### ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n**Extract and populate:**\n- Full legal company name and CIN\n- Complete registered office address (building, street, city, state, PIN)\n- Corporate office if different from registered office\n- ALL manufacturing/operational facilities with locations and brief capacity overview\n- Company website URL\n- Names and contact details of ALL Book Running Lead Managers (BRLMs)\n- Registrar to the Issue (name, address, contact)\n- Exact date of incorporation\n- Names of all banker relationships\n\n**Format Requirements:**\n- Present as clean list format (not table)\n- Verify all addresses are complete\n- Include contact numbers/emails where available\n\n---\n\n### ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n**Extract and populate:**\n- ISIN (if available, else state \"To be allotted\")\n- Statutory Auditor: Firm name, lead partners, registration number, peer review number\n- Peer-reviewed auditor details if applicable\n- Issue opening date (or [â—] if not fixed)\n- Issue closing date (or [â—] if not fixed)\n- Auditor changes in last 3 years with dates and reasons\n- Market maker information (for SME IPOs)\n- RHP filing date with SEBI\n\n**Format Requirements:**\n- Present as clean list\n- Include complete auditor details with all numbers\n- Note if any information uses [â—] placeholder\n\n---\n\n### ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n#### Primary Business Description (400-500 words)\n\n**Must include in this exact order:**\n1. **Opening (2-3 sentences)**: Company overview, incorporation year, legal status\n2. **Core Business (2-3 sentences)**: Primary industry/sector, years of operation, market position\n3. **Business Segments (3-4 sentences)**: List ALL segments and product categories clearly\n4. **Manufacturing Capabilities (2-3 sentences)**: Production facilities, installed capacity overview, operational locations\n5. **Target Markets (2-3 sentences)**: End-use industries, customer segments, geographic markets served\n6. **Competitive Positioning (2-3 sentences)**: Market leadership, unique strengths, differentiation factors\n\n**Writing Guidelines:**\n- Write in flowing paragraphs (not bullet points)\n- Focus on WHAT the company does\n- Use specific numbers (e.g., \"operates 3 manufacturing facilities with combined capacity of 50,000 MT\")\n- Avoid generic statements without data backing\n\n#### Business Segments & Revenue Breakdown\n\n**Format:**\nList each segment with revenue contribution:\n- **Segment 1 Name**: [X%] of revenue â€“ [Brief description of products/services]\n- **Segment 2 Name**: [Y%] of revenue â€“ [Brief description]\n\n**Example:**\n- **Aroma Chemicals**: 68% of revenue â€“ Manufactures Linalool, Geraniol, and other specialty chemicals for fragrance industry\n- **Essential Oils**: 32% of revenue â€“ Natural and synthetic essential oils for personal care and food industries\n\n#### Key Products/Services by Segment\n\n**Format:**\nOrganize by segment, avoid repeating Primary Business content:\n\n**Segment 1 â€“ [Name]:**\n- Product A: [Technical description, applications, key features]\n- Product B: [Technical description, applications, key features]\n\n**Segment 2 â€“ [Name]:**\n- Product C: [Technical description, applications, key features]\n\n#### Geographic Revenue Distribution **MANDATORY**\n\n**Create THREE tables exactly as specified:**\n\n**Table 1: Domestic Revenue by Top 5 States/Regions**\n\n| State/Region | Latest Amt (â‚¹ lakhs) | Latest % | FY24 Amt (â‚¹ lakhs) | FY24 % | FY23 Amt (â‚¹ lakhs) | FY23 % | FY22 Amt (â‚¹ lakhs) | FY22 % |\n|--------------|---------------------|----------|-------------------|---------|-------------------|---------|-------------------|---------|\n| [State 1] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] |\n| [State 2] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] |\n| ... | ... | ... | ... | ... | ... | ... | ... | ... |\n| **Total Top 5** | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] |\n\n**Table 2: Export Revenue by Geography**\n\n| Country | Latest Amt (â‚¹ lakhs) | Latest % | FY24 Amt (â‚¹ lakhs) | FY24 % | FY23 Amt (â‚¹ lakhs) | FY23 % | FY22 Amt (â‚¹ lakhs) | FY22 % |\n|---------|---------------------|----------|-------------------|---------|-------------------|---------|-------------------|---------|\n| [Country] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] |\n| **Total Exports** | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] | [Amount] | [%] |\n\n**Table 3: Overall Revenue Split**\n\n| Revenue Type | Latest % | FY24 % | FY23 % | FY22 % |\n|--------------|----------|---------|---------|---------|\n| Domestic | [%] | [%] | [%] | [%] |\n| Exports | [%] | [%] | [%] | [%] |\n| **Total** | **100%** | **100%** | **100%** | **100%** |\n\n**Critical Rules:**\n- MUST include both absolute amounts (â‚¹ lakhs) AND percentages\n- Ensure totals are accurate\n- If data missing for any period, state \"Data not available\"\n\n#### Business Model & Value Chain\n\n**Extract:**\n- Revenue model (B2B/B2C, manufacturing/trading, direct/distribution)\n- Position in value chain (manufacturer, processor, trader, service provider)\n- Key value-add activities and differentiation points\n\n**Format:** 2-3 paragraph narrative\n\n#### Manufacturing Process / Service Delivery\n\n**Extract:**\n- Operational workflow description\n- Key process steps\n- Technology/equipment used\n- Quality control measures\n\n**Format:** Narrative paragraph or process flow description\n\n#### Key Clients / Customers\n\n**Extract:**\n- Major customer segments (e.g., \"Top 10 pharmaceutical companies in India\")\n- Disclosed client names if any\n- Significant relationships and their importance\n\n**Format:** Narrative with specific examples\n\n#### Customer Concentration Analysis **MANDATORY**\n\n**Extract from risk factors and present narratively:**\n\n\"**Customer Concentration Risk**: The top 10 customers accounted for [X]% ([â‚¹Y] million) of total revenue in Sep 2024, [A]% ([â‚¹B] million) in FY 2024, [C]% ([â‚¹D] million) in FY 2023, and [E]% ([â‚¹F] million) in FY 2022. The top 5 customers represented [G]% in Sep 2024, [H]% in FY 2024, [I]% in FY 2023, and [J]% in FY 2022. The largest single customer contributed [K]% of revenue in FY 2024.\"\n\n**Critical:** Must include EXACT percentages AND amounts for all periods\n\n#### Supplier Concentration Analysis **MANDATORY**\n\n**Extract from risk factors and present narratively with geographic split:**\n\n\"**Supplier Concentration Risk**: The top 10 suppliers represented [X]% ([â‚¹Y] lakhs) of total purchases in Sep 2024, [A]% ([â‚¹B] lakhs) in FY 2024, [C]% ([â‚¹D] lakhs) in FY 2023, and [E]% ([â‚¹F] lakhs) in FY 2022. Geographic concentration: [G]% of suppliers were from [State] in Sep 2024, [H]% in FY 2024, [I]% in FY 2023, and [J]% in FY 2022. The top 5 suppliers accounted for [K]% in FY 2024.\"\n\n**Critical:** Must include amounts, percentages, AND geographic distribution\n\n#### Additional Business Information\n\n**Extract:**\n- **Intellectual Property**: List all patents, trademarks, copyrights with registration numbers and status\n- **Competitive Advantages**: Unique selling propositions with specific backing (e.g., \"Only company in India with XYZ certification\")\n- **Growth Strategy**: Short-term and long-term plans with specific initiatives\n- **Operational Scale**: Note if >75% revenue from one region (geographic concentration risk)\n\n#### Capacity Utilization Table **MANDATORY**\n\n| Product Category | Period | Installed Capacity (MT p.a.) | Actual Production (MT) | Utilization (%) |\n|------------------|---------|------------------------------|------------------------|-----------------|\n| [Product 1] | Sep 2024 (6m annualized) | [Amount] | [Amount] | [%] |\n| [Product 1] | FY 2024 | [Amount] | [Amount] | [%] |\n| [Product 1] | FY 2023 | [Amount] | [Amount] | [%] |\n| [Product 1] | FY 2022 | [Amount] | [Amount] | [%] |\n| [Product 2] | Sep 2024 (6m annualized) | [Amount] | [Amount] | [%] |\n| [Product 2] | FY 2024 | [Amount] | [Amount] | [%] |\n\n**Critical:** Search exhaustively for this data - often buried in operations section\n\n---\n\n### ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n**CRITICAL**: Use ONLY factual data from \"About the Company\" and Industry Overview sections. Avoid generic content.\n\n#### Industry Size and Market Data\n\n**Extract with sources:**\n- India market size (value, volume, units)\n- Global market size if mentioned\n- Consumption statistics\n- Production statistics\n- Import/export data\n\n**Format:** \"The Indian [industry] market was valued at â‚¹[X] crores/USD [Y] billion in [year] according to [source]. Domestic production stood at [Z] MT in [year]...\"\n\n#### Industry Growth Drivers and Tailwinds\n\n**Extract specific factors with supporting data:**\n- Demand drivers (e.g., \"Rising middle-class consumption increased from X% to Y%\")\n- Structural shifts (e.g., \"Government's Make in India initiative led to Z% growth\")\n- Market catalysts with quantification\n\n**Format:** Narrative paragraphs with specific data points, not generic lists\n\n#### Global Industry Trends\n\n**Extract international dynamics:**\n- Global consumption patterns with numbers\n- Export-import trends affecting India\n- International market shifts impacting domestic industry\n\n#### Domestic Industry Trends\n\n**Extract with specific data:**\n- Consumption trends (growth rates, volumes)\n- Production capacity additions\n- Market dynamics (pricing, competition)\n- Sector consolidation or fragmentation data\n\n#### Government Policies and Support Measures\n\n**Extract comprehensively:**\n- **Government Spending**: Specific allocation amounts and programs\n- **Policy Initiatives/Schemes**: Name schemes with benefits (e.g., \"PLI Scheme offering â‚¹X incentive\")\n- **Regulatory Changes**: Recent regulations aiding growth\n- **Government Targets**: Specific goals (e.g., \"Achieve â‚¹X production by 2030\")\n- **Tax Benefits**: Rate reductions, exemptions with percentages\n- **Subsidies**: Amounts and eligibility\n- **Incentives**: Export incentives, capital subsidies\n\n#### Industry Structure and Value Chain\n\n**Extract:**\n- Market structure (fragmented/consolidated)\n- Number of players\n- Value chain breakdown (raw material â†’ manufacturing â†’ distribution)\n- Market positioning of different player types\n\n#### Sector Strengths\n\n**Analyze with data:**\n- **Domestic Manufacturing Capacity**: Scale, growth, global ranking\n- **R&D Infrastructure**: Investment amounts, facilities, capabilities\n- **Extension Networks**: Distribution reach, institutional support\n- **Raw Material Availability**: Domestic sourcing %, supply chain advantages\n- **Export Competitiveness**: Export growth rates, global market share\n- **Other Advantages**: Cost, quality, technology with specific metrics\n\n#### Sector Challenges and Risk Factors\n\n**Detailed breakdown with specifics:**\n- **Agro-climatic Constraints**: Regional limitations, climate change impact with data\n- **Regional/Geographic Limitations**: Concentration issues with percentages\n- **Price Volatility**: Historical volatility data, impact on margins\n- **Supply Chain Vulnerabilities**: Import dependencies with percentages\n- **Competitive Pressure**: Market saturation indicators\n- **Infrastructure/Institutional Constraints**: Specific bottlenecks\n- **Other Challenges**: Regulatory, technological with examples\n\n#### Projected Growth Rate\n\n**Extract with sources:**\n\"The [industry] is expected to grow at a CAGR of [X]% from [year] to [year], reaching â‚¹[Y] crores/USD [Z] billion by [year], according to [source]. Key drivers include...\"\n\n#### Company's Market Position\n\n**Extract quantitative metrics:**\n- Market share percentage\n- Industry ranking (e.g., \"3rd largest player with X% share\")\n- Competitive positioning with specific advantages\n\n#### Peer Comparison Table **MANDATORY**\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (â‚¹ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|-------------------|\n| [Company Name] | [Value] | [Value] | [Value] | [Value] | [Value] | [Value] |\n| Peer 1 | [Value] | [Value] | [Value] | [Value] | [Value] | [Value] |\n| Peer 2 | [Value] | [Value] | [Value] | [Value] | [Value] | [Value] |\n| Peer 3 | [Value] | [Value] | [Value] | [Value] | [Value] | [Value] |\n\n**Note**: Include company's own metrics for comparison\n\n#### Additional Industry Information\n\n- **Sector Trends**: Emerging developments with data\n- **Regulatory Environment**: Key regulations with compliance requirements\n- **Market Opportunities**: Growth segments with sizing\n- **Challenges and Threats**: Industry-specific with impact assessment\n\n---\n\n### ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n#### Promoters Table **MANDATORY**\n\n| Name | Designation | Education | Experience | Shareholding (%) | Address |\n|------|-------------|-----------|------------|------------------|---------|\n| [Name] | [Designation] | [Qualifications] | [Years, key background] | [%] | [Complete address] |\n\n**Extract for each promoter:**\n- Full name\n- Exact designation\n- Educational qualifications (or \"Nil\" if not disclosed)\n- Experience summary (years, key roles)\n- Exact shareholding percentage (pre-issue)\n- Complete address\n\n#### Promoter Group\n\n**List all entities/individuals:**\n\"The Promoter Group consists of: [List all names with relationship to promoters]\"\n\n#### Board of Directors Table **MANDATORY**\n\n| Name | Designation | DIN | Education | Experience | Shareholding | Address |\n|------|-------------|-----|-----------|------------|--------------|---------|\n| [Name] | Chairman/ED/NED/ID | [8-digit DIN] | [Qualifications] | [Summary] | [% or \"Nil\"] | [Address] |\n\n**Extract for each director:**\n- Full name\n- Designation (Executive/Non-Executive/Independent/Nominee)\n- 8-digit DIN\n- Educational background\n- Experience summary\n- Shareholding if any\n- Residential address\n\n#### Key Management Personnel Table **MANDATORY**\n\n| Name | Designation | Age | Qualification | Year Joined | Experience (Yrs) | Previous Employment | Compensation FY24 (â‚¹ Lakhs) | Term |\n|------|-------------|-----|---------------|-------------|------------------|---------------------|----------------------------|------|\n| [Name] | Chairman & MD | [Age] | [Degrees] | [Year] | [Years] | [Company, Role] | [Amount] | [Years/Until] |\n| [Name] | CFO | [Age] | [Degrees] | [Year] | [Years] | [Company, Role] | [Amount] | [Years/Until] |\n| [Name] | Company Secretary | [Age] | [Degrees, Memberships] | [Year] | [Years] | [Company, Role] | [Amount] | [Years/Until] |\n\n#### Individual KMP Profiles\n\n**For each KMP, write detailed profile:**\n\n**Chairman & Managing Director: [Full Name]**\n\n**Education**: [List all degrees chronologically, e.g., \"B.Tech in Chemical Engineering from IIT Delhi (1995), MBA from IIM Ahmedabad (1997)\" OR \"Nil\" if no formal education disclosed]\n\n**Professional Experience**: [Chronological career path with specific roles and years. Example: \"Joined ABC Ltd in 1998 as Production Manager, promoted to General Manager in 2003, moved to XYZ Corp as VP Operations in 2007...\"]\n\n**Industry Experience**: [Specific sector experience, e.g., \"25 years in specialty chemicals industry, with expertise in aroma chemicals manufacturing\"]\n\n**Key Achievements**: [If mentioned in DRHP, list specific accomplishments]\n\n**Chief Financial Officer: [Full Name]**\n\n**Education**: [Qualifications - e.g., \"Chartered Accountant (2005), B.Com from Delhi University (2002)\"]\n\n**Professional Experience**: [Complete career history with companies and roles]\n\n**Previous Roles**: [Specific positions, e.g., \"Finance Manager at DEF Ltd (2010-2015), Assistant Manager at GHI Corp (2005-2010)\"]\n\n**Expertise**: [Financial domains - e.g., \"Treasury management, financial planning & analysis, statutory compliance\"]\n\n**Company Secretary & Compliance Officer: [Full Name]**\n\n**Education**: [Qualifications and memberships - e.g., \"Company Secretary (ICSI - 2008), LLB from Mumbai University (2006), Member of ICSI\"]\n\n**Professional Experience**: [Career progression with specific roles]\n\n**Previous Companies**: [List companies and positions]\n\n**Expertise**: [Regulatory background - e.g., \"Corporate governance, SEBI compliance, secretarial audits, board management\"]\n\n#### Additional Governance Information\n\n**Corporate Governance Structure**: \n[Describe board committees: Audit Committee, Nomination & Remuneration Committee, Stakeholders Relationship Committee with member names and chairpersons]\n\n#### Employee Information Table\n\n| Department | Employees | % |\n|------------|-----------|---|\n| Production | [Count] | [%] |\n| Sales & Marketing | [Count] | [%] |\n| Administration | [Count] | [%] |\n| R&D | [Count] | [%] |\n| **Total** | [Count] | **100%** |\n\n#### Compliance and Legal\n\n**Delayed Filings & Penalties**:\n\n| Financial Year | Type of Filing | Delay (Days) | Penalty Amount (â‚¹) | Status |\n|----------------|----------------|--------------|-------------------|---------|\n| [FY] | [Annual Return/Financial Statements] | [Days] | [Amount] | Paid/Pending |\n\n**Director Directorships**: \n[List other companies where directors hold board positions]\n\n---\n\n### ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n#### Share Capital History **MANDATORY**\n\n| Sr. | Date | Change | Equity Shares | Face Value (â‚¹) | Authorized Capital (â‚¹ lakhs) | Meeting | Reason/Event |\n|-----|------|--------|---------------|----------------|------------------------------|---------|--------------|\n| 1 | [Incorporation Date] | Initial | [Number] | [Value] | [Amount] | N.A. | Incorporation |\n| 2 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n\n**Cover ALL changes from incorporation to present**\n\n#### Current Capital Structure\n\n**Authorized Share Capital**: â‚¹[Amount] lakhs divided into [Number] equity shares of â‚¹[Face Value] each\n\n**Paid-up Share Capital (Pre-Issue)**: â‚¹[Amount] lakhs divided into [Number] equity shares of â‚¹[Face Value] each\n\n#### Shareholding Pattern **MANDATORY**\n\n**Pre-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| **Promoters & Promoter Group** | [Number] | [%] |\n| - Individual Promoters | [Number] | [%] |\n| - Promoter Group Entities | [Number] | [%] |\n| **Public Shareholders** | [Number] | [%] |\n| **Total** | [Number] | **100%** |\n\n**Post-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| **Promoters & Promoter Group** | [Number] | [%] |\n| **Public Shareholders** | [Number] | [%] |\n| **Total** | [Number] | **100%** |\n\n#### Capital Structure Details\n\n**Preferential Allotments (Last 3 Years):**\n\n| Date | Allottee | Shares | Price/Share (â‚¹) | Total (â‚¹ million) |\n|------|----------|--------|-----------------|-------------------|\n| [Date] | [Name] | [Number] | [Price] | [Amount] |\n\n**Latest Private Placement**: [Details of most recent placement before IPO]\n\n**ESOP/ESPS**: [Details of all employee stock option plans with numbers and pricing]\n\n**Convertible Instruments**: [Any outstanding convertibles with terms]\n\n**Promoter Holding Changes**: [3-year history with dates, reasons, and percentage changes]\n\n---\n\n### ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n#### Financial Highlights Table **MANDATORY**\n\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|---------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ mn) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ mn) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ mn) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n**Calculate margins if not provided: EBITDA Margin = (EBITDA/Revenue)*100, PAT Margin = (PAT/Revenue)*100**\n\n#### Financial Analysis\n\n**Revenue Breakdown**: \n[Create table showing revenue by segment, geography, product with % contribution across periods]\n\n**Balance Sheet Summary**: \n[Narrative covering: Total Assets, Net Worth, Total Liabilities, Fixed Assets, Current Assets, Current Liabilities with YoY changes and percentages]\n\n**Debt Profile**: \n[Present: Long-term debt, short-term debt, total debt, D/E ratio, debt maturity profile with trends across periods]\n\n#### Restated Cash Flow Statement **MANDATORY** (â‚¹ Lakhs)\n\n| Particulars | Latest | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|--------|---------|---------|---------|---------|\n| **A) OPERATING ACTIVITIES** | | | | | |\n| Net Profit before Tax | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Depreciation | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Interest Paid | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Provision for Gratuity | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Interest Income | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| Other Adjustments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Operating Profit before WC Changes | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Inventory | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Trade Receivables | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Other Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Increase/(Decrease) in Trade Payables | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Increase/(Decrease) in Other Liabilities | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Cash Generated from Operations | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Less: Income Taxes Paid | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| **Net Cash from Operating Activities (A)** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n| | | | | | |\n| **B) INVESTING ACTIVITIES** | | | | | |\n| Purchase of Fixed Assets | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| Sale of Fixed Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Increase)/Decrease in Other Non-Current Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| (Purchase)/Sale of Current Investments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Interest Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Dividend Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| **Net Cash from Investing Activities (B)** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n| | | | | | |\n| **C) FINANCING ACTIVITIES** | | | | | |\n| Proceeds from Issue of Share Capital | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Increase/(Decrease) in Short-term Borrowings | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Proceeds from Long-term Borrowings | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Repayment of Long-term Borrowings | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| Interest Paid | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| Dividends Paid | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) | ([Amt]) |\n| **Net Cash from Financing Activities (C)** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n| | | | | | |\n| **Net Increase/(Decrease) in Cash (A+B+C)** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n| Opening Cash & Cash Equivalents | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| **Closing Cash & Cash Equivalents** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n\n**Critical**: Extract ALL line items exactly as presented in DRHP. Use parentheses for outflows/deductions.\n\n#### Components of Cash & Cash Equivalents\n\n| Component | Latest | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-----------|--------|---------|---------|---------|---------|\n| Cash on Hand | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Balance with Banks - Current Accounts | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Balance with Banks - Deposit Accounts | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Other Bank Balances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| **Total** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** | **[Amt]** |\n\n#### Key Financial Ratios (Consolidated)\nMANDATORY\nCategory\nRatio\nFY 20xx (current year to last 3 year )\nFY 20xx\nFY 20xx\nFY 20xx\nProfitability\nROE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nROCE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nGross Margin (%)\n[%]\n[%]\n[%]\n[%]\nLiquidity\nCurrent Ratio\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nLeverage\nDebt/Equity\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nEfficiency\nInventory Turnover (days)\n[Days]\n[Days]\n[Days]\n[Days]\n\nAdditional Financial Info\nWorking Capital Cycle: [Analysis with days/amounts]\n\n\nFX Exposure: [If applicable]\nContingent Liabilities Table\nMANDATORY\nLiability Type\nAmount (â‚¹ mn)\nDescription\n[Type]\n[Amt]\n[Details]\nTotal\n[Total]\n\n\n\n\n## Section VIII: IPO Details\nIssue Size: [Breakdown of total, fresh issue & OFS]\n\n\nPrice Band: [Floor & cap or [â—]]\n\n\nLot Size: [Minimum bid quantity]\n\n\nIssue Structure: [Fresh issue vs OFS breakdown]\n\n\nIssue Allocation\nCategory\n% Allocation\nAmount (â‚¹ mn)\nQIB\n[%]\n[Amount]\nNII\n[%]\n[Amount]\nRetail\n[%]\n[Amount]\n\nFund Utilization\nProceeds Use: [Breakdown table of fund allocation]\n\n\nTimeline: [Schedule for deployment]\n\n\nSelling Shareholders\nMANDATORY\nShareholder\nShares Offered\nAvg. Cost (â‚¹)\nProceeds (â‚¹ mn)\n[Name]\n[Shares]\n[Cost]\n[Amount]\n\n## Section IX: Legal & Regulatory\nStatutory Approvals: [Key licenses/permits]\n\n\nPending Clearances(Pending Approvals): [If any]\n\n\nOutstanding Litigation\nMANDATORY\nAgainst\nCases(direct tax,indirect tax detail)\nExposure (â‚¹ mn)\nNature\nCompany\n[Count]\n[Amount]\n[Description]\nPromoters\n[Count]\n[Amount]\n[Description]\nDirectors\n[Count]\n[Amount]\n[Description]\n\nAdditional Legal Info\nMaterial Developments: [Since last audit period]\n\n\nTax Proceedings: [Summary with amounts/status](direct tax,indirect tax detail)\n\n\n\n\n## Section X: Corporate Structure\n\n#### Subsidiaries Table\n**MANDATORY detailed table**\n\n| Subsidiary Name | Ownership (%) | Business Focus | Key Financials |\n|-----------------|---------------|----------------|---------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n#### Corporate Relationships\n- **Joint Ventures**: [Complete details with ownership and business focus]\n- **Associate Companies**: [Names and relationships]\n- **Group Companies**: [Complete list with business profiles and key financials where available]\n\n#### Related Party Transactions (Complete Analysis):\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n#### Related Party Outstanding Balances:\n\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n---\n ## Section XI: Additional Information\nAwards : [Honors received]\n\n\nCSR Initiatives: [Social programs, csr policy ,figures]\n\n\nCertifications: [Quality, environmental, other]\n\n\nR&D: [Facilities & focus areas]\n\n\nInternational Ops: [Global presence]\n\n\nFuture Outlook: [Vision & targets]\n\n\nDividend Policy: [History & future policy ,dates ]\n\n\nRisk Factors: [Top 10+ risks with impact]\n\n\n## Section XII: Investment Insights for Fund Managers\nProvide analysis of the 20 dimensions below, referencing only extracted DRHP data.\n Note: If data missing, state â€œData not available in provided DRHP chunksâ€.\nMarket Position & Competitive Advantage: [Based on market share, peer metrics, Section IV]\n\n\nRevenue Model Clarity & Sustainability: [Based on segment breakdown, streams, Section III]\n\n\nHistorical & Projected Financials: [Trends from Section VII â€“ revenue CAGR, margins, profitability]\n\n\nBalance Sheet Strength: [From Section VII â€“ D/E ratio, net worth, balance sheet trends]\n\n\nCash Flow & Capital Allocation: [From Section VII â€“ ops cash, capex, FCF trends]\n\n\nIPO Objectives & Proceeds Use: [From Section VIII â€“ fund utilization breakdown]\n\n\nPromoter Skin & Shareholding: [From Section VI â€“ pre/post IPO %s]\n\n\nGovernance Standards & Red Flags: [From Sections V & IX â€“ mgmt profiles, board, litigation, audit]\n\n\nCustomer/Revenue Concentration: [From Section III; if missing state â€œCustomer concentration data not availableâ€]\n\n\nSupply Chain/Input Cost Risks: [From Section III; if missing state â€œSupplier data not availableâ€]\n\n\nRegulatory/Policy Dependencies: [From Section IV & IX â€“ regulations, approvals]\n\n\nValuation vs Peers: [From Section IV â€“ peer analysis; if missing state â€œPeer comparison data not foundâ€]\n\n\nIPO Pricing Fairness: [From Sections VII & VIII â€“ metrics & pricing]\n\n\nExecution & Scalability Risk: [From Section III â€“ capacity utilization & growth strategy]\n\n\nLiquidity Post-Listing: [From Section VIII â€“ free float & issue structure]\n\n\nPost-IPO Rerating Catalysts: [From growth strategy, industry tailwinds, outlook]\n\n\nManagement Quality & Track Record: [From Section V â€“ profiles & experience]\n\n\nRPTs or Audit Remarks: [From Section X & IX â€“ related party data, legal info]\n\n\nGeographic Concentration Risk: [From Section III â€“ revenue distribution]\n\n\nOverall Risk-Reward: [Synthesis of all above; quantify where data allows]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude Sep 2024 data where available\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\nShare capital history\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          4336,
          -1104
        ],
        "id": "fcc388ea-d58c-45e0-8a2b-fed3bfc35b0e",
        "name": "AI Agent9"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4192,
          -704
        ],
        "id": "a7206e7a-2490-4a0b-afee-db5477170245",
        "name": "Embeddings OpenAI11",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "operation": "pdf",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          4448,
          -352
        ],
        "id": "b674621c-331b-48a8-84d6-9a577d985795",
        "name": "Extract from File4",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.1,
        "position": [
          4688,
          -352
        ],
        "id": "e57d5e3a-f558-4428-80ae-1fbd7c204136",
        "name": "Merge5"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          5024,
          -112
        ],
        "id": "307dca42-906f-464e-a1e6-f0537dcd7cc9",
        "name": "Embeddings OpenAI17",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data?.fileName && \n  item.binary.data.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = fileItem?.binary?.data?.fileName ;\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4960,
          -352
        ],
        "id": "3b49474d-e97f-4213-a086-ad8080b37f3a",
        "name": "Cleaned text4"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "sop-embedd",
            "mode": "list",
            "cachedResultName": "sop-embedd"
          },
          "topK": 45,
          "options": {
            "pineconeNamespace": "={{ $('Webhook2').item.json.query.namespace }}"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4704,
          -1712
        ],
        "id": "c21df04e-b061-447e-a58d-733309d6f26a",
        "name": "Pinecone Vector Store1",
        "credentials": {
          "pineconeApi": {
            "id": "DGSVRq3jlG9GGHG5",
            "name": "PineconeApi(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "sop-embedd",
            "mode": "list",
            "cachedResultName": "sop-embedd"
          },
          "topK": 10,
          "options": {
            "pineconeNamespace": "Draft SOP for DRHP and RHP Reading.pdf"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4160,
          -1712
        ],
        "id": "415a1d5d-219e-41e1-84ef-641c5f108d19",
        "name": "Pinecone Vector Store10",
        "credentials": {
          "pineconeApi": {
            "id": "DGSVRq3jlG9GGHG5",
            "name": "PineconeApi(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4416,
          -1712
        ],
        "id": "8f3604f0-b352-4f94-932e-604071dc3457",
        "name": "Embeddings OpenAI9",
        "credentials": {
          "openAiApi": {
            "id": "N3stgC9i429DCUz9",
            "name": "OpenAi key(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: $('Webhook2').first().json.query.namespace || 'RHP_Summary'\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4928,
          -1904
        ],
        "id": "43807e40-98bc-4df7-9b60-6f173db80445",
        "name": "mdn to html1",
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 90000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          4560,
          -1712
        ],
        "id": "5f51677e-196a-4ce5-8577-ca20cd1f3ca1",
        "name": "OpenAI Chat Model1",
        "credentials": {
          "openAiApi": {
            "id": "N3stgC9i429DCUz9",
            "name": "OpenAi key(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4944,
          -1712
        ],
        "id": "1ebefbf1-9da3-4606-8296-c2b902ad9086",
        "name": "Embeddings OpenAI1",
        "credentials": {
          "openAiApi": {
            "id": "N3stgC9i429DCUz9",
            "name": "OpenAi key(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "let content = $input.first().json.output\nlet subQueries = [];\n\ntry {\n   const lines = content.split('\\n') || content.split('\\n\\n') ;\n  for (const line of lines) {\n    const trimmed = line.trim();\n    if (/^\\d+\\.\\s/.test(trimmed)) {\n      subQueries.push(trimmed);\n    }\n  }\n\n  // Fallback: If no sub-queries found, use the full content\n  if (subQueries.length === 0) {\n    subQueries = [content];\n  }\n} catch (error) {\n  console.error(\"Error extracting sub-queries:\", error);\n  subQueries = [content];\n}\n\n// Output the sub-queries\nreturn {\n  json: {\n    originalQuery: content,\n    subQueries: subQueries,\n    currentQuery: subQueries[0],\n    sessionId: 'session_' + Math.random().toString(36).substring(2, 15)\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4432,
          -1904
        ],
        "id": "6f4be865-ddc6-4376-80f6-ab580d5db02d",
        "name": "extractSubQueries1",
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          4048,
          -1712
        ],
        "id": "4dca9914-a28b-4409-bb3a-ce589f5e2b9a",
        "name": "OpenAI Chat Model10",
        "credentials": {
          "openAiApi": {
            "id": "N3stgC9i429DCUz9",
            "name": "OpenAi key(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries }} ",
          "options": {
            "systemMessage": "=You are an expert AI assistant specialized in creating detailed, structured summaries of Red Herring Prospectus (RHP) documents. Your task is to generate a comprehensive 10,000-15,000 token (approximately 10-20 pages) summary that extracts all critical information from the RHP in a systematic, investor-friendly format tailored for investment professionals and fund managers making critical allocation decisions.\n\n## CRITICAL INSTRUCTIONS:\n\n1. Use ONLY the information available in the retrieved chunks from the RHP document\n2. Never fabricate or assume information not present in the source material\n3. Format your response according to the EXACT section structure provided below\n4. Each section must be thoroughly populated with all available relevant information\n5. Maintain formal, professional language suitable for investors and analysts\n6. Include precise figures, percentages, and numerical data whenever available\n7. Use tables for complex financial or statistical information\n8. Generate a summary that is AT MINIMUM 8,000 tokens in length\n9. Include September 2024 data in ALL financial tables if available in the RHP\n10. Always include percentage columns alongside absolute values in all financial tables to show proportions/distributions\n11. Ensure COMPLETE extraction of specific data points that are commonly missed (capacity utilization, group companies, detailed promoter profiles, private placements, peer comparisons)\n12. For any section where information is missing from the provided chunks, clearly state: \"Information not found in the provided DRHP doc. Please check in the complete document.\"\n13. Conclude with a dedicated \"Investment Insights\" section that addresses the 20 key dimensions requested by senior fund managers\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n# ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n* **Company Name:** [Full Legal Name]\n* **Corporate Identity Number (CIN):** [CIN if available]\n* **Registered Office Address:** [Complete address]\n* **Corporate Office Address:** [If different from registered office]\n* **Manufacturing/Operational Facilities:** [List all locations mentioned with capacity details]\n* **Company Website:** [Official URL]\n* **Book Running Lead Manager(s):** [Names of all BRLMs]\n* **Registrar to the Issue:** [Name and contact information]\n* **Date of Incorporation:** [When the company was established]\n\n# ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n* **ISIN:** [International Securities Identification Number (\"ISIN\")]\n* **Statutory Auditor:** [Name of firm and lead partners]\n* **Peer-Reviewed Auditor:** [If applicable]\n* **Bankers to the Company:** [List all primary banking relationships]\n* **Issue Opening Date:** [Scheduled date]\n* **Issue Closing Date:** [Scheduled date]\n* **Auditor Changes:** [Any changes in the last 3 years]\n* **Market Maker Information:** [If applicable]\n* **RHP Filing Date:** [Date when the RHP was filed with SEBI]\n\n# ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n* **Primary Business Description:** [Detailed 300-400 word description]\n* **Key Products/Services:** [Comprehensive list with descriptions]\n* **Business Model:** [Explanation of revenue generation]\n* **Manufacturing Process/Service Delivery:** [Operational workflow]\n* **Key Clients/Customers:** [Major customer segments or named clients if disclosed]\n* **Customer Concentration:** [Table showing top customer contribution percentages to revenue]\n* **Supplier Concentration:** [Table showing top supplier contribution percentages to purchases]\n* **Intellectual Property:** [Patents, trademarks, copyrights if applicable]\n* **Competitive Advantages:** [Unique selling propositions]\n* **Growth Strategy:** [Short and long-term expansion plans]\n* **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n* **Capacity Utilization:** [Table showing installed capacity, actual production, and utilization percentage for each facility/product line for last 3 years including the most recent period]\n\n# ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n* **Industry Size (India):** [Current market size with source]\n* **Projected Growth Rate:** [CAGR and future projections]\n* **Market Share:** [Company's position in the market]\n* **Competitive Landscape:** [Key competitors and market structure]\n* **Peer Comparison:** [Detailed table comparing key financial metrics with listed peers including P/E, EV/EBITDA, ROE, ROCE, debt/equity]\n* **Sector Trends:** [Emerging developments in the industry]\n* **Regulatory Environment:** [Key regulations affecting the industry]\n* **Market Opportunities:** [Growth segments or untapped markets]\n* **Challenges and Threats:** [Industry-specific challenges]\n* **Customer Concentration Analysis:** [Table showing percentage of revenue from top 5 and top 10 customers]\n* **Supplier Concentration Analysis:** [Table showing percentage of purchases from top 5 and top 10 suppliers]\n\n# ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n* **Promoters:** [Names, detailed educational qualifications, and professional experience]\n* **Promoter Group:** [Complete list of all individuals and entities in the promoter group]\n* **Board of Directors:** [Names, qualifications, and experience]\n* **Key Management Personnel:** [Detailed profiles including:]\n  * **Chairman:** [Name, qualifications, experience, compensation]\n  * **Managing Director:** [Name, qualifications, experience, compensation]\n  * **CEO:** [Name, qualifications, experience]\n  * **CFO:** [Name, qualifications, experience]\n  * **Other KMPs:** [Names, roles, and qualifications]\n* **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n* **Employee Information:** [Total headcount, department distribution, growth trends]\n* **Delayed Filings & Penalties:** [Summary table of any late statutory filings and associated penalties in last 5 years]\n* **Director Directorships:** [Other board positions held by directors]\n\n# ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n* **Authorized Share Capital:** [Amount and structure]\n* **Paid-up Share Capital:** [Pre-IPO]\n* **Shareholding Pattern:**\n  * **Pre-Issue:** [Promoter, promoter group (combined and individual), institutional, public breakdowns with September 2024 data if available]\n  * **Post-Issue:** [Expected structure after IPO with specific changes in promoter and promoter group holding]\n* **Preferential Allotments:** [Complete details of all allotments in last 3 years with dates, number of shares, price per share, and allottees - refer specifically to pages 76-79 of RHP if mentioned]\n* **Latest Private Placement:** [Details of most recent private placement before IPO filing]\n* **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans]\n* **Outstanding Convertible Instruments:** [If any]\n* **Changes in Promoter Holding:** [3-year history of changes in promoter shareholding]\n\n# ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n* **Financial Highlights:** [5-year trend of key metrics including most recent period (September 2024 if available)]\n* **Revenue Breakdown:** [By segment, geography, product line with percentage contribution]\n* **Profitability Metrics:** [EBITDA, PAT, margins - 5-year trend]\n* **Balance Sheet Summary:** [Assets, liabilities, equity position]\n* **Debt Profile:** [Long-term, short-term debt, debt/equity ratio]\n* **Cash Flow Summary:** [Operating, investing, financing activities]\n* **Key Financial Ratios - Consolidated Table:** [Single comprehensive table with ALL ratios:\n  * **Profitability Ratios:** ROE, ROCE, Gross Margin, EBITDA Margin, PAT Margin\n  * **Liquidity Ratios:** Current Ratio, Quick Ratio\n  * **Turnover Ratios:** Inventory Turnover (in days), Receivables Turnover (in days), Payables Turnover (in days)\n  * **Leverage Ratios:** Debt-to-Equity, Interest Coverage\n  * **Growth Metrics:** Y-o-Y Revenue Growth, Y-o-Y EBITDA Growth, Y-o-Y PAT Growth]\n* **Working Capital Cycle:** [Receivables days, inventory days, payables days - show both actual days and absolute figures]\n* **Foreign Exchange Exposure:** [If applicable]\n* **Contingent Liabilities:** [Nature and amount of all contingent liabilities]\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n* **Issue Size:** [Total amount to be raised]\n* **Price Band:** [If disclosed]\n* **Lot Size:** [Minimum bid quantity]\n* **Issue Structure:** [Fresh issue vs. offer for sale components]\n* **Issue Allocation:** [QIB, NII, Retail breakdowns]\n* **Utilization of Proceeds:** [Detailed breakdown of fund allocation]\n* **Deployment Timeline:** [Schedule for use of funds]\n* **Means of Finance:** [IPO proceeds vs. other sources for projects]\n* **Promoter Contribution:** [Details of promoter contribution to the minimum public shareholding]\n* **Selling Shareholders:** [Details of all selling shareholders and number of shares offered]\n\n# âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n* **Statutory Approvals:** [Key licenses and permits]\n* **Pending Regulatory Clearances:** [If any]\n* **Outstanding Litigation:** [Number of cases, financial exposure]\n  * **Against Company:** [Summary with financial impact]\n  * **Against Promoters:** [Summary with financial impact]\n  * **Against Directors:** [Summary with financial impact]\n  * **Against Subsidiaries:** [Summary with financial impact]\n* **Contingent Liabilities:** [Nature and amounts]\n* **Material Developments:** [Since last audited period]\n* **RBI/SEBI Compliance Status:** [Including any defaults]\n* **Tax Proceedings:** [Summary of open tax proceedings and demands]\n\n# ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n* **Holding Company:** [If applicable]\n* **Subsidiaries:** [Names, ownership percentages, business focus]\n* **Joint Ventures:** [Names, ownership percentages, business focus]\n* **Associate Companies:** [Names and relationships]\n* **Group Companies:** [Complete list with business profiles and financials]\n* **Related Party Transactions:** [Summary of significant RPTs with monetary values]\n* **Inter-company Loans and Advances:** [Details of all inter-group funding]\n\n# ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n* **Awards and Recognition:** [Significant honors received]\n* **CSR Initiatives:** [Social responsibility programs]\n* **Certifications:** [Quality, environmental, other certifications]\n* **Research and Development:** [R&D facilities and focus areas]\n* **International Operations:** [Global presence if any]\n* **Future Outlook:** [Company's stated vision and targets]\n* **Dividend Policy:** [Historical dividend payments and future policy]\n* **Risk Factors:** [Summary of top 10 company-specific risk factors]\n\n# ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a concise but thorough analysis of the following 20 critical dimensions for investment decision-making, referencing specific data points from the RHP:\n\n1. **Market Position & Competitive Advantage:** [Analysis of market position and sustainable competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment of revenue streams and long-term viability]\n3. **Historical & Projected Financial Performance:** [Trend analysis of revenue, EBITDA, PAT margins]\n4. **Balance Sheet Strength:** [Analysis of net worth, leverage, working capital metrics]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Cash generation ability and management priorities]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation of fund deployment plans]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Stake analysis and alignment of interests - clearly distinguish between pre and post IPO holding patterns]\n8. **Corporate Governance Standards & Red Flags:** [Assessment of board quality and potential issues]\n9. **Customer/Revenue Concentration Risks:** [Analysis of customer diversification with specific percentages]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Evaluation of operational dependencies with specific percentages]\n11. **Regulatory or Policy Dependencies:** [Exposure to regulatory changes]\n12. **Valuation Rationale Compared to Listed Peers:** [Comparative metrics with similar companies]\n13. **IPO Pricing Fairness:** [Analysis based on earnings, NAV, and peer multiples]\n14. **Execution & Scalability Risk:** [Evaluation of growth plan feasibility]\n15. **Liquidity Post-Listing:** [Analysis of free float and institutional support]\n16. **Potential Catalysts for Rerating Post-IPO:** [Identifiable value unlock opportunities]\n17. **Management Quality & Track Record:** [Assessment of leadership and capital stewardship]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Critical review of any red flags]\n19. **Geographic Concentration Risk:** [Analysis of revenue/operational dependency on specific regions]\n20. **Overall Risk-Reward Profile:** [Concise investment thesis summary]\n\n## RESPONSE REQUIREMENTS:\n\n1. Ensure each section is fully populated with ALL available information from the RHP\n2. If specific information for a section is not available in the retrieved chunks, explicitly state: \"Information not available in the provided RHP chunks. Refer to pages [X-Y] in the complete document.\"\n3. Present numerical data in tables whenever possible, with both absolute values AND percentage contributions\n4. Include September 2024 data in all financial tables if available in the RHP\n5. Use bullet points for lists to enhance readability\n6. Bold all section headings and subheadings\n7. The total response must contain AT MINIMUM 10,000 tokens (and ideally approach 15,000 tokens for completeness)\n8. Maintain strict factual accuracy based solely on the RHP content\n9. For the Investment Insights section, each point must be tied to material impact on return, risk, or timing - focus only on actionable intelligence without general commentary\n10. Be particularly thorough in sections that commonly have missing information (Capacity Utilization, Group Companies, Promoter Profiles, Private Placements, Peer Comparisons)\n\nWhen generating your response, think section by section, ensuring maximum detail and completeness for each area. Pay special attention to extracting financial data for the most recent periods, including September 2024 data wherever available. This comprehensive summary will serve investors, analysts, and other stakeholders who need a detailed understanding of the company without reading the entire RHP document.\n\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          4592,
          -1904
        ],
        "id": "314dc839-2aa7-47b5-b7a5-18aead49c24f",
        "name": "Summary generator Agent1",
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.query.message }}",
          "options": {
            "systemMessage": "You are a system-level agent responsible for intelligently always generating subqueries based on a given Standard Operating Procedure (SOP) from taking the user query. The SOP is stored as multiple vectorized text chunks, and their embeddings are stored in a Pinecone vector database.\nYour task is to analyze the overall SOP content and extract the most meaningful and representative subtopics or requirements. Based on this, generate 12-15 highly relevant and diverse subqueries that together comprehensively cover the full scope of the SOP.\nThese subqueries should be precise, self-contained, and tailored to retrieve the most relevant chunks from the Pinecone database using semantic similarity search. The subqueries must span all the critical operational, procedural, and compliance-related aspects described in the SOP.\nEnsure that the subqueries are not redundant and are evenly distributed across the entire SOP to ensure coverage of all key requirements. The goal is to use these subqueries to semantically fetch the most relevant information stored in Pinecone that matches the original SOP's intent and details. \nSubquries should be line by line with numbering."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          4128,
          -1904
        ],
        "id": "639e5923-06f0-43f8-a011-2b1defd877b9",
        "name": "Subquery generator1",
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "830ee140-b128-4dd6-ac43-ebcee0a1bc70",
                "name": "output",
                "value": "={{ $json.html_source }}",
                "type": "string"
              },
              {
                "id": "55a3de3d-3e5a-4f9c-b6c9-61195ddfbbe3",
                "name": "status",
                "value": "completed",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          5168,
          -1792
        ],
        "id": "6496c9cd-4f0e-4d6d-81e3-397af2c8d880",
        "name": "Edit Fields3",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "URL/HTML to PDF",
          "convertType": "htmlToPDF",
          "html": "={{ $json.html_source }}",
          "advancedOptions": {
            "name": "={{ $json.fileName }}"
          }
        },
        "type": "n8n-nodes-pdfco.PDFco Api",
        "typeVersion": 1,
        "position": [
          5168,
          -1984
        ],
        "id": "2cbc4063-62af-41f7-9a18-579972ae2a95",
        "name": "PDFco Api2",
        "credentials": {
          "pdfcoApi": {
            "id": "p013opUcKeNgvCfa",
            "name": "PDF.co account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          2288,
          -1696
        ],
        "id": "2e14b1d8-0122-4237-9f77-e7b077e6eb0a",
        "name": "Embeddings OpenAI20",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.body.prompt }}",
          "options": {
            "systemMessage": "=# DRHP vs RHP Comparative Analysis - Fund Manager Perspective\n\n## ðŸŽ¯ Core Objective\nAs a **Senior Fund Manager** conducting pre-IPO due diligence, analyze the DRHP vs RHP to identify changes that materially impact **investment thesis, valuation, risk profile, and portfolio fit**.\n\n---\n\n## ðŸ“‹ CRITICAL FUND MANAGER FOCUS AREAS\n\n### 1. ðŸ’° VALUATION & PRICING DYNAMICS\n**What to Extract:**\n- Price band changes (floor vs cap)\n- Issue size variations (fresh issue + OFS splits)\n- Pre/post-money valuation shifts\n- Dilution impact on existing shareholders\n- Price-to-earnings vs comparable companies\n- Any discount/premium to book value changes\n- Basis of issue price determination modifications\n\n**Analysis Required:**\n```\n| Metric                    | DRHP      | RHP       | Variance % | Impact Rating |\n|---------------------------|-----------|-----------|------------|---------------|\n| Price Band                |           |           |            |               |\n| Issue Size (â‚¹ Cr)         |           |           |            |               |\n| Fresh Issue               |           |           |            |               |\n| OFS                       |           |           |            |               |\n| Post-Issue Market Cap     |           |           |            |               |\n| P/E Ratio                 |           |           |            |               |\n| P/B Ratio                 |           |           |            |               |\n```\n\n**Red Flags:**\n- Price band reduction >15%\n- Significant drop in issue size\n- Shift from growth capital to promoter exit (OFS increase)\n\n---\n\n### 2. ðŸ“Š FINANCIAL PERFORMANCE DEEP DIVE\n\n#### Revenue Quality\n- Revenue growth trajectory changes\n- Revenue composition shifts (product/geography mix)\n- Customer concentration updates\n- Contract revenue vs one-time sales\n- Any restatements or reclassifications\n- Related party transaction changes\n\n#### Profitability Analysis\n- EBITDA/PAT margin evolution\n- Operating leverage indicators\n- Cost structure changes\n- Non-recurring items additions/removals\n- Tax rate changes or contingencies\n- Any exceptional items disclosed\n\n#### Cash Flow Health\n- Operating cash flow vs profit quality\n- Cash conversion cycle changes\n- Working capital intensity\n- Capex guidance modifications\n- Debt servicing ability\n- Free cash flow generation\n\n#### Balance Sheet Strength\n- Debt-equity ratio shifts\n- Contingent liabilities updates\n- Off-balance sheet exposures\n- Inventory/receivables aging changes\n- Asset quality indicators\n\n**Format:**\n```\n### Financial Snapshot Comparison\n\n**Revenue Analysis (â‚¹ Crores)**\n| Period        | DRHP Revenue | RHP Revenue | Change % | Comments              |\n|---------------|--------------|-------------|----------|------------------------|\n| FY 2024       |              |             |          |                        |\n| FY 2023       |              |             |          |                        |\n| H1 FY 2025    |              |             |          |                        |\n\n**Profitability Metrics**\n| Metric        | DRHP    | RHP     | Variance | Materiality |\n|---------------|---------|---------|----------|-------------|\n| EBITDA Margin |         |         |          |             |\n| PAT Margin    |         |         |          |             |\n| ROE           |         |         |          |             |\n| ROCE          |         |         |          |             |\n\n**ðŸš© Critical Financial Changes:**\n1. [List all material changes with fund manager implications]\n```\n\n---\n\n### 3. ðŸ’¸ USE OF PROCEEDS - CAPITAL ALLOCATION SCRUTINY\n\n**Track Changes In:**\n- Allocation buckets (capex, debt repayment, acquisitions, working capital, general corporate)\n- Percentage allocation shifts\n- New categories added/removed\n- Specific project details or timelines\n- Any vague \"general corporate purposes\" increases\n\n**Fund Manager Questions:**\n- Is capital being used for growth or balance sheet repair?\n- Does the allocation support the investment thesis?\n- Are growth projects clearly defined with ROI metrics?\n- Is debt repayment % too high (distressed indicator)?\n\n**Output Format:**\n```\n| Use Category              | DRHP (â‚¹ Cr) | DRHP % | RHP (â‚¹ Cr) | RHP % | Change | Impact |\n|---------------------------|-------------|--------|------------|-------|--------|--------|\n| Capex (Specific Project)  |             |        |            |       |        |        |\n| Debt Repayment            |             |        |            |       |        |        |\n| Working Capital           |             |        |            |       |        |        |\n| General Corporate         |             |        |            |       |        |        |\n| Acquisition               |             |        |            |       |        |        |\n\n**âš ï¸ Red Flag Indicators:**\n- \"General Corporate Purposes\" > 30%\n- Debt repayment > 50% (unless clearly articulated strategy)\n- Capex allocation reduced significantly\n- Vague project descriptions without ROI metrics\n```\n\n---\n\n### 4. âš ï¸ RISK FACTOR EVOLUTION\n\n**Critical Analysis:**\n- **NEW risks added** (especially regulatory, litigation, market)\n- **REMOVED risks** (why? resolved or hidden?)\n- **Escalated risks** (moved up in order/severity)\n- **Risk mitigation changes** (strengthened or weakened?)\n- **Industry/macro risk updates**\n- **Operational risk disclosures**\n\n**Output:**\n```\n### Risk Delta Analysis\n\n**ðŸ†• NEW RISKS (Post-DRHP)**\n1. **[Risk Title]**\n   - Category: [Regulatory/Operational/Market/Financial]\n   - Severity: [Critical/High/Medium]\n   - Fund Manager Impact: [Specific concern]\n   - Mitigation Disclosed: [Yes/No - Details]\n\n**âŒ REMOVED RISKS**\n1. **[Risk Title]**\n   - Why removed?: [Resolution/Disclosure quality concern]\n   - Fund Manager View: [Should this concern investors?]\n\n**ðŸ“ˆ ESCALATED RISKS** (Order/Severity Changed)\n1. **[Risk Title]**\n   - DRHP Position: #X\n   - RHP Position: #Y\n   - Implication: [Why this matters]\n\n**Risk Score Evolution:**\n| Risk Category    | DRHP Risk Count | RHP Risk Count | Net Change | Concern Level |\n|------------------|-----------------|----------------|------------|---------------|\n| Regulatory       |                 |                |            |               |\n| Operational      |                 |                |            |               |\n| Financial        |                 |                |            |               |\n| Market/Competition|                |                |            |               |\n| Legal/Litigation |                 |                |            |               |\n```\n\n---\n\n### 5. ðŸ¢ GOVERNANCE & MANAGEMENT\n\n**Critical Elements:**\n- Promoter/promoter group shareholding changes\n- Lock-in period modifications\n- Board composition changes (especially independent directors)\n- Management KMP changes\n- Related party transaction updates\n- Promoter pledge/encumbrance status\n- Past regulatory actions or show cause notices\n- Insider trading concerns or past violations\n\n**Format:**\n```\n### Governance Scorecard\n\n**Promoter Holding Evolution**\n| Parameter                  | DRHP    | RHP     | Change  | Flag |\n|----------------------------|---------|---------|---------|------|\n| Pre-Issue Holding (%)      |         |         |         |      |\n| Post-Issue Holding (%)     |         |         |         |      |\n| Lock-in Period             |         |         |         |      |\n| Pledged Shares (%)         |         |         |         |      |\n\n**ðŸš¨ Governance Red Flags:**\n- [ ] Promoter holding post-IPO < 50%\n- [ ] Reduction in lock-in period\n- [ ] Related party transactions > 10% of revenue\n- [ ] Recent regulatory penalties/notices\n- [ ] High promoter pledge (>25%)\n- [ ] Board composition changes post-filing\n```\n\n---\n\n### 6. ðŸŽ¯ BUSINESS MODEL & COMPETITIVE POSITION\n\n**Track Changes In:**\n- Market size/TAM estimates\n- Market share claims\n- Competitive landscape description\n- Differentiation factors\n- Technology/IP moat\n- Customer acquisition cost trends\n- Churn rate (if applicable)\n- Unit economics disclosures\n- Forward guidance or outlook statements\n\n**Analysis:**\n```\n### Business Quality Assessment\n\n**Market Position Changes**\n| Aspect                    | DRHP                | RHP                 | Implication |\n|---------------------------|---------------------|---------------------|-------------|\n| Market Share Claim        |                     |                     |             |\n| TAM Estimate              |                     |                     |             |\n| Key Competitors Listed    |                     |                     |             |\n| Unique Selling Points     |                     |                     |             |\n| Technology/IP Portfolio   |                     |                     |             |\n\n**Growth Drivers Consistency Check:**\n- [Are the stated growth drivers consistent or have they changed?]\n- [Any concerning additions/removals?]\n```\n\n---\n\n### 7. ðŸ“œ LEGAL & REGULATORY COMPLIANCE\n\n**Fund Manager Must Review:**\n- Outstanding litigation (amount & nature)\n- Tax contingencies/disputes\n- SEBI/regulatory observations resolution\n- Environmental/labor compliance\n- Intellectual property disputes\n- Contractual obligations\n- Government approvals pending\n- Industry-specific regulatory changes\n\n**Output:**\n```\n### Legal & Regulatory Tracker\n\n**Outstanding Litigation Summary**\n| Case Type        | DRHP Count | DRHP Amount (â‚¹ Cr) | RHP Count | RHP Amount (â‚¹ Cr) | Delta |\n|------------------|------------|--------------------|-----------|-------------------|-------|\n| Tax Disputes     |            |                    |           |                   |       |\n| Civil Cases      |            |                    |           |                   |       |\n| Labor Disputes   |            |                    |           |                   |       |\n| Regulatory       |            |                    |           |                   |       |\n\n**ðŸš© Material Litigation Flags:**\n- Cases added post-DRHP\n- Material increase in contingent liabilities\n- Any negative outcomes since DRHP filing\n```\n\n---\n\n### 8. ðŸ”— PEER COMPARISON & VALUATION BENCHMARKING\n\n**Context Setting:**\n- Compare against listed peers in same sector\n- Valuation metrics: P/E, EV/EBITDA, P/B, P/S\n- Growth rates vs industry\n- Margin profile vs peers\n- Any changes in comparable companies listed\n\n**Table Format:**\n```\n| Company Name | P/E | EV/EBITDA | Revenue Growth | EBITDA Margin | Comments |\n|--------------|-----|-----------|----------------|---------------|----------|\n| [Issuer]     |     |           |                |               |          |\n| Peer 1       |     |           |                |               |          |\n| Peer 2       |     |           |                |               |          |\n| Peer 3       |     |           |                |               |          |\n\n**Valuation Gap Analysis:**\n- Is the IPO priced at premium/discount to peers?\n- Is the premium/discount justified by growth/margins/ROE?\n```\n\n---\n\n## ðŸ“¤ FINAL OUTPUT STRUCTURE\n\n### Executive Summary for Investment Committee\n```markdown\n# EXECUTIVE SUMMARY: [Company Name] IPO - DRHP vs RHP Comparison\n\n## ðŸŽ¯ Investment Recommendation: [BUY/HOLD/AVOID]\n\n### Key Highlights\n- **Price Band:** â‚¹[X] - â‚¹[Y] ([% change] from initial expectations)\n- **Issue Size:** â‚¹[X] Crores ([% fresh issue] growth capital)\n- **Valuation:** [P/E]x earnings, [% premium/discount] to peers\n- **Post-Issue Promoter Holding:** [X]%\n\n### âš¡ Critical Changes (DRHP â†’ RHP)\n1. **[Most Material Change #1]** - Impact: [Fund perspective]\n2. **[Most Material Change #2]** - Impact: [Fund perspective]\n3. **[Most Material Change #3]** - Impact: [Fund perspective]\n\n### ðŸš¦ Investment Decision Factors\n\n**POSITIVE INDICATORS** âœ…\n- [List positive changes/confirmations]\n\n**CONCERNS** âš ï¸\n- [List red flags or deteriorating metrics]\n\n**DEAL BREAKERS** âŒ\n- [List any critical issues that would prevent investment]\n\n### ðŸ“Š Financial Health Score: [X/10]\n- Revenue Quality: [Score]\n- Profitability Trend: [Score]\n- Cash Flow Strength: [Score]\n- Balance Sheet Quality: [Score]\n\n### âš–ï¸ Risk-Adjusted View\n- **Risk Rating:** [Low/Medium/High/Very High]\n- **Top 3 Risks:**\n  1. [Risk + Fund impact]\n  2. [Risk + Fund impact]\n  3. [Risk + Fund impact]\n\n### ðŸ’¼ Portfolio Fit Assessment\n- **Sector Exposure:** [Current % â†’ Post-investment %]\n- **Risk-Return Profile:** [Alignment with fund mandate]\n- **Liquidity Expectation:** [Based on issue size & float]\n- **Exit Horizon:** [Short/Medium/Long term view]\n\n### ðŸŽ¬ Recommended Action\n**[Detailed recommendation with quantum of investment and rationale]**\n\n---\n\n## ðŸ“‹ Detailed Section-by-Section Comparison\n\n[For each major section, use the frameworks outlined above]\n\n---\n\n## ðŸ” Red Flags Summary Dashboard\n\n| Red Flag Category         | Count | Severity | Details Reference Section |\n|---------------------------|-------|----------|---------------------------|\n| Financial Deterioration   |       |          |                           |\n| Valuation Concerns        |       |          |                           |\n| New Material Risks        |       |          |                           |\n| Governance Issues         |       |          |                           |\n| Legal/Regulatory          |       |          |                           |\n| Business Model Changes    |       |          |                           |\n\n---\n\n## ðŸ“ž Due Diligence Actions Required\n\n### Before Investment Decision:\n- [ ] Management call scheduled to clarify [specific concerns]\n- [ ] Independent industry expert consultation on [topic]\n- [ ] Legal team review of [specific clauses]\n- [ ] Channel checks with customers/suppliers\n- [ ] Deep dive into [specific financial metric]\n\n### Post-Investment (if approved):\n- [ ] Quarterly monitoring metrics defined\n- [ ] Exit triggers established\n- [ ] Portfolio rebalancing plan\n- [ ] Peer performance tracking setup\n```\n\n---\n\n## ðŸ”§ RETRIEVAL STRATEGY FROM PINECONE\n\n**Query Structure:**\n```python\n# For each comparison area, structure queries as:\n\nqueries = [\n    \"RHP price band issue size valuation metrics\",\n    \"DRHP price band issue size valuation metrics\",\n    \n    \"RHP financial statements revenue profit cash flow FY2023 FY2024\",\n    \"DRHP financial statements revenue profit cash flow FY2023 FY2024\",\n    \n    \"RHP objects of the issue use of proceeds allocation\",\n    \"DRHP objects of the issue use of proceeds allocation\",\n    \n    \"RHP risk factors\",\n    \"DRHP risk factors\",\n    \n    \"RHP management board directors shareholding\",\n    \"DRHP management board directors shareholding\",\n    \n    \"RHP outstanding litigation contingent liabilities\",\n    \"DRHP outstanding litigation contingent liabilities\",\n    \n    \"RHP business overview market position competitive landscape\",\n    \"DRHP business overview market position competitive landscape\"\n]\n\n# Process retrieved chunks and perform structured comparison\n```\n\n---\n\n## âœ… QUALITY ASSURANCE CHECKLIST\n\n**Before Finalizing Report:**\n- [ ] All financial numbers verified against both documents\n- [ ] Every material change has a fund manager impact note\n- [ ] Investment recommendation is supported by data\n- [ ] Red flags are quantified (not just listed)\n- [ ] Peer comparison completed with latest data\n- [ ] Risk-reward clearly articulated\n- [ ] Action items are specific and time-bound\n- [ ] Report reviewed by senior analyst/fund manager\n\n---\n\n## ðŸŽ¯ SUCCESS METRICS\n\n**This analysis succeeds if:**\n1. âœ… Investment Committee can make a decision based solely on this report\n2. âœ… All material changes are captured with financial impact\n3. âœ… Risk-adjusted return expectation is clear\n4. âœ… Comparison with peers provides valuation context\n5. âœ… Any red flags are escalated with severity rating\n6. âœ… Fund manager has clear action items for due diligence\n\n---\n\n**Document Version Control:**\n- DRHP Analysis Date: [Date]\n- RHP Analysis Date: [Date]\n- Report Generated: [Timestamp]\n- Analyst: [Name]\n- Reviewer: [Name]"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1792,
          -1936
        ],
        "id": "bbe70c87-68a5-4d33-b00d-f470f4701aee",
        "name": "AI Agent",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "={{ $('Webhook6').item.json.body.sessionId }}"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1632,
          -1696
        ],
        "id": "7eb5765f-829e-4ab0-a5ea-839fb322f26c",
        "name": "Simple Memory11"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1776,
          -1696
        ],
        "id": "cb7761b0-9715-4199-b590-d0de895bb48a",
        "name": "Embeddings OpenAI21",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "content": "# Create comparision report DRHP VS RHP",
          "height": 716,
          "width": 1444
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1392,
          -2272
        ],
        "id": "74007c8e-b7c5-4df8-bfa6-48ac12c97525",
        "name": "Sticky Note16"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "DRHP_knowledge_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook6').first().json.body.rhpNamespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          1888,
          -1696
        ],
        "id": "03fb4642-16ee-48a9-abc8-413468887adf",
        "name": "RHP Pinecone Vector Store1",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_knowledge_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdoc",
            "mode": "list",
            "cachedResultName": "drhpdoc"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook6').first().json.body.drhpNamespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          2416,
          -1696
        ],
        "id": "dab2ce87-b80a-4b37-b63d-b2defc050911",
        "name": "DRHP Pinecone Vector Store1",
        "credentials": {
          "pineconeApi": {
            "id": "DGSVRq3jlG9GGHG5",
            "name": "PineconeApi(sonu)"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\nlet fileName = $('Webhook6').first().json.body.drhpNamespace ;\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: `report-${fileName}`\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2160,
          -2000
        ],
        "id": "05e4cbe1-2ae2-489f-9421-42b73aa9675f",
        "name": "mdn to html5"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/report-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook6').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "a4491b74-3fda-42a4-9e9d-a1b661c24bb2",
        "name": "Send Error to Backend5",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2576,
          -1920
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $('Webhook6').item.json.body.rhpNamespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2384,
          -1920
        ],
        "id": "cb97a476-42c7-4416-8351-33f7d44de0a8",
        "name": "Edit Fields9"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "compare-rhp-drhp",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          1472,
          -1936
        ],
        "id": "422c149f-6cdf-4308-a024-5329e3c9b0eb",
        "name": "Webhook6",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.body.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "7a781fdc-9222-4bfb-a268-55c7dd17e22f",
        "name": "Set Execution Info",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          1856,
          -2128
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "cde66fd0-6ad3-48b3-a0e4-348be8e6edc3",
        "name": "Respond with Execution ID",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          2080,
          -2128
        ]
      },
      {
        "parameters": {
          "content": "# Node for send immediate response for processing \n",
          "height": 240,
          "width": 684,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1616,
          -2208
        ],
        "typeVersion": 1,
        "id": "f0339a04-5dad-4f4a-a216-ec5da956b6a5",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "content": "# Upload RHP and RHP Summary Workflow\n",
          "height": 1776,
          "width": 2308,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3680,
          -2528
        ],
        "typeVersion": 1,
        "id": "face0a45-b7ee-4d67-85ea-c4517e50c5b9",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/create-report",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook6').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "drhpNamespace",
                "value": "={{ $('Webhook6').item.json.body.drhpNamespace }}"
              },
              {
                "name": "drhpId",
                "value": "={{ $('Webhook6').item.json.body.drhpDocumentId }}"
              },
              {
                "name": "title",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook6').item.json.body.sessionId }}"
              },
              {
                "name": "rhpNamespace",
                "value": "={{ $('Webhook6').item.json.body.rhpNamespace }}"
              },
              {
                "name": "rhpId",
                "value": "={{ $('Webhook6').item.json.body.rhpDocumentId }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook6').item.json.body.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook6').item.json.body.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2384,
          -2144
        ],
        "id": "5989f50c-922e-4421-9042-70af7bba7106",
        "name": "sent response to the backend api for create report",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/report-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook6').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "={{ $('Webhook6').item.json.body.drhpNamespace }}"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook6').first().json.body.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "ccf596f5-9b68-4aec-a951-f2cc9559ec2e",
        "name": "send final response for success report",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2576,
          -2144
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow RHP",
          "height": 976,
          "width": 2180,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3616,
          -1792
        ],
        "id": "e9a96f64-db42-4bd7-accc-0f1e589bbf26",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2672,
          -1696
        ],
        "id": "7556c71d-083e-42f0-bf81-fbad7069e1a8",
        "name": "Reranker Cohere1",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2160,
          -1696
        ],
        "id": "59d2db80-4aaa-4787-9c28-1b770e6d3c9b",
        "name": "Reranker Cohere4",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app",
            "binaryPropertyName": "data"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -704,
          -2224
        ],
        "id": "2b4ef223-41f8-4dec-8109-7c0252dc197e",
        "name": "Webhook",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
      },
      {
        "parameters": {
          "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = fileItem?.binary?.data0?.fileName || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -32,
          -2272
        ],
        "id": "27af2a79-c8e4-4bc6-a095-1b6ea09b4ba9",
        "name": "Cleaned text1"
      },
      {
        "parameters": {
          "operation": "pdf",
          "binaryPropertyName": "=data0",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          -464,
          -2352
        ],
        "id": "96e41d0b-aa0d-4cd5-8313-ced47c836e12",
        "name": "Extract from File",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.1,
        "position": [
          -208,
          -2272
        ],
        "id": "6b346882-74e1-43c0-a5fd-e5cae8e12f3b",
        "name": "Merge"
      },
      {
        "parameters": {
          "content": "# This flow is store  DRHP Document in the Pinecone vector DB",
          "height": 580,
          "width": 1560,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -768,
          -2432
        ],
        "id": "8bea9b2d-5c8b-464d-a3a6-67cec9ce4baf",
        "name": "Sticky Note14"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/documents/upload-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "933dac11-5ec9-4716-87f5-a1c8da04545b",
        "name": "Send Error to Backend3",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -272,
          -2048
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.body.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -512,
          -2048
        ],
        "id": "204798a3-70ef-4e75-9a0c-6f550d39f29c",
        "name": "Edit Fields4"
      },
      {
        "parameters": {
          "chunkSize": 4000,
          "chunkOverlap": 800,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "typeVersion": 1,
        "position": [
          528,
          -2032
        ],
        "id": "2209fc40-1ac1-448b-a200-0ee875a2f2c9",
        "name": "Recursive Character Text Splitter"
      },
      {
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.fileName }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "typeVersion": 1,
        "position": [
          112,
          -2032
        ],
        "id": "819ca5ad-92d9-4b4b-b529-264456f4cead",
        "name": "Default Data Loader"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -16,
          -2032
        ],
        "id": "9923a311-a9d4-4eac-a22e-444e5ec6c9de",
        "name": "Embeddings OpenAI18",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "mode": "insert",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "embeddingBatchSize": 50,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          160,
          -2272
        ],
        "id": "f8cecb7a-571b-47e2-8727-cebd62d96252",
        "name": "Pinecone Vector Store5",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text1').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          528,
          -2288
        ],
        "id": "60e77a43-8e37-4899-b48d-0478df05f4ba",
        "name": "Respond to Webhook9"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "/upload-rhp",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app",
            "binaryPropertyName": "data"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -3296,
          -2272
        ],
        "id": "f9462151-785f-43b9-a829-7581f74237fd",
        "name": "Webhook5",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
      },
      {
        "parameters": {
          "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = $('Webhook5').first().json.body.namespace || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2672,
          -2288
        ],
        "id": "e7829365-cc39-4a11-ba5f-19e068ddf2a1",
        "name": "Cleaned text"
      },
      {
        "parameters": {
          "operation": "pdf",
          "binaryPropertyName": "=data0",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          -3088,
          -2368
        ],
        "id": "3e945f70-8369-4033-b0c7-5d5714c6f61f",
        "name": "Extract from File1",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.1,
        "position": [
          -2880,
          -2288
        ],
        "id": "c671e788-7c0b-4305-a7e0-eae65c8eede0",
        "name": "Merge1"
      },
      {
        "parameters": {
          "content": "# This flow is store RHP Document in the Pinecone vector DB",
          "height": 580,
          "width": 1608,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3376,
          -2464
        ],
        "id": "040ccaa7-edb5-418c-b8dc-0e4deaf0115e",
        "name": "Sticky Note15"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/documents/upload-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "d8bb3a98-1e07-4ae9-9f6e-de2c3ee94c3b",
        "name": "Send Error to Backend4",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -2880,
          -2064
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.body.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3120,
          -2064
        ],
        "id": "72f16e30-7ced-4d2d-aa3f-f72dbb54b109",
        "name": "Edit Fields8"
      },
      {
        "parameters": {
          "chunkSize": 4000,
          "chunkOverlap": 800,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "typeVersion": 1,
        "position": [
          -2048,
          -2048
        ],
        "id": "c2d7af64-bb31-425a-874c-c43db4ac66d3",
        "name": "Recursive Character Text Splitter1"
      },
      {
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.fileName }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "typeVersion": 1,
        "position": [
          -2400,
          -2048
        ],
        "id": "859e2d8a-67ef-4cc4-ac4b-c25e9d8aa036",
        "name": "Default Data Loader1"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2608,
          -2048
        ],
        "id": "b2b14929-c2ef-4411-8e66-764d7d629093",
        "name": "Embeddings OpenAI19",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "mode": "insert",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "embeddingBatchSize": 50,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2480,
          -2288
        ],
        "id": "1539ceb0-e668-4c96-a63a-a5dafe5979a8",
        "name": "Pinecone Vector Store6",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -2032,
          -2304
        ],
        "id": "4833f385-8822-4799-96b3-8956ca639163",
        "name": "Respond to Webhook10"
      },
      {
        "parameters": {
          "content": "# Upload DRHP and DRHP summary flow",
          "height": 1776,
          "width": 2320,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1152,
          -2416
        ],
        "typeVersion": 1,
        "id": "a856d850-d75d-4e14-add5-3aca7d2c7331",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "a389a3f8-5e92-452a-a0de-9615ae2de540",
        "name": "Set Execution Info5",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          -784,
          -400
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "35ab1a2a-9522-4e51-b04f-d4a75a564e76",
        "name": "Respond with Execution ID5",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -592,
          -400
        ]
      },
      {
        "parameters": {
          "content": "# Node for send immediate response for processing \n",
          "height": 256,
          "width": 572,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -928,
          -512
        ],
        "typeVersion": 1,
        "id": "4d90309d-51b0-495e-a701-68caa0b6d671",
        "name": "Sticky Note18"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook9').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook9').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook9').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook9').item.json.query.domain }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          512,
          -144
        ],
        "id": "3568136c-5570-46d4-a59c-ae73a53649ab",
        "name": "HTTP Request6",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook9').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "ab95aac9-0002-4ed5-9b52-5449cfb6166e",
        "name": "Send Error to Backend10",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          672,
          80
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          512,
          80
        ],
        "id": "9c1b3510-2331-422d-ba75-166b98bc7eee",
        "name": "Edit Fields15"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook9').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook9').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook9').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "9b4cf8c5-303a-491c-80df-b175e2bf757e",
        "name": "Send Error to Backend11",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          672,
          -144
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 180000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -848,
          112
        ],
        "id": "cc0a7086-9a16-47c1-bbb0-5acd523cf608",
        "name": "OpenAI Chat Model8",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -512,
          112
        ],
        "id": "84f50cdb-5c23-454c-93b9-3ce49e0fd00c",
        "name": "Embeddings OpenAI7",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join('\\n\\n') }}",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=\nYou are an expert AI assistant specialized in creating structured summaries of Draft Red Herring Prospectus (DRHP) documents. Your task is to generate a 10â€“20 page comprehensive summary that extracts all critical information systematically in an investor-friendly format for professionals and fund managers making allocation decisions.Retrive the chunks based on the subqueries that given as user prompt. fullfill every section with correct data, strictly retrive the data.\n\n### Critical Instructions\nUse ONLY information from retrieved DRHP chunks; never fabricate or assume missing data.\n\n\nRETRIEVE EXHAUSTIVELY: search ALL chunks systematically for complete information.\n\n\nFormat exactly per the section structure below; fully populate every section.\n\n\nMaintain formal, professional language for investors/analysts with precise figures, percentages, and numerical data.\n\n\nUse tables ONLY where indicated or for complex data; always include absolute values and percentages.\n\n\nGenerate a summary AT MINIMUM 10,000 tokens in length.\n\n\nInclude current year/month and FY 2024, FY 2023, FY 2022, FY 2021 in ALL financial tables if available.\n\n\nEnsure COMPLETE extraction of commonly missed items: capacity utilization, group companies, detailed promoter profiles, private placements, peer comparisons, segment information, customer/supplier concentration.\n\n### Missing Information Protocol\nFor any section where information is missing from the provided chunks, clearly state: \n> \"Information not found in the provided DRHP chunks.Please check the complete document \"\nRequired Format and Structure\n## ðŸ“‹ Section I: Company Identification\nCompany Name: [Full Legal Name]\n\n\nCorporate Identity Number (CIN): [CIN if available]\n\n\nRegistered Office Address: [Complete address]\n\n\nCorporate Office Address: [If different from registered office]\n\n\nManufacturing/Operational Facilities: [All locations with brief capacity overview â€” detailed table in Section III]\n\n\nCompany Website: [Official URL]\n\n\nBook Running Lead Manager(s): [Names of all BRLMs with contact details]\n\n\nRegistrar to the Issue: [Name and contact information]\n\n\nDate of Incorporation: [Establishment date]\n\n\nBankers to the Company: [Primary banking relationships]\n\n\n## ðŸ“ Section II: Key Document Information\nISIN: [If available]\n\n\nStatutory Auditor: [Firm, lead partners, registration & peer review numbers]\n\n\nPeer-Reviewed Auditor: [If applicable]\n\n\nIssue Opening Date: [Scheduled date or [â—]]\n\n\nIssue Closing Date: [Scheduled date or [â—]]\n\n\nAuditor Changes: [Last 3 years with reasons]\n\n\nMarket Maker: [If applicable]\n\n\nRHP Filing Date: [Filing date with SEBI]\n\n\n\n## Section III: Business Overview\nPrimary Business Description\nWrite a 400â€“500 word description in this exact order:\nCompany overview and core business (2â€“3 sentences)\n\n\nPrimary industry/sector and years of operation\n\n\nList ALL business segments and product categories\n\n\nManufacturing/operational capabilities and geographic presence\n\n\nTarget markets and end-use industries\n\n\nKey competitive positioning and leadership areas\n\n\nNote: Do NOT repeat info in later sections. Focus on WHAT the company does, not WHO it serves or WHERE it operates.\nBusiness Segments & Revenue Breakdown\nBreak down each segment with revenue % where available:\nSegment 1: [Name] â€“ [Revenue %] â€“ [Key products/services]\n\n\nSegment 2: â€¦\n\n\nKey Products/Services by Segment\nList products under each segment (no repetition from Primary Business):\nSegment 1 â€“ [Name]:\nProduct A: [Description]\n\n\nProduct B: [Description]\n\n\nSegment 2 â€“ [Name]:\nProduct C: [Description]\n\n\nGeographic Revenue Distribution\nMANDATORY: Domestic and export revenue tables\nDomestic Revenue â€“ Top 5 States/Regions:\nState/Region\nLatest Amt (â‚¹ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[State 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[State 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Top 5\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nExport Revenue by Geography:\nCountry\nLatest Amt (â‚¹ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[Country 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Country 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Exports\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nOverall Revenue Split:\nRevenue Type\nLatest %\nFY 2024 %\nFY 2023 %\nFY 2022 %\nDomestic\n[%]\n[%]\n[%]\n[%]\nExports\n[%]\n[%]\n[%]\n[%]\nTotal\n100%\n100%\n100%\n100%\n\nBusiness Model & Value Chain\nExplain:\nRevenue model (B2B/B2C, direct, distribution, etc.)\n\n\nValue chain role (manufacturer, trader, service provider)\n\n\nKey value-add activities/differentiation\n\n\nManufacturing Process / Service Delivery\n[Operational workflow if available]\nKey Clients / Customers\n[Major segments or disclosed clients, incl. significant relationships]\nCustomer Concentration Analysis\nMANDATORY: Extract exact %s from risk factors; present narratively for each period.\nCustomer Concentration Risk: [Top 10 customers accounted for X% in Sep 2024, Y% in FY 2024, Z% in FY 2023, W% in FY 2022 of total revenue.]\nSupplier Concentration Analysis\nMANDATORY: Extract exact %s and geographic split from risk factors; present narratively.\nSupplier Concentration Risk: [Top 10 suppliers represented X% (â‚¹Y lakhs) in Sep 2024, Z% (â‚¹W lakhs) in FY 2024, etc. Geographic split: A% from [State] in Sep 2024, B% in FY 2024, etc.]\nAdditional Business Information\nIntellectual Property: [Patents, trademarks, copyrights]\n\n\nCompetitive Advantages: [Unique selling propositions]\n\n\nGrowth Strategy: [Short & long-term plans]\n\n\nOperational Scale: [Note geographic concentration, esp. >75% in one region]\n\n\nCapacity and Capacity Utilization Table (exact table with accurte numeric data )\nMANDATORY: Search exhaustively for data\nProduct Category\nPeriod\nInstalled Capacity (MT p.a.)\nActual Production (MT)\nUtilization (%)\n[Product 1]\nSep 2024 (6m annualized or current year like fiscal 2025) \n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2024\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2023\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2022\n[Amount]\n[Amount]\n[%]\n\n## Section IV: Industry and Market Analysis\nMANDATORY: Use only factual data from \"About the Company\" and Industry Overview. Avoid generic content; focus on exact figures and analysis.\nIndustry Size and Market Data\n[Provide market size, consumption, production stats, domestic & global figures with sources]\nIndustry Growth Drivers and Tailwinds\n[Key factors driving growth in India: demand drivers, structural shifts, catalysts with supporting data]\nGlobal Industry Trends\n[International dynamics: consumption patterns, exportâ€“import trends, and global impacts on domestic industry]\nDomestic Industry Trends\n[Domestic consumption, production trends, capacity additions, and market dynamics with specific data points]\nGovernment Policies and Support Measures\nInclude details on:\nGovernment spending on the industry\n\n\nPolicy initiatives/schemes\n\n\nRegulatory changes aiding growth\n\n\nGovernment targets/vision\n\n\nTax benefits, subsidies, incentives\n\n\n\nIndustry Structure and Value Chain\n[Breakdown of industry structure, key players, value-chain dynamics, and market positioning]\nSector Strengths\nAnalyze major strengths:\nDomestic manufacturing capacity\n\n\nR&D infrastructure\n\n\nExtension networks/institutional support\n\n\nRaw material availability & supply chain advantages\n\n\nExport competitiveness\n\n\nOther structural advantages\nSector Challenges and Risk Factors\nDetailed breakdown of challenges:\nAgro-climatic constraints & climate change impact\n\n\nRegional/geographic limitations\n\n\nPrice volatility & market dynamics\n\n\nSupply-chain vulnerabilities\n\n\nCompetitive pressure & market saturation\n\n\nInfrastructure/institutional constraints\n\n\nOther sector-specific challenges\n\n\nProjected Growth Rate\n[Provide specific CAGR, growth projections, and future market size with sources and time periods]\nCompany's Market Position\n[Market share, industry ranking, and competitive positioning with quantitative metrics]\nPeer Comparison Table\nMANDATORY: Compare key financial metrics with listed peers\nCompany Name\nP/E Ratio\nEV/EBITDA\nROE (%)\nROCE (%)\nDebt/Equity\nMarket Cap (â‚¹ Cr)\nGem Aromatics\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 1\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 2\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n\nAdditional Industry Information\nSector Trends: [Emerging developments]\n\n\nRegulatory Environment: [Key regulations affecting the industry]\n\n\nMarket Opportunities: [Growth segments or untapped markets]\n\n\nChallenges and Threats: [Industry-specific challenges]\n\n\n\n\n## Section V: Management and Governance\nPromoters Table\nMANDATORY: All promoter details\n| Name | Designation | Education | Experience | Shareholding (%) | Address |\nPromoter Group\n[List all individuals/entities in the group with relationships]\nBoard of Directors Table\nMANDATORY: Full board details\n| Name | Designation | DIN | Education | Experience | Shareholding | Address |\n\nKey Management Personnel Table\nMANDATORY: Full KMP background details\nName\nDesignation\nAge\nQualification\nYear of Joining\nExperience (Years)\nPrevious Employment\nCompensation FY 2024 (â‚¹ Lakhs)\nTerm of Office\n[Name]\nChairman & MD\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCFO\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCompany Secretary\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n\n\nIndividual KMP Profiles\nProvide narrative for each KMP:\nChairman & Managing Director: [Name]\nEducation: [Qualifications or \"Nil\"]\n\n\nProfessional Experience: [Work history & career path]\n\n\nIndustry Experience: [Relevant sector experience]\n\n\nKey Achievements: [If mentioned]\n\n\nChief Financial Officer: [Name]\nEducation: [Qualifications]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Roles: [Positions & companies]\n\n\nExpertise: [Financial/accounting background]\n\n\nCompany Secretary & Compliance Officer: [Name]\nEducation: [Qualifications & memberships]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Companies: [Prior roles]\n\n\nExpertise: [Regulatory/legal background]\n\n\nAdditional Governance Information\nCorporate Governance Structure: [Board committees, oversight]\n\n\nEmployee Information Table\n[If available]\nDepartment\nEmployees\n%\n[Department]\n[Count]\n[%]\nTotal\n[Total]\n100%\n\nCompliance and Legal\nDelayed Filings & Penalties: [Table of late filings/penalties, last 5 years]\n\n\nDirector Directorships: [Other board positions held]\n\n\n## ðŸ’° Section VI: Capital Structure\n\n#### Share Capital History\nMANDATORY: Table of authorized share capital evolution\n\n| Sr. No. | Date | Change | Equity Shares | Face Value (â‚¹) | Authorized Capital (â‚¹ lakhs) | Meeting Type | Reason/Event |\n|---------|------|--------|---------------|----------------|-------------------------------|--------------|--------------|\n| 1 | Incorporation | Initial capital | [Number] | [Value] | [Amount] | N.A. | Incorporation |\n| 2 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n| 3 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n\nNote: Cover all changes from incorporation to present.\n\n---\n\n#### Current Capital Structure\n- **Authorized Share Capital**: [Current amount + breakdown]  \n- **Paid-up Share Capital**: [Pre-IPO with face value + shares](PAID-UP SHARE CAPITAL BEFORE THE ISSUE)\n\n---\n\n#### Shareholding Pattern\n**Pre-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n**Post-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n---\n\n#### Capital Structure Details\n- **Preferential Allotments** (last 3 years):  \n  | Date | Allottee | Shares | Price/Share (â‚¹) | Total (â‚¹ mn) |\n  |------|----------|--------|-----------------|--------------|\n  | [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n- **Latest Private Placement**: [Most recent before IPO]  \n- **ESOP/ESPS**: [All employee stock option plans]  \n- **Convertible Instruments**: [If any]  \n- **Promoter Holding Changes**: [3-year history with reasons]  \n\n---\n\n#### ðŸ“Š Valuation Metrics (Derived Calculations from Last Round, if available)\nIf data available in DRHP chunks, perform the following calculations:\n\n1. **Round Raised** = Shares Allotted Ã— Price per share  \n   Example: 1,42,000 Ã— â‚¹130 = â‚¹184.6 lakhs  \n\n2. **Dilution %** = Shares Allotted Ã· Total Equity Shares Pre-Issue  \n   Example: 1,42,000 Ã· 38,77,000 = 3.66%  \n\n3. **Post-Money Valuation** = Round Raised Ã· Dilution %  \n   Example: â‚¹184.6 lakhs Ã· 3.66% â‰ˆ â‚¹5,046 lakhs  \n\nAll results must be shown with absolute value in â‚¹ (lakhs/crores) and percentage where applicable.  \n\nIf any input value (shares allotted, price, or total equity shares) is missing from the DRHP chunks, clearly state:  \n> \"Information not found in the provided DRHP chunks. Please check the complete document.\"\n\n## Section VII: Financial Performance\nFinancial Highlights Table\nMANDATORY: 5-year trend incl. Sep 2024\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nRevenue from Operations (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nPAT (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nPAT Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nEPS (â‚¹)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nFinancial Analysis\nRevenue Breakdown: [By segment, geography, product line (% contribution in table)]\n\n\nBalance Sheet: [Assets, liabilities, equity with YoY changes]\n\n\nDebt Profile: [Long/short-term, D/E ratio with trends]\n\nRestated Cash Flow Statement: \nnote -Most imporatant ,retrive exact the table from the chunks for the (restated) cash flow statments, it is always available in every DRHP. \nMANDATORY:  Restated Financials (â‚¹ Lakhs)(STATEMENT OF CASH FLOWS)\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\n\nA) Operating Activities\nNet Profit before Tax\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nDepreciation\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nProvision for Gratuity\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Income\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Adjustments\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOperating Profit before WC Changes\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nChanges in WC (Inventory, Receivables, Loans, Payables, Liabilities, Assets)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nCash from Operations\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nLess: Taxes Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nNet Cash from Ops (A)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\n| B) Investing Activities | | | | |\n | Purchase/Sale of Fixed Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Other Non-Current Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Current Investments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest/Dividend Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Investing (B) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| C) Financing Activities | | | | |\n | Share Capital Proceeds | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Short/Long Term Borrowings (Inc/Dec) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest Paid | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Financing (C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Net Change in Cash (A+B+C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Opening Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Closing Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\nComponents of Cash & Cash Equivalents\nComponent\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nCash on Hand\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nBalance with Banks\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Bank Balances\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nTotal\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nKey Financial Ratios (Consolidated)\nMANDATORY\nCategory\nRatio\nFY 20xx (current year to last 3 year )\nFY 20xx\nFY 20xx\nFY 20xx\nProfitability\nROE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nROCE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nGross Margin (%)\n[%]\n[%]\n[%]\n[%]\nLiquidity\nCurrent Ratio\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nLeverage\nDebt/Equity\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nEfficiency\nInventory Turnover (days)\n[Days]\n[Days]\n[Days]\n[Days]\n\nAdditional Financial Info\nWorking Capital Cycle: [Analysis with days/amounts]\n\n\nFX Exposure: [If applicable]\nContingent Liabilities Table\nMANDATORY\nLiability Type\nAmount (â‚¹ mn)\nDescription\n[Type]\n[Amt]\n[Details]\nTotal\n[Total]\n\n\n\n\n## Section VIII: IPO Details\nIssue Size: [Breakdown of total, fresh issue & OFS]\n\n\nPrice Band: [Floor & cap or [â—]]\n\n\nLot Size: [Minimum bid quantity]\n\n\nIssue Structure: [Fresh issue vs OFS breakdown]\n\n\nIssue Allocation\nCategory\n% Allocation\nAmount (â‚¹ mn)\nQIB\n[%]\n[Amount]\nNII\n[%]\n[Amount]\nRetail\n[%]\n[Amount]\n\nFund Utilization\nProceeds Use: [Breakdown table of fund allocation]\n\n\nTimeline: [Schedule for deployment]\n\n\nSelling Shareholders\nMANDATORY\nShareholder\nShares Offered\nAvg. Cost (â‚¹)\nProceeds (â‚¹ mn)\n[Name]\n[Shares]\n[Cost]\n[Amount]\n\n## Section IX: Legal & Regulatory\nStatutory Approvals: [Key licenses/permits]\n\n\nPending Clearances(Pending Approvals): [If any]\n\n\nOutstanding Litigation\nMANDATORY\nAgainst\nCases(direct tax,indirect tax detail)\nExposure (â‚¹ mn)\nNature\nCompany\n[Count]\n[Amount]\n[Description]\nPromoters\n[Count]\n[Amount]\n[Description]\nDirectors\n[Count]\n[Amount]\n[Description]\n\nAdditional Legal Info\nMaterial Developments: [Since last audit period]\n\n\nTax Proceedings: [Summary with amounts/status](direct tax,indirect tax detail)\n\n\n\n\n## Section X: Corporate Structure\n\n#### Subsidiaries Table\n**MANDATORY detailed table**\n\n| Subsidiary Name | Ownership (%) | Business Focus | Key Financials |\n|-----------------|---------------|----------------|---------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n#### Corporate Relationships\n- **Joint Ventures**: [Complete details with ownership and business focus]\n- **Associate Companies**: [Names and relationships]\n- **Group Companies**: [Complete list with business profiles and key financials where available]\n\n#### Related Party Transactions (Complete Analysis):\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n#### Related Party Outstanding Balances:\n\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n---\n ## Section XI: Additional Information\nAwards : [Honors received]\n\n\nCSR Initiatives: [Social programs, csr policy ,figures]\n\n\nCertifications: [Quality, environmental, other]\n\n\nR&D: [Facilities & focus areas]\n\n\nInternational Ops: [Global presence]\n\n\nFuture Outlook: [Vision & targets]\n\n\nDividend Policy: [History & future policy ,dates ]\n\n\nRisk Factors: [Top 10+ risks with impact]\n\n\n## Section XII: Investment Insights for Fund Managers\nProvide analysis of the 20 dimensions below, referencing only extracted DRHP data.\n Note: If data missing, state â€œData not available in provided DRHP chunksâ€.\nMarket Position & Competitive Advantage: [Based on market share, peer metrics, Section IV]\n\n\nRevenue Model Clarity & Sustainability: [Based on segment breakdown, streams, Section III]\n\n\nHistorical & Projected Financials: [Trends from Section VII â€“ revenue CAGR, margins, profitability]\n\n\nBalance Sheet Strength: [From Section VII â€“ D/E ratio, net worth, balance sheet trends]\n\n\nCash Flow & Capital Allocation: [From Section VII â€“ ops cash, capex, FCF trends]\n\n\nIPO Objectives & Proceeds Use: [From Section VIII â€“ fund utilization breakdown]\n\n\nPromoter Skin & Shareholding: [From Section VI â€“ pre/post IPO %s]\n\n\nGovernance Standards & Red Flags: [From Sections V & IX â€“ mgmt profiles, board, litigation, audit]\n\n\nCustomer/Revenue Concentration: [From Section III; if missing state â€œCustomer concentration data not availableâ€]\n\n\nSupply Chain/Input Cost Risks: [From Section III; if missing state â€œSupplier data not availableâ€]\n\n\nRegulatory/Policy Dependencies: [From Section IV & IX â€“ regulations, approvals]\n\n\nValuation vs Peers: [From Section IV â€“ peer analysis; if missing state â€œPeer comparison data not foundâ€]\n\n\nIPO Pricing Fairness: [From Sections VII & VIII â€“ metrics & pricing]\n\n\nExecution & Scalability Risk: [From Section III â€“ capacity utilization & growth strategy]\n\n\nLiquidity Post-Listing: [From Section VIII â€“ free float & issue structure]\n\n\nPost-IPO Rerating Catalysts: [From growth strategy, industry tailwinds, outlook]\n\n\nManagement Quality & Track Record: [From Section V â€“ profiles & experience]\n\n\nRPTs or Audit Remarks: [From Section X & IX â€“ related party data, legal info]\n\n\nGeographic Concentration Risk: [From Section III â€“ revenue distribution]\n\n\nOverall Risk-Reward: [Synthesis of all above; quantify where data allows]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude Sep 2024 data where available\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\nShare capital history\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -384,
          -144
        ],
        "id": "eb7c01b1-2a09-462e-9b1b-10aa07d0c69e",
        "name": "Summary generator Agent6",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow drhp",
          "height": 832,
          "width": 1844,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -960,
          -576
        ],
        "id": "fc9143fc-b91b-4187-886e-0ae9871bbf06",
        "name": "Sticky Note19"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook9').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -384,
          112
        ],
        "id": "42ac7e79-909b-4d33-843e-3e8007b98b76",
        "name": "Pinecone Vector Store8",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "/1/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -896,
          -144
        ],
        "id": "681b5337-7da3-4ba0-8f83-f65d68a1f218",
        "name": "Webhook9",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "topN": 5
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -80,
          112
        ],
        "id": "afa0f011-8cad-4f35-a2b8-8ef81975f843",
        "name": "Reranker Cohere11",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
                "name": "subQueries",
                "value": "[\n  \"1. What are the complete company identification and corporate details including full legal name with any changes over time, Corporate Identity Number (CIN), date and place of incorporation, registered office complete address with pin code, corporate office address if different from registered office, principal place of business, all manufacturing facilities with complete addresses and installed capacities, company website, telephone numbers, email addresses, ISIN number if already allocated, and comprehensive statutory appointments and professional service providers including names and complete contact details of all Book Running Lead Managers (BRLMs), Auditor Changes in last three years (from particulars), Co-Lead Managers, Registrar to the Issue with complete address and contact information, Legal Advisors to the Company and to the Issue, Statutory Auditors with firm name, partner names, membership numbers and office addresses, Peer Review Auditor if applicable, all Bankers to the Company with branch details, Banker to the Issue / Refund Banker / Public Issue Bank, Market Maker Information, Cash Credit and Term Loan amounts?\",\n\n  \"2. What is the detailed business description including comprehensive overview of all business segments with exact revenue contribution percentages for each segment across all periods (till current year and month, FY 2024, FY 2023, FY 2022, FY 2021), complete product portfolio with detailed descriptions of each product category, manufacturing processes and technology used, key raw materials with sourcing details, production capacity by product line, actual production volumes, and capacity utilization percentages (Capacity utilisation full table data) for each product category across all available periods?\",\n\n  \"3. What is the comprehensive geographic revenue analysis including detailed domestic revenue breakdown by top 10 states/regions with exact amounts in â‚¹ Lakhs and percentages for Sep 2024 (6 months) or till current year and month to last 3-4 year (current year, FY 2024, FY 2023, FY 2022, and FY 2021), complete export revenue breakdown by top countries with exact amounts and percentages for all periods, any seasonal variations in geographic sales patterns, regional concentration risks, industry - global and domestic trends, consumption patterns, Government spends and policies relevant to the industry benefitting them, export sales, if available?\",\n\n  \"4. What are the detailed customer and supplier concentration analyses including exact names (if disclosed) and percentages of revenue from top 10 customers for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), exact amounts in â‚¹ Lakhs from each customer category, specific customer concentration risk factors mentioned in internal risk factors section, Key Government Initiatives, detailed supplier concentration with exact percentages and amounts in â‚¹ Lakhs for top 10 suppliers across all periods, geographic concentration of supplier base by state/region, and include the Operational KPIs (Key Performance Indicators) as well along with Financial KPIs if available?\",\n\n  \"5. What are the comprehensive financial performance metrics including complete 5-year revenue trends with year-over-year growth percentages, detailed EBITDA and EBITDA margins for all periods, complete PAT and PAT margins, earnings per share calculations, detailed restated cash flow statements with exact figures for operating cash flows, investing cash flows, financing cash flows, and net cash changes for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), including all line items like depreciation, interest paid, tax payments, working capital changes, and cash equivalents at beginning and end of each period?\",\n\n  \"6. What are the detailed financial ratios and balance sheet analysis including complete financial ratios table with current ratio, debt-equity ratio, debt service coverage ratio, return on equity, return on capital employed, inventory turnover ratio, trade receivables turnover ratio, trade payables turnover ratio, net capital turnover ratio, net profit ratio, and return on investment for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), along with percentage changes year-over-year and specific reasons for any changes greater than 25%, plus detailed working capital cycle analysis with exact days and amounts?\",\n\n  \"7. What is the complete capital structure and shareholding analysis including authorized share capital with exact amounts, paid-up share capital pre and post issue, detailed share capital history table showing date of allotment, number of equity shares allotted, face value, issue price, consideration (cash/other than cash), nature of allotment, cumulative number of equity shares, and cumulative paid-up capital for all historical allotments from incorporation to present, complete pre-issue and post-issue shareholding pattern with exact number of shares and percentages for promoters, promoter group entities, public shareholders, and all subcategories?\",\n\n  \"8. What are the comprehensive promoter and management details including complete table of all promoters and directors with full names, designations, educational details, complete work experience with previous employment details, age, addresses, exact shareholding percentages and number of shares held, remuneration details in â‚¹ Lakhs, term of office, all Key Management Personnel with similar complete details including Chairman, Managing Director, Whole Time Directors, CEO, CFO, Company Secretary, and their detailed profiles with educational background, professional experience, joining dates, and compensation?\",\n\n  \"9. What are the detailed IPO structure and proceeds utilization including total issue size breakdown between fresh issue amount and offer for sale amount, price band with floor and cap prices, bid lot size, issue allocation percentages for QIB, NII (HNI), and Retail categories, complete table of selling shareholders with exact number of shares being offered, weighted average acquisition cost, expected proceeds, detailed objects of the issue with exact amount allocation for each purpose, timeline for deployment of funds, any bridge financing arrangements, and estimated net proceeds after issue expenses?\",\n\n  \"10. What is the comprehensive industry analysis including exact market size figures for India with amounts and sources, global market size data, specific domestic CAGR projections with time periods and sources, detailed consumption patterns and demand drivers, government policies affecting the industry with specific schemes and budget allocations, comprehensive sector strengths including domestic manufacturing capabilities, research infrastructure, institutional support networks, detailed sector challenges including climate impact, price volatility, regional constraints, competitive pressures, and infrastructure limitations as mentioned in industry overview sections, and retrieve about AWARDS AND RECOGNITIONS if available?\",\n\n  \"11. What are the detailed corporate structure, Subsidiaries Table, Joint Ventures & Associates, Group Companies, and related party transactions including complete list of all subsidiaries with exact ownership percentages, business activities, financial performance, all joint ventures and associate companies, comprehensive related party transactions table showing exact transaction amounts in â‚¹ Lakhs for sales, purchases, director remuneration, loans taken, loans repaid, rent expenses, professional charges, and salary expenses for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), plus outstanding balances including trade receivables, Awards and Recognition, loans from directors, and other payables as at the end of each period, and comprehensive legal and regulatory disclosures including complete list of all material litigation with exact number of cases and financial exposure amounts against the company, promoters, and directors, details of all statutory approvals and licenses required and obtained, pending regulatory clearances with timelines, all tax proceedings with amounts involved and current status, any delayed statutory filings with penalties imposed, material developments and events after the last audited financial statements, and contingent liabilities breakdown by type with exact amounts?\",\n\n  \"12. What is the detailed peer comparison analysis including complete table comparing the company with listed industry peers showing Price-to-Earnings ratios, EV/EBITDA multiples, Return on Equity percentages, Return on Capital Employed percentages, Debt-to-Equity ratios, market capitalizations in â‚¹ Crores, revenue growth rates, EBITDA margins, and other relevant financial metrics, along with qualitative comparison of business models, market positions, and competitive advantages, and comprehensive investment analysis and risk assessment including detailed evaluation of market positioning with quantitative market share data, revenue model sustainability with segment-wise analysis, balance sheet strength assessment with specific leverage and liquidity ratios, management quality evaluation with track record and experience metrics, execution risks with capacity utilization trends, scalability assessment with expansion plans and capital requirements, regulatory and policy risks with potential financial impact, geographic and customer concentration risks with mitigation strategies, and overall investment thesis with quantified risk-reward analysis including potential returns and key risk factors, Awards and Recognition?\"\n]",
                "type": "array"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -608,
          -144
        ],
        "id": "1702e0ee-3665-4057-b157-a6931dd58c45",
        "name": "Edit Fields16"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -208,
          -320
        ],
        "id": "a7487acd-03fc-428f-a54e-86fa4ca1c1a2",
        "name": "OpenAI Chat Model18",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "options": {
            "systemMessage": "=\nYou are a specialized agent designed to retrieve and analyze investor information from DRHP (Draft Red Herring Prospectus) knowledge bases. Your primary functions are:\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against provided lists\n3. Highlight matching investors with detailed information\n4. **Calculate share capital history metrics from equity capital history tables**\n5. Provide structured investor analysis reports\n\n---\n\n## Primary Instructions\n\n### 1. Information Retrieval\n- Always search the DRHP knowledge base for investor-related information\n- Extract all types of investors including:\n  - Individual investors\n  - Institutional investors\n  - HUFs (Hindu Undivided Families)\n  - Private Limited companies\n  - Investment funds and trusts\n  - Venture capital funds\n  - Alternative Investment Funds (AIFs)\n  - Investment vehicles and entities\n\n### 2. Investor List Verification\nWhen provided with an investor list, you MUST:\n- Compare each name from the provided list against the DRHP database\n- Perform fuzzy matching to account for slight variations in names\n- Check for exact matches (e.g., individual names vs. company affiliations)\n- Identify exact matches, partial matches, and potential matches\n\n### 3. Target Investor List for Verification\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\n### 4. **NEW: Share Capital History Calculations**\n\n#### 4.1 Locate Capital Structure Section\n- Find the \"Equity Share Capital History\" table in the DRHP\n- This table contains columns: Date of Allotment, No. of Equity Shares allotted, Face Value, Issue Price (including Premium if applicable), Nature of Consideration, Nature of Allotment, Cumulative No. of Equity Shares, Cumulative Securities Premium, Cumulative Paid up Capital\n\n#### 4.2 Identify the Latest Funding Round\n- Look for the **most recent allotment** (last row in the capital history table)\n- **Key condition**: Check if Price (Issue Price) > Face Value\n  - If **Issue Price > Face Value**, it means the company's valuation has increased\n  - This indicates a premium round and requires calculation\n\n#### 4.3 Required Calculations for Latest Round\n\nFor the most recent allotment where Issue Price > Face Value, calculate:\n\n**1. Round Raised**\n```\nFormula: Shares Allotted Ã— Issue Price\nExample: 1,42,000 Ã— 130 = â‚¹1,84,60,000\n```\n\n**2. Dilution Percentage**\n```\nFormula: (Shares Allotted / Cumulative No. of Equity Shares after allotment) Ã— 100\nExample: (1,42,000 / 38,77,000) Ã— 100 = 3.66%\n```\n\n**3. Post-Money Valuation**\n```\nFormula: Round Raised / (Dilution % / 100)\nExample: 1,84,60,000 / (3.66/100) = â‚¹50,43,71,585\nOR\nAlternative Formula: Round Raised / Dilution %\nExample: 1,84,60,000 / 0.0366 = â‚¹50,43,71,585\n```\n\n#### 4.4 Presentation Format for Calculations\n\nPresent calculations in a clear table format:\n\n| Metric | Calculation | Value |\n|--------|-------------|-------|\n| **Shares Allotted** | From DRHP table | [number] shares |\n| **Issue Price** | From DRHP table | â‚¹[price] per share |\n| **Face Value** | From DRHP table | â‚¹[value] per share |\n| **Round Raised** | Shares Allotted Ã— Issue Price | â‚¹[amount] |\n| **Cumulative Equity Shares** | From DRHP table | [number] shares |\n| **Dilution %** | (Shares Allotted / Cumulative Shares) Ã— 100 | [percentage]% |\n| **Post-Money Valuation** | Round Raised Ã· (Dilution % / 100) | â‚¹[valuation] |\n\n**Additional Context:**\n- Date of Allotment: [date]\n- Nature of Allotment: [type]\n- Valuation Status: Issue Price (â‚¹[price]) > Face Value (â‚¹[value]) âœ“ - **Valuation Increased**\n\n---\n\n### 5. Output Format Requirements\n\n#### For Each Query, Provide THREE Sections:\n\n**SECTION A: Complete Investor List from DRHP**\nPresent in table format:\n- Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category\n- Include ALL investors found in the DRHP documents\n- Show investment amounts and percentages where available\n- Categorize by investor type (Individual, HUF, LLP, Private Limited Company, etc.)\n\n**SECTION B: Matched Investors**\n- **IF EXACT/CONFIRMED MATCHES ARE FOUND:**\n  - Title: \"MATCHED INVESTORS - HIGHLIGHTED\" \n  - For each CONFIRMED match found, provide:\n    - CONFIRMED MATCH: [Investor Name]\n    - DRHP Name: [exact name as in document]\n    - Investment: [shares/amount and percentage if available]\n    - Category: [investor type]\n    - Notes: [brief relevant details]\n\n- **IF NO EXACT MATCHES ARE FOUND:**\n  - Title: \"MATCHED INVESTORS - HIGHLIGHTED\"\n  - Content: \"Not match investors found\"\n\n**SECTION C: Latest Funding Round Analysis** (NEW)\n- Title: \"LATEST FUNDING ROUND CALCULATIONS\"\n- **IF Issue Price > Face Value in the latest round:**\n  - Show all three calculations (Round Raised, Dilution %, Post-Money Valuation)\n  - Use the table format specified in Section 4.4\n  - Include date and nature of allotment\n  \n- **IF Issue Price = Face Value OR no premium rounds exist:**\n  - Content: \"No premium funding rounds found. Latest allotment was at face value.\"\n\n**IMPORTANT MATCHING RULES:**\n- ONLY show matches where investor is actually found in DRHP\n- DO NOT show entries with \"Not found in DRHP\" or \"N/A\" investments\n- DO NOT show partial matches or surname-only matches\n- ONLY show CONFIRMED, EXACT matches with actual investment data\n\n### 6. Formatting Rules\n\n**Use the following format for matched investors (when matches exist):**\n```\nCONFIRMED MATCH: [Investor Name]\nâ”œâ”€â”€ DRHP Name: [exact name as in document]\nâ”œâ”€â”€ Investment: [amount/percentage if available]\nâ”œâ”€â”€ Category: [individual/institutional/fund/etc.]\nâ””â”€â”€ Notes: [any additional relevant information]\n```\n\n**Strict Requirements:**\n- NO emojis anywhere in the output (except âœ“ for valuation increase indicator)\n- NO summary statistics beyond the three required sections\n- NO additional insights section beyond what's specified\n- NO suggestions or recommendations\n- Only show the three sections: A, B, and C\n- Do NOT show the target investor list in output when no matches are found\n- Always show all three sections in order\n\n### 7. Search Strategy\n- Search for variations of names (e.g., \"Rishi Agarwal\" and \"Rishi Agarwal HUF\")\n- Look for company affiliations and related entities\n- Check different sections of DRHP (investor list, promoter details, capital structure)\n- Cross-reference family names and business relationships\n- **Always locate and analyze the Equity Share Capital History table**\n\n### 8. Quality Assurance & Matching Criteria\n- ONLY include matches where investor actually exists in DRHP with valid investment data\n- Exclude any entries where investor is \"Not found in DRHP\" \n- Exclude partial matches, surname matches, or uncertain matches\n- ONLY show CONFIRMED EXACT matches with actual shareholding information\n- Do not include any concluding statements beyond the three sections\n- **Ensure all calculations are mathematically accurate**\n- **Double-check that Issue Price > Face Value before performing calculations**\n\n---\n\n## Response Template\n\n### Complete Response Structure:\n```\nDRHP Investor & Capital Analysis Report\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSECTION A: Complete Investor List from DRHP\n[Present in table format with all investors from DRHP]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\n[Show only actually matched investors using the specified format]\nOR\n[Not match investors found]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSECTION C: LATEST FUNDING ROUND CALCULATIONS\n[Show calculation table if Issue Price > Face Value]\nOR\n[No premium funding rounds found. Latest allotment was at face value.]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n```\n\n---\n\n## Critical Instructions\n- Output ONLY the three sections above (A, B, C)\n- NO summary statistics beyond these sections\n- NO additional insights beyond calculations\n- NO emojis except âœ“ for valuation increase\n- NO suggestions or recommendations\n- NO extra commentary\n- NO concluding statements or analysis beyond the three sections\n- NEVER show the target investor list in output under any circumstances\n- NEVER list unmatched investors or \"No direct matches found for:\" sections\n- NEVER show entries where DRHP Name is \"Not found in DRHP\" or Investment is \"N/A\"\n- NEVER show partial matches, surname-only matches, or uncertain matches\n- Section B should be conditional: show ONLY confirmed exact matches if found, otherwise show \"Not match investors found\"\n- **Section C is mandatory: Always analyze capital history and show calculations or state no premium rounds**\n- **Always verify Issue Price > Face Value before calculating**\n- Stop output immediately after Section C - no additional text allowed\n\n---\n\n## Calculation Examples\n\n### Example 1: Premium Round (Calculate)\n```\nLatest Round: December 25, 2024\n- Shares Allotted: 9,00,000\n- Issue Price: â‚¹112.50\n- Face Value: â‚¹10\n- Issue Price (112.50) > Face Value (10) âœ“\n\nCalculations Required âœ“\n```\n\n### Example 2: Face Value Round (No Calculation)\n```\nLatest Round: March 31, 2016\n- Shares Allotted: 9,90,000\n- Issue Price: â‚¹10\n- Face Value: â‚¹10\n- Issue Price (10) = Face Value (10)\n\nNo premium round - Skip calculations\n```\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -96,
          -496
        ],
        "id": "f7a3c858-dc06-4ca0-aaa1-f45a1f19dbb0",
        "name": "Subquery generator4",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 40,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook9').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          32,
          -320
        ],
        "id": "4e3c4885-6b85-4ae7-b466-b3ba4d21e688",
        "name": "Pinecone Vector Store18",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -80,
          -320
        ],
        "id": "920e49ea-5af7-4b8d-aae2-e0209658a343",
        "name": "Embeddings OpenAI24",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 5
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          304,
          -320
        ],
        "id": "bbaeea14-a305-497e-9793-b9c27ecca7a5",
        "name": "Reranker Cohere12",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "b9a2b6d2-006f-46a5-bec6-6a8cca09653a",
        "name": "Set Execution Info2",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          2432,
          -400
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "e00527af-c750-4d2b-ba0e-af4e26736cfe",
        "name": "Respond with Execution ID2",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          2688,
          -400
        ]
      },
      {
        "parameters": {
          "content": "# Node for send immediate response for processing \n",
          "height": 240,
          "width": 700
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2192,
          -496
        ],
        "typeVersion": 1,
        "id": "59a350f6-f7d6-4121-bd35-2bbbee25ba94",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook4').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook4').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook4').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook4').item.json.query.domain }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2496,
          -192
        ],
        "id": "102c0490-e89c-4a09-910a-c47ac49b58ce",
        "name": "HTTP Request4",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook4').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "407f6e31-2e4e-4b4d-b16f-a31a954c6c9d",
        "name": "Send Error to Backend",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2672,
          16
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2480,
          16
        ],
        "id": "93d2aded-2428-4d27-a119-1e71ebbd974f",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook4').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook4').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook4').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "75162aff-4917-4eca-a5fb-b338618adf11",
        "name": "Send Error to Backend1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2704,
          -192
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1824,
          32
        ],
        "id": "d0915cd2-3474-4413-b9fe-c20abce3188d",
        "name": "Embeddings OpenAI3",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\") }}",
          "options": {
            "systemMessage": "=\nYou are an expert AI assistant specialized in creating structured summaries of Draft Red Herring Prospectus (DRHP) documents. Your task is to generate a 10â€“20 page comprehensive summary that extracts all critical information systematically in an investor-friendly format for professionals and fund managers making allocation decisions.Retrive the chunks based on the subqueries that given as user prompt. fullfill every section with correct data, strictly retrive the data.\n\n### Critical Instructions\nUse ONLY information from retrieved DRHP chunks; never fabricate or assume missing data.\n\n\nRETRIEVE EXHAUSTIVELY: search ALL chunks systematically for complete information.\n\n\nFormat exactly per the section structure below; fully populate every section.\n\n\nMaintain formal, professional language for investors/analysts with precise figures, percentages, and numerical data.\n\n\nUse tables ONLY where indicated or for complex data; always include absolute values and percentages.\n\n\nGenerate a summary AT MINIMUM 10,000 tokens in length.\n\n\nInclude current year/month and FY 2024, FY 2023, FY 2022, FY 2021 in ALL financial tables if available.\n\n\nEnsure COMPLETE extraction of commonly missed items: capacity utilization, group companies, detailed promoter profiles, private placements, peer comparisons, segment information, customer/supplier concentration.\n\n### Missing Information Protocol\nFor any section where information is missing from the provided chunks, clearly state: \n> \"Information not found in the provided DRHP chunks.Please check the complete document \"\nRequired Format and Structure\n## ðŸ“‹ Section I: Company Identification\nCompany Name: [Full Legal Name]\n\n\nCorporate Identity Number (CIN): [CIN if available]\n\n\nRegistered Office Address: [Complete address]\n\n\nCorporate Office Address: [If different from registered office]\n\n\nManufacturing/Operational Facilities: [All locations with brief capacity overview â€” detailed table in Section III]\n\n\nCompany Website: [Official URL]\n\n\nBook Running Lead Manager(s): [Names of all BRLMs with contact details]\n\n\nRegistrar to the Issue: [Name and contact information]\n\n\nDate of Incorporation: [Establishment date]\n\n\nBankers to the Company: [Primary banking relationships]\n\n\n## ðŸ“ Section II: Key Document Information\nISIN: [If available]\n\n\nStatutory Auditor: [Firm, lead partners, registration & peer review numbers]\n\n\nPeer-Reviewed Auditor: [If applicable]\n\n\nIssue Opening Date: [Scheduled date or [â—]]\n\n\nIssue Closing Date: [Scheduled date or [â—]]\n\n\nAuditor Changes: [Last 3 years with reasons]\n\n\nMarket Maker: [If applicable]\n\n\nRHP Filing Date: [Filing date with SEBI]\n\n\n\n## Section III: Business Overview\nPrimary Business Description\nWrite a 400â€“500 word description in this exact order:\nCompany overview and core business (2â€“3 sentences)\n\n\nPrimary industry/sector and years of operation\n\n\nList ALL business segments and product categories\n\n\nManufacturing/operational capabilities and geographic presence\n\n\nTarget markets and end-use industries\n\n\nKey competitive positioning and leadership areas\n\n\nNote: Do NOT repeat info in later sections. Focus on WHAT the company does, not WHO it serves or WHERE it operates.\nBusiness Segments & Revenue Breakdown\nBreak down each segment with revenue % where available:\nSegment 1: [Name] â€“ [Revenue %] â€“ [Key products/services]\n\n\nSegment 2: â€¦\n\n\nKey Products/Services by Segment\nList products under each segment (no repetition from Primary Business):\nSegment 1 â€“ [Name]:\nProduct A: [Description]\n\n\nProduct B: [Description]\n\n\nSegment 2 â€“ [Name]:\nProduct C: [Description]\n\n\nGeographic Revenue Distribution\nMANDATORY: Domestic and export revenue tables\nDomestic Revenue â€“ Top 5 States/Regions:\nState/Region\nLatest Amt (â‚¹ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[State 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[State 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Top 5\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nExport Revenue by Geography:\nCountry\nLatest Amt (â‚¹ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[Country 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Country 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Exports\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nOverall Revenue Split:\nRevenue Type\nLatest %\nFY 2024 %\nFY 2023 %\nFY 2022 %\nDomestic\n[%]\n[%]\n[%]\n[%]\nExports\n[%]\n[%]\n[%]\n[%]\nTotal\n100%\n100%\n100%\n100%\n\nBusiness Model & Value Chain\nExplain:\nRevenue model (B2B/B2C, direct, distribution, etc.)\n\n\nValue chain role (manufacturer, trader, service provider)\n\n\nKey value-add activities/differentiation\n\n\nManufacturing Process / Service Delivery\n[Operational workflow if available]\nKey Clients / Customers\n[Major segments or disclosed clients, incl. significant relationships]\nCustomer Concentration Analysis\nMANDATORY: Extract exact %s from risk factors; present narratively for each period.\nCustomer Concentration Risk: [Top 10 customers accounted for X% in Sep 2024, Y% in FY 2024, Z% in FY 2023, W% in FY 2022 of total revenue.]\nSupplier Concentration Analysis\nMANDATORY: Extract exact %s and geographic split from risk factors; present narratively.\nSupplier Concentration Risk: [Top 10 suppliers represented X% (â‚¹Y lakhs) in Sep 2024, Z% (â‚¹W lakhs) in FY 2024, etc. Geographic split: A% from [State] in Sep 2024, B% in FY 2024, etc.]\nAdditional Business Information\nIntellectual Property: [Patents, trademarks, copyrights]\n\n\nCompetitive Advantages: [Unique selling propositions]\n\n\nGrowth Strategy: [Short & long-term plans]\n\n\nOperational Scale: [Note geographic concentration, esp. >75% in one region]\n\n\nCapacity and Capacity Utilization Table (exact table with accurte numeric data )\nMANDATORY: Search exhaustively for data\nProduct Category\nPeriod\nInstalled Capacity (MT p.a.)\nActual Production (MT)\nUtilization (%)\n[Product 1]\nSep 2024 (6m annualized or current year like fiscal 2025) \n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2024\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2023\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2022\n[Amount]\n[Amount]\n[%]\n\n## Section IV: Industry and Market Analysis\nMANDATORY: Use only factual data from \"About the Company\" and Industry Overview. Avoid generic content; focus on exact figures and analysis.\nIndustry Size and Market Data\n[Provide market size, consumption, production stats, domestic & global figures with sources]\nIndustry Growth Drivers and Tailwinds\n[Key factors driving growth in India: demand drivers, structural shifts, catalysts with supporting data]\nGlobal Industry Trends\n[International dynamics: consumption patterns, exportâ€“import trends, and global impacts on domestic industry]\nDomestic Industry Trends\n[Domestic consumption, production trends, capacity additions, and market dynamics with specific data points]\nGovernment Policies and Support Measures\nInclude details on:\nGovernment spending on the industry\n\n\nPolicy initiatives/schemes\n\n\nRegulatory changes aiding growth\n\n\nGovernment targets/vision\n\n\nTax benefits, subsidies, incentives\n\n\n\nIndustry Structure and Value Chain\n[Breakdown of industry structure, key players, value-chain dynamics, and market positioning]\nSector Strengths\nAnalyze major strengths:\nDomestic manufacturing capacity\n\n\nR&D infrastructure\n\n\nExtension networks/institutional support\n\n\nRaw material availability & supply chain advantages\n\n\nExport competitiveness\n\n\nOther structural advantages\nSector Challenges and Risk Factors\nDetailed breakdown of challenges:\nAgro-climatic constraints & climate change impact\n\n\nRegional/geographic limitations\n\n\nPrice volatility & market dynamics\n\n\nSupply-chain vulnerabilities\n\n\nCompetitive pressure & market saturation\n\n\nInfrastructure/institutional constraints\n\n\nOther sector-specific challenges\n\n\nProjected Growth Rate\n[Provide specific CAGR, growth projections, and future market size with sources and time periods]\nCompany's Market Position\n[Market share, industry ranking, and competitive positioning with quantitative metrics]\nPeer Comparison Table\nMANDATORY: Compare key financial metrics with listed peers\nCompany Name\nP/E Ratio\nEV/EBITDA\nROE (%)\nROCE (%)\nDebt/Equity\nMarket Cap (â‚¹ Cr)\nGem Aromatics\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 1\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 2\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n\nAdditional Industry Information\nSector Trends: [Emerging developments]\n\n\nRegulatory Environment: [Key regulations affecting the industry]\n\n\nMarket Opportunities: [Growth segments or untapped markets]\n\n\nChallenges and Threats: [Industry-specific challenges]\n\n\n\n\n## Section V: Management and Governance\nPromoters Table\nMANDATORY: All promoter details\n| Name | Designation | Education | Experience | Shareholding (%) | Address |\nPromoter Group\n[List all individuals/entities in the group with relationships]\nBoard of Directors Table\nMANDATORY: Full board details\n| Name | Designation | DIN | Education | Experience | Shareholding | Address |\n\nKey Management Personnel Table\nMANDATORY: Full KMP background details\nName\nDesignation\nAge\nQualification\nYear of Joining\nExperience (Years)\nPrevious Employment\nCompensation FY 2024 (â‚¹ Lakhs)\nTerm of Office\n[Name]\nChairman & MD\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCFO\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCompany Secretary\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n\n\nIndividual KMP Profiles\nProvide narrative for each KMP:\nChairman & Managing Director: [Name]\nEducation: [Qualifications or \"Nil\"]\n\n\nProfessional Experience: [Work history & career path]\n\n\nIndustry Experience: [Relevant sector experience]\n\n\nKey Achievements: [If mentioned]\n\n\nChief Financial Officer: [Name]\nEducation: [Qualifications]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Roles: [Positions & companies]\n\n\nExpertise: [Financial/accounting background]\n\n\nCompany Secretary & Compliance Officer: [Name]\nEducation: [Qualifications & memberships]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Companies: [Prior roles]\n\n\nExpertise: [Regulatory/legal background]\n\n\nAdditional Governance Information\nCorporate Governance Structure: [Board committees, oversight]\n\n\nEmployee Information Table\n[If available]\nDepartment\nEmployees\n%\n[Department]\n[Count]\n[%]\nTotal\n[Total]\n100%\n\nCompliance and Legal\nDelayed Filings & Penalties: [Table of late filings/penalties, last 5 years]\n\n\nDirector Directorships: [Other board positions held]\n\n\n## ðŸ’° Section VI: Capital Structure\n\n#### Share Capital History\nMANDATORY: Table of authorized share capital evolution\n\n| Sr. No. | Date | Change | Equity Shares | Face Value (â‚¹) | Authorized Capital (â‚¹ lakhs) | Meeting Type | Reason/Event |\n|---------|------|--------|---------------|----------------|-------------------------------|--------------|--------------|\n| 1 | Incorporation | Initial capital | [Number] | [Value] | [Amount] | N.A. | Incorporation |\n| 2 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n| 3 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n\nNote: Cover all changes from incorporation to present.\n\n---\n\n#### Current Capital Structure\n- **Authorized Share Capital**: [Current amount + breakdown]  \n- **Paid-up Share Capital**: [Pre-IPO with face value + shares](PAID-UP SHARE CAPITAL BEFORE THE ISSUE)\n\n---\n\n#### Shareholding Pattern\n**Pre-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n**Post-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n---\n\n#### Capital Structure Details\n- **Preferential Allotments** (last 3 years):  \n  | Date | Allottee | Shares | Price/Share (â‚¹) | Total (â‚¹ mn) |\n  |------|----------|--------|-----------------|--------------|\n  | [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n- **Latest Private Placement**: [Most recent before IPO]  \n- **ESOP/ESPS**: [All employee stock option plans]  \n- **Convertible Instruments**: [If any]  \n- **Promoter Holding Changes**: [3-year history with reasons]  \n\n---\n\n#### ðŸ“Š Valuation Metrics (Derived Calculations from Last Round, if available)\nIf data available in DRHP chunks, perform the following calculations:\n\n1. **Round Raised** = Shares Allotted Ã— Price per share  \n   Example: 1,42,000 Ã— â‚¹130 = â‚¹184.6 lakhs  \n\n2. **Dilution %** = Shares Allotted Ã· Total Equity Shares Pre-Issue  \n   Example: 1,42,000 Ã· 38,77,000 = 3.66%  \n\n3. **Post-Money Valuation** = Round Raised Ã· Dilution %  \n   Example: â‚¹184.6 lakhs Ã· 3.66% â‰ˆ â‚¹5,046 lakhs  \n\nAll results must be shown with absolute value in â‚¹ (lakhs/crores) and percentage where applicable.  \n\nIf any input value (shares allotted, price, or total equity shares) is missing from the DRHP chunks, clearly state:  \n> \"Information not found in the provided DRHP chunks. Please check the complete document.\"\n\n## Section VII: Financial Performance\nFinancial Highlights Table\nMANDATORY: 5-year trend incl. Sep 2024\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nRevenue from Operations (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nPAT (â‚¹ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nPAT Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nEPS (â‚¹)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nFinancial Analysis\nRevenue Breakdown: [By segment, geography, product line (% contribution in table)]\n\n\nBalance Sheet: [Assets, liabilities, equity with YoY changes]\n\n\nDebt Profile: [Long/short-term, D/E ratio with trends]\n\nRestated Cash Flow Statement: \nnote -Most imporatant ,retrive exact the table from the chunks for the (restated) cash flow statments, it is always available in every DRHP. \nMANDATORY:  Restated Financials (â‚¹ Lakhs)(STATEMENT OF CASH FLOWS)\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\n\nA) Operating Activities\nNet Profit before Tax\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nDepreciation\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nProvision for Gratuity\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Income\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Adjustments\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOperating Profit before WC Changes\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nChanges in WC (Inventory, Receivables, Loans, Payables, Liabilities, Assets)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nCash from Operations\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nLess: Taxes Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nNet Cash from Ops (A)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\n| B) Investing Activities | | | | |\n | Purchase/Sale of Fixed Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Other Non-Current Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Current Investments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest/Dividend Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Investing (B) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| C) Financing Activities | | | | |\n | Share Capital Proceeds | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Short/Long Term Borrowings (Inc/Dec) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest Paid | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Financing (C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Net Change in Cash (A+B+C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Opening Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Closing Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\nComponents of Cash & Cash Equivalents\nComponent\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nCash on Hand\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nBalance with Banks\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Bank Balances\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nTotal\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nKey Financial Ratios (Consolidated)\nMANDATORY\nCategory\nRatio\nFY 20xx (current year to last 3 year )\nFY 20xx\nFY 20xx\nFY 20xx\nProfitability\nROE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nROCE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nGross Margin (%)\n[%]\n[%]\n[%]\n[%]\nLiquidity\nCurrent Ratio\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nLeverage\nDebt/Equity\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nEfficiency\nInventory Turnover (days)\n[Days]\n[Days]\n[Days]\n[Days]\n\nAdditional Financial Info\nWorking Capital Cycle: [Analysis with days/amounts]\n\n\nFX Exposure: [If applicable]\nContingent Liabilities Table\nMANDATORY\nLiability Type\nAmount (â‚¹ mn)\nDescription\n[Type]\n[Amt]\n[Details]\nTotal\n[Total]\n\n\n\n\n## Section VIII: IPO Details\nIssue Size: [Breakdown of total, fresh issue & OFS]\n\n\nPrice Band: [Floor & cap or [â—]]\n\n\nLot Size: [Minimum bid quantity]\n\n\nIssue Structure: [Fresh issue vs OFS breakdown]\n\n\nIssue Allocation\nCategory\n% Allocation\nAmount (â‚¹ mn)\nQIB\n[%]\n[Amount]\nNII\n[%]\n[Amount]\nRetail\n[%]\n[Amount]\n\nFund Utilization\nProceeds Use: [Breakdown table of fund allocation]\n\n\nTimeline: [Schedule for deployment]\n\n\nSelling Shareholders\nMANDATORY\nShareholder\nShares Offered\nAvg. Cost (â‚¹)\nProceeds (â‚¹ mn)\n[Name]\n[Shares]\n[Cost]\n[Amount]\n\n## Section IX: Legal & Regulatory\nStatutory Approvals: [Key licenses/permits]\n\n\nPending Clearances(Pending Approvals): [If any]\n\n\nOutstanding Litigation\nMANDATORY\nAgainst\nCases(direct tax,indirect tax detail)\nExposure (â‚¹ mn)\nNature\nCompany\n[Count]\n[Amount]\n[Description]\nPromoters\n[Count]\n[Amount]\n[Description]\nDirectors\n[Count]\n[Amount]\n[Description]\n\nAdditional Legal Info\nMaterial Developments: [Since last audit period]\n\n\nTax Proceedings: [Summary with amounts/status](direct tax,indirect tax detail)\n\n\n\n\n## Section X: Corporate Structure\n\n#### Subsidiaries Table\n**MANDATORY detailed table**\n\n| Subsidiary Name | Ownership (%) | Business Focus | Key Financials |\n|-----------------|---------------|----------------|---------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n#### Corporate Relationships\n- **Joint Ventures**: [Complete details with ownership and business focus]\n- **Associate Companies**: [Names and relationships]\n- **Group Companies**: [Complete list with business profiles and key financials where available]\n\n#### Related Party Transactions (Complete Analysis):\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n#### Related Party Outstanding Balances:\n\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n---\n ## Section XI: Additional Information\nAwards : [Honors received]\n\n\nCSR Initiatives: [Social programs, csr policy ,figures]\n\n\nCertifications: [Quality, environmental, other]\n\n\nR&D: [Facilities & focus areas]\n\n\nInternational Ops: [Global presence]\n\n\nFuture Outlook: [Vision & targets]\n\n\nDividend Policy: [History & future policy ,dates ]\n\n\nRisk Factors: [Top 10+ risks with impact]\n\n\n## Section XII: Investment Insights for Fund Managers\nProvide analysis of the 20 dimensions below, referencing only extracted DRHP data.\n Note: If data missing, state â€œData not available in provided DRHP chunksâ€.\nMarket Position & Competitive Advantage: [Based on market share, peer metrics, Section IV]\n\n\nRevenue Model Clarity & Sustainability: [Based on segment breakdown, streams, Section III]\n\n\nHistorical & Projected Financials: [Trends from Section VII â€“ revenue CAGR, margins, profitability]\n\n\nBalance Sheet Strength: [From Section VII â€“ D/E ratio, net worth, balance sheet trends]\n\n\nCash Flow & Capital Allocation: [From Section VII â€“ ops cash, capex, FCF trends]\n\n\nIPO Objectives & Proceeds Use: [From Section VIII â€“ fund utilization breakdown]\n\n\nPromoter Skin & Shareholding: [From Section VI â€“ pre/post IPO %s]\n\n\nGovernance Standards & Red Flags: [From Sections V & IX â€“ mgmt profiles, board, litigation, audit]\n\n\nCustomer/Revenue Concentration: [From Section III; if missing state â€œCustomer concentration data not availableâ€]\n\n\nSupply Chain/Input Cost Risks: [From Section III; if missing state â€œSupplier data not availableâ€]\n\n\nRegulatory/Policy Dependencies: [From Section IV & IX â€“ regulations, approvals]\n\n\nValuation vs Peers: [From Section IV â€“ peer analysis; if missing state â€œPeer comparison data not foundâ€]\n\n\nIPO Pricing Fairness: [From Sections VII & VIII â€“ metrics & pricing]\n\n\nExecution & Scalability Risk: [From Section III â€“ capacity utilization & growth strategy]\n\n\nLiquidity Post-Listing: [From Section VIII â€“ free float & issue structure]\n\n\nPost-IPO Rerating Catalysts: [From growth strategy, industry tailwinds, outlook]\n\n\nManagement Quality & Track Record: [From Section V â€“ profiles & experience]\n\n\nRPTs or Audit Remarks: [From Section X & IX â€“ related party data, legal info]\n\n\nGeographic Concentration Risk: [From Section III â€“ revenue distribution]\n\n\nOverall Risk-Reward: [Synthesis of all above; quantify where data allows]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude Sep 2024 data where available\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\nShare capital history\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1952,
          -176
        ],
        "id": "b5a49706-30ad-4426-b220-ad3b0b8173f0",
        "name": "Summary generator Agent2",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow DRHP",
          "height": 960,
          "width": 2196,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          3008,
          976
        ],
        "id": "15f01aa8-8803-4671-b2b2-0bc8400d3842",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook4').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          1936,
          32
        ],
        "id": "7357cdb1-42e3-4aba-8be3-19bc14c27a4c",
        "name": "Pinecone Vector Store2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>DRHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: $('Webhook4').first().json.query.namespace || 'RHP_Summary'\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2304,
          -192
        ],
        "id": "f73f88b6-aa4f-4e1c-84bc-68e6bedf5172",
        "name": "mdn to html2"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "/3/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          1488,
          -176
        ],
        "id": "ea777678-3d02-4f9e-b80d-a8591ab5f700",
        "name": "Webhook4",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8",
        "disabled": true
      },
      {
        "parameters": {
          "topN": 12
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2192,
          32
        ],
        "id": "c68cb985-42be-49a5-bade-c4a15b725f80",
        "name": "Reranker Cohere2",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
                "name": "subQueries",
                "value": "[\n  \"1. What are the complete company identification and corporate details including full legal name with any changes over time, Corporate Identity Number (CIN), date and place of incorporation, registered office complete address with pin code, corporate office address if different from registered office, principal place of business, all manufacturing facilities with complete addresses and installed capacities, company website, telephone numbers, email addresses, and ISIN number if already allocated?\",\n\n  \"2. What are the comprehensive statutory appointments and professional service providers including names and complete contact details of all Book Running Lead Managers (BRLMs), Auditor Changes in last three years (from particulars), Co-Lead Managers, Registrar to the Issue with complete address and contact information, Legal Advisors to the Company and to the Issue, Statutory Auditors with firm name, partner names, membership numbers and office addresses, Peer Review Auditor if applicable, all Bankers to the Company with branch details, Banker to the Issue / Refund Banker / Public Issue Bank,Market Maker Information,Cash Credit and Term Loan amounts?\",\n\n  \"3. What is the detailed business description including comprehensive overview of all business segments with exact revenue contribution percentages for each segment across all periods (till current year and month , FY 2024, FY 2023, FY 2022, FY 2021), complete product portfolio with detailed descriptions of each product category, manufacturing processes and technology used, key raw materials with sourcing details, production capacity by product line, actual production volumes, and capacity utilization percentages(Capcity utilisation full table data ) for each product category across all available periods?\",\n\n  \"4. What is the comprehensive geographic revenue analysis including detailed domestic revenue breakdown by top 10 states/regions with exact amounts in â‚¹ Lakhs and percentages for Sep 2024 (6 months)or till current year and month to last 3-4 year, (current year ,FY 2024, FY 2023, FY 2022, and FY 2021), complete export revenue breakdown by top comtries with exact amounts and percentages for all periods, any seasonal variations in geographic sales patterns, and regional concentration risks ,industry - global and domestic trends, consumption patterns. Government spends and policies relevant to the industry benefitting them,export sales, if available?\",\n\n  \"5. What are the detailed customer and supplier concentration analyses including exact names (if disclosed) and percentages of revenue from top 10 customers  for current year and month to last 3-4 year, (FY 2024, FY 2023, FY 2022, and FY 2021), exact amounts in â‚¹ Lakhs from each customer category, specific customer concentration risk factors mentioned in internal risk factors section,Key Government Initiatives, detailed supplier concentration with exact percentages and amounts in â‚¹ Lakhs for top 10 suppliers across all periods, and geographic concentration of supplier base by state/region,include the Operational KPIs(Key Performance Indicators) as well along with Financial KPIs if available ?\",\n\n  \"6. What are the comprehensive financial performance metrics including complete 5-year revenue trends with year-over-year growth percentages, detailed EBITDA and EBITDA margins for all periods, complete PAT and PAT margins, earnings per share calculations, detailed restated cash flow statements with exact figures for operating cash flows, investing cash flows, financing cash flows, and net cash changes for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), including all line items like depreciation, interest paid, tax payments, working capital changes, and cash equivalents at beginning and end of each period?\",\n\n  \"7. What are the detailed financial ratios and balance sheet analysis including complete financial ratios table with current ratio, debt-equity ratio, debt service coverage ratio, return on equity, return on capital employed, inventory turnover ratio, trade receivables turnover ratio, trade payables turnover ratio, net capital turnover ratio, net profit ratio, and return on investment for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), along with percentage changes year-over-year and specific reasons for any changes greater than 25%, plus detailed working capital cycle analysis with exact days and amounts?\",\n\n  \"8. What is the complete capital structure and shareholding analysis including authorized share capital with exact amounts, paid-up share capital pre and post issue, detailed share capital history table showing date of allotment, number of equity shares allotted, face value, issue price, consideration (cash/other than cash), nature of allotment, cumulative number of equity shares, and cumulative paid-up capital for all historical allotments from incorporation to present, complete pre-issue and post-issue shareholding pattern with exact number of shares and percentages for promoters, promoter group entities, public shareholders, and all subcategories?\",\n\n  \"9. What are the comprehensive promoter and management details including complete table of all promoters and directors with full names, designations, educational details, complete work experience with previous employment details, age, addresses, exact shareholding percentages and number of shares held, remuneration details in â‚¹ Lakhs, term of office, all Key Management Personnel with similar complete details including Chairman, Managing Director, Whole Time Directors, CEO, CFO, Company Secretary, and their detailed profiles with educational background, professional experience, joining dates, and compensation?\",\n\n  \"10. What are the detailed IPO structure and proceeds utilization including total issue size breakdown between fresh issue amount and offer for sale amount, price band with floor and cap prices, bid lot size, issue allocation percentages for QIB, NII (HNI), and Retail categories, complete table of selling shareholders with exact number of shares being offered, weighted average acquisition cost, expected proceeds, detailed objects of the issue with exact amount allocation for each purpose, timeline for deployment of funds, any bridge financing arrangements, and estimated net proceeds after issue expenses?\",\n\n  \"11. What is the comprehensive industry analysis including exact market size figures for India with amounts and sources, global market size data, specific(domesti CAGR projections with time periods and sources, detailed consumption patterns and demand drivers, government policies affecting the industry with specific schemes and budget allocations, comprehensive sector strengths including domestic manufacturing capabilities, research infrastructure, institutional support networks, and detailed sector challenges including climate impact, price volatility, regional constraints, competitive pressures, and infrastructure limitations as mentioned in industry overview sections and retrieve about AWARDS AND RECOGNITIONS if available?\",\n\n  \"12. What are the detailed corporate structure,Subsidiaries Table,Joint Ventures & Associates,Group Companies, and related party transactions including complete list of all subsidiaries with exact ownership percentages, business activities, financial performance, all joint ventures and associate companies, comprehensive related party transactions table showing exact transaction amounts in â‚¹ Lakhs for sales, purchases, director remuneration, loans taken, loans repaid, rent expenses, professional charges, and salary expenses for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), plus outstanding balances including trade receivables,Awards and Recognition, loans from directors, and other payables as at the end of each period?\",\n\n  \"13. What are the comprehensive legal and regulatory disclosures including complete list of all material litigation with exact number of cases and financial exposure amounts against the company, promoters, and directors, details of all statutory approvals and licenses required and obtained, pending regulatory clearances with timelines, all tax proceedings with amounts involved and current status, any delayed statutory filings with penalties imposed, material developments and events after the last audited financial statements, and contingent liabilities breakdown by type with exact amounts?\",\n\n  \"14. What is the detailed peer comparison analysis including complete table comparing the company with listed industry peers showing Price-to-Earnings ratios, EV/EBITDA multiples, Return on Equity percentages, Return on Capital Employed percentages, Debt-to-Equity ratios, market capitalizations in â‚¹ Crores, revenue growth rates, EBITDA margins, and other relevant financial metrics, along with qualitative comparison of business models, market positions, and competitive advantages?\",\n\n  \"15. What is the comprehensive investment analysis and risk assessment including detailed evaluation of market positioning with quantitative market share data, revenue model sustainability with segment-wise analysis, balance sheet strength assessment with specific leverage and liquidity ratios, management quality evaluation with track record and experience metrics, execution risks with capacity utilization trends, scalability assessment with expansion plans and capital requirements, regulatory and policy risks with potential financial impact, geographic and customer concentration risks with mitigation strategies, and overall investment thesis with quantified risk-reward analysis including potential returns and key risk factors, Awards and Recognition ?\"\n]",
                "type": "array"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1712,
          -368
        ],
        "id": "486c9fae-8965-4020-9c90-e1126a1c43b8",
        "name": "Edit Fields11"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    \n        <div >\n          ${html}\n        </div>\n      \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n     investor_Html: htmlContent,\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          272,
          -512
        ],
        "id": "d187be54-fd56-446a-9ec5-1b9da66e95df",
        "name": "mdn to html8"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced HTML Generator for n8n Function node - Auto-insert Investor data after Section VI\nconst inputData = $input.first().json;\n\nfunction insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml) {\n  // Define possible patterns for Section VI and Section VII\n  const sectionVIPatterns = [\n    /(<h3[^>]*>.*?ðŸ’°.*?Section VI.*?Capital Structure.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?Section VI.*?Capital Structure.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?ðŸ’°.*?VI.*?Capital.*?<\\/h3>)/i,\n    /(<h2[^>]*>.*?ðŸ’°.*?Section VI.*?Capital Structure.*?<\\/h2>)/i,\n    /(<h2[^>]*>.*?Section VI.*?Capital Structure.*?<\\/h2>)/i\n  ];\n  \n  const sectionVIIPatterns = [\n    /(<h3[^>]*>.*?Section VII.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?VII.*?<\\/h3>)/i,\n    /(<h2[^>]*>.*?Section VII.*?<\\/h2>)/i,\n    /(<h2[^>]*>.*?VII.*?<\\/h2>)/i\n  ];\n\n  let modifiedHtml = fullSummaryHtml;\n  let sectionVIFound = false;\n  let insertionPoint = -1;\n\n  // Try to find Section VI\n  for (const pattern of sectionVIPatterns) {\n    const match = modifiedHtml.match(pattern);\n    if (match) {\n      sectionVIFound = true;\n      console.log('Found Section VI:', match[0]);\n      \n      // Find the end of Section VI content (before Section VII)\n      let sectionVIEnd = match.index + match[0].length;\n      \n      // Look for Section VII to determine where Section VI content ends\n      for (const viiPattern of sectionVIIPatterns) {\n        const sectionVIIMatch = modifiedHtml.substring(sectionVIEnd).match(viiPattern);\n        if (sectionVIIMatch) {\n          insertionPoint = sectionVIEnd + sectionVIIMatch.index;\n          console.log('Found Section VII at position:', insertionPoint);\n          break;\n        }\n      }\n      \n      // If Section VII not found, insert at the end of the document\n      if (insertionPoint === -1) {\n        insertionPoint = modifiedHtml.length - 20; // Before closing tags\n      }\n      \n      break;\n    }\n  }\n\n  if (sectionVIFound && insertionPoint !== -1) {\n    // Create the investor section HTML with proper formatting\n    const investorSectionHtml = `\n      \n      <!-- Inserted Investor Data -->\n      <div >\n       <h3 style=\"color: #4B2A06; font-size: 16px; margin: 15px 0 10px 0; font-weight: 700;\">\n       Matched Investors & Analysis\n      </h3>\n        ${investorHtml}\n      </div>\n      \n    `;\n\n    // Insert the investor data at the calculated position\n    modifiedHtml = modifiedHtml.substring(0, insertionPoint) + \n                   investorSectionHtml + \n                   modifiedHtml.substring(insertionPoint);\n    \n    console.log('Successfully inserted investor data after Section VI');\n  } else {\n    console.log('Section VI not found, appending investor data at the end');\n    // Fallback: append at the end if Section VI is not found\n    const investorSectionHtml = `\n      \n      <h3 style=\"color: #4B2A06; font-size: 16px; margin: 15px 0 10px 0; font-weight: 700;\">\n       Matched Investors & Analysis\n      </h3>\n      ${investorHtml}\n    `;\n    modifiedHtml = modifiedHtml.replace('</div>', investorSectionHtml + '</div>');\n  }\n\n  return modifiedHtml;\n}\n\nfunction generateEnhancedHtml(modifiedSummaryHtml) {\n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title >Investment Analysis Report</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 14px;\n            line-height: 1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 10px;\n            margin: 0 auto;\n          }\n          \n          .container {\n            width: 100%;\n            background: white;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            color: #1e40af;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n          }\n          \n          h2 { \n            font-size: 16px;\n            color: #334155;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n          }\n          \n          h3 { \n            font-size: 14px;\n            color: #475569;\n            margin-bottom: 8px;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 8px 0 12px 0;\n            text-align: justify;\n            line-height: 1;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 8px 0;\n            padding-left: 20px;\n          }\n          \n          li { \n            margin: 4px 0;\n            line-height: 1;\n          }\n          \n          /* Tables */\n          table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 12px;\n            background: white;\n            border: 1px solid #374151;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          }\n          \n          th { \n            border: 1px solid #374151;\n            padding: 10px 8px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            font-size: 11px;\n          }\n          \n          td { \n            border: 1px solid #374151;\n            padding: 8px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 11px;\n          }\n          \n          tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 12px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Special formatting */\n          .amount, .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 2px solid #d1d5db;\n            margin: 15px 0;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n          }\n          \n          /* Print styles */\n          @media print {\n            body {\n              margin: 0;\n              font-size: 11px;\n            }\n            \n            h1, h2, h3 {\n              color: #000 !important;\n              page-break-after: avoid;\n            }\n            \n            table {\n              page-break-inside: avoid;\n              font-size: 10px;\n            }\n            \n            th, td {\n              font-size: 9px;\n              padding: 4px 3px;\n            }\n            \n            th {\n              background: #f0f0f0 !important;\n              color: #000 !important;\n            }\n            \n            .investor-data-insertion {\n              background: #f8f8f8 !important;\n              border: 1px solid #000 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n          }\n          \n          /* Mobile responsive */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 13px;\n            }\n            \n            table {\n              font-size: 10px;\n              overflow-x: auto;\n              display: block;\n            }\n            \n            th, td {\n              font-size: 9px;\n              padding: 6px 4px;\n            }\n            \n            .investor-data-insertion {\n              padding: 15px;\n              margin: 15px 0;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          ${modifiedSummaryHtml}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\n// Get the HTML content from input\nconst investorHtml = $input.first().json.investor_Html || '';\nconst fullSummaryHtml = $input.first().json.html_summary || '';\n\n// Insert investor data after Section VI\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\n\n// Generate final HTML\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// Return the result\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook9').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          672,
          -400
        ],
        "id": "011d90f4-154c-444f-a4ae-950070a83abe",
        "name": "mdn to html11"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook9').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -16,
          -160
        ],
        "id": "79f6fa68-79ff-4d9c-a6f5-2bbb21ef462b",
        "name": "mdn to html12"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          512,
          -400
        ],
        "id": "b7ed1bdc-1e7e-40a2-b663-c4671736f27b",
        "name": "Merge3"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "={{ $('Webhook9').item.json.query.session_id }}"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          -656,
          112
        ],
        "id": "4ed852d0-f17a-449e-8d6a-aa319785d50a",
        "name": "Simple Memory3"
      },
      {
        "parameters": {
          "content": "# chat and comparision document flow",
          "height": 1584,
          "width": 1568,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1328,
          -2336
        ],
        "typeVersion": 1,
        "id": "5c3783f1-fbad-413c-89ce-34358a3de8f5",
        "name": "Sticky Note20"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1472,
          -1696
        ],
        "id": "61e46bfb-176a-41e9-84f7-f63c770327c9",
        "name": "OpenAI Chat Model4",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "url": "https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/describe_index_stats",
          "sendHeaders": true,
          "specifyHeaders": "json",
          "jsonHeaders": "{\n  \"Api-Key\": \"pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp\",\n   \"Content-Type\": \"application/json\"\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -2880,
          96
        ],
        "id": "26200ffc-5e64-4966-823a-4c347ea22c3d",
        "name": "HTTP Request1"
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "={{ $json.vectorCount }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3232,
          -448
        ],
        "id": "8d3dd69e-4333-499d-9c16-c0fe8cac75a9",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "jsCode": "// n8n Function node\n// Combine all vector IDs into a single array without repeats\n\nconst allVectors = [];\n\n// Iterate through each input item\nfor (const item of $input.all()) {\n  const vectors = item.json.vectors || []; // use current item, not first()\n  for (const v of vectors) {\n    if (v.id) allVectors.push(v.id); // push only the id\n  }\n}\n\n// Return a single item containing the merged vector IDs\nreturn [\n  {\n    json: {\n      vectors: allVectors,\n      total_vectors: allVectors.length,\n      namespace: $input.first().json.namespace // optional: use first namespace for reference\n    }\n  }\n];\n"
        },
        "name": "Batch Vector IDs",
        "type": "n8n-nodes-base.code",
        "position": [
          -1760,
          -432
        ],
        "id": "a5bd16d6-e3bc-4522-89b7-cd8cc5e0b317",
        "typeVersion": 2
      },
      {
        "parameters": {
          "url": "https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/fetch",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "ids",
                "value": "={{ $json.vectors }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              }
            ]
          },
          "options": {}
        },
        "name": "Fetch Vectors with Data",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1568,
          -432
        ],
        "id": "850ec76c-53a7-4853-a3aa-b8baaf733241",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "jsCode": "// n8n Function node\n// Input: items with 'vectors' as an object\n// Output: items with updated metadata including documentName\n\nconst docName = $input.first().json.namespace; // set your document name here\nconst vectorsObj = $input.first().json.vectors || {}; // get the vectors object\n\n// Iterate through each vector and add documentName to metadata\nfor (const id in vectorsObj) {\n    if (vectorsObj.hasOwnProperty(id)) {\n        const vector = vectorsObj[id];\n        vector.metadata = vector.metadata || {};\n        vector.metadata.documentName = docName;\n    }\n}\n\n// Return the updated vectors object\nreturn [\n    {\n        json: {\n            vectors: vectorsObj,\n            documentName: docName,\n            total_vectors: Object.keys(vectorsObj).length\n        }\n    }\n];\n"
        },
        "name": "Transform Vectors",
        "type": "n8n-nodes-base.code",
        "position": [
          -1760,
          -208
        ],
        "id": "3d894d58-1bdc-4350-8c95-cc0fddb62886",
        "typeVersion": 2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhpdoc-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/upsert",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"vectors\": {{ JSON.stringify($json.vectors) }}\n}\n",
          "options": {}
        },
        "name": "Upsert to Default Namespace",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3120,
          96
        ],
        "id": "b49fac54-b305-4972-b90c-b1973a8486f4",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "={{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3072,
          -352
        ],
        "id": "24e63f18-3ba7-4b6b-b420-429a674ffebe",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs2",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2928,
          -256
        ],
        "id": "06846bb0-27dd-4cfc-a98a-9524607946b8",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2768,
          -160
        ],
        "id": "183ebdd1-56e8-4dac-b127-1d43426e70eb",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs4",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2608,
          -80
        ],
        "id": "b78a792f-68ad-4867-a85a-0fbc374ff453",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "numberInputs": 8
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -1968,
          -448
        ],
        "id": "a3866e54-0d13-44c3-b19a-ba4c2f130774",
        "name": "Merge8"
      },
      {
        "parameters": {
          "jsCode": "// n8n Function Node\n// Input: single item with \"vectors\" as an object\n// Output: multiple items, each containing a batch of 100 vectors ready for upsert\n\nconst vectorsObj = $input.first().json.vectors || {};\nconst allVectors = Object.keys(vectorsObj).map(id => vectorsObj[id]); // convert object to array\n\nconst batchSize = 100; // number of vectors per batch\nconst batches = [];\n\nfor (let i = 0; i < allVectors.length; i += batchSize) {\n    const batch = allVectors.slice(i, i + batchSize);\n    batches.push({ json: { vectors: batch} });\n}\n\nreturn batches;\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -1568,
          -208
        ],
        "id": "fda6bb5c-b8ac-41bf-aac6-5eb42805c09c",
        "name": "Code"
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs5",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2448,
          0
        ],
        "id": "2fc5bde5-4fb4-471f-905f-450b807202ba",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://rhpdocuments-w5m6qxe.svc.aped-4627-b74a.pinecone.io/vectors/upsert",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_3w2DRP_RvXZ2gG3FdMKUPmeACmbQvcDwb1Lm4UvfFrcMe8pj2VbKntibu6zzVecrGDGPFW"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"vectors\": {{ JSON.stringify($json.vectors) }}\n}\n",
          "options": {}
        },
        "name": "Upsert to Default Namespace1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1696,
          80
        ],
        "id": "7da8a61a-8a07-40a6-a4ee-1885019f5227",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs6",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2288,
          80
        ],
        "id": "cd95f53f-ec04-4db7-9352-92fa15a865f3",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "content": "# migrate  all namespaces vectors into another index",
          "height": 880,
          "width": 2064
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3440,
          -608
        ],
        "typeVersion": 1,
        "id": "f17ba48a-7ced-4417-a73c-7befeb89343f",
        "name": "Sticky Note21"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1664,
          32
        ],
        "id": "d5b880b7-2777-4b8a-8ee3-0113a909e3a9",
        "name": "OpenAI Chat Model2",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8886f164-fd25-41b0-9984-902708d4fc55",
                "name": "namespace",
                "value": "=1761802414095.pdf",
                "type": "string"
              },
              {
                "id": "c4a4e5ac-7cc2-4fc6-96df-c47416bc79be",
                "name": "vectorCount",
                "value": "1268",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3392,
          -448
        ],
        "id": "c54c7303-266d-409d-b184-a440d7c80c26",
        "name": "Edit Fields21"
      },
      {
        "parameters": {
          "content": "# trget pinecone index to upsert vectors",
          "height": 288,
          "width": 384,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1856,
          -48
        ],
        "typeVersion": 1,
        "id": "e8c35d37-5c51-4e99-a699-e46148dae202",
        "name": "Sticky Note22"
      },
      {
        "parameters": {
          "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
              },
              {
                "name": "Accept",
                "value": "application/json"
              },
              {
                "name": "vectorCount",
                "value": "=497"
              },
              {
                "name": "pagination",
                "value": "=  {{ $json.pagination.next }}"
              }
            ]
          },
          "options": {}
        },
        "name": "List Vector IDs14",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2112,
          144
        ],
        "id": "805b872d-01b0-476b-b384-45f98e00756a",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "https://docs.google.com/document/d/14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI/edit?tab=t.0"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          4736,
          -880
        ],
        "id": "4b38ce0b-e5bf-4f04-916e-e2afcafb6811",
        "name": "Get a document in Google Docs1",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "f8lWeDpliC7apaBH",
            "name": "Google Docs account(Harsh)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4448,
          -704
        ],
        "id": "7d22cbf9-38a7-4ee7-8524-1855228ebdc5",
        "name": "Embeddings OpenAI13",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "sop-embedd",
            "mode": "list",
            "cachedResultName": "sop-embedd"
          },
          "topK": 10,
          "options": {
            "pineconeNamespace": "Draft SOP for DRHP and RHP Reading.pdf"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4224,
          -880
        ],
        "id": "283b3741-0738-47bd-a2e9-4352dbbd79c6",
        "name": "Fund SOP Pinecone Vector Store16",
        "credentials": {
          "pineconeApi": {
            "id": "DGSVRq3jlG9GGHG5",
            "name": "PineconeApi(sonu)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 45,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "A-One Steel DRHP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4480,
          -880
        ],
        "id": "5d4ca6ed-37d2-48f3-a919-ebe0138d6d7b",
        "name": "DRHP Pinecone Vector Store15",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          5104,
          -688
        ],
        "id": "d665eaff-9d11-46af-b649-92c832efa030",
        "name": "Reranker Cohere9",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
                "name": "subQueries",
                "value": "[\n  \"1. Retrieve all company identification and registration details including: Full legal name (including any historical name changes),Corporate Identity Number (CIN),Date and place of incorporation,Registered and corporate office complete address (with PIN),Email, telephone, and website,Nature of business and principal place of operation,Manufacturing facilities and installed capacities (with address),ISIN number (if allotted),Key contact details of directors, compliance officers, company secretary, Summary of major company milestones and incorporation history\",\n\n  \"2. Retrieve complete statutory and legal details including:Names, designations, and contact details of statutory auditors, legal counsel, registrar, and bankers, Details of regulatory approvals, licenses, and compliance requirements ,Pending litigation or contingent liabilities against the company, promoters, or subsidiaries,Material contracts and agreements summary, Summary of promoter group and promoter holdings with regulatory declarations\",\n\n  \"3. Retrieve detailed business overview including:Nature of operations, key product/service categories, and markets served, Business model and revenue segments (domestic vs export), Industry and sector classification (NIC code if available), Manufacturing processes, production capacity, plant locations, and technology used, Details of subsidiaries, joint ventures, and group entities, SWOT or risk summary mentioned in DRHP, Market position, competitors, and key differentiators\",\n\n  \"4. Retrieve the industry analysis section covering:Market size, structure, and segmentation, Industry growth trends, drivers, and challenges, Government policies and sectoral regulations, Competitive landscape and key industry participants, Historical and projected demand-supply statistics, Impact of macroeconomic factors on the sector\",\n\n  \"5. Retrieve all material risk factors including:Internal (business, operational, financial) and external (industry, regulatory, market) risks, Litigation, dependency, and credit risks, Foreign exchange, commodity, and raw material supply risks, Key management and promoter-related risks, Any historical adverse events disclosed in DRHP\",\n\n  \"6. Retrieve complete capital structure information including:Authorized, issued, subscribed, and paid-up share capital, Shareholding pattern pre- and post-issue, Details of securities issued in last 3 years, Promoter and promoter group holdings, Details of outstanding convertible instruments (if any), Breakup of current capital and changes over the past 3 years\",\n\n  \"7. Retrieve complete audited standalone and consolidated financial information for the current and last 3 financial years, including:Balance Sheet (Assets, Liabilities, Net Worth), Profit and Loss Account (Revenue, EBITDA, PAT, EPS), Cash Flow Statement (operating, investing, financing), Key Ratios (ROE, ROCE, Debt/Equity, Net Margin), Segment-wise performance (if disclosed), Notes to accounts with auditor remarks, Restated financial statements summary (current year to last 3 year like ,FY2025, FY2024, FY2023, FY2022)\",\n\n  \"8. Retrieve all details about the issue objectives including:Purpose of the IPO (expansion, repayment, working capital, acquisitions, etc.), Amount proposed to be used for each objective, Deployment schedule of funds (table form), Source of financing and pre-issue expenses, Means of finance and expected benefits to the company\",\n\n  \"9. Retrieve the complete management discussion and analysis section including: Summary of financial performance for current and last 3 years, Discussion on operations, margins, and profitability trends, Key operational KPIs, Analysis of industry trends impacting company performance, Liquidity, capital expenditure, and future outlook, Management commentary on risks and mitigation\",\n\n  \"10. Retrieve dividend and capital return information including: Historical dividend payout for the last 3 years (FY2025, FY2024, FY2023, FY2022), Dividend per share and percentage declared, Retained earnings and reserves position, Any buyback, bonus, or split actions taken, Companyâ€™s dividend policy statement and board approval remarks\",\n\n  \"11. Retrieve detailed management information including: Full list of directors and key managerial personnel with designations and experience, Promoter group details and shareholding percentages, Organizational structure (management hierarchy), Remuneration of directors and KMP (last 3 years), Board committees (audit, nomination, CSR), Summary of promoter background and relationships\",\n\n  \"12. Retrieve other material information including: Details of pending or obtained regulatory approvals and government permissions, Summary of group company transactions, Any material developments post-balance sheet date, Related party transactions and disclosure of loans/guarantees, Important declarations, consents, and disclaimers included in DRHP\",\n\n ]",
                "type": "array"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          4144,
          -1104
        ],
        "id": "19bf3369-c970-4f5f-9d46-59d84a92d5f1",
        "name": "Edit Fields22"
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          4592,
          -704
        ],
        "id": "09a8f64a-ffdd-4b53-9210-f891d720d4fc",
        "name": "Reranker Cohere13",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "markdownToHtml",
          "markdown": "={{ $json.output }}",
          "options": {
            "completeHTMLDocument": true,
            "disableForced4SpacesIndentedSublists": true,
            "tables": true
          }
        },
        "type": "n8n-nodes-base.markdown",
        "typeVersion": 1,
        "position": [
          4832,
          -1312
        ],
        "id": "3e698b25-6f08-4394-b484-11d0d8b7f3f9",
        "name": "Markdown3"
      },
      {
        "parameters": {
          "html": "{{ $json.data }}"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          5040,
          -1312
        ],
        "id": "248d7c9f-c76f-4431-8c63-50359ac6835f",
        "name": "HTML4"
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "https://docs.google.com/document/d/14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI/edit?tab=t.0"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          5296,
          -880
        ],
        "id": "0a1c755d-7034-4cf7-97e1-925ec1d72a66",
        "name": "Get a document in Google Docs2",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "f8lWeDpliC7apaBH",
            "name": "Google Docs account(Harsh)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "DRHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 45,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "A-One Steel DRHP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          5008,
          -880
        ],
        "id": "23e2f429-f73f-485c-b822-4e7dbd8c99bf",
        "name": "DRHP Pinecone Vector Store14",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          4096,
          1760
        ],
        "id": "e263f26f-44fa-4bb1-9988-90d471f80e74",
        "name": "OpenAI Chat Model15",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2304,
          -976
        ],
        "id": "5cf2eb1d-f1cd-4c0b-a80d-32a25456052c",
        "name": "Embeddings OpenAI23",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          3104,
          1760
        ],
        "id": "4661bdf2-0d15-4a63-9fe8-51263e450031",
        "name": "OpenAI Chat Model17",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 5px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n            padding:10px;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 5px;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 5px;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 12px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 10mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 9px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 9px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 9px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4336,
          -176
        ],
        "id": "62ebc755-6a4e-4904-80cd-2d1b2d6c0f9c",
        "name": "mdn to html13"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          3216,
          1760
        ],
        "id": "eedea90d-efd9-408d-8ce4-b88df0b34720",
        "name": "Embeddings OpenAI26",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -1952,
          -976
        ],
        "id": "53153251-8d5c-403d-8a92-cd82417fb5ec",
        "name": "Reranker Cohere14",
        "credentials": {
          "cohereApi": {
            "id": "604WWVX2sUlVBMR0",
            "name": "CohereApi account (s 7891)"
          }
        }
      },
      {
        "parameters": {
          "html": "<!DOCTYPE html>\n\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>My HTML document</title>\n</head>\n<body>\n  {{ $json.html_source }}\n</body>\n</html>\n\n<style>\n.container {\n  background-color: #ffffff;\n  text-align: center;\n  padding: 16px;\n  border-radius: 8px;\n}\n\nh1 {\n  color: #ff6d5a;\n  font-size: 24px;\n  font-weight: bold;\n  padding: 8px;\n}\n\nh2 {\n  color: #909399;\n  font-size: 18px;\n  font-weight: bold;\n  padding: 8px;\n}\n</style>\n\n<script>\nconsole.log(\"Hello World!\");\n</script>"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          4560,
          -176
        ],
        "id": "a6a66046-f6a4-462a-adcc-879da89e7919",
        "name": "HTML5"
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          3600,
          1760
        ],
        "id": "aa1fa959-bb6e-464f-a662-20239485761c",
        "name": "Reranker Cohere15",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "/4/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "*"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          3056,
          1520
        ],
        "id": "a7514556-0e24-48a0-8f74-2893c2432b41",
        "name": "Webhook10",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "c04822e8-2916-453d-90ec-655fa9c1ebbe",
        "name": "Set Execution Info6",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          3232,
          1120
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "eccfd662-eca0-46eb-929c-1fe43a63b67d",
        "name": "Respond with Execution ID6",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          3424,
          1120
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook10').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "8b8ec814-49b2-45bd-8132-78efd3bae54e",
        "name": "Send Error to Backend12",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          5024,
          1744
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          4832,
          1744
        ],
        "id": "07fb26c1-5e75-45d1-b350-322939694325",
        "name": "Edit Fields19"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
                "name": "subQueries",
                "value": "[\n  \"1. Retrieve all company identification and registration details including: Full legal name (including any historical name changes),Corporate Identity Number (CIN),Date and place of incorporation,Registered and corporate office complete address (with PIN),Email, telephone, and website,Nature of business and principal place of operation,Manufacturing facilities and installed capacities (with address),ISIN number (if allotted),Key contact details of directors, compliance officers, company secretary, Summary of major company milestones and incorporation history\",\n\n  \"2. Retrieve complete statutory and legal details including:Names, designations, and contact details of statutory auditors, legal counsel, registrar, and bankers, Details of regulatory approvals, licenses, and compliance requirements ,Pending litigation or contingent liabilities against the company, promoters, or subsidiaries,Material contracts and agreements summary, Summary of promoter group and promoter holdings with regulatory declarations\",\n\n  \"3. Retrieve detailed business overview including:Nature of operations, key product/service categories, and markets served, Business model and revenue segments (domestic vs export), Industry and sector classification (NIC code if available), Manufacturing processes, production capacity, plant locations, and technology used, Details of subsidiaries, joint ventures, and group entities, SWOT or risk summary mentioned in DRHP, Market position, competitors, and key differentiators\",\n\n  \"4. Retrieve the industry analysis section covering:Market size, structure, and segmentation, Industry growth trends, drivers, and challenges, Government policies and sectoral regulations, Competitive landscape and key industry participants, Historical and projected demand-supply statistics, Impact of macroeconomic factors on the sector\",\n\n  \"5. Retrieve all material risk factors including:Internal (business, operational, financial) and external (industry, regulatory, market) risks, Litigation, dependency, and credit risks, Foreign exchange, commodity, and raw material supply risks, Key management and promoter-related risks, Any historical adverse events disclosed in DRHP\",\n\n  \"6. Retrieve complete capital structure information including:Authorized, issued, subscribed, and paid-up share capital, Shareholding pattern pre- and post-issue, Details of securities issued in last 3 years, Promoter and promoter group holdings, Details of outstanding convertible instruments (if any), Breakup of current capital and changes over the past 3 years\",\n\n  \"7. Retrieve complete audited standalone and consolidated financial information for the current and last 3 financial years, including:Balance Sheet (Assets, Liabilities, Net Worth), Profit and Loss Account (Revenue, EBITDA, PAT, EPS), Cash Flow Statement (operating, investing, financing), Key Ratios (ROE, ROCE, Debt/Equity, Net Margin), Segment-wise performance (if disclosed), Notes to accounts with auditor remarks, Restated financial statements summary (current year to last 3 year like ,FY2025, FY2024, FY2023, FY2022)\",\n\n  \"8. Retrieve all details about the issue objectives including:Purpose of the IPO (expansion, repayment, working capital, acquisitions, etc.), Amount proposed to be used for each objective, Deployment schedule of funds (table form), Source of financing and pre-issue expenses, Means of finance and expected benefits to the company\",\n\n  \"9. Retrieve the complete management discussion and analysis section including: Summary of financial performance for current and last 3 years, Discussion on operations, margins, and profitability trends, Key operational KPIs, Analysis of industry trends impacting company performance, Liquidity, capital expenditure, and future outlook, Management commentary on risks and mitigation\",\n\n  \"10. Retrieve dividend and capital return information including: Historical dividend payout for the last 3 years (FY2025, FY2024, FY2023, FY2022), Dividend per share and percentage declared, Retained earnings and reserves position, Any buyback, bonus, or split actions taken, Companyâ€™s dividend policy statement and board approval remarks\",\n\n  \"11. Retrieve detailed management information including: Full list of directors and key managerial personnel with designations and experience, Promoter group details and shareholding percentages, Organizational structure (management hierarchy), Remuneration of directors and KMP (last 3 years), Board committees (audit, nomination, CSR), Summary of promoter background and relationships\",\n\n  \"12. Retrieve other material information including: Details of pending or obtained regulatory approvals and government permissions, Summary of group company transactions, Any material developments post-balance sheet date, Related party transactions and disclosure of loans/guarantees, Important declarations, consents, and disclaimers included in DRHP\"\n]",
                "type": "array"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1712,
          -176
        ],
        "id": "e99c4ad6-f021-44c0-a26f-512d78170014",
        "name": "Edit Fields24"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2576,
          -976
        ],
        "id": "0b156033-377f-4f5a-8827-b51a373043c2",
        "name": "OpenAI Chat Model21",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3552,
          -976
        ],
        "id": "31fa5e08-ad02-408d-b911-9d3ddc4215ba",
        "name": "OpenAI Chat Model22",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2928,
          -976
        ],
        "id": "147ec0af-e93e-4f58-9d16-411c41557a46",
        "name": "Embeddings OpenAI31",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3040,
          -976
        ],
        "id": "17466af4-1f91-4fcc-97cc-8d3ea7dc8025",
        "name": "Embeddings OpenAI32",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -3408,
          -976
        ],
        "id": "110046b3-71d8-4867-8a7d-e122f3cd6e15",
        "name": "Reranker Cohere18",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "34919f0e-17a4-4453-b2e0-dae5b8760c20",
        "name": "Set Execution Info7",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          -3424,
          -1664
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "71d96f70-dd8c-4b34-a203-151542c399e4",
        "name": "Respond with Execution ID7",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -3200,
          -1664
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook11').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "4ffa201c-a382-403f-88d2-d59da438e1df",
        "name": "Send Error to Backend14",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -1632,
          -992
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1824,
          -992
        ],
        "id": "5df1a824-a437-49e2-a173-1877ef7091eb",
        "name": "Edit Fields23"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "/1/rhp/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -3552,
          -1248
        ],
        "id": "8cf5360c-600a-4bce-9f08-389592d09943",
        "name": "Webhook11",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "content": "# Immediate responce sent to the UI",
          "height": 224,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3568,
          -1728
        ],
        "typeVersion": 1,
        "id": "7ee14424-fffe-4df7-baa9-0e73b95b94ce",
        "name": "Sticky Note8"
      },
      {
        "parameters": {
          "content": "# Immediate responce sent to the UI",
          "height": 224,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          3056,
          1040
        ],
        "typeVersion": 1,
        "id": "8f4b8a96-df1d-43bd-acc0-35448aa6f8a4",
        "name": "Sticky Note23"
      },
      {
        "parameters": {
          "content": "# Previous summary workflows",
          "height": 720,
          "width": 1776,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1216,
          -528
        ],
        "typeVersion": 1,
        "id": "b4345c32-2ed7-433f-9342-bafdd3aea338",
        "name": "Sticky Note25"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook11').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -3296,
          -976
        ],
        "id": "bdf82760-2bb3-449a-b7d2-64d09f4cf962",
        "name": "RHP Pinecone Vector DB1",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "SOP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2832,
          -976
        ],
        "id": "d9bf74d2-37d0-4177-bbec-489094de8ace",
        "name": "Fund SOP Pinecone Vector DB2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade RHP ( Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved RHP chunks.\n\n## Your Resources\n\n**Retrieved RHP Data**: Retrieved RHP chunks based on 10 Subquries. Always retrive chunks of RHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted RHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the RHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved RHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided RHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved RHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the RHP uses â€œSep-24â€, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows â‚¹ 8,894.54, table must show 8,894.54 (or â‚¹ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\nâ€¢ **Company Name:** [Full Legal Name]\nâ€¢ **Corporate Identity Number (CIN):** [CIN if available]\nâ€¢ **Registered Office Address:** [Complete address]\nâ€¢ **Corporate Office Address:** [If different from registered office]\nâ€¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\nâ€¢ **Company Website:** [Official URL]\nâ€¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\nâ€¢ **Registrar to the Issue:** [Name and complete contact information]\nâ€¢ **Date of Incorporation:** [When the company was established]\nâ€¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\nâ€¢ **ISIN:** [International Securities Identification Number if available, if marked as [â—]]\n    â€¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\nâ€¢ **Peer-Reviewed Auditor:** [If applicable]\nâ€¢ **Issue Opening Date:** [Scheduled date or mention if marked as [â—]]\nâ€¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\nâ€¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\nâ€¢ **Market Maker Information:** [If applicable]\nâ€¢ **RHP Filing Date:** [Date when the RHP was filed with SEBI only RHP filling date if mention otherwise keep [â—],not mention RHP date  strictly check ]\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\nâ€¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\nâ€¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (â‚¹ million) | Domestic (%) | Export Revenue (â‚¹ million) | Export (%) | Total Revenue (â‚¹ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\nâ€¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\nâ€¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\nâ€¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\nâ€¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (â‚¹ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\nâ€¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (â‚¹ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\nâ€¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\nâ€¢ **Competitive Advantages:** [All unique selling propositions mentioned]\nâ€¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\nâ€¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\nâ€¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in RHP for better readability (details of capacity utilization , this table is an example,get  exact table from RHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\nâ€¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\nâ€¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\nâ€¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\nâ€¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\nâ€¢ **Projected Growth Rate:** [CAGR and future projections with sources]\nâ€¢ **Market Share:** [Company's position in the market with specific figures]\n\nâ€¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\nâ€¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in RHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (â‚¹) | Revenue from Operations (â‚¹ in Lakhs) | Basic EPS (â‚¹) | Diluted EPS (â‚¹) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (â‚¹) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\nâ€¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\nâ€¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\nâ€¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in RHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (â‚¹ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\nâ€¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\nâ€¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in RHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\nâ€¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\nâ€¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\nâ€¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\nâ€¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\nâ€¢ **Director Directorships:** [Other board positions held by each director]\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\nâ€¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\nâ€¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\nâ€¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\nâ€¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (â‚¹) | Total Amount (â‚¹ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\nâ€¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\nâ€¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\nâ€¢ **Outstanding Convertible Instruments:** [Complete list if any]\nâ€¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\nâ€¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\nâ€¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\nâ€¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\nâ€¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\nâ€¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\nâ€¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\nâ€¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in RHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (â‚¹ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\nâ€¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\nâ€¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [â—]]\nâ€¢ **Lot Size:** [Minimum bid quantity]\nâ€¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\nâ€¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (â‚¹ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\nâ€¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\nâ€¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\nâ€¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (â‚¹) | Expected Proceeds (â‚¹ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\nâ€¢ **Statutory Approvals:** [Complete list of key licenses and permits]\nâ€¢ **Pending Regulatory Clearances:** [Complete list if any]\n\nâ€¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in RHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n\n| **Name** | **Criminal Proceedings** | **Tax Proceedings** | **Statutory or Regulatory Proceedings** | **Disciplinary Actions by SEBI or Stock Exchanges against our Promoters** | **Material Civil Litigations** | **Aggregate Amount Involved (â‚¹ in Lakhs)** |\n|-----------|---------------------------|---------------------|----------------------------------------|----------------------------------------------------------------------------|--------------------------------|---------------------------------------------|\n| **Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Senior Management Personnel and Key Managerial Personnel (SMPs & KMPs)** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Litigation involving Group Companies which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Outstanding Litigation which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n\n\nâ€¢ **Material Developments:** [All developments since last audited period]\nâ€¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\nâ€¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\nâ€¢ **Joint Ventures:** [Complete details with ownership and business focus]\nâ€¢ **Associate Companies:** [Names and relationships]\nâ€¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n### Summary of Related Party Transactions (Complete Analysis)**\n\n**Note:**  \nExtract all tables mentioned in the RHP under **â€œSummary of Related Party Transactionsâ€** or **â€œRelated Party Transactionsâ€** for **all financial years** (e.g., *2022â€“23, 2023â€“24, 2024â€“25*).\n---\nâ€¢ ** Summary of Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\nâ€¢ **Awards and Recognition:** [All significant honors received]\nâ€¢ **CSR Initiatives:** [Complete details of social responsibility programs]\nâ€¢ **Certifications:** [All quality, environmental, other certifications]\nâ€¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\nâ€¢ **International Operations:** [Complete global presence details]\nâ€¢ **Future Outlook:** [Company's stated vision and targets]\nâ€¢ **Dividend Policy:** [Historical dividend payments and future policy]\nâ€¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the RHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all RHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided RHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only RHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -3104,
          -1248
        ],
        "id": "45b449dc-9aa7-4eb8-a41b-1d2044694f9b",
        "name": "RHP Summary Generator Agent",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved DRHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses â€œSep-24â€, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows â‚¹ 8,894.54, table must show 8,894.54 (or â‚¹ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\nâ€¢ **Company Name:** [Full Legal Name]\nâ€¢ **Corporate Identity Number (CIN):** [CIN if available]\nâ€¢ **Registered Office Address:** [Complete address]\nâ€¢ **Corporate Office Address:** [If different from registered office]\nâ€¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\nâ€¢ **Company Website:** [Official URL]\nâ€¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\nâ€¢ **Registrar to the Issue:** [Name and complete contact information]\nâ€¢ **Date of Incorporation:** [When the company was established]\nâ€¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\nâ€¢ **ISIN:** [International Securities Identification Number if available, if marked as [â—]]\n    â€¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\nâ€¢ **Peer-Reviewed Auditor:** [If applicable]\nâ€¢ **Issue Opening Date:** [Scheduled date or mention if marked as [â—]]\nâ€¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\nâ€¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\nâ€¢ **Market Maker Information:** [If applicable]\nâ€¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [â—],not mention DDRHP date  strictly check ]\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\nâ€¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\nâ€¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (â‚¹ million) | Domestic (%) | Export Revenue (â‚¹ million) | Export (%) | Total Revenue (â‚¹ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\nâ€¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\nâ€¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\nâ€¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\nâ€¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (â‚¹ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\nâ€¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (â‚¹ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\nâ€¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\nâ€¢ **Competitive Advantages:** [All unique selling propositions mentioned]\nâ€¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\nâ€¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\nâ€¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\nâ€¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\nâ€¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\nâ€¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\nâ€¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\nâ€¢ **Projected Growth Rate:** [CAGR and future projections with sources]\nâ€¢ **Market Share:** [Company's position in the market with specific figures]\n\nâ€¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (â‚¹ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\nâ€¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\nâ€¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\nâ€¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (â‚¹ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\nâ€¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\nâ€¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background] | [%] | [Term] |\n\nâ€¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\nâ€¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\nâ€¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\nâ€¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\nâ€¢ **Director Directorships:** [Other board positions held by each director]\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\nâ€¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\nâ€¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\nâ€¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\nâ€¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (â‚¹) | Total Amount (â‚¹ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\nâ€¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\nâ€¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\nâ€¢ **Outstanding Convertible Instruments:** [Complete list if any]\nâ€¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\nâ€¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\nâ€¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\nâ€¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\nâ€¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\nâ€¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\nâ€¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\nâ€¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:[exact table from]\n| Type of Contingent Liability | Amount (â‚¹ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\nâ€¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\nâ€¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [â—]]\nâ€¢ **Lot Size:** [Minimum bid quantity]\nâ€¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\nâ€¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (â‚¹ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\nâ€¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\nâ€¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\nâ€¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (â‚¹) | Expected Proceeds (â‚¹ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\nâ€¢ **Statutory Approvals:** [Complete list of key licenses and permits]\nâ€¢ **Pending Regulatory Clearances:** [Complete list if any]\n\nâ€¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown]\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (â‚¹ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\nâ€¢ **Material Developments:** [All developments since last audited period]\nâ€¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\nâ€¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\nâ€¢ **Joint Ventures:** [Complete details with ownership and business focus]\nâ€¢ **Associate Companies:** [Names and relationships]\nâ€¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\nâ€¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\nâ€¢ **Awards and Recognition:** [All significant honors received]\nâ€¢ **CSR Initiatives:** [Complete details of social responsibility programs]\nâ€¢ **Certifications:** [All quality, environmental, other certifications]\nâ€¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\nâ€¢ **International Operations:** [Complete global presence details]\nâ€¢ **Future Outlook:** [Company's stated vision and targets]\nâ€¢ **Dividend Policy:** [Historical dividend payments and future policy]\nâ€¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DDRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          3520,
          1504
        ],
        "id": "1e96f7e0-df88-4a1c-a945-d1fac67147f2",
        "name": "DRHP Summary Generator Agent",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## ðŸŽ¯ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [â—] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## ðŸ”§ RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## ðŸŽ¯ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (Iâ€“XII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [â—] from DRHP\n\n---\n\n## âš ï¸ CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows â‚¹ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" â†’ Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- âœ… State explicitly: \"Data not available in DRHP\"\n- âœ… Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- âŒ NEVER estimate or calculate missing data\n- âŒ NEVER copy data from similar companies\n- âŒ NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## ðŸ” VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [â—] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the DRHP under **â€œSummary of Related Party Transactionsâ€** or **â€œRelated Party Transactionsâ€** for **all financial years** (e.g., *2022â€“23, 2023â€“24, 2024â€“25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- âœ… ALL 12 sections present in correct order\n- âœ… EVERY data point traced to DRHP source\n- âœ… ALL tables verified cell-by-cell\n- âœ… NO fabricated, assumed, or estimated data\n- âœ… ALL financial figures exact from source\n- âœ… NO placeholders except official [â—] from DRHP\n- âœ… Consistent units throughout (as per DRHP)\n- âœ… Period labels match DRHP format exactly\n- âœ… SOP requirements fully met\n- âœ… Professional formatting maintained\n\n---\n\n## âœ… OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- âœ… **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- âœ… **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- âœ… **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- âœ… **SOP COMPLIANT** - all requirements from SOP document met\n- âœ… **NO FABRICATION** - all data sourced from DRHP chunks only\n- âœ… **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- âœ… **EXACT TRANSCRIPTION** - all numbers match source precisely\n- âœ… **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## ðŸ”’ OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n## ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## ðŸš¨ CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## ðŸ“Œ ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          4032,
          1488
        ],
        "id": "d4d493ef-eaf9-4fa1-b01a-46693ce3e5ad",
        "name": "DRHP Summary Preview Agent",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=\nYou are an expert RHP ( Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY RHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official RHP data retrieved from Pinecone vector search.\n\n---\n\n## ðŸŽ¯ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against RHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [â—] in the source RHP\n- **If data is not found in RHP chunks, explicitly state \"Data not available in RHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## ðŸ”§ RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the RHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft RHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial RHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone RHP chunks to populate missing sections\n\n---\n\n## ðŸŽ¯ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone RHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (Iâ€“XII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from RHP , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [â—] from RHP\n\n---\n\n## âš ï¸ CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in RHP chunks\n- **Maintain all decimal places** - if source shows â‚¹ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If RHP shows \"12,345.67 lakhs\" â†’ Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from RHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If RHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone RHP chunks:**\n- âœ… State explicitly: \"Data not available in RHP\"\n- âœ… Leave cell empty in tables with note: \"Not disclosed in RHP\"\n- âŒ NEVER estimate or calculate missing data\n- âŒ NEVER copy data from similar companies\n- âŒ NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific RHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against RHP source\n2. **Check row and column headers** match RHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if RHP provides totals, they must match exactly\n\n---\n\n## ðŸ” VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches RHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against RHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches RHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in RHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches RHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from RHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from RHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match RHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match RHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match RHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [â—] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches RHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches RHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the RHP under **â€œSummary of Related Party Transactionsâ€** or **â€œRelated Party Transactionsâ€** for **all financial years** (e.g., *2022â€“23, 2023â€“24, 2024â€“25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match RHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches RHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in RHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant RHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in RHP, state explicitly: \"Data not available in RHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- âœ… ALL 12 sections present in correct order\n- âœ… EVERY data point traced to RHP source\n- âœ… ALL tables verified cell-by-cell\n- âœ… NO fabricated, assumed, or estimated data\n- âœ… ALL financial figures exact from source\n- âœ… NO placeholders except official [â—] from RHP\n- âœ… Consistent units throughout (as per RHP)\n- âœ… Period labels match RHP format exactly\n- âœ… SOP requirements fully met\n- âœ… Professional formatting maintained\n\n---\n\n## âœ… OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- âœ… **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- âœ… **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- âœ… **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- âœ… **SOP COMPLIANT** - all requirements from SOP document met\n- âœ… **NO FABRICATION** - all data sourced from RHP chunks only\n- âœ… **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- âœ… **EXACT TRANSCRIPTION** - all numbers match source precisely\n- âœ… **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## ðŸ”’ OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n## ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## ðŸš¨ CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in RHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of RHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## ðŸ“Œ ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against RHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant RHP summary with zero fabrication and full verification of all data points against the Pinecone RHP vector store.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -2576,
          -1264
        ],
        "id": "6df0bc9f-669e-42ce-b653-2743568512b0",
        "name": "RHP Summary Preview Agent",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook10').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          3328,
          1760
        ],
        "id": "010b6f6e-69aa-47ed-a708-f514a4c1b15e",
        "name": "DRHP Pinecone VectorDB",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          4224,
          1760
        ],
        "id": "74c12b1a-34a7-4d71-874a-e321cf50566b",
        "name": "Summary Format Doc1",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FklNSi7dT4QA9U7t",
            "name": "Google doc api(sonu)"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          -2432,
          -976
        ],
        "id": "e3273c8d-cdd4-43cd-8d50-b0820c4ac9a9",
        "name": "Summary Format Doc2",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FklNSi7dT4QA9U7t",
            "name": "Google doc api(sonu)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook10').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook10').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook10').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook10').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook10').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          4832,
          1488
        ],
        "id": "0e0031ad-e25a-4418-8cc6-c6230636b472",
        "name": "Update Summary In MongoDB",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook10').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook10').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook10').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "da18f510-9708-4f97-9b3d-8b7160784873",
        "name": "Response Back To Pollong Webhook",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          5008,
          1488
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          3248,
          1360
        ],
        "id": "57a0a187-e1ce-4f95-8dad-c1bfc8f12226",
        "name": "OpenAI Chat Model26",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge bases.\n\n---\n\n## ðŸ—ï¸ **Primary Functions**\n\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\nâš ï¸ **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the DRHP.\n\n---\n\n## ðŸ” **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the DRHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output â€“ used internally for matching)*\n\n---\n\n## ðŸ“Š **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate â€œCapital Structureâ€ or â€œEquity Share Capital Historyâ€\n\n* Identify the exact DRHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the DRHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## ðŸ§© **Output Requirements**\n\nFor **every DRHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from DRHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the DRHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | DRHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | DRHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (â‚¹) | Issue Price (â‚¹) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (â‚¹) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\nâœ“ Row 2: February 28, 2011 - Issue Price â‚¹50.00 > Face Value â‚¹10\nâœ“ Row 5: September 17, 2025 - Issue Price â‚¹90.00 > Face Value â‚¹10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no â‚¹).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## ðŸ§± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[âœ“ List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## âš™ï¸ **Critical Rules Recap**\n\nâœ… Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\nâœ… Keep numeric values **exact** (no rounding, commas, or â‚¹).\nâœ… No missing rows or modified column names.\nâœ… No analysis, commentary, or suggestions.\nâœ… Output stops immediately after Section C Part 3.\nâœ… JSON syntax must be valid.\nâœ… Use âœ“ only for premium round indicators.\n\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          3712,
          1104
        ],
        "id": "ee91fa19-2cae-48c8-a36e-b3d8003d21af",
        "name": "Subquery generator2",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"âœ“ Row 3: Jan 2023 - Issue Price â‚¹90 > Face Value â‚¹10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          3776,
          1360
        ],
        "id": "eae34da8-ca81-4584-b6bb-23c29d447f9a",
        "name": "Structured Output Parser1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          3520,
          1360
        ],
        "id": "5e75dfc5-27c4-4d3f-9345-d82524932815",
        "name": "Auto-fixing Output Parser1"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          3392,
          1360
        ],
        "id": "85e6f7bc-c028-4cdb-8020-675adc9e2c29",
        "name": "OpenAI Chat Model13",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4144,
          1088
        ],
        "id": "c1ae5d7f-0629-45fa-a396-10672e295ba3",
        "name": "Code5"
      },
      {
        "parameters": {
          "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4400,
          1088
        ],
        "id": "6abc47fa-65a7-4bef-8d2d-906f85bb10cc",
        "name": "Code6"
      },
      {
        "parameters": {
          "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (â”, â”â”, etc.)\n  .replace(/^[â”â”€=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4256,
          1008
        ],
        "id": "348a0f72-6e99-408d-9717-471eb2b6ce07",
        "name": "Code7"
      },
      {
        "parameters": {
          "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          5008,
          1056
        ],
        "id": "4a9ba974-3e62-43d0-8edd-cc939a7daa7b",
        "name": "HTML7"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          4608,
          1056
        ],
        "id": "215a8440-45c8-4cd6-bd8a-2a82d85c85e5",
        "name": "Merge6",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          4832,
          1056
        ],
        "id": "cc0871fb-01d7-4bfb-bb48-f74f88075d84",
        "name": "Aggregate2"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook10').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4608,
          1472
        ],
        "id": "cf5d0bbf-7801-4cb8-905a-8b9e9391b534",
        "name": "mdn to html17",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:ðŸ’°\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:ðŸ¦\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"âœ… Investor data inserted after Section VI\");\n  } else {\n    console.log(\"âš ï¸ Section VI not found â€” appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook10').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5008,
          1280
        ],
        "id": "567a0be8-31c2-4539-8eea-78f780bd9017",
        "name": "mdn to html18"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          4832,
          1280
        ],
        "id": "c85d75bb-1c08-4d19-9414-f61e0e1f3127",
        "name": "Merge9"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          3904,
          1360
        ],
        "id": "82e6f0a0-84ac-4727-90d3-fd3a40054c2f",
        "name": "Embeddings OpenAI33",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          4256,
          1360
        ],
        "id": "86aa0dcb-a04f-4784-b9a7-299f38f45f4a",
        "name": "Reranker Cohere19",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook10').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4000,
          1360
        ],
        "id": "7c738913-2930-4575-b9d2-1d7f9e24bb0b",
        "name": "DRHP Pinecone VectorDB5",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          4352,
          1760
        ],
        "id": "54c3bcf0-9be0-4383-a3b4-d867834c612b",
        "name": "Embeddings OpenAI38",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          4704,
          1760
        ],
        "id": "3cc44cd8-d190-44f6-bb2b-9109f1878bd8",
        "name": "Reranker Cohere23",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook10').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          4448,
          1760
        ],
        "id": "c47c6f01-7d18-44d0-8388-1ac0ccc48c24",
        "name": "DRHP Pinecone VectorDB6",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3408,
          -1392
        ],
        "id": "4918bd41-004d-41df-af5b-01e3885f475f",
        "name": "OpenAI Chat Model27",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=You are a specialized agent designed to retrieve and extract investor information and share capital history data from RHP (Red Herring Prospectus) knowledge bases.\n\n---\n\n# ðŸ—ï¸ PRIMARY FUNCTIONS\n\n1. ALWAYS retrieve and extract the **company name** from RHP chunks.\n2. Extract **comprehensive investor lists** from RHP documents.\n3. Cross-reference and verify investors against a provided target investor list.\n4. Mention **only matched investors**, with detailed RHP information.\n5. Extract **complete equity share capital history** exactly as shown in RHP.\n6. Identify **premium rounds** and return calculation parameters in JSON format.\n7. Provide a **fully structured, rule-compliant investor analysis report**.\n\n---\n\n# ðŸš¨ CRITICAL REQUIREMENTS\n\n1. The **company name MUST be extracted from RHP chunks**  \n2. The company name MUST appear in **all JSON outputs**  \n3. If not found â†’ set: `\"Company Name Not Found in RHP\"`  \n4. This agent DOES NOT perform calculations  \n5. All numeric values must remain EXACT (no formatting changes)  \n\n---\n\n# âš™ï¸ BEHAVIOR RULES\n\n## 1. Information Retrieval\nYou must always extract:\n- Company name  \n- Full investor list  \n- All capital structure tables  \n- All equity share capital history rows EXACTLY as in RHP  \n- Issue prices, face values, dates, share counts  \n\n---\n\n## 2. Investor List Verification (IMPORTANT)\n\nUse fuzzy but accurate matching:\n- Case-insensitive  \n- Ignore partial surname matches  \n- Match only when entity name is clearly identical  \n\n---\n\n# ðŸ”¥ HARD RULE FOR SECTION B (STRICT ENFORCEMENT â€” OVERRIDES ALL OTHER RULES)\n\nThe target investor list is used **internally ONLY**.  \nYou must NEVER print or list ANY target investor name unless it is CONFIRMED to exist in the RHP.\n\n### SECTION B Output Logic:\n\n### âœ” If ZERO matches found:\n- Output ONLY this text:  \n  `No matches found`\n- DO NOT generate a table  \n- DO NOT display any investor names  \n- DO NOT show blanks, placeholders, or rows with â€œ-â€ or \"No match found\"  \n\n### âœ” If ONE OR MORE matches found:\n- Show ONLY a Markdown table containing the matched investors  \n- DO NOT include unmatched investors  \n- DO NOT include empty rows or placeholder values  \n- DO NOT preserve the order of the target list  \n- Include ONLY real RHP-matched names with valid data  \n\n**This rule is absolute and overrides every other instruction.**\n\n---\n\n## 3. Target Investor List (Internal Use ONLY)\n\nYou must match RHP investors against this internal list:\n\n- Adheesh Kabra  \n- Shilpa Kabra  \n- Rishi Agarwal  \n- Aarth AIF / Aarth AIF Growth Fund  \n- Chintan Shah  \n- Sanjay Popatlal Jain  \n- Manoj Agrawal  \n- Rajasthan Global Securities Private Limited  \n- Finavenue Capital Trust  \n- SB Opportunities Fund  \n- Smart Horizon Opportunity Fund  \n- Nav Capital Vcc - Nav Capital Emerging  \n- Invicta Continuum Fund  \n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1  \n- MERU INVESTMENT FUND PCC- CELL 1  \n- Finavenue Growth Fund  \n- Anant Aggarwal  \n- PACE COMMODITY BROKERS PRIVATE LIMITED  \n- Bharatbhai Prahaladbhai Patel  \n- ACCOR OPPORTUNITIES TRUST  \n- V2K Hospitality Private Limited  \n- Mihir Jain  \n- Rajesh Kumar Jain  \n- Vineet Saboo  \n- Prabhat Investment Services LLP  \n- Nikhil Shah  \n- Nevil Savjani  \n- Yogesh Jain  \n- Shivin Jain  \n- Pushpa Kabra  \n- KIFS Dealer  \n- Jitendra Agrawal  \n- Komalay Investrade Private Limited  \n- Viney Equity Market LLP  \n- Nitin Patel  \n- Pooja Kushal Patel  \n- Gitaben Patel  \n- Rishi Agarwal HUF  \n- Sunil Singhania  \n- Mukul Mahavir Agrawal  \n- Ashish Kacholia  \n- Lalit Dua  \n- Utsav Shrivastav  \n\nThis list is ONLY for internal matching â€” NEVER show it unless they match in RHP.\n\n---\n\n# ðŸ“Š OUTPUT REQUIREMENTS â€” ALWAYS RETURN EXACTLY 3 SECTIONS\n\n---\n\n# **SECTION A â€” Complete Investor List from RHP**\n\n- Always a **Markdown table**  \n- Columns:  \n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`  \n- Must include **every investor** found in the RHP  \n- Preserve **exact names, numbers, and formatting**  \n\n---\n\n# **SECTION B â€” Matched Investors (Strict Rule Applied)**\n\nFollow the **Hard Rule**:\n\n### If no matches â†’ output ONLY:\nNo matches found\n\n### If matches exist â†’ output:\n- Markdown Table with columns:  \n  `Investor Name | RHP Name | Investment | Category | Notes`\n\nOnly matched investors must appear.\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from RHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (â‚¹) | Issue Price (â‚¹) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (â‚¹) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n**Importand Rule** :always check  in which rows the Issue price > Face value && Issue price != Face means when Issue proce bigger than Face value only than find row and get that details in json strictly match this condition  , if this condtion true than it will added on Premium rounds\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\nâœ“ Row 2: February 28, 2011 - Issue Price â‚¹50.00 > Face Value â‚¹10\nâœ“ Row 5: September 17, 2025 - Issue Price â‚¹90.00 > Face Value â‚¹10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no â‚¹).\n\nExample:\n\n```json\n{\n  \"total_premium_rounds\": 2,\n   \"company_name\": \"string\",\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n---\n\n## ðŸ§± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"company_name\": \"string\",\n    \"content\": \"RHP Investor & Capital Data Extraction Report\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION A: Complete Investor List from RHP\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[âœ“ List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n## âš™ï¸ **Critical Rules Recap**\n\nâœ… Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\nâœ… Keep numeric values **exact** (no rounding, commas, or â‚¹).\nâœ… No missing rows or modified column names.\nâœ… No analysis, commentary, or suggestions.\nâœ… Output stops immediately after Section C Part 3.\nâœ… JSON syntax must be valid.\nâœ… Use âœ“ only for premium round indicators.\n\n## ðŸ”´ **Validation Checklist Before Returning Output**\n\nBefore returning the final JSON, verify:\n\n- [ ] Company name has been retrieved from Pinecone RHP knowledge base, If company name not found again check RHP chunk without compnay name never return output \n- [ ] Complete Investor List retrieved from Pinecone RHP knowledge base \n- [ ] MATCHED INVESTORS list fuzzy  matched \n- [ ] SHARE CAPITAL HISTORY DATA EXTRACTION exact table retrieved from Pinecone RHP knowledge base  \n- [ ] If company name not found, value is set to \"Company Name Not Found in RHP\"\n\n**If any checkbox is unchecked, DO NOT return the output. Retrieve the missing data first.**\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -2960,
          -1664
        ],
        "id": "b7ce98e9-46a5-4152-bd16-507bcc9ef220",
        "name": "Subquery generator5",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"âœ“ Row 3: Jan 2023 - Issue Price â‚¹90 > Face Value â‚¹10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          -2928,
          -1392
        ],
        "id": "4737eae0-409f-4439-bbdb-682993cecb00",
        "name": "Structured Output Parser2"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          -3184,
          -1392
        ],
        "id": "96e38a7b-0c35-4c59-a45e-eda6a8cac727",
        "name": "Auto-fixing Output Parser2"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3280,
          -1392
        ],
        "id": "cb4daf3f-2e72-4890-9bdb-a6763b08b9e5",
        "name": "OpenAI Chat Model28",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook11').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2080,
          -1280
        ],
        "id": "9ec33ab4-23c0-40ea-a63c-fade4d1ce0e7",
        "name": "mdn to html19",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2784,
          -1392
        ],
        "id": "8b4a3dbb-b770-41b4-9abe-50cd88ed07a6",
        "name": "Embeddings OpenAI39",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -2416,
          -1392
        ],
        "id": "40e8438d-e07f-4bf7-8cd0-6b353b99e9a8",
        "name": "Reranker Cohere24",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook11').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook11').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook11').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook11').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook11').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1824,
          -1232
        ],
        "id": "c18e14ed-ece6-403b-9d59-4a9ecb5a7e0e",
        "name": "Update in MongoDB",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook11').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook11').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook11').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "87a437bf-7f79-420f-8281-65673e71b7f3",
        "name": "Response Back to Polling Webhook",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -1632,
          -1232
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook11').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2672,
          -1392
        ],
        "id": "11583dd7-e845-48b7-a562-00d77868b96b",
        "name": "RHP Pinecone VectorDB7",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook11').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2208,
          -976
        ],
        "id": "d508ff63-06de-4427-a82e-582af568d002",
        "name": "RHP Pinecone VectorDB1",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          2240,
          1424
        ],
        "id": "7fbfa64f-1659-48d3-a177-35e4452f42d2",
        "name": "Embeddings OpenAI30",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.body.prompt }}",
          "options": {
            "systemMessage": "=You are a Senior Financial Document Analyst with 15+ years of experience in Indian capital markets, SEBI compliance, and IPO documentation. You specialize in comparative analysis of prospectus documents, identifying regulatory, financial, strategic, and disclosure-related differences between draft and final versions.\n\nðŸŽ¯ Objective\nConduct a comprehensive comparative analysis between the DRHP (Draft Red Herring Prospectus) and RHP (Red Herring Prospectus) to identify all textual, semantic, financial, legal, and regulatory changes. RHP is the final, SEBI-approved version and takes precedence.\n\nðŸ“„ Document Retrieval Instructions\nRHP Document\nSource: RHP_knowledge_base\n\nMethod: Match based on section headers, page numbers, and content alignment\n\nExtract: All available sections\n\nInclude Metadata: Titles, page numbers, subsection labels, hierarchy\n\nDRHP Document\nSource: DRHP_knowledge_base\n\nMethod: Align corresponding sections using section titles and structure\n\nExtract: Matched sections from DRHP\n\nInclude Metadata: Same structure and identifiers as RHP\n\nðŸ“˜ Analysis Framework\n1. ðŸ” Section-by-Section Comparison\nFor each section pair:\n\nTextual Changes: Additions, deletions, rewording\n\nStructural Changes: Reordering, renaming, new sections\n\nSemantic Shifts: Alteration in meaning or tone\n\nNumerical Differences: Highlight all financial or statistical changes\n\n2. ðŸ§­ Change Categorization Matrix\nPrimary Types:\n\nFINANCIAL | REGULATORY | LEGAL | OPERATIONAL | STRATEGIC\n\nGOVERNANCE | MARKET | RISK\n\nSecondary Types:\n\nTechnical corrections | Formatting | Disclosure enhancements | Cross-referencing\n\n3. âš–ï¸ Materiality Assessment\nCritical (Red Flag): Material financial changes (>10%), legal action, new risks, change in use of proceeds\n\nHigh: 5â€“10% financial changes, strategic shifts, regulatory disclosures\n\nMedium: <5% updates, minor governance, new trends\n\nLow: Formatting, technical corrections\n\n4. ðŸ“Š Financial Analysis\nRevenue, Profitability, Ratios, Valuation\n\nVariance %: DRHP vs RHP\n\nCash Flow and Balance Sheet line-by-line comparison\n\n5. âš ï¸ Risk Factor Evolution\nNew, Removed, Modified risks\n\nOrder/relevance shifts\n\nUpdated mitigation strategies\n\n6. ðŸ§  Strategy & Operations\nMarket expansion changes\n\nProduct portfolio additions/removals\n\nTechnology/supply chain updates\n\n7. ðŸ‘¥ Governance & Management\nBoard or key personnel changes\n\nInternal policy or control framework updates\n\nðŸ§¾ Output Format\nExecutive Summary\nKey updates & significance\n\nImpact overview\n\nRegulatory flags\n\nSuggested actions\n\nDetailed Section Report\nFor each aligned section:\n\n**Section**: [Section Title]\n**Pages**: DRHP [X] vs RHP [Y]\n\nðŸ”„ Key Changes:\n1. [Change description]\n   - Type: [Financial/Strategic/etc.]\n   - Materiality: [Critical/High/etc.]\n   - Before: [DRHP content]\n   - After: [RHP content]\n   - Impact: [e.g., Increased investor risk]\n   - Regulatory Note: [e.g., Non-compliance with SEBI X.X.X]\n\n\nðŸ“Œ Summary: [Brief summary of changes in this section]\nDashboards\nChange Count by Category\n\nFinancial Summary Table (DRHP vs RHP)\n\nRisk Status (New/Removed/Modified count)\n\nCompliance Checklist\n\nRecommendations\nðŸ“£ Communicate to: Investors / SEBI / Board\n\nðŸ§ª Further Due Diligence Areas\n\nâ± Timeline Alerts or Required Actions\n\nâœ… QA Checklist\nArea\tValidation Item\nAccuracy\tAll figures verified to match document content\nCompleteness\tAll major sections accounted for\nConsistency\tCategories and structure used uniformly\nRegulatory\tChecked against SEBI ICDR requirements\n\nðŸ“ˆ Success Criteria\nAccuracy: â‰¥ 99% in identifying changes\n\nCoverage: 100% section match between DRHP and RHP\n\nTimeliness: Delivered within [X] hours\n\nActionability: Clear, usable insights for legal & compliance teams\n\n\n\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1744,
          1184
        ],
        "id": "7373d5aa-c56a-40c2-a1c2-4f73086d8484",
        "name": "AI Agent2",
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "={{ $('Webhook7').item.json.body.sessionId }}"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1584,
          1424
        ],
        "id": "ff5913e1-f787-4000-ae1e-19c3a72d54e3",
        "name": "Simple Memory",
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1728,
          1424
        ],
        "id": "f53a629b-c848-44d9-9178-1acaf6d6facc",
        "name": "Embeddings OpenAI40",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Create comparision report DRHP VS RHP",
          "height": 732,
          "width": 1444
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1360,
          848
        ],
        "id": "6822bd75-5024-48c6-9ffe-575159adbfd2",
        "name": "Sticky Note17",
        "disabled": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "DRHP_knowledge_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook7').first().json.body.rhpNamespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          1840,
          1424
        ],
        "id": "c51f6c4d-b19e-4a16-8aac-854f079d3b7a",
        "name": "RHP Pinecone Vector Store",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_knowledge_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdoc",
            "mode": "list",
            "cachedResultName": "drhpdoc"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook7').first().json.body.drhpNamespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          2368,
          1424
        ],
        "id": "446fd0d8-5259-44a6-ac77-024b73a46cd3",
        "name": "DRHP Pinecone Vector Store",
        "credentials": {
          "pineconeApi": {
            "id": "DGSVRq3jlG9GGHG5",
            "name": "PineconeApi(sonu)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\nlet fileName = $('Webhook7').first().json.body.drhpNamespace ;\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: `report-${fileName}`\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2112,
          1120
        ],
        "id": "ba0b45f6-018d-4ff5-9856-b00a33859702",
        "name": "mdn to html6",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/reports/report-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook7').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "ee39ba21-ea4e-42f3-8648-fa991a3366f5",
        "name": "Send Error to Backend7",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2528,
          1200
        ],
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $('Webhook7').item.json.body.rhpNamespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2336,
          1200
        ],
        "id": "b152cfa9-3162-4ba9-a241-f9318d0564f6",
        "name": "Edit Fields10",
        "disabled": true
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "new/compare-rhp-drhp",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          1424,
          1184
        ],
        "id": "94308481-1e28-4ff4-a4df-193e3470e44a",
        "name": "Webhook7",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
        "disabled": true
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.body.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "92af9769-231a-4fe2-93b1-b517f9c310cc",
        "name": "Set Execution Info1",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          1808,
          992
        ],
        "disabled": true
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "6c59bfe5-97be-4887-8015-6b1612c3d3fc",
        "name": "Respond with Execution ID1",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          2032,
          992
        ],
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Node for send immediate response for processing \n",
          "height": 240,
          "width": 684,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1568,
          912
        ],
        "typeVersion": 1,
        "id": "9f724165-ed16-46c8-9595-2d29f2d58bb8",
        "name": "Sticky Note13",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Upload RHP and RHP Summary Workflow\n",
          "height": 1776,
          "width": 2068,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3472,
          592
        ],
        "typeVersion": 1,
        "id": "1e15516c-7ae5-4b57-a4ea-90ca2ca6ccf8",
        "name": "Sticky Note27",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/reports/create-report",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook7').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "drhpNamespace",
                "value": "={{ $('Webhook7').item.json.body.drhpNamespace }}"
              },
              {
                "name": "drhpId",
                "value": "={{ $('Webhook7').item.json.body.drhpDocumentId }}"
              },
              {
                "name": "title",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook7').item.json.body.sessionId }}"
              },
              {
                "name": "rhpNamespace",
                "value": "={{ $('Webhook7').item.json.body.rhpNamespace }}"
              },
              {
                "name": "rhpId",
                "value": "={{ $('Webhook7').item.json.body.rhpDocumentId }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook7').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook7').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2336,
          976
        ],
        "id": "1b1f0ba2-2879-4ea4-92d6-b072374e7e9a",
        "name": "sent response to the backend api for create report1",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/reports/report-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook7').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "={{ $('Webhook7').item.json.body.drhpNamespace }}"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook7').first().json.body.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "8a1aad6c-26c6-430a-8e31-4b0bf50dcf6b",
        "name": "send final response for success report1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2528,
          976
        ],
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow RHP",
          "height": 960,
          "width": 1940,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3408,
          1344
        ],
        "id": "95af57f8-3331-4c62-9b7c-231457749b81",
        "name": "Sticky Note28"
      },
      {
        "parameters": {
          "topN": 12
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2624,
          1424
        ],
        "id": "80d72f5f-f668-4e3e-8d76-2d37b031668c",
        "name": "Reranker Cohere8",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "topN": 12
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2112,
          1424
        ],
        "id": "568fd059-0115-40c7-9165-774ded6efbcc",
        "name": "Reranker Cohere17",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "new/upload-drhp",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://drhp-summarizer-mu.vercel.app",
            "binaryPropertyName": "data"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -864,
          864
        ],
        "id": "ed027689-b783-4fc3-8af3-27bf2b207d35",
        "name": "Webhook3",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = fileItem?.binary?.data0?.fileName || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -208,
          848
        ],
        "id": "f9aa492f-fde3-4f75-9f05-a9ff9999a92e",
        "name": "Cleaned text2",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "pdf",
          "binaryPropertyName": "=data0",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          -640,
          768
        ],
        "id": "7d6842a5-e451-42a8-b5fa-6c6646aabf61",
        "name": "Extract from File2",
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.1,
        "position": [
          -384,
          848
        ],
        "id": "5b43f7d3-1f42-4056-8257-bf16bc1bb405",
        "name": "Merge12",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# This flow is store  DRHP Document in the Pinecone vector DB",
          "height": 580,
          "width": 1560,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -944,
          688
        ],
        "id": "115d674e-8384-416b-b874-b7b41a11dcc3",
        "name": "Sticky Note29",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/documents/upload-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "62d96a25-86ba-4dfa-94cf-32a24a47f2a3",
        "name": "Send Error to Backend13",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -448,
          1072
        ],
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.body.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -688,
          1072
        ],
        "id": "b53e672f-9186-4213-a026-7d8d94336e2b",
        "name": "Edit Fields12",
        "disabled": true
      },
      {
        "parameters": {
          "chunkSize": 4000,
          "chunkOverlap": 800,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "typeVersion": 1,
        "position": [
          352,
          1088
        ],
        "id": "17abf732-41b7-42bf-949e-5317593f5db5",
        "name": "Recursive Character Text Splitter2",
        "disabled": true
      },
      {
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.fileName }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "typeVersion": 1,
        "position": [
          -64,
          1088
        ],
        "id": "f39dabac-6d40-468e-80c8-45688c04a192",
        "name": "Default Data Loader2",
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -192,
          1088
        ],
        "id": "6d06e1cc-53f2-415b-86b1-a632665e4bb1",
        "name": "Embeddings OpenAI41",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "mode": "insert",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "embeddingBatchSize": 50,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -16,
          848
        ],
        "id": "db87c4a0-015c-4941-8977-769d494671ba",
        "name": "Pinecone Vector Store9",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text2').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          352,
          832
        ],
        "id": "028c7a59-61d8-4e32-9571-9df0e7b01916",
        "name": "Respond to Webhook11",
        "disabled": true
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "new/upload-rhp",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://drhp-summarizer-mu.vercel.app",
            "binaryPropertyName": "data"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -3328,
          848
        ],
        "id": "f3b0d596-ecdc-4a50-8788-b62f1f12e8ac",
        "name": "Webhook12",
        "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = $('Webhook12').first().json.body.namespace || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2704,
          832
        ],
        "id": "ec2fa3d1-5d5a-47eb-8ffc-c1ef096d5bd7",
        "name": "Cleaned text3",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "pdf",
          "binaryPropertyName": "=data0",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          -3120,
          752
        ],
        "id": "f60432cc-febf-4b13-be53-195d51f96ca6",
        "name": "Extract from File3",
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.1,
        "position": [
          -2912,
          832
        ],
        "id": "d84fb5ae-ada2-4638-9d20-9eaf0b834831",
        "name": "Merge14",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# This flow is store RHP Document in the Pinecone vector DB",
          "height": 580,
          "width": 1608,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -3408,
          656
        ],
        "id": "231eab0d-668c-471d-a704-c087e034f866",
        "name": "Sticky Note30",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/documents/upload-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "1ef0bf87-4ed3-41a3-9121-3ed32e36b641",
        "name": "Send Error to Backend15",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -2912,
          1056
        ],
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.body.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=MVsxMzD48YvOQ34P",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3152,
          1056
        ],
        "id": "ad41badd-efdd-4615-aedc-4ef947865827",
        "name": "Edit Fields18",
        "disabled": true
      },
      {
        "parameters": {
          "chunkSize": 4000,
          "chunkOverlap": 800,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
        "typeVersion": 1,
        "position": [
          -2080,
          1072
        ],
        "id": "c030e81e-516a-421d-ad7e-aba4460c5026",
        "name": "Recursive Character Text Splitter3",
        "disabled": true
      },
      {
        "parameters": {
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.fileName }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
        "typeVersion": 1,
        "position": [
          -2432,
          1072
        ],
        "id": "a1959fc6-1999-4dfb-b9c1-63aed23a9047",
        "name": "Default Data Loader3",
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2640,
          1072
        ],
        "id": "87aa8cce-3863-4fc4-8f5b-fcfa9e0c6ec9",
        "name": "Embeddings OpenAI42",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "mode": "insert",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "embeddingBatchSize": 50,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2512,
          832
        ],
        "id": "e7858dbc-2eef-485b-a6a1-6011a61038ed",
        "name": "Pinecone Vector Store16",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text3').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -2064,
          816
        ],
        "id": "32b84515-0250-488d-9992-e3bf80ef547c",
        "name": "Respond to Webhook12",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Upload DRHP and DRHP summary flow",
          "height": 1776,
          "width": 2144,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1008,
          592
        ],
        "typeVersion": 1,
        "id": "6b9af633-23b1-4976-909f-1a12127f7994",
        "name": "Sticky Note31",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow DRHP",
          "height": 944,
          "width": 2020,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -944,
          1360
        ],
        "id": "fe04b307-3b8b-499f-8a03-a195df2d1e58",
        "name": "Sticky Note32"
      },
      {
        "parameters": {
          "content": "# chat and comparision document flow",
          "height": 1584,
          "width": 1568,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1296,
          784
        ],
        "typeVersion": 1,
        "id": "8f3cb8c9-31a8-4d65-926b-bbd40b168a0a",
        "name": "Sticky Note33",
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1424,
          1424
        ],
        "id": "c14d17ff-d98b-4465-bcb2-705cf9be790f",
        "name": "OpenAI Chat Model30",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -64,
          2144
        ],
        "id": "fecda2e1-6a4d-4cb9-b4ce-d0106621b799",
        "name": "OpenAI Chat Model31",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2352,
          2144
        ],
        "id": "e40e3fcd-7a23-4d97-bea4-fc223e12468d",
        "name": "Embeddings OpenAI43",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -864,
          2144
        ],
        "id": "6488583d-0a7d-4603-9205-e195a87e9062",
        "name": "OpenAI Chat Model32",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -192,
          2144
        ],
        "id": "d15377ce-a78c-4ea1-824e-4a3e249cf413",
        "name": "Embeddings OpenAI44",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -496,
          2144
        ],
        "id": "5ad86e73-a21d-4aab-8fef-994b816721bb",
        "name": "Embeddings OpenAI45",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 12
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -2000,
          2144
        ],
        "id": "0164f5c1-e262-4c43-8e10-98e935765b31",
        "name": "Reranker Cohere25",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -368,
          2144
        ],
        "id": "9e116a34-374d-494a-9623-db148d10f5d3",
        "name": "Reranker Cohere26",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "new/1/drhp/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -864,
          1888
        ],
        "id": "7eeca432-05a0-473b-97bb-c14d2c4db788",
        "name": "Webhook13",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "2cf6c95e-729f-46ea-8097-2d20accb5c66",
        "name": "Set Execution Info8",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          -672,
          1504
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "a1cae549-4900-476c-932d-f099ea616e75",
        "name": "Respond with Execution ID8",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -496,
          1504
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook13').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "53194812-d860-460f-9cd7-98e40222ed50",
        "name": "Send Error to Backend16",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          832,
          2032
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          672,
          2032
        ],
        "id": "1b23f04d-07a5-42f1-b687-8f357714a8cb",
        "name": "Edit Fields25"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2608,
          2144
        ],
        "id": "d60744f6-55b4-4857-80dc-52618740e278",
        "name": "OpenAI Chat Model33",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3328,
          2144
        ],
        "id": "f8aec9b7-71b9-414b-9316-770f1acddf5f",
        "name": "OpenAI Chat Model34",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2736,
          2144
        ],
        "id": "cb23322c-a6f6-4f2a-a4e8-7fcff86cad4a",
        "name": "Embeddings OpenAI46",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2848,
          2144
        ],
        "id": "d287af72-8bbb-42ba-bc21-13eefd4b2eb0",
        "name": "Embeddings OpenAI47",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -2976,
          2144
        ],
        "id": "03007422-02a6-4bb4-9c77-ac90460568d9",
        "name": "Reranker Cohere27",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "f91e4bfd-1e02-4b35-bcf0-83bdc1fc9409",
        "name": "Set Execution Info9",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          -3168,
          1456
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "26823f9e-9168-4ed1-a198-5ae640bda229",
        "name": "Respond with Execution ID9",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -2944,
          1456
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook14').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "7326f9da-f3c1-41ea-857d-872d8e523fc4",
        "name": "Send Error to Backend17",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -1664,
          2128
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1840,
          2128
        ],
        "id": "b066c7e7-da70-47fe-b051-170e3aefc9d5",
        "name": "Edit Fields26"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "new/1/rhp/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -3376,
          1872
        ],
        "id": "660323e2-d821-4936-862f-27be8280865f",
        "name": "Webhook14",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "content": "# Immediate responce sent to the UI",
          "height": 224,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3312,
          1392
        ],
        "typeVersion": 1,
        "id": "49a2658e-3bd7-4d0a-84f3-c6fed3bae9ac",
        "name": "Sticky Note34"
      },
      {
        "parameters": {
          "content": "# Immediate responce sent to the UI",
          "height": 224,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -864,
          1440
        ],
        "typeVersion": 1,
        "id": "f3429943-2bca-4234-87f4-c2c5062979ea",
        "name": "Sticky Note35"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook14').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -3232,
          2144
        ],
        "id": "6695f6a7-f814-4691-b9fc-bc12e99650b7",
        "name": "RHP Pinecone Vector DB",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "SOP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2736,
          2000
        ],
        "id": "1965c652-562b-4e58-b134-326fa8bbc74c",
        "name": "Fund SOP Pinecone Vector DB",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade RHP (Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved RHP chunks.\n\n## Your Resources\n\n**Retrieved RHP Data**: Retrieved RHP chunks based on 10 Subquries. Always retrive chunks of RHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted RHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved RHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided RHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved RHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the RHP uses â€œSep-24â€, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows â‚¹ 8,894.54, table must show 8,894.54 (or â‚¹ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\nâ€¢ **Company Name:** [Full Legal Name]\nâ€¢ **Corporate Identity Number (CIN):** [CIN if available]\nâ€¢ **Registered Office Address:** [Complete address]\nâ€¢ **Corporate Office Address:** [If different from registered office]\nâ€¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\nâ€¢ **Company Website:** [Official URL]\nâ€¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\nâ€¢ **Registrar to the Issue:** [Name and complete contact information]\nâ€¢ **Date of Incorporation:** [When the company was established]\nâ€¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\nâ€¢ **ISIN:** [International Securities Identification Number if available, if marked as [â—]]\n    â€¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\nâ€¢ **Peer-Reviewed Auditor:** [If applicable]\nâ€¢ **Issue Opening Date:** [Scheduled date or mention if marked as [â—]]\nâ€¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\nâ€¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\nâ€¢ **Market Maker Information:** [If applicable]\nâ€¢ **RHP Filing Date:** [Date when the RHP was filed with SEBI only RHP filling date if mention otherwise keep [â—],not mention RHP date  strictly check ]\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\nâ€¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\nâ€¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (â‚¹ million) | Domestic (%) | Export Revenue (â‚¹ million) | Export (%) | Total Revenue (â‚¹ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\nâ€¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\nâ€¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\nâ€¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\nâ€¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (â‚¹ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\nâ€¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (â‚¹ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\nâ€¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\nâ€¢ **Competitive Advantages:** [All unique selling propositions mentioned]\nâ€¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\nâ€¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\nâ€¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DRHP for better readability (details of capacity utilization , this table is an example,get  exact table from drhp chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\nâ€¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\nâ€¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\nâ€¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\nâ€¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\nâ€¢ **Projected Growth Rate:** [CAGR and future projections with sources]\nâ€¢ **Market Share:** [Company's position in the market with specific figures]\n\nâ€¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (â‚¹ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\nâ€¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\nâ€¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\nâ€¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (â‚¹ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\nâ€¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\nâ€¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background] | [%] | [Term] |\n\nâ€¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\nâ€¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\nâ€¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\nâ€¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\nâ€¢ **Director Directorships:** [Other board positions held by each director]\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\nâ€¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\nâ€¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\nâ€¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\nâ€¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (â‚¹) | Total Amount (â‚¹ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\nâ€¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\nâ€¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\nâ€¢ **Outstanding Convertible Instruments:** [Complete list if any]\nâ€¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\nâ€¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\nâ€¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\nâ€¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\nâ€¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\nâ€¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\nâ€¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\nâ€¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\n| Type of Contingent Liability | Amount (â‚¹ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\nâ€¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\nâ€¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [â—]]\nâ€¢ **Lot Size:** [Minimum bid quantity]\nâ€¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\nâ€¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (â‚¹ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\nâ€¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\nâ€¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\nâ€¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (â‚¹) | Expected Proceeds (â‚¹ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\nâ€¢ **Statutory Approvals:** [Complete list of key licenses and permits]\nâ€¢ **Pending Regulatory Clearances:** [Complete list if any]\n\nâ€¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown]\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (â‚¹ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\nâ€¢ **Material Developments:** [All developments since last audited period]\nâ€¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\nâ€¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\nâ€¢ **Joint Ventures:** [Complete details with ownership and business focus]\nâ€¢ **Associate Companies:** [Names and relationships]\nâ€¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\nâ€¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\nâ€¢ **Awards and Recognition:** [All significant honors received]\nâ€¢ **CSR Initiatives:** [Complete details of social responsibility programs]\nâ€¢ **Certifications:** [All quality, environmental, other certifications]\nâ€¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\nâ€¢ **International Operations:** [Complete global presence details]\nâ€¢ **Future Outlook:** [Company's stated vision and targets]\nâ€¢ **Dividend Policy:** [Historical dividend payments and future policy]\nâ€¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the RHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all RHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided RHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only RHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -2976,
          1872
        ],
        "id": "36fbbbe4-ae99-4a4e-9c10-6fe2f479ab6a",
        "name": "RHP Summary Generator Agent1",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved DRHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses â€œSep-24â€, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows â‚¹ 8,894.54, table must show 8,894.54 (or â‚¹ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\nâ€¢ **Company Name:** [Full Legal Name]\nâ€¢ **Corporate Identity Number (CIN):** [CIN if available]\nâ€¢ **Registered Office Address:** [Complete address]\nâ€¢ **Corporate Office Address:** [If different from registered office]\nâ€¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\nâ€¢ **Company Website:** [Official URL]\nâ€¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\nâ€¢ **Registrar to the Issue:** [Name and complete contact information]\nâ€¢ **Date of Incorporation:** [When the company was established]\nâ€¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\nâ€¢ **ISIN:** [International Securities Identification Number if available, if marked as [â—]]\n    â€¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\nâ€¢ **Peer-Reviewed Auditor:** [If applicable]\nâ€¢ **Issue Opening Date:** [Scheduled date or mention if marked as [â—]]\nâ€¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\nâ€¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\nâ€¢ **Market Maker Information:** [If applicable]\nâ€¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [â—],not mention DDRHP date  strictly check ]\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\nâ€¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\nâ€¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (â‚¹ million) | Domestic (%) | Export Revenue (â‚¹ million) | Export (%) | Total Revenue (â‚¹ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\nâ€¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\nâ€¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\nâ€¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\nâ€¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (â‚¹ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\nâ€¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (â‚¹ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\nâ€¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\nâ€¢ **Competitive Advantages:** [All unique selling propositions mentioned]\nâ€¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\nâ€¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\nâ€¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\nâ€¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\nâ€¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\nâ€¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\nâ€¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\nâ€¢ **Projected Growth Rate:** [CAGR and future projections with sources]\nâ€¢ **Market Share:** [Company's position in the market with specific figures]\n\nâ€¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\nâ€¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in DRHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (â‚¹) | Revenue from Operations (â‚¹ in Lakhs) | Basic EPS (â‚¹) | Diluted EPS (â‚¹) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (â‚¹) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (â‚¹ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\nâ€¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\nâ€¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\nâ€¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (â‚¹ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\nâ€¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\nâ€¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\nâ€¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\nâ€¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\nâ€¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\nâ€¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\nâ€¢ **Director Directorships:** [Other board positions held by each director]\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\nâ€¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\nâ€¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\nâ€¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\nâ€¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (â‚¹) | Total Amount (â‚¹ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\nâ€¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\nâ€¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\nâ€¢ **Outstanding Convertible Instruments:** [Complete list if any]\nâ€¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\nâ€¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\nâ€¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\nâ€¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\nâ€¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\nâ€¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\nâ€¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\nâ€¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in DRHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (â‚¹ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\nâ€¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\nâ€¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [â—]]\nâ€¢ **Lot Size:** [Minimum bid quantity]\nâ€¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\nâ€¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (â‚¹ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\nâ€¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\nâ€¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\nâ€¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (â‚¹) | Expected Proceeds (â‚¹ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\nâ€¢ **Statutory Approvals:** [Complete list of key licenses and permits]\nâ€¢ **Pending Regulatory Clearances:** [Complete list if any]\n\nâ€¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in DRHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (â‚¹ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\nâ€¢ **Material Developments:** [All developments since last audited period]\nâ€¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\nâ€¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\nâ€¢ **Joint Ventures:** [Complete details with ownership and business focus]\nâ€¢ **Associate Companies:** [Names and relationships]\nâ€¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\nâ€¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\nnote:- Exact tables mention in the DRHP from \"Summary of Related Party Transactions\"\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\nâ€¢ **Awards and Recognition:** [All significant honors received]\nâ€¢ **CSR Initiatives:** [Complete details of social responsibility programs]\nâ€¢ **Certifications:** [All quality, environmental, other certifications]\nâ€¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\nâ€¢ **International Operations:** [Complete global presence details]\nâ€¢ **Future Outlook:** [Company's stated vision and targets]\nâ€¢ **Dividend Policy:** [Historical dividend payments and future policy]\nâ€¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DDRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -400,
          1888
        ],
        "id": "bad0980a-1a9a-4fcc-bfb3-8437d4a7a96a",
        "name": "DRHP Summary Generator Agent2",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## ðŸŽ¯ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [â—] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## ðŸ”§ RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## ðŸŽ¯ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (Iâ€“XII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [â—] from DRHP\n\n---\n\n## âš ï¸ CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows â‚¹ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" â†’ Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- âœ… State explicitly: \"Data not available in DRHP\"\n- âœ… Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- âŒ NEVER estimate or calculate missing data\n- âŒ NEVER copy data from similar companies\n- âŒ NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## ðŸ” VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience)\n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN ) these data dound and insert in table , if not in the table \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [â—] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Litigation counts verified for all categories\n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions table verified for all periods\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- âœ… ALL 12 sections present in correct order\n- âœ… EVERY data point traced to DRHP source\n- âœ… ALL tables verified cell-by-cell\n- âœ… NO fabricated, assumed, or estimated data\n- âœ… ALL financial figures exact from source\n- âœ… NO placeholders except official [â—] from DRHP\n- âœ… Consistent units throughout (as per DRHP)\n- âœ… Period labels match DRHP format exactly\n- âœ… SOP requirements fully met\n- âœ… Professional formatting maintained\n\n---\n\n## âœ… OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- âœ… **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- âœ… **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- âœ… **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- âœ… **SOP COMPLIANT** - all requirements from SOP document met\n- âœ… **NO FABRICATION** - all data sourced from DRHP chunks only\n- âœ… **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- âœ… **EXACT TRANSCRIPTION** - all numbers match source precisely\n- âœ… **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## ðŸ”’ OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n## ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## ðŸš¨ CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## ðŸ“Œ ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          16,
          1872
        ],
        "id": "ec32a78a-5f25-4d14-b2f5-69167a481382",
        "name": "DRHP Summary Preview Agent2",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=\nYou are an expert RHP (Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY RHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official RHP data retrieved from Pinecone vector search.\n\n---\n\n## ðŸŽ¯ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against RHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [â—] in the source RHP\n- **If data is not found in RHP chunks, explicitly state \"Data not available in RHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## ðŸ”§ RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the RHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft RHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial RHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone RHP chunks to populate missing sections\n\n---\n\n## ðŸŽ¯ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone RHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (Iâ€“XII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from RHP , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [â—] from RHP\n\n---\n\n## âš ï¸ CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in RHP chunks\n- **Maintain all decimal places** - if source shows â‚¹ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If RHP shows \"12,345.67 lakhs\" â†’ Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from RHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If RHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone RHP chunks:**\n- âœ… State explicitly: \"Data not available in RHP\"\n- âœ… Leave cell empty in tables with note: \"Not disclosed in RHP\"\n- âŒ NEVER estimate or calculate missing data\n- âŒ NEVER copy data from similar companies\n- âŒ NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific RHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against RHP source\n2. **Check row and column headers** match RHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if RHP provides totals, they must match exactly\n\n---\n\n## ðŸ” VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches RHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against RHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches RHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches RHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly\n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN ) these data dound and insert in table , if not in the table \n- [ ] Board composition verified\n- [ ] Management experience details match RHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match RHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match RHP format exactly\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [â—] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches RHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches RHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Litigation counts verified for all categories\n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions table verified for all periods\n- [ ] RPT values match RHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches RHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in RHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant RHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in RHP, state explicitly: \"Data not available in RHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- âœ… ALL 12 sections present in correct order\n- âœ… EVERY data point traced to RHP source\n- âœ… ALL tables verified cell-by-cell\n- âœ… NO fabricated, assumed, or estimated data\n- âœ… ALL financial figures exact from source\n- âœ… NO placeholders except official [â—] from RHP\n- âœ… Consistent units throughout (as per RHP)\n- âœ… Period labels match RHP format exactly\n- âœ… SOP requirements fully met\n- âœ… Professional formatting maintained\n\n---\n\n## âœ… OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- âœ… **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- âœ… **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- âœ… **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- âœ… **SOP COMPLIANT** - all requirements from SOP document met\n- âœ… **NO FABRICATION** - all data sourced from RHP chunks only\n- âœ… **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- âœ… **EXACT TRANSCRIPTION** - all numbers match source precisely\n- âœ… **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## ðŸ”’ OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n## ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## ðŸš¨ CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in RHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## ðŸ“Œ ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against RHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant RHP summary with zero fabrication and full verification of all data points against the Pinecone RHP vector store.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -2480,
          1856
        ],
        "id": "5327f56a-562c-4c9e-af52-3c2f31c7556a",
        "name": "RHP Summary Preview Agent1",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "SOP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -192,
          2016
        ],
        "id": "1efe1629-6214-4697-9ad3-d259e99a449e",
        "name": "Fund SOP Pinecone VectorDB2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook13').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -752,
          2144
        ],
        "id": "94641966-b23e-4d88-ac0a-bb2f41956d84",
        "name": "DRHP Pinecone VectorDB1",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          80,
          2144
        ],
        "id": "14bcdefe-debd-4dfd-894b-b89c576f258b",
        "name": "Summary Format Doc",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FklNSi7dT4QA9U7t",
            "name": "Google doc api(sonu)"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          -2480,
          2144
        ],
        "id": "1202babd-1db4-4e30-88b4-14ff7cf3212a",
        "name": "Summary Format Doc3",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FklNSi7dT4QA9U7t",
            "name": "Google doc api(sonu)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook13').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook13').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook13').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook13').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook13').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          672,
          1856
        ],
        "id": "74863210-ee9a-4fe5-b06c-fc30909e492d",
        "name": "Update Summary In MongoDB1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook13').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook13').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook13').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "4fe32682-a18f-42dc-9220-dc1792e8ce1e",
        "name": "Response Back To Pollong Webhook1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          832,
          1856
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -624,
          1712
        ],
        "id": "1f9c96b6-9249-4206-85ed-965c66c7c34f",
        "name": "OpenAI Chat Model35",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge bases.\n\n---\n\n## ðŸ—ï¸ **Primary Functions**\n\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\nâš ï¸ **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the DRHP.\n\n---\n\n## ðŸ” **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the DRHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output â€“ used internally for matching)*\n\n---\n\n## ðŸ“Š **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate â€œCapital Structureâ€ or â€œEquity Share Capital Historyâ€\n\n* Identify the exact DRHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the DRHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## ðŸ§© **Output Requirements**\n\nFor **every DRHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from DRHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the DRHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | DRHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | DRHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (â‚¹) | Issue Price (â‚¹) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (â‚¹) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\nâœ“ Row 2: February 28, 2011 - Issue Price â‚¹50.00 > Face Value â‚¹10\nâœ“ Row 5: September 17, 2025 - Issue Price â‚¹90.00 > Face Value â‚¹10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no â‚¹).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## ðŸ§± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[âœ“ List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## âš™ï¸ **Critical Rules Recap**\n\nâœ… Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\nâœ… Keep numeric values **exact** (no rounding, commas, or â‚¹).\nâœ… No missing rows or modified column names.\nâœ… No analysis, commentary, or suggestions.\nâœ… Output stops immediately after Section C Part 3.\nâœ… JSON syntax must be valid.\nâœ… Use âœ“ only for premium round indicators.\n\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -240,
          1504
        ],
        "id": "a47b5c46-2879-484d-af28-a4b1a5db90ab",
        "name": "Subquery generator6",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"âœ“ Row 3: Jan 2023 - Issue Price â‚¹90 > Face Value â‚¹10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          -128,
          1712
        ],
        "id": "eee3d6e4-0c44-4d43-a9af-1bd7823ea39d",
        "name": "Structured Output Parser3"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          -368,
          1712
        ],
        "id": "7ed75a7f-327f-453b-a7fd-1155a82cb1e6",
        "name": "Auto-fixing Output Parser3"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -480,
          1712
        ],
        "id": "37aee879-472c-4cc3-a416-a571e69fc552",
        "name": "OpenAI Chat Model36",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          272,
          1488
        ],
        "id": "f91e3b62-8428-49ee-a479-26befb9d1bdb",
        "name": "Code11"
      },
      {
        "parameters": {
          "jsCode": "// Input: split node output\nconst inputArray = $input.first().json.result;\n\n// If no data is present, return message HTML\nif (!inputArray || inputArray.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Merge array of key-value objects into a single object\nlet merged = {};\ninputArray.forEach(item => {\n  const key = Object.keys(item)[0];\n  merged[key] = item[key];\n});\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Generate HTML table\nlet html = `\n<table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n  <thead style=\"background-color: #f2f2f2;\">\n    <tr>\n      <th>Field</th>\n      <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr><td>Row</td><td>${merged.row_number || \"-\"}</td></tr>\n    <tr><td>Date of Allotment</td><td>${merged.date_of_allotment || \"-\"}</td></tr>\n    <tr><td>Nature of Allotment</td><td>${merged.nature_of_allotment || \"-\"}</td></tr>\n    <tr><td>Shares Allotted</td><td>${merged.shares_allotted || \"-\"}</td></tr>\n    <tr><td>Face Value (â‚¹)</td><td>${merged.face_value || \"-\"}</td></tr>\n    <tr><td>Issue Price (â‚¹)</td><td>${merged.issue_price || \"-\"}</td></tr>\n    <tr><td>Cumulative Equity Shares</td><td>${merged.cumulative_equity_shares || \"-\"}</td></tr>\n    <tr><td>Round Raised (â‚¹)</td><td>${formatNumber(merged.round_raised)}</td></tr>\n    <tr><td>Dilution</td><td>${formatNumber(merged.dilution)}</td></tr>\n    <tr><td>Dilution (%)</td><td>${formatNumber(merged.dilution_percent)}</td></tr>\n    <tr><td>Post Money Valuation (â‚¹)</td><td>${formatNumber(merged.post_money_valuation)}</td></tr>\n  </tbody>\n</table>\n`;\n\n// Return HTML\nreturn [\n  {\n    json: {\n      html_output1: html\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          448,
          1488
        ],
        "id": "6b5479f5-2787-4060-965e-b1a889ca98c3",
        "name": "Code12"
      },
      {
        "parameters": {
          "jsCode": "// Get the Markdown input from the node\nconst markdownInput =$input.first().json.output.results[0].content ;\n\n// Function to convert a Markdown table row to HTML <tr>\nfunction mdTableToHTML(md) {\n    const lines = md.split(\"\\n\");\n    let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n\n    let headerProcessed = false;\n    lines.forEach(line => {\n        if (!line.trim()) return; // skip empty lines\n        const cells = line.split(\"|\").map(c => c.trim()).filter(c => c !== \"\");\n        if (cells.length === 0) return;\n        if (!headerProcessed) {\n            html += \"  <thead>\\n    <tr>\\n\";\n            cells.forEach(cell => { html += `      <th>${cell}</th>\\n`; });\n            html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n            headerProcessed = true;\n        } else if (!/^-+$/.test(cells[0])) {\n            html += \"    <tr>\\n\";\n            cells.forEach(cell => { html += `      <td>${cell}</td>\\n`; });\n            html += \"    </tr>\\n\";\n        }\n    });\n    html += \"  </tbody>\\n</table>\\n\";\n    return html;\n}\n\n// Convert Markdown to HTML\nlet htmlOutput = markdownInput;\n\n// Convert tables in Markdown to HTML\nconst tableRegex = /\\|(.+\\|)+\\s*(\\n\\|[-| ]+\\|)+((\\n\\|.*)+)?/g;\nhtmlOutput = htmlOutput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers (SECTION A/B/C etc.)\nhtmlOutput = htmlOutput\n    .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\") // convert # headers to <h3>\n    .replace(/^â”+$/gm, \"<hr>\") // convert lines to <hr>\n    .replace(/\\n\\n/g, \"<br>\"); // convert double newlines to <br>\n\n// Wrap in HTML structure\nhtmlOutput = `\n\n<div>\n${htmlOutput}\n</div>\n`;\n\n// Return HTML\nreturn [\n    {\n        json: {\n            html_output0: htmlOutput\n        }\n    }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          352,
          1376
        ],
        "id": "1bef7407-093a-448c-89f8-17b135479a87",
        "name": "Code13"
      },
      {
        "parameters": {
          "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          928,
          1440
        ],
        "id": "bb1c25e2-afef-489b-bbd2-77f34b258f89",
        "name": "HTML10"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          608,
          1440
        ],
        "id": "cf4629f0-7fa3-4fba-a816-58b6bde9696a",
        "name": "Merge15",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          768,
          1440
        ],
        "id": "1157f41a-2a76-483e-87bb-cc17d9ce8410",
        "name": "Aggregate4"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook13').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          432,
          1856
        ],
        "id": "1e6da31e-4e2c-4424-94fe-adea1a402e48",
        "name": "mdn to html23",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:ðŸ’°\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:ðŸ¦\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"âœ… Investor data inserted after Section VI\");\n  } else {\n    console.log(\"âš ï¸ Section VI not found â€” appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook13').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          816,
          1648
        ],
        "id": "36f312fa-c00a-47e4-bd63-1b30485214a4",
        "name": "mdn to html24"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          656,
          1648
        ],
        "id": "4c596809-0c1a-455c-ada4-866678118b0d",
        "name": "Merge16"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          32,
          1712
        ],
        "id": "2528e72e-4ad9-4b02-9885-2c572307866b",
        "name": "Embeddings OpenAI48",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          384,
          1712
        ],
        "id": "ecb6104f-1bf0-4841-9cdb-8752d043070e",
        "name": "Reranker Cohere28",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook13').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          144,
          1712
        ],
        "id": "47d0533c-1eb5-409d-a2d8-ab2de2e5f144",
        "name": "DRHP Pinecone VectorDB7",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          208,
          2144
        ],
        "id": "99f29414-6b92-4696-b423-f4ceb8117635",
        "name": "Embeddings OpenAI49",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          560,
          2144
        ],
        "id": "ff5e9941-698e-493d-a6fa-07cef900e9db",
        "name": "Reranker Cohere29",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook13').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          304,
          2144
        ],
        "id": "d23ee65f-7f38-4aaa-8449-a718ec01f386",
        "name": "DRHP Pinecone VectorDB8",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3088,
          1696
        ],
        "id": "2ce1307c-273b-4949-8b91-57de430f30ea",
        "name": "OpenAI Chat Model37",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and capital history data from RHP ( Red Herring Prospectus) knowledge bases.\n\n---\n\n## ðŸ—ï¸ **Primary Functions**\n\n1. Extract comprehensive investor lists from RHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\nâš ï¸ **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the RHP.\n\n---\n\n## ðŸ” **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the RHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output â€“ used internally for matching)*\n\n---\n\n## ðŸ“Š **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate â€œCapital Structureâ€ or â€œEquity Share Capital Historyâ€\n\n* Identify the exact RHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the RHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## ðŸ§© **Output Requirements**\n\nFor **every RHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from RHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the RHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | RHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | RHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from RHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (â‚¹) | Issue Price (â‚¹) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (â‚¹) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\nâœ“ Row 2: February 28, 2011 - Issue Price â‚¹50.00 > Face Value â‚¹10\nâœ“ Row 5: September 17, 2025 - Issue Price â‚¹90.00 > Face Value â‚¹10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no â‚¹).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## ðŸ§± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"RHP Investor & Capital Data Extraction Report\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION A: Complete Investor List from RHP\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[âœ“ List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## âš™ï¸ **Critical Rules Recap**\n\nâœ… Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\nâœ… Keep numeric values **exact** (no rounding, commas, or â‚¹).\nâœ… No missing rows or modified column names.\nâœ… No analysis, commentary, or suggestions.\nâœ… Output stops immediately after Section C Part 3.\nâœ… JSON syntax must be valid.\nâœ… Use âœ“ only for premium round indicators.\n\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -2688,
          1520
        ],
        "id": "d297075e-fcb8-4a15-a781-edb027288e53",
        "name": "Subquery generator7",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"âœ“ Row 3: Jan 2023 - Issue Price â‚¹90 > Face Value â‚¹10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          -2608,
          1696
        ],
        "id": "0e78c0df-be86-4a51-a9c6-6fd08a449d12",
        "name": "Structured Output Parser4"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          -2848,
          1696
        ],
        "id": "251f2be3-f2b7-4d2e-8038-4a1bb3ca8b8b",
        "name": "Auto-fixing Output Parser4"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2960,
          1696
        ],
        "id": "0b101a0f-1d92-4965-9b2d-3d3e071bae2d",
        "name": "OpenAI Chat Model38",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2288,
          1504
        ],
        "id": "23221839-e73f-4fef-9760-855e586cbc78",
        "name": "Code14"
      },
      {
        "parameters": {
          "jsCode": "// Input: split node output\nconst inputArray = $input.first().json.result;\n\n// If no data is present, return message HTML\nif (!inputArray || inputArray.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Merge array of key-value objects into a single object\nlet merged = {};\ninputArray.forEach(item => {\n  const key = Object.keys(item)[0];\n  merged[key] = item[key];\n});\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Generate HTML table\nlet html = `\n<table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n  <thead style=\"background-color: #f2f2f2;\">\n    <tr>\n      <th>Field</th>\n      <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr><td>Row</td><td>${merged.row_number || \"-\"}</td></tr>\n    <tr><td>Date of Allotment</td><td>${merged.date_of_allotment || \"-\"}</td></tr>\n    <tr><td>Nature of Allotment</td><td>${merged.nature_of_allotment || \"-\"}</td></tr>\n    <tr><td>Shares Allotted</td><td>${merged.shares_allotted || \"-\"}</td></tr>\n    <tr><td>Face Value (â‚¹)</td><td>${merged.face_value || \"-\"}</td></tr>\n    <tr><td>Issue Price (â‚¹)</td><td>${merged.issue_price || \"-\"}</td></tr>\n    <tr><td>Cumulative Equity Shares</td><td>${merged.cumulative_equity_shares || \"-\"}</td></tr>\n    <tr><td>Round Raised (â‚¹)</td><td>${formatNumber(merged.round_raised)}</td></tr>\n    <tr><td>Dilution</td><td>${formatNumber(merged.dilution)}</td></tr>\n    <tr><td>Dilution (%)</td><td>${formatNumber(merged.dilution_percent)}</td></tr>\n    <tr><td>Post Money Valuation (â‚¹)</td><td>${formatNumber(merged.post_money_valuation)}</td></tr>\n  </tbody>\n</table>\n`;\n\n// Return HTML\nreturn [\n  {\n    json: {\n      html_output1: html\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2128,
          1504
        ],
        "id": "7d3ab582-2369-4517-89d8-2b0f2b86ab4f",
        "name": "Code15"
      },
      {
        "parameters": {
          "jsCode": "// Get the Markdown input from the node\nconst markdownInput =$input.first().json.output.results[0].content ;\n\n// Function to convert a Markdown table row to HTML <tr>\nfunction mdTableToHTML(md) {\n    const lines = md.split(\"\\n\");\n    let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n\n    let headerProcessed = false;\n    lines.forEach(line => {\n        if (!line.trim()) return; // skip empty lines\n        const cells = line.split(\"|\").map(c => c.trim()).filter(c => c !== \"\");\n        if (cells.length === 0) return;\n        if (!headerProcessed) {\n            html += \"  <thead>\\n    <tr>\\n\";\n            cells.forEach(cell => { html += `      <th>${cell}</th>\\n`; });\n            html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n            headerProcessed = true;\n        } else if (!/^-+$/.test(cells[0])) {\n            html += \"    <tr>\\n\";\n            cells.forEach(cell => { html += `      <td>${cell}</td>\\n`; });\n            html += \"    </tr>\\n\";\n        }\n    });\n    html += \"  </tbody>\\n</table>\\n\";\n    return html;\n}\n\n// Convert Markdown to HTML\nlet htmlOutput = markdownInput;\n\n// Convert tables in Markdown to HTML\nconst tableRegex = /\\|(.+\\|)+\\s*(\\n\\|[-| ]+\\|)+((\\n\\|.*)+)?/g;\nhtmlOutput = htmlOutput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers (SECTION A/B/C etc.)\nhtmlOutput = htmlOutput\n    .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\") // convert # headers to <h3>\n    .replace(/^â”+$/gm, \"<hr>\") // convert lines to <hr>\n    .replace(/\\n\\n/g, \"<br>\"); // convert double newlines to <br>\n\n// Wrap in HTML structure\nhtmlOutput = `\n\n<div>\n${htmlOutput}\n</div>\n`;\n\n// Return HTML\nreturn [\n    {\n        json: {\n            html_output0: htmlOutput\n        }\n    }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2208,
          1376
        ],
        "id": "82810fc7-1d90-40dc-bb13-30bf5450b704",
        "name": "Code16"
      },
      {
        "parameters": {
          "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          -1632,
          1424
        ],
        "id": "ba91ff85-bb42-41d2-9daa-6685d28c0972",
        "name": "HTML11"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -1952,
          1424
        ],
        "id": "74bcee9a-2586-42d5-af91-03e09058e140",
        "name": "Merge17",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          -1792,
          1424
        ],
        "id": "07b2a9b8-30bf-4c7f-9d3d-b9c5ecb344c6",
        "name": "Aggregate5"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook14').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2128,
          1856
        ],
        "id": "9901712b-1e42-47c1-bda0-bff4d846e2cf",
        "name": "mdn to html25",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:ðŸ’°\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:ðŸ¦\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"âœ… Investor data inserted after Section VI\");\n  } else {\n    console.log(\"âš ï¸ Section VI not found â€” appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook14').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -1744,
          1632
        ],
        "id": "973eace8-58f4-435e-b0f0-b1dd783bdb3d",
        "name": "mdn to html26"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -1904,
          1632
        ],
        "id": "a02a52c4-0611-4378-a289-c32bc7f65192",
        "name": "Merge18"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2480,
          1696
        ],
        "id": "3cf46300-d322-480d-a5d7-41208caf28ca",
        "name": "Embeddings OpenAI50",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -2128,
          1696
        ],
        "id": "ad9d1df8-0303-4aa5-90e6-9bf6596ff303",
        "name": "Reranker Cohere30",
        "credentials": {
          "cohereApi": {
            "id": "k6JgqgLn1jxbZHmF",
            "name": "CohereApi account(devExcollo)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook14').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook14').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook14').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook14').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook14').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -1856,
          1856
        ],
        "id": "1e1285cb-377d-4170-8cab-d89fda1a6b20",
        "name": "Update in MongoDB1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook14').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook14').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook14').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "30010afa-9b62-4b0a-9e5b-73a78373c677",
        "name": "Response Back to Polling Webhook1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          -1680,
          1856
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook14').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2384,
          1696
        ],
        "id": "4ec862c7-3031-454e-bd1a-521416aa9a07",
        "name": "RHP Pinecone VectorDB",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook14').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -2256,
          2144
        ],
        "id": "84c44858-f70e-4658-8a3b-d6f86b2c8bfb",
        "name": "RHP Pinecone VectorDB2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          3280,
          1520
        ],
        "id": "787b8c25-5158-4c7a-bffd-a1b9a7cc2f12",
        "name": "Edit Fields2",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, Summary of related party transactions tables, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3328,
          -1232
        ],
        "id": "397832b6-32a5-4eca-8acc-a6cd14fb685e",
        "name": "Edit Fields13",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://rhpdocuments-w5m6qxe.svc.aped-4627-b74a.pinecone.io/vectors/delete",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Api-Key",
                "value": "pcsk_3w2DRP_RvXZ2gG3FdMKUPmeACmbQvcDwb1Lm4UvfFrcMe8pj2VbKntibu6zzVecrGDGPFW"
              },
              {
                "name": "Accept",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"filter\": {\n    \"documentName\": { \"$eq\": \"{{ $json.documentName }}\" }\n  },\n  \"deleteAll\": false\n}",
          "options": {}
        },
        "name": "List All Vector IDs - Page 1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3664,
          -176
        ],
        "id": "4fbc9270-e9f1-4104-8193-52f193cc1c1a",
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "content": "# Delete Vectors by Document Name (Metadata Filter)\n\n**Flow:**\n1. List all vector IDs (with pagination)\n2. Fetch vectors in batches to get metadata\n3. Filter by documentName metadata\n4. Delete matching vectors\n\n**Configure:** Set documentName in first node",
          "height": 320,
          "width": 768,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4272,
          -304
        ],
        "typeVersion": 1,
        "id": "85b8f74e-76d8-4e71-a88e-7fcb5d37c064",
        "name": "Workflow Info"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "/delete/pincone-vectors",
          "options": {
            "allowedOrigins": "*"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -4064,
          -176
        ],
        "id": "14db87c1-299f-4d5f-aa6c-3936a4e47a8e",
        "name": "Webhook8",
        "webhookId": "b81beb61-1cf4-40a5-a586-d37643ddd9bf"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          3744,
          1760
        ],
        "id": "de2caa6f-9a0e-4bb4-a352-842d596a961e",
        "name": "Embeddings OpenAI51",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "SOP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          3840,
          1760
        ],
        "id": "5b709fde-b303-4a8d-8c6a-8b3ec8e01288",
        "name": "Fund SOP Pinecone Vector DB3",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/chats/chat-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook15').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "fa5b23f0-26f5-42a0-bb0c-ca70255b8d79",
        "name": "Send Error to Backend8",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2592,
          -1168
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1744,
          -960
        ],
        "id": "dd41713b-53a6-45fc-8aaa-5c855c0bcfd7",
        "name": "Embeddings OpenAI16",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseHeaders": {
              "entries": [
                {
                  "name": "Access-Control-Allow-Origin",
                  "value": "*"
                }
              ]
            }
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          2592,
          -1312
        ],
        "id": "aa311445-fabe-42d9-b397-6c9ea9b369df",
        "name": "Respond to Webhook13"
      },
      {
        "parameters": {
          "content": "# Use for chat flow",
          "height": 644,
          "width": 1432
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1392,
          -1472
        ],
        "id": "00adf3e9-c500-4d59-9377-cce992b61ba8",
        "name": "Sticky Note24"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "ddb614d4-4f1d-453c-ae52-9a916bb8b708",
                "name": "status",
                "value": "completed",
                "type": "string"
              },
              {
                "id": "36aa2c3e-9f66-48b0-a299-a22685183842",
                "name": "output",
                "value": "={{ $json.output }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2400,
          -1456
        ],
        "id": "157f2e64-d372-45a0-9ce9-7cfa0051537d",
        "name": "Edit Fields14"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2416,
          -992
        ],
        "id": "b7f7e4f1-93e7-4d23-a79d-df6b0c876d7e",
        "name": "Edit Fields17"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "1/chat/docs",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          1472,
          -1280
        ],
        "id": "b788fe44-635e-4926-94ea-b04f02711feb",
        "name": "Webhook15",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2208,
          -960
        ],
        "id": "a6a7c0e3-59e3-4819-b563-17dd8c18e623",
        "name": "Reranker Cohere5",
        "credentials": {
          "cohereApi": {
            "id": "604WWVX2sUlVBMR0",
            "name": "CohereApi account (s 7891)"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1840,
          -1280
        ],
        "id": "bba0256f-8c79-469a-b5a8-94dc69925a62",
        "name": "OpenAI Chat Model14",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1952,
          -1280
        ],
        "id": "7b8f4119-f01d-40c6-86ec-c5f612a92a15",
        "name": "Embeddings OpenAI22",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2304,
          -1280
        ],
        "id": "f1a30b3b-39fb-44b1-91e8-5d866d56429a",
        "name": "Reranker Cohere6",
        "credentials": {
          "cohereApi": {
            "id": "604WWVX2sUlVBMR0",
            "name": "CohereApi account (s 7891)"
          }
        }
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.query.document_type }}",
                      "rightValue": "DRHP",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "12cbd881-9505-4aba-a40e-9bcf25cec018"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "ef031276-a451-4791-8e52-83611f470513",
                      "leftValue": "={{ $json.query.document_type }}",
                      "rightValue": "RHP",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.3,
        "position": [
          1648,
          -1280
        ],
        "id": "c6235d71-0aaf-46fb-b807-d09e164be755",
        "name": "Switch"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.query.message }}",
          "options": {
            "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\nâ€“ Formal, structured, detail-oriented, and direct.\nâ€“ Cite the source you consulted at the start of your answer.\nâ€“ Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\nâ€“ Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from â‚¹150 crores in FY2021 to â‚¹280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1904,
          -1120
        ],
        "id": "54c6fa48-b7bf-4656-ba32-ddc47d2359fe",
        "name": "RHP Chat Agent",
        "retryOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.query.message }}",
          "options": {
            "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\nâ€“ Formal, structured, detail-oriented, and direct.\nâ€“ Cite the source you consulted at the start of your answer.\nâ€“ Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\nâ€“ Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from â‚¹150 crores in FY2021 to â‚¹280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1904,
          -1440
        ],
        "id": "92078b84-2f2f-4750-8950-fc368dcc0542",
        "name": "DRHP Chat Agent2",
        "retryOnFail": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          2048,
          -1280
        ],
        "id": "c74c6f5a-53ef-4c51-bd6d-d28b7f3cc04a",
        "name": "DRHP Pinecone Vector Store2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 10,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          1920,
          -960
        ],
        "id": "28f21adf-a0c6-451e-974b-8b36e116fda4",
        "name": "RHP Pinecone Vector Store2",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1568,
          -960
        ],
        "id": "183f3dce-8575-458b-84ea-efee7def217d",
        "name": "OpenAI Chat  Model9",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/chats/chat-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook16').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "fc5505a7-c2e6-401b-baa3-828c76b81508",
        "name": "Send Error to Backend18",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          2576,
          1952
        ],
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1728,
          2160
        ],
        "id": "71f24185-74f6-4e14-a2f0-aac1e8fb72ae",
        "name": "Embeddings OpenAI25",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseHeaders": {
              "entries": [
                {
                  "name": "Access-Control-Allow-Origin",
                  "value": "*"
                }
              ]
            }
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          2576,
          1808
        ],
        "id": "0e7fed0b-2cf5-41a2-bc30-9924e857feb9",
        "name": "Respond to Webhook14",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Use for chat flow",
          "height": 644,
          "width": 1432
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1376,
          1648
        ],
        "id": "8eca1861-a134-480c-b2b5-80fff6aec4dd",
        "name": "Sticky Note36",
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "ddb614d4-4f1d-453c-ae52-9a916bb8b708",
                "name": "status",
                "value": "completed",
                "type": "string"
              },
              {
                "id": "36aa2c3e-9f66-48b0-a299-a22685183842",
                "name": "output",
                "value": "={{ $json.output }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2384,
          1664
        ],
        "id": "4b74a941-d3a1-4da6-8f22-9e4cda090d0a",
        "name": "Edit Fields20",
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2400,
          2128
        ],
        "id": "a8468971-e187-49e7-89a2-c2c8774816b1",
        "name": "Edit Fields27",
        "disabled": true
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "1/new/chat/docs",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          1456,
          1840
        ],
        "id": "b7992f4a-2dba-447b-9b02-0c5460981056",
        "name": "Webhook16",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8",
        "disabled": true
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2192,
          2160
        ],
        "id": "ec294e83-8e09-4f39-bb1b-2bf838cde1c6",
        "name": "Reranker Cohere10",
        "credentials": {
          "cohereApi": {
            "id": "uPFpRpnI3U261h1t",
            "name": "sv92-drhp"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1824,
          1840
        ],
        "id": "a57313e1-c7c9-4482-a6a8-f2ca8b98d266",
        "name": "OpenAI Chat Model16",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          1936,
          1840
        ],
        "id": "1f822527-5a35-4aef-be2c-2a6ed81ab345",
        "name": "Embeddings OpenAI52",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "topN": 10
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          2288,
          1840
        ],
        "id": "247c33c1-d60a-482f-8224-43705e901ca4",
        "name": "Reranker Cohere31",
        "credentials": {
          "cohereApi": {
            "id": "uPFpRpnI3U261h1t",
            "name": "sv92-drhp"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.query.document_type }}",
                      "rightValue": "DRHP",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "12cbd881-9505-4aba-a40e-9bcf25cec018"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "ef031276-a451-4791-8e52-83611f470513",
                      "leftValue": "={{ $json.query.document_type }}",
                      "rightValue": "RHP",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.3,
        "position": [
          1632,
          1840
        ],
        "id": "63fdca20-daa0-499e-a68d-2b95c90e1c18",
        "name": "Switch1",
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.query.message }}",
          "options": {
            "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\nâ€“ Formal, structured, detail-oriented, and direct.\nâ€“ Cite the source you consulted at the start of your answer.\nâ€“ Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\nâ€“ Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from â‚¹150 crores in FY2021 to â‚¹280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1888,
          2000
        ],
        "id": "e582db0b-4395-4da5-9319-c676f4e55d54",
        "name": "RHP Chat Agent1",
        "retryOnFail": true,
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.query.message }}",
          "options": {
            "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\nâ€“ Formal, structured, detail-oriented, and direct.\nâ€“ Cite the source you consulted at the start of your answer.\nâ€“ Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\nâ€“ Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from â‚¹150 crores in FY2021 to â‚¹280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          1888,
          1680
        ],
        "id": "05bc5a91-5c9f-422e-b526-13dbc6aa5622",
        "name": "DRHP Chat Agent3",
        "retryOnFail": true,
        "disabled": true,
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          2032,
          1840
        ],
        "id": "f0d58779-2a81-4336-9acc-d3d8a86ae99d",
        "name": "DRHP Pinecone Vector Store3",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "rhpdocuments",
            "mode": "list",
            "cachedResultName": "rhpdocuments"
          },
          "topK": 10,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          1904,
          2160
        ],
        "id": "ea76df31-f8d2-4d77-b482-c8d251b3f1de",
        "name": "RHP Pinecone Vector Store3",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          1552,
          2160
        ],
        "id": "753b69e1-1df9-4668-a217-2fcd6e5c2cf9",
        "name": "OpenAI Chat  Model",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "292eea1f-444f-4a84-9e3c-901f8256e7a5",
                "name": "documentName",
                "value": "DRHPInspros.pdf.pdf",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3856,
          -176
        ],
        "id": "5717064e-d965-4234-bc17-dea72d677e00",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -656,
          1904
        ],
        "id": "d2cd3849-38e5-44e2-bc95-66f74180138a",
        "name": "Edit Fields5",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -3184,
          1888
        ],
        "id": "f6b6bf2a-0aef-4fb5-87ea-b7dfdedb03ea",
        "name": "Edit Fields6",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node outputs\n\n\n\n// Try multiple possible field names for the HTML content\nconst investorHtml = $input.first().json.html;\nconst researchHtml =  $input.first().json.research_html;\nconst fullSummaryHtml = $input.first().json.html_summary;\n\n\n// --- Function: Insert HTML Content Before Specific Section ---\nfunction insertHtmlBeforeSection(fullHtml, insertHtml, sectionHeader, sectionLabel) {\n  // Check if fullHtml is valid\n  if (!fullHtml || typeof fullHtml !== 'string') {\n    console.log(`âš ï¸ Invalid HTML content - cannot insert ${sectionLabel}`);\n    return fullHtml || '';\n  }\n  \n  // Check if there's content to insert\n  if (!insertHtml || typeof insertHtml !== 'string' || insertHtml.trim().length === 0) {\n    console.log(`âš ï¸ No content to insert for ${sectionLabel}`);\n    return fullHtml;\n  }\n  \n  // Create pattern to find the section header\n  const sectionPattern = new RegExp(\n    `(<h2[^>]*>[^<]*${sectionHeader}[^<]*<\\\\/h2>)`,\n    'i'\n  );\n  \n  let modifiedHtml = fullHtml;\n  const sectionMatch = modifiedHtml.match(sectionPattern);\n  \n  if (sectionMatch) {\n    const insertionPoint = sectionMatch.index;\n    \n    const insertionHtml = `\n      <!-- Inserted ${sectionLabel} -->\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n      <hr><br>\n    `;\n    \n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      insertionHtml +\n      modifiedHtml.slice(insertionPoint);\n    \n    console.log(`âœ… ${sectionLabel} inserted before ${sectionHeader}`);\n  } else {\n    console.log(`âš ï¸ ${sectionHeader} not found â€” appending ${sectionLabel} at the end`);\n    const insertionHtml = `\n      <hr><br>\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n    `;\n    modifiedHtml += insertionHtml;\n  }\n  \n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n        hr {\n          border: none;\n          border-top: 1px solid #e5e7eb;\n          margin: 20px 0;\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\n\n// Check if we have the base HTML summary\nif (!fullSummaryHtml || fullSummaryHtml.trim().length === 0) {\n  console.log('âš ï¸ No html_summary found - returning available data or error');\n  \n  // Try to return whatever HTML we have\n  let availableHtml = '';\n  if (investorHtml) availableHtml += investorHtml;\n  if (researchHtml) availableHtml += researchHtml;\n  \n  if (availableHtml) {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml(availableHtml),\n        fileName: $input.first().json.fileName,\n        warning: 'No html_summary found, returning available HTML only'\n      }\n    }];\n  } else {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml('<p>No HTML data available. Please check merge node configuration.</p>'),\n        fileName: $input.first().json.fileName || 'report.html',\n        error: 'No html_summary, html, or research_html found',\n        available_fields: Object.keys($input.first().json)\n      }\n    }];\n  }\n}\n\nlet modifiedHtml = fullSummaryHtml;\n\n// Step 1: Insert investor data (html) before SECTION VII\nif (investorHtml && investorHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    investorHtml, \n    'SECTION VII',\n    'Matched Investors & Analysis'\n  );\n} else {\n  console.log('â„¹ï¸ No investor HTML to insert');\n}\n\n// Step 2: Insert research data (research_html) before SECTION XII\nif (researchHtml && researchHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    researchHtml, \n    'SECTION XII',\n    'Adverse Findings & Research'\n  );\n} else {\n  console.log('â„¹ï¸ No research HTML to insert');\n}\n\n// Step 3: Generate final HTML with wrapper\nconst finalHtml = generateEnhancedHtml(modifiedHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: $input.first().json.fileName || 'report.html'\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          912,
          -1472
        ],
        "id": "af8f23f1-1472-40a0-9691-eaea81f6fff8",
        "name": "mdn to html27"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineByPosition",
          "numberInputs": 3,
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          736,
          -1488
        ],
        "id": "5bed7336-6f7f-4211-9547-cca228f05faf",
        "name": "Merge20",
        "alwaysOutputData": false
      },
      {
        "parameters": {
          "content": "# Get the text from webhook and Generate the summary flow DRHP",
          "height": 928,
          "width": 2196,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -1088,
          -1760
        ],
        "id": "9f058bf5-fd3b-467e-8590-ad9f029e2a3d",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          0,
          -992
        ],
        "id": "a8ae8607-5f8b-4e42-b8d8-6e66ad23c73f",
        "name": "OpenAI Chat Model29",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -992,
          -992
        ],
        "id": "d6d7d647-8670-4dff-8d66-5d25a5aed209",
        "name": "OpenAI Chat Model39",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -880,
          -992
        ],
        "id": "f2b003c8-0769-4137-918e-763452fd8145",
        "name": "Embeddings OpenAI53",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -496,
          -992
        ],
        "id": "beaea7ec-e510-44ae-b691-44b60e2f22bf",
        "name": "Reranker Cohere",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "GET"
          ],
          "path": "/3/summary",
          "responseMode": "responseNode",
          "options": {
            "allowedOrigins": "*"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -1040,
          -1232
        ],
        "id": "1bfec86d-e868-4a26-be92-fdf5e05ada6a",
        "name": "Webhook17",
        "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
      },
      {
        "parameters": {
          "values": {
            "string": [
              {
                "name": "message",
                "value": "Execution started"
              },
              {
                "name": "executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "processing"
              },
              {
                "name": "documentId",
                "value": "={{ $json.query.documentId }}"
              }
            ]
          },
          "options": {}
        },
        "id": "d4381cd5-e765-426f-b8d3-1064c034e37d",
        "name": "Set Execution Info10",
        "type": "n8n-nodes-base.set",
        "typeVersion": 2,
        "position": [
          -864,
          -1632
        ]
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {
            "responseCode": 200
          }
        },
        "id": "1f58d0d0-bdff-4573-a519-5a1f924edd3f",
        "name": "Respond with Execution ID10",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.2,
        "position": [
          -672,
          -1632
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook17').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $json.jobId }}"
              },
              {
                "name": "namespace",
                "value": "={{ $json.namespace }}"
              },
              {
                "name": "error.message",
                "value": "={{ $json.error.message }}"
              },
              {
                "name": "error.stack",
                "value": "={{ $json.error.stack }}"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $json.error.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "={{ $json.execution.workflowId }}"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $json.execution.executionId }}"
              },
              {
                "name": "status",
                "value": "={{ $json.status }}"
              }
            ]
          },
          "options": {}
        },
        "id": "cae15b6f-27a8-4b58-a35d-00f204016a08",
        "name": "Send Error to Backend19",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          928,
          -1008
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
                "name": "jobId",
                "value": "={{ $execution.id }}",
                "type": "string"
              },
              {
                "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
                "name": "status",
                "value": "failed ",
                "type": "string"
              },
              {
                "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
                "name": "namespace",
                "value": "={{ $json.query.namespace }}",
                "type": "string"
              },
              {
                "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
                "name": "error.message",
                "value": "={{ $json.error }}",
                "type": "string"
              },
              {
                "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
                "name": "error.stack",
                "value": "NodeApiError",
                "type": "string"
              },
              {
                "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
                "name": "error.timestamp",
                "value": "={{ $json.query.timestamp }}",
                "type": "string"
              },
              {
                "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV",
                "type": "string"
              },
              {
                "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
                "name": "execution.executionId",
                "value": "={{ $execution.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          736,
          -1008
        ],
        "id": "292930c8-a3b7-40be-81aa-5774fc356f15",
        "name": "Edit Fields28"
      },
      {
        "parameters": {
          "content": "# Immediate responce sent to the UI",
          "height": 224,
          "width": 576
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1040,
          -1712
        ],
        "typeVersion": 1,
        "id": "028708d0-5676-4caf-b203-ff73fd55e9c7",
        "name": "Sticky Note37"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
          "options": {
            "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRxHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- âœ… Use ONLY information found in retrieved DRHP chunks\n- âŒ NEVER fabricate, assume, or extrapolate missing data\n- âŒ NEVER use placeholder text like \"strong growth\" without specific numbers\n- âœ… If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (â‚¹ lakhs, â‚¹ million, â‚¹ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses â€œSep-24â€, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows â‚¹ 8,894.54, table must show 8,894.54 (or â‚¹ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\nâ€¢ **Company Name:** [Full Legal Name]\nâ€¢ **Corporate Identity Number (CIN):** [CIN if available]\nâ€¢ **Registered Office Address:** [Complete address]\nâ€¢ **Corporate Office Address:** [If different from registered office]\nâ€¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\nâ€¢ **Company Website:** [Official URL]\nâ€¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\nâ€¢ **Registrar to the Issue:** [Name and complete contact information]\nâ€¢ **Date of Incorporation:** [When the company was established]\nâ€¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\nâ€¢ **ISIN:** [International Securities Identification Number if available, if marked as [â—]]\n    â€¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\nâ€¢ **Peer-Reviewed Auditor:** [If applicable]\nâ€¢ **Issue Opening Date:** [Scheduled date or mention if marked as [â—]]\nâ€¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\nâ€¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\nâ€¢ **Market Maker Information:** [If applicable]\nâ€¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [â—],not mention DDRHP date  strictly check ]\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\nâ€¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\nâ€¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (â‚¹ million) | Domestic (%) | Export Revenue (â‚¹ million) | Export (%) | Total Revenue (â‚¹ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\nâ€¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\nâ€¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\nâ€¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\nâ€¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (â‚¹ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\nâ€¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (â‚¹ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\nâ€¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\nâ€¢ **Competitive Advantages:** [All unique selling propositions mentioned]\nâ€¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\nâ€¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\nâ€¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\nâ€¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\nâ€¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\nâ€¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\nâ€¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\nâ€¢ **Projected Growth Rate:** [CAGR and future projections with sources]\nâ€¢ **Market Share:** [Company's position in the market with specific figures]\n\nâ€¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\nâ€¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in DRHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (â‚¹) | Revenue from Operations (â‚¹ in Lakhs) | Basic EPS (â‚¹) | Diluted EPS (â‚¹) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (â‚¹) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\nâ€¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\nâ€¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\nâ€¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (â‚¹ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\nâ€¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\nâ€¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\nâ€¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\nâ€¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\nâ€¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\nâ€¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\nâ€¢ **Director Directorships:** [Other board positions held by each director]\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\nâ€¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\nâ€¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\nâ€¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\nâ€¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (â‚¹) | Total Amount (â‚¹ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\nâ€¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\nâ€¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\nâ€¢ **Outstanding Convertible Instruments:** [Complete list if any]\nâ€¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\nâ€¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (â‚¹) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\nâ€¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\nâ€¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\nâ€¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (â‚¹ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (â‚¹ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\nâ€¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\nâ€¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\nâ€¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\nâ€¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in DRHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (â‚¹ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# ðŸŽ¯ SECTION VIII: IPO DETAILS\n\nâ€¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\nâ€¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [â—]]\nâ€¢ **Lot Size:** [Minimum bid quantity]\nâ€¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\nâ€¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (â‚¹ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\nâ€¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\nâ€¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\nâ€¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (â‚¹) | Expected Proceeds (â‚¹ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\nâ€¢ **Statutory Approvals:** [Complete list of key licenses and permits]\nâ€¢ **Pending Regulatory Clearances:** [Complete list if any]\n\nâ€¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in DRHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n\n| **Name** | **Criminal Proceedings** | **Tax Proceedings** | **Statutory or Regulatory Proceedings** | **Disciplinary Actions by SEBI or Stock Exchanges against our Promoters** | **Material Civil Litigations** | **Aggregate Amount Involved (â‚¹ in Lakhs)** |\n|-----------|---------------------------|---------------------|----------------------------------------|----------------------------------------------------------------------------|--------------------------------|---------------------------------------------|\n| **Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Senior Management Personnel and Key Managerial Personnel (SMPs & KMPs)** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Litigation involving Group Companies which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Outstanding Litigation which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n\n\nâ€¢ **Material Developments:** [All developments since last audited period]\nâ€¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\nâ€¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\nâ€¢ **Joint Ventures:** [Complete details with ownership and business focus]\nâ€¢ **Associate Companies:** [Names and relationships]\nâ€¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n### Summary of Related Party Transactions (Complete Analysis)**\n\n**Note:**  \nExtract all tables mentioned in the DRHP under **â€œSummary of Related Party Transactionsâ€** or **â€œRelated Party Transactionsâ€** for **all financial years** (e.g., *2022â€“23, 2023â€“24, 2024â€“25*).\n---\nâ€¢ ** Summary of Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (â‚¹ Lacs) | FY 2024 (â‚¹ Lacs) | FY 2023 (â‚¹ Lacs) | FY 2022 (â‚¹ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\nâ€¢ **Awards and Recognition:** [All significant honors received]\nâ€¢ **CSR Initiatives:** [Complete details of social responsibility programs]\nâ€¢ **Certifications:** [All quality, environmental, other certifications]\nâ€¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\nâ€¢ **International Operations:** [Complete global presence details]\nâ€¢ **Future Outlook:** [Company's stated vision and targets]\nâ€¢ **Dividend Policy:** [Historical dividend payments and future policy]\nâ€¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state â€œInformation not availableâ€.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; donâ€™t miss existing info.\nMandatory Sections\nFill every section with available data. Use â€œInformation not found in provided DDRHP chunks. Please check complete documentâ€ only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with â€œAbout the Companyâ€ data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -576,
          -1248
        ],
        "id": "28bcc831-2053-4b3c-af7b-68b1c4845a66",
        "name": "DRHP Summary Generator Agent3",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "promptType": "=define",
          "text": "={{ $json.output }}",
          "options": {
            "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## ðŸŽ¯ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [â—] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## ðŸ”§ RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## ðŸŽ¯ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (Iâ€“XII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [â—] from DRHP\n\n---\n\n## âš ï¸ CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows â‚¹ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" â†’ Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- âœ… State explicitly: \"Data not available in DRHP\"\n- âœ… Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- âŒ NEVER estimate or calculate missing data\n- âŒ NEVER copy data from similar companies\n- âŒ NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## ðŸ” VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [â—] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the DRHP under **â€œSummary of Related Party Transactionsâ€** or **â€œRelated Party Transactionsâ€** for **all financial years** (e.g., *2022â€“23, 2023â€“24, 2024â€“25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- âœ… ALL 12 sections present in correct order\n- âœ… EVERY data point traced to DRHP source\n- âœ… ALL tables verified cell-by-cell\n- âœ… NO fabricated, assumed, or estimated data\n- âœ… ALL financial figures exact from source\n- âœ… NO placeholders except official [â—] from DRHP\n- âœ… Consistent units throughout (as per DRHP)\n- âœ… Period labels match DRHP format exactly\n- âœ… SOP requirements fully met\n- âœ… Professional formatting maintained\n\n---\n\n## âœ… OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- âœ… **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- âœ… **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- âœ… **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- âœ… **SOP COMPLIANT** - all requirements from SOP document met\n- âœ… **NO FABRICATION** - all data sourced from DRHP chunks only\n- âœ… **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- âœ… **EXACT TRANSCRIPTION** - all numbers match source precisely\n- âœ… **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## ðŸ”’ OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## ðŸ“‹ SECTION I: COMPANY IDENTIFICATION\n\n## ðŸ“ SECTION II: KEY DOCUMENT INFORMATION\n\n## ðŸ’¼ SECTION III: BUSINESS OVERVIEW\n\n## ðŸ“ˆ SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## ðŸ‘¥ SECTION V: MANAGEMENT AND GOVERNANCE\n\n## ðŸ’° SECTION VI: CAPITAL STRUCTURE\n\n## ðŸ¦ SECTION VII: FINANCIAL PERFORMANCE\n\n## ðŸŽ¯ SECTION VIII: IPO DETAILS\n\n## âš–ï¸ SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## ðŸ”— SECTION X: CORPORATE STRUCTURE\n\n## ðŸ† SECTION XI: ADDITIONAL INFORMATION\n\n## ðŸ“Š SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## ðŸš¨ CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## ðŸ“Œ ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -64,
          -1264
        ],
        "id": "485b603d-4e76-4a75-aaa6-340e16825889",
        "name": "DRHP Summary Preview Agent3",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook17').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -768,
          -992
        ],
        "id": "2bb64f87-b84c-4326-b00c-ed0d9c382aca",
        "name": "DRHP Pinecone VectorDB9",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
        },
        "type": "n8n-nodes-base.googleDocsTool",
        "typeVersion": 2,
        "position": [
          128,
          -992
        ],
        "id": "5d748532-6e25-42b2-9aa9-24d195f2865b",
        "name": "Summary Format Doc5",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "FklNSi7dT4QA9U7t",
            "name": "Google doc api(sonu)"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook17').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "namespace",
                "value": "={{ $json.fileName }}"
              },
              {
                "name": "documentId",
                "value": "={{ $('Webhook17').item.json.query.documentId }}"
              },
              {
                "name": "title",
                "value": "=summary for {{ $json.fileName }}"
              },
              {
                "name": "content",
                "value": "={{ $json.html_source }}"
              },
              {
                "name": "id",
                "value": "={{ $('Webhook17').item.json.query.session_id }}"
              },
              {
                "name": "domain",
                "value": "={{ $('Webhook17').item.json.query.domain }}"
              },
              {
                "name": "domainId",
                "value": "={{ $('Webhook17').item.json.query.domainId }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          736,
          -1280
        ],
        "id": "65c38f05-fe62-4516-a399-38dba6b14a9c",
        "name": "Update Summary In MongoDB2",
        "retryOnFail": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "={{ $('Webhook17').item.json.headers.authorization }}"
              },
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "jobId",
                "value": "={{ $execution.id}}"
              },
              {
                "name": "namespace",
                "value": "=$('Webhook17').first().json.query.namespace"
              },
              {
                "name": "error.message",
                "value": "=null"
              },
              {
                "name": "error.stack",
                "value": "=null"
              },
              {
                "name": "error.timestamp",
                "value": "={{ $('Webhook17').first().json.query.timestamp }}"
              },
              {
                "name": "=execution.workflowId",
                "value": "=j5Yz0X50IzUwIkgV"
              },
              {
                "name": "execution.executionId",
                "value": "={{ $execution.id }}"
              },
              {
                "name": "status",
                "value": "=success "
              }
            ]
          },
          "options": {}
        },
        "id": "c9561faa-eda0-4de9-9900-9f6f6b5ac8c6",
        "name": "Response Back To Pollong Webhook2",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4,
        "position": [
          912,
          -1280
        ],
        "retryOnFail": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4.1-mini",
            "mode": "list",
            "cachedResultName": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -848,
          -1392
        ],
        "id": "c6322725-dd05-446d-8f9f-19ad2be08cba",
        "name": "OpenAI Chat Model40",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=You are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge bases.\n\n---\n\n# ðŸ—ï¸ PRIMARY FUNCTIONS\n\n1. ALWAYS retrieve and extract the **company name** from DRHP chunks.\n2. Extract **comprehensive investor lists** from DRHP documents.\n3. Cross-reference and verify investors against a provided target investor list.\n4. Mention **only matched investors**, with detailed DRHP information.\n5. Extract **complete equity share capital history** exactly as shown in DRHP.\n6. Identify **premium rounds** and return calculation parameters in JSON format.\n7. Provide a **fully structured, rule-compliant investor analysis report**.\n\n---\n\n# ðŸš¨ CRITICAL REQUIREMENTS\n\n1. The **company name MUST be extracted from DRHP chunks**  \n2. The company name MUST appear in **all JSON outputs**  \n3. If not found â†’ set: `\"Company Name Not Found in DRHP\"`  \n4. This agent DOES NOT perform calculations  \n5. All numeric values must remain EXACT (no formatting changes)  \n\n---\n\n# âš™ï¸ BEHAVIOR RULES\n\n## 1. Information Retrieval\nYou must always extract:\n- Company name  \n- Full investor list  \n- All capital structure tables  \n- All equity share capital history rows EXACTLY as in DRHP  \n- Issue prices, face values, dates, share counts  \n\n---\n\n## 2. Investor List Verification (IMPORTANT)\n\nUse fuzzy but accurate matching:\n- Case-insensitive  \n- Ignore partial surname matches  \n- Match only when entity name is clearly identical  \n\n---\n\n# ðŸ”¥ HARD RULE FOR SECTION B (STRICT ENFORCEMENT â€” OVERRIDES ALL OTHER RULES)\n\nThe target investor list is used **internally ONLY**.  \nYou must NEVER print or list ANY target investor name unless it is CONFIRMED to exist in the DRHP.\n\n### SECTION B Output Logic:\n\n### âœ” If ZERO matches found:\n- Output ONLY this text:  \n  `No matches found`\n- DO NOT generate a table  \n- DO NOT display any investor names  \n- DO NOT show blanks, placeholders, or rows with â€œ-â€ or \"No match found\"  \n\n### âœ” If ONE OR MORE matches found:\n- Show ONLY a Markdown table containing the matched investors  \n- DO NOT include unmatched investors  \n- DO NOT include empty rows or placeholder values  \n- DO NOT preserve the order of the target list  \n- Include ONLY real DRHP-matched names with valid data  \n\n**This rule is absolute and overrides every other instruction.**\n\n---\n\n## 3. Target Investor List (Internal Use ONLY)\n\nYou must match DRHP investors against this internal list:\n\n- Adheesh Kabra  \n- Shilpa Kabra  \n- Rishi Agarwal  \n- Aarth AIF / Aarth AIF Growth Fund  \n- Chintan Shah  \n- Sanjay Popatlal Jain  \n- Manoj Agrawal  \n- Rajasthan Global Securities Private Limited  \n- Finavenue Capital Trust  \n- SB Opportunities Fund  \n- Smart Horizon Opportunity Fund  \n- Nav Capital Vcc - Nav Capital Emerging  \n- Invicta Continuum Fund  \n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1  \n- MERU INVESTMENT FUND PCC- CELL 1  \n- Finavenue Growth Fund  \n- Anant Aggarwal  \n- PACE COMMODITY BROKERS PRIVATE LIMITED  \n- Bharatbhai Prahaladbhai Patel  \n- ACCOR OPPORTUNITIES TRUST  \n- V2K Hospitality Private Limited  \n- Mihir Jain  \n- Rajesh Kumar Jain  \n- Vineet Saboo  \n- Prabhat Investment Services LLP  \n- Nikhil Shah  \n- Nevil Savjani  \n- Yogesh Jain  \n- Shivin Jain  \n- Pushpa Kabra  \n- KIFS Dealer  \n- Jitendra Agrawal  \n- Komalay Investrade Private Limited  \n- Viney Equity Market LLP  \n- Nitin Patel  \n- Pooja Kushal Patel  \n- Gitaben Patel  \n- Rishi Agarwal HUF  \n- Sunil Singhania  \n- Mukul Mahavir Agrawal  \n- Ashish Kacholia  \n- Lalit Dua  \n- Utsav Shrivastav  \n\nThis list is ONLY for internal matching â€” NEVER show it unless they match in DRHP.\n\n---\n\n# ðŸ“Š OUTPUT REQUIREMENTS â€” ALWAYS RETURN EXACTLY 3 SECTIONS\n\n---\n\n# **SECTION A â€” Complete Investor List from DRHP**\n\n- Always a **Markdown table**  \n- Columns:  \n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`  \n- Must include **every investor** found in the DRHP  \n- Preserve **exact names, numbers, and formatting**  \n\n---\n\n# **SECTION B â€” Matched Investors (Strict Rule Applied)**\n\nFollow the **Hard Rule**:\n\n### If no matches â†’ output ONLY:\nNo matches found\n\n### If matches exist â†’ output:\n- Markdown Table with columns:  \n  `Investor Name | DRHP Name | Investment | Category | Notes`\n\nOnly matched investors must appear.\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (â‚¹) | Issue Price (â‚¹) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (â‚¹) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n**Importand Rule** :always check  in which rows the Issue price > Face value && Issue price != Face means when Issue proce bigger than Face value only than find row and get that details in json strictly match this condition  , if this condtion true than it will added on Premium rounds\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\nâœ“ Row 2: February 28, 2011 - Issue Price â‚¹50.00 > Face Value â‚¹10\nâœ“ Row 5: September 17, 2025 - Issue Price â‚¹90.00 > Face Value â‚¹10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no â‚¹).\n\nExample:\n\n```json\n{\n  \"total_premium_rounds\": 2,\n   \"company_name\": \"string\",\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n---\n\n## ðŸ§± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"company_name\": \"string\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[âœ“ List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n## âš™ï¸ **Critical Rules Recap**\n\nâœ… Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\nâœ… Keep numeric values **exact** (no rounding, commas, or â‚¹).\nâœ… No missing rows or modified column names.\nâœ… No analysis, commentary, or suggestions.\nâœ… Output stops immediately after Section C Part 3.\nâœ… JSON syntax must be valid.\nâœ… Use âœ“ only for premium round indicators.\n\n## ðŸ”´ **Validation Checklist Before Returning Output**\n\nBefore returning the final JSON, verify:\n\n- [ ] Company name has been retrieved from Pinecone DRHP knowledge base, If company name not found again check DRHP chunk without compnay name never return output \n- [ ] Complete Investor List retrieved from Pinecone DRHP knowledge base \n- [ ] MATCHED INVESTORS list fuzzy  matched \n- [ ] SHARE CAPITAL HISTORY DATA EXTRACTION exact table retrieved from Pinecone DRHP knowledge base  \n- [ ] If company name not found, value is set to \"Company Name Not Found in DRHP\"\n\n**If any checkbox is unchecked, DO NOT return the output. Retrieve the missing data first.**\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.9,
        "position": [
          -384,
          -1648
        ],
        "id": "04ca2be6-5ed9-41ec-8e36-c2efa9ad9676",
        "name": "Subquery generator3",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"âœ“ Row 3: Jan 2023 - Issue Price â‚¹90 > Face Value â‚¹10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          144,
          -1392
        ],
        "id": "a158bb80-0ed3-472c-a8a5-06753ef3e0f8",
        "name": "Structured Output Parser5"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          -112,
          -1392
        ],
        "id": "fd6607de-4285-4b51-ae30-fb36dc83d76d",
        "name": "Auto-fixing Output Parser5"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "options": {
            "timeout": 120000
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -240,
          -1392
        ],
        "id": "7843b3c9-5a71-4798-8491-4f0e85066271",
        "name": "OpenAI Chat Model41",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          48,
          -1664
        ],
        "id": "eaf195d0-4743-4b88-8a45-44df867551fd",
        "name": "Code17"
      },
      {
        "parameters": {
          "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          304,
          -1664
        ],
        "id": "3f0a3536-e769-4e13-8adc-5dd17d12c75e",
        "name": "Code18"
      },
      {
        "parameters": {
          "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (â”, â”â”, etc.)\n  .replace(/^[â”â”€=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          176,
          -1744
        ],
        "id": "8cebc0f7-2895-4673-8942-065c939997b6",
        "name": "Code19"
      },
      {
        "parameters": {
          "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          912,
          -1696
        ],
        "id": "5bdebef8-ac7a-474d-9620-aa8580ec8de2",
        "name": "HTML12"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          512,
          -1696
        ],
        "id": "824e72cb-70f8-4690-8964-32d90c7d68e0",
        "name": "Merge19",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          736,
          -1696
        ],
        "id": "b0db58fc-8950-4c9f-b033-62a96f4a345d",
        "name": "Aggregate"
      },
      {
        "parameters": {
          "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">â‚¹$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// â€¦ your table conversion â€¦\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/â‚¹\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">â‚¹$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook17').first().json.query.namespace \n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          512,
          -1280
        ],
        "id": "059a79ae-2007-424d-a275-7a9bc91b0247",
        "name": "mdn to html",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -720,
          -1392
        ],
        "id": "9941444f-945e-4ad3-9bcb-16f602c65aa7",
        "name": "Embeddings OpenAI54",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          -368,
          -1392
        ],
        "id": "f235b42e-ea15-41c8-9883-68ba5746b1b3",
        "name": "Reranker Cohere32",
        "credentials": {
          "cohereApi": {
            "id": "OPXUAEyN6q367p55",
            "name": "CohereApi account 2(sv.excollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook17').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -624,
          -1392
        ],
        "id": "9d263b48-1312-4b74-9373-ffd7b522c92f",
        "name": "DRHP Pinecone VectorDB10",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          256,
          -992
        ],
        "id": "858ca2b5-27f9-4b7d-a362-7c0eff89711a",
        "name": "Embeddings OpenAI55",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "topN": 15
        },
        "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
        "typeVersion": 1,
        "position": [
          608,
          -992
        ],
        "id": "579bb6c0-ac6c-4ada-a80b-43974f167d36",
        "name": "Reranker Cohere33",
        "credentials": {
          "cohereApi": {
            "id": "604WWVX2sUlVBMR0",
            "name": "CohereApi account (s 7891)"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "RHP_Document_base",
          "toolDescription": "retrieve the data from the pinecone vector store tool",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 50,
          "useReranker": true,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "={{ $('Webhook17').item.json.query.namespace }}"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          352,
          -992
        ],
        "id": "77e57218-8aa3-4b1d-9f4c-476bc6586e47",
        "name": "DRHP Pinecone VectorDB11",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, Summary of related party transactions tables, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -752,
          -1232
        ],
        "id": "b19a1de8-ca25-441c-a63a-d1e0c195c3ef",
        "name": "Edit Fields29",
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "model": "text-embedding-3-large",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
        "typeVersion": 1.2,
        "position": [
          -352,
          -992
        ],
        "id": "c967e7dc-0ed7-488f-ae4a-e71a44292fa9",
        "name": "Embeddings OpenAI56",
        "credentials": {
          "openAiApi": {
            "id": "s0tbpIaVVpTmGxAg",
            "name": "Yash OpenAI account"
          }
        }
      },
      {
        "parameters": {
          "mode": "retrieve-as-tool",
          "toolName": "sop_knowledge_base",
          "toolDescription": "retrieve the the SOP data ",
          "pineconeIndex": {
            "__rl": true,
            "value": "drhpdocuments",
            "mode": "list",
            "cachedResultName": "drhpdocuments"
          },
          "topK": 10,
          "options": {
            "metadata": {
              "metadataValues": [
                {
                  "name": "documentName",
                  "value": "SOP.pdf"
                }
              ]
            }
          }
        },
        "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
        "typeVersion": 1.1,
        "position": [
          -256,
          -992
        ],
        "id": "2c6ba457-6483-42f7-88db-c19621acbbc7",
        "name": "Fund SOP Pinecone Vector DB4",
        "credentials": {
          "pineconeApi": {
            "id": "hADqCHAGuIhQbnrx",
            "name": "PineconeApi(sonuvExcollo)"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node outputs\n\n\n\n// Try multiple possible field names for the HTML content\nconst investorHtml = $input.first().json.html;\nconst researchHtml =  $input.first().json.research_html;\nconst fullSummaryHtml = $input.first().json.html_summary;\n\n\n// --- Function: Insert HTML Content Before Specific Section ---\nfunction insertHtmlBeforeSection(fullHtml, insertHtml, sectionHeader, sectionLabel) {\n  // Check if fullHtml is valid\n  if (!fullHtml || typeof fullHtml !== 'string') {\n    console.log(`âš ï¸ Invalid HTML content - cannot insert ${sectionLabel}`);\n    return fullHtml || '';\n  }\n  \n  // Check if there's content to insert\n  if (!insertHtml || typeof insertHtml !== 'string' || insertHtml.trim().length === 0) {\n    console.log(`âš ï¸ No content to insert for ${sectionLabel}`);\n    return fullHtml;\n  }\n  \n  // Create pattern to find the section header\n  const sectionPattern = new RegExp(\n    `(<h2[^>]*>[^<]*${sectionHeader}[^<]*<\\\\/h2>)`,\n    'i'\n  );\n  \n  let modifiedHtml = fullHtml;\n  const sectionMatch = modifiedHtml.match(sectionPattern);\n  \n  if (sectionMatch) {\n    const insertionPoint = sectionMatch.index;\n    \n    const insertionHtml = `\n      <!-- Inserted ${sectionLabel} -->\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n      <hr><br>\n    `;\n    \n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      insertionHtml +\n      modifiedHtml.slice(insertionPoint);\n    \n    console.log(`âœ… ${sectionLabel} inserted before ${sectionHeader}`);\n  } else {\n    console.log(`âš ï¸ ${sectionHeader} not found â€” appending ${sectionLabel} at the end`);\n    const insertionHtml = `\n      <hr><br>\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n    `;\n    modifiedHtml += insertionHtml;\n  }\n  \n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n        hr {\n          border: none;\n          border-top: 1px solid #e5e7eb;\n          margin: 20px 0;\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\n\n// Check if we have the base HTML summary\nif (!fullSummaryHtml || fullSummaryHtml.trim().length === 0) {\n  console.log('âš ï¸ No html_summary found - returning available data or error');\n  \n  // Try to return whatever HTML we have\n  let availableHtml = '';\n  if (investorHtml) availableHtml += investorHtml;\n  if (researchHtml) availableHtml += researchHtml;\n  \n  if (availableHtml) {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml(availableHtml),\n        fileName: $input.first().json.fileName,\n        warning: 'No html_summary found, returning available HTML only'\n      }\n    }];\n  } else {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml('<p>No HTML data available. Please check merge node configuration.</p>'),\n        fileName: $input.first().json.fileName || 'report.html',\n        error: 'No html_summary, html, or research_html found',\n        available_fields: Object.keys($input.first().json)\n      }\n    }];\n  }\n}\n\nlet modifiedHtml = fullSummaryHtml;\n\n// Step 1: Insert investor data (html) before SECTION VII\nif (investorHtml && investorHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    investorHtml, \n    'SECTION VII',\n    'Matched Investors & Analysis'\n  );\n} else {\n  console.log('â„¹ï¸ No investor HTML to insert');\n}\n\n// Step 2: Insert research data (research_html) before SECTION XII\nif (researchHtml && researchHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    researchHtml, \n    'SECTION XII',\n    'Adverse Findings & Research'\n  );\n} else {\n  console.log('â„¹ï¸ No research HTML to insert');\n}\n\n// Step 3: Generate final HTML with wrapper\nconst finalHtml = generateEnhancedHtml(modifiedHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: $input.first().json.fileName || 'report.html'\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -1632,
          -1472
        ],
        "id": "61883421-1deb-4446-b6ff-1045197714c9",
        "name": "mdn to html28"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineByPosition",
          "numberInputs": 3,
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -1808,
          -1488
        ],
        "id": "3b24b207-0fbc-458b-a777-7ecd53142e07",
        "name": "Merge21",
        "alwaysOutputData": false
      },
      {
        "parameters": {
          "messages": {
            "message": [
              {
                "content": "=You are an Expert Forensic Due-Diligence Analyst specializing in:\n\nGlobal sanctions\n\nRegulatory enforcement\n\nCriminal litigation\n\nOSINT adverse media\n\nCorporate networks of promoters & entities\n\nYour responsibility is to perform deep-dive adverse findings research on a target company and all its promoters, directors, beneficial owners, affiliates, and related entities.\n\nINPUT\n\nThe user will provide only the company name.\n\nYou must:\n\nIdentify all promoters, directors, beneficial owners, and related entities.\n\nPerform a global risk investigation across all layers defined below.\n\nReturn results only in the specified JSON format â€” no prose, no extra text.\n\nMANDATORY RESEARCH REQUIREMENTS\n1. Entity & Promoter Identification\n\nIdentify:\n\nAll current and past promoters, directors, shareholders, beneficial owners.\n\nAssociated companies or entities linked to promoters.\nUse:\n\nCorporate registries\n\nLitigation & debt filings\n\nRegulatory & enforcement databases\n\nHistorical and financial media\n\n2. GLOBAL ADVERSE SEARCH\n\nSearch comprehensively across:\n\nIndia, UAE, USA, UK, and all international jurisdictions.\nDatabases to include:\n\nOFAC SDN, BIS Entity List, UN Sanctions List, World Bank Debarment\n\nDFSA, ADGM, CBUAE, DIFC\n\nSEBI, RBI, SFIO, CBI, ED, DGGI\n\n3. CRIMINAL, FRAUD & REGULATORY VIOLATIONS\n\nExplicitly investigate using the following keyword set:\n\narrest, FIR, charge sheet, fraud, money laundering, PMLA, FEMA, SEBI order, SAT judgment, CBI case, ED attachment, DGGI show cause, GST evasion, blacklisted, wilful defaulter, NCLT order, CIRP, liquidation, Interpol Red Notice, DOJ indictment, SEC litigation release, OFAC SDN, BIS Entity List, UN sanctions list, World Bank debarment, DFSA enforcement, ADGM penalty, CBUAE sanction, DIFC judgment, etc.\n\nFor every match:\n\nRetrieve official document or case ID\n\nExtract related entities mentioned in the same document\n\n4. FINAL CASE STATUS\n\nFor each finding, state:\n\nFinal judgment\n\nAcquittal / Conviction / Settlement\n\nOngoing / Closed\n\nRISK SCORING LOGIC (UPDATED) âœ…\n\nWhen generating \"risk_assessment\":\n\nAssign each risk type (financial_crime_risk, regulatory_compliance_risk, reputational_risk, sanctions_risk, litigation_risk) one of:\n\n\"Low\" â†’ 0.0\n\n\"Moderate\" â†’ 3.0â€“6.0\n\n\"High\" â†’ 7.0â€“10.0\n\nIf no adverse findings detected in any layer, set:\n\n\"overall_risk_score\": 0.0\n\n\"risk_factors\": [\"No adverse findings detected\"]\n\nIf adverse findings exist:\n\nCompute \"overall_risk_score\" as an average of relevant risk levels (1â€“10 scale).\n\nAdd concise \"risk_factors\" explaining reasons.\nExample:\n\n\"risk_factors\": [\n  \"SEBI consent order against promoter (2021)\",\n  \"ED attachment under PMLA (2020)\"\n]\n\nSTRICT OUTPUT JSON FORMAT\n\nReturn only the following JSON (no extra text or markdown):\n\n{\n  \"metadata\": {\n    \"company\": \" {{ $json.company }}\",\n    \"promoters\": {{ $json.promoters }},\n    \"investigation_date\": \"{{ $now }}\",\n    \"jurisdictions_searched\": [\"India\", \"UAE\", \"USA\", \"UK\", \"International\"],\n    \"total_sources_checked\": 0\n  },\n  \"executive_summary\": {\n    \"adverse_flag\": false,\n    \"risk_level\": \"Low\",\n    \"confidence_overall\": 0.0,\n    \"key_findings\": \"\",\n    \"red_flags_count\": {\n      \"sanctions\": 0,\n      \"enforcement_actions\": 0,\n      \"criminal_cases\": 0,\n      \"high_risk_media\": 0\n    },\n    \"recommended_action\": \"proceed\"\n  },\n  \"detailed_findings\": {\n    \"layer1_sanctions\": [],\n    \"layer2_legal_regulatory\": [],\n    \"layer3_osint_media\": []\n  },\n  \"entity_network\": {\n    \"associated_companies\": [],\n    \"associated_persons\": [],\n    \"beneficial_owners_identified\": [],\n    \"related_entities_in_adverse_actions\": []\n  },\n  \"risk_assessment\": {\n    \"financial_crime_risk\": \"Low\",\n    \"regulatory_compliance_risk\": \"Low\",\n    \"reputational_risk\": \"Low\",\n    \"sanctions_risk\": \"Low\",\n    \"litigation_risk\": \"Low\",\n    \"overall_risk_score\": 0.0,\n    \"risk_factors\": [\"No adverse findings detected\"]\n  },\n  \"gaps_and_limitations\": [],\n  \"next_steps\": []\n}\n",
                "role": "system"
              },
              {
                "content": "={{ $json.output.results[0].calculation_parameters.company_name }}"
              }
            ]
          },
          "simplify": true,
          "options": {},
          "requestOptions": {}
        },
        "type": "n8n-nodes-base.perplexity",
        "typeVersion": 1,
        "position": [
          176,
          -1568
        ],
        "id": "27b3e6a1-2146-46d8-a70f-fa6f222ac9da",
        "name": "Adverse Findings Analyzer3",
        "credentials": {
          "perplexityApi": {
            "id": "E5nFmQXliwmGzdUQ",
            "name": "Perplexity account"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "model": "sonar-pro",
          "messages": {
            "message": [
              {
                "content": "=You are an Expert Forensic Due-Diligence Analyst specializing in:\n\nGlobal sanctions\n\nRegulatory enforcement\n\nCriminal litigation\n\nOSINT adverse media\n\nCorporate networks of promoters & entities\n\nYour responsibility is to perform deep-dive adverse findings research on a target company and all its promoters, directors, beneficial owners, affiliates, and related entities.\n\nINPUT\n\nThe user will provide only the company name.\n\nYou must:\n\nIdentify all promoters, directors, beneficial owners, and related entities.\n\nPerform a global risk investigation across all layers defined below.\n\nReturn results only in the specified JSON format â€” no prose, no extra text.\n\nMANDATORY RESEARCH REQUIREMENTS\n1. Entity & Promoter Identification\n\nIdentify:\n\nAll current and past promoters, directors, shareholders, beneficial owners.\n\nAssociated companies or entities linked to promoters.\nUse:\n\nCorporate registries\n\nLitigation & debt filings\n\nRegulatory & enforcement databases\n\nHistorical and financial media\n\n2. GLOBAL ADVERSE SEARCH\n\nSearch comprehensively across:\n\nIndia, UAE, USA, UK, and all international jurisdictions.\nDatabases to include:\n\nOFAC SDN, BIS Entity List, UN Sanctions List, World Bank Debarment\n\nDFSA, ADGM, CBUAE, DIFC\n\nSEBI, RBI, SFIO, CBI, ED, DGGI\n\n3. CRIMINAL, FRAUD & REGULATORY VIOLATIONS\n\nExplicitly investigate using the following keyword set:\n\narrest, FIR, charge sheet, fraud, money laundering, PMLA, FEMA, SEBI order, SAT judgment, CBI case, ED attachment, DGGI show cause, GST evasion, blacklisted, wilful defaulter, NCLT order, CIRP, liquidation, Interpol Red Notice, DOJ indictment, SEC litigation release, OFAC SDN, BIS Entity List, UN sanctions list, World Bank debarment, DFSA enforcement, ADGM penalty, CBUAE sanction, DIFC judgment, etc.\n\nFor every match:\n\nRetrieve official document or case ID\n\nExtract related entities mentioned in the same document\n\n4. FINAL CASE STATUS\n\nFor each finding, state:\n\nFinal judgment\n\nAcquittal / Conviction / Settlement\n\nOngoing / Closed\n\nRISK SCORING LOGIC (UPDATED) âœ…\n\nWhen generating \"risk_assessment\":\n\nAssign each risk type (financial_crime_risk, regulatory_compliance_risk, reputational_risk, sanctions_risk, litigation_risk) one of:\n\n\"Low\" â†’ 0.0\n\n\"Moderate\" â†’ 3.0â€“6.0\n\n\"High\" â†’ 7.0â€“10.0\n\nIf no adverse findings detected in any layer, set:\n\n\"overall_risk_score\": 0.0\n\n\"risk_factors\": [\"No adverse findings detected\"]\n\nIf adverse findings exist:\n\nCompute \"overall_risk_score\" as an average of relevant risk levels (1â€“10 scale).\n\nAdd concise \"risk_factors\" explaining reasons.\nExample:\n\n\"risk_factors\": [\n  \"SEBI consent order against promoter (2021)\",\n  \"ED attachment under PMLA (2020)\"\n]\n\nSTRICT OUTPUT JSON FORMAT\n\nReturn only the following JSON (no extra text or markdown):\n\n{\n  \"metadata\": {\n    \"company\": \" {{ $json.company }}\",\n    \"promoters\": {{ $json.promoters }},\n    \"investigation_date\": \"{{ $now }}\",\n    \"jurisdictions_searched\": [\"India\", \"UAE\", \"USA\", \"UK\", \"International\"],\n    \"total_sources_checked\": 0\n  },\n  \"executive_summary\": {\n    \"adverse_flag\": false,\n    \"risk_level\": \"Low\",\n    \"confidence_overall\": 0.0,\n    \"key_findings\": \"\",\n    \"red_flags_count\": {\n      \"sanctions\": 0,\n      \"enforcement_actions\": 0,\n      \"criminal_cases\": 0,\n      \"high_risk_media\": 0\n    },\n    \"recommended_action\": \"proceed\"\n  },\n  \"detailed_findings\": {\n    \"layer1_sanctions\": [],\n    \"layer2_legal_regulatory\": [],\n    \"layer3_osint_media\": []\n  },\n  \"entity_network\": {\n    \"associated_companies\": [],\n    \"associated_persons\": [],\n    \"beneficial_owners_identified\": [],\n    \"related_entities_in_adverse_actions\": []\n  },\n  \"risk_assessment\": {\n    \"financial_crime_risk\": \"Low\",\n    \"regulatory_compliance_risk\": \"Low\",\n    \"reputational_risk\": \"Low\",\n    \"sanctions_risk\": \"Low\",\n    \"litigation_risk\": \"Low\",\n    \"overall_risk_score\": 0.0,\n    \"risk_factors\": [\"No adverse findings detected\"]\n  },\n  \"gaps_and_limitations\": [],\n  \"next_steps\": []\n}\n",
                "role": "system"
              },
              {
                "content": "={{ $json.output.results[0].calculation_parameters.company_name }}"
              }
            ]
          },
          "simplify": true,
          "options": {},
          "requestOptions": {}
        },
        "type": "n8n-nodes-base.perplexity",
        "typeVersion": 1,
        "position": [
          -2416,
          -1584
        ],
        "id": "bd40575f-08c9-47b5-ba35-91e6cbff63b0",
        "name": "Adverse Findings Analyzer",
        "credentials": {
          "perplexityApi": {
            "id": "E5nFmQXliwmGzdUQ",
            "name": "Perplexity account"
          }
        },
        "onError": "continueErrorOutput"
      },
      {
        "parameters": {
          "jsCode": "// Parse Perplexity JSON output and convert it to a comprehensive research_html report\nlet raw =  $input.first().json.message;\n\n// Clean up and normalize the text\nif (typeof raw !== 'string') {\n  raw = JSON.stringify(raw);\n}\n\n// Remove code fences or markdown artifacts like ```json ... ```\nraw = raw\n  .replace(/^```json/i, '')\n  .replace(/^```/, '')\n  .replace(/```$/g, '')\n  .trim();\n\n// Try to find the JSON part if the model added extra text before or after\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (jsonMatch) {\n  raw = jsonMatch[0];\n}\n\n// Safe JSON parse\nlet data;\ntry {\n  data = JSON.parse(raw);\n} catch (e) {\n  return [{ research_html: `<p>âŒ Error parsing JSON: ${e.message}</p><pre>${raw}</pre>` }];\n}\n\n// Extract fields with safe fallback\nconst {\n  metadata = {},\n  executive_summary = {},\n  detailed_findings = {},\n  entity_network = {},\n  risk_assessment = {},\n  gaps_and_limitations = [],\n  next_steps = []\n} = data;\n\n// Extract metadata\nconst {\n  company = \"Unknown Company\",\n  promoters = \"\",\n  investigation_date = \"N/A\",\n  jurisdictions_searched = [],\n  total_sources_checked = 0\n} = metadata;\n\n// Extract executive summary\nconst {\n  adverse_flag = false,\n  risk_level = \"Not Rated\",\n  confidence_overall = 0,\n  key_findings = \"No findings available.\",\n  red_flags_count = {},\n  recommended_action = \"N/A\"\n} = executive_summary;\n\n// Extract risk assessment\nconst {\n  financial_crime_risk = \"N/A\",\n  regulatory_compliance_risk = \"N/A\",\n  reputational_risk = \"N/A\",\n  sanctions_risk = \"N/A\",\n  litigation_risk = \"N/A\",\n  overall_risk_score = 0,\n  risk_factors = []\n} = risk_assessment;\n\n// Extract detailed findings\nconst {\n  layer1_sanctions = [],\n  layer2_legal_regulatory = [],\n  layer3_osint_media = []\n} = detailed_findings;\n\n// Extract entity network\nconst {\n  associated_companies = [],\n  associated_persons = [],\n  beneficial_owners_identified = [],\n  related_entities_in_adverse_actions = []\n} = entity_network;\n\n// Handle promoters array or string gracefully\nconst promoterList = Array.isArray(promoters)\n  ? promoters.map(p => (typeof p === 'object' ? `${p.name || p.full_name || 'Unknown'} (${p.role || 'Unknown Role'})` : String(p))).join(', ')\n  : typeof promoters === 'string'\n  ? promoters\n  : 'Not Available';\n\n// Helper function to get action badge\nconst getActionBadge = (action) => {\n  const badges = {\n    'proceed': { text: 'Proceed'},\n    'proceed_with_caution': { text: 'Proceed with Caution'},\n    'enhanced_due_diligence': { text: 'Enhanced Due Diligence Required'},\n    'do_not_proceed': { text: 'Do Not Proceed' }\n  };\n  const badge = badges[action] || { text: action};\n  return `<span>${badge.text}</span>`;\n};\n\n// Helper for generating sanctions section\nconst generateSanctionsSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No sanctions or debarment records found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>âš ï¸ SANCTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>List:</strong> ${item.list_name || 'N/A'}</p>`;\n    research_html += `<p><strong>Matched Entity:</strong> ${item.matched_entity || 'N/A'}</p>`;\n    research_html += `<p><strong>Role:</strong> ${item.role || 'N/A'}</p>`;\n    research_html += `<p><strong>Reason:</strong> ${item.reason || 'N/A'}</p>`;\n    if (item.action_date) research_html += `<p><strong>Date:</strong> ${item.action_date}</p>`;\n    if (item.document_id) research_html += `<p><strong>Document ID:</strong> ${item.document_id}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url) {\n      research_html += `<p><strong>Source:</strong> <a href=\"${item.source_url}\" target=\"_blank\">${item.source_url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}% | <strong>Status:</strong> ${item.verification_status || 'N/A'}</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating legal/regulatory section\nconst generateLegalSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No legal or regulatory enforcement actions found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>âš–ï¸ LEGAL & REGULATORY ACTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Type:</strong> ${item.action_type || 'N/A'}</p>`;\n    if (item.case_number) research_html += `<p><strong>Case Number:</strong> ${item.case_number}</p>`;\n    if (item.filing_date) research_html += `<p><strong>Filing Date:</strong> ${item.filing_date}</p>`;\n    research_html += `<p><strong>Parties:</strong> ${item.parties || 'N/A'}</p>`;\n    if (item.jurisdiction) research_html += `<p><strong>Jurisdiction:</strong> ${item.jurisdiction}</p>`;\n    research_html += `<p><strong>Allegations:</strong> ${item.allegations || item.summary || 'N/A'}</p>`;\n    if (item.key_findings) research_html += `<p><strong>Key Findings:</strong> ${item.key_findings}</p>`;\n    if (item.penalties) research_html += `<p><strong>Penalties:</strong> ${item.penalties}</p>`;\n    research_html += `<p><strong>Status:</strong> <span>${item.final_disposition || item.disposition || 'N/A'}</span></p>`;\n    if (item.appeal_status) research_html += `<p><strong>Appeal Status:</strong> ${item.appeal_status}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url || item.url) {\n      const url = item.source_url || item.url;\n      research_html += `<p><strong>Source:</strong> <a href=\"${url}\" target=\"_blank\">${url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating OSINT/media section\nconst generateMediaSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No adverse media coverage found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>ðŸ“° MEDIA & OSINT FINDINGS</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Headline:</strong> ${item.headline || 'N/A'}</p>`;\n    if (item.publication) research_html += `<p><strong>Publication:</strong> ${item.publication}</p>`;\n    if (item.date) research_html += `<p><strong>Date:</strong> ${item.date}</p>`;\n    research_html += `<p><strong>Summary:</strong> ${item.snippet || item.allegations || 'N/A'}</p>`;\n    research_html += `<p><strong>Source Type:</strong> ${item.source_type || 'N/A'} | `;\n    research_html += `<strong>Risk Level:</strong> <span>${item.risk_label || 'N/A'}</span></p>`;\n    if (item.corroboration) research_html += `<p><strong>Corroboration:</strong> ${item.corroboration}</p>`;\n    if (item.credibility_score !== undefined) {\n      research_html += `<p><strong>Credibility Score:</strong> ${(item.credibility_score * 100).toFixed(0)}%</p>`;\n    }\n    if (item.url) {\n      research_html += `<p><strong>Link:</strong> <a href=\"${item.url}\" target=\"_blank\">${item.url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Build final comprehensive research_html report\nlet research_html = `\n<div>\n  \n  <!-- Header -->\n   <!-- <div>\n    <h1>ðŸ” Adverse Findings Report</h1>\n    <p>Investigation Date: ${new Date(investigation_date).toLocaleString()}</p>\n  </div>  -->\n\n  <!-- Executive Summary Card -->\n  <div>\n    <h2>ðŸ“Š Executive Summary</h2>\n    \n    <div>\n      <div>\n        <div>Company</div>\n        <div>${company}</div>\n      </div>\n      \n      <div>\n        <div>Adverse Flag</div>\n        <div>${adverse_flag ? 'âš ï¸ YES' : 'âœ… NO'}</div>\n      </div>\n      \n      <div>\n        <div>Risk Level</div>\n        <div>${risk_level}</div>\n      </div>\n      \n      <!-- <div>\n        <div>Confidence</div>\n        <div>${(confidence_overall * 100).toFixed(1)}%</div>\n      </div>-->\n    </div>\n\n    <div>\n      <strong>Promoters/Key Persons:</strong><br>\n      <span>${promoterList}</span>\n    </div>\n\n    <div>\n      <strong>Key Findings:</strong><br>\n      <span>${key_findings}</span>\n    </div>\n\n    <div>\n      <strong>Recommended Action:</strong><br>\n      ${getActionBadge(recommended_action)}\n    </div>\n\n    <div>\n      <strong>Red Flags Summary:</strong>\n      <div>\n        <div>ðŸš« Sanctions: <strong>${red_flags_count.sanctions || 0}</strong></div>\n        <div>âš–ï¸ Enforcement Actions: <strong>${red_flags_count.enforcement_actions || 0}</strong></div>\n        <div>ðŸ‘® Criminal Cases: <strong>${red_flags_count.criminal_cases || 0}</strong></div>\n        <div>ðŸ“° High-Risk Media: <strong>${red_flags_count.high_risk_media || 0}</strong></div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Investigation Metadata -->\n  <div>\n    <strong>ðŸ”Ž Investigation Scope:</strong><br>\n    <span>Jurisdictions: ${jurisdictions_searched.join(', ')}</span><br>\n    <span>Total Sources Checked: ${total_sources_checked}</span>\n  </div>\n\n  <!-- Detailed Findings -->\n  <div>\n    <h2>ðŸ” Detailed Findings</h2>\n    \n    <h3>ðŸš« Layer 1: Sanctions & Debarment</h3>\n    ${generateSanctionsSection(layer1_sanctions)}\n    \n    <h3>âš–ï¸ Layer 2: Legal & Regulatory Actions</h3>\n    ${generateLegalSection(layer2_legal_regulatory)}\n    \n    <h3>ðŸ“° Layer 3: OSINT & Media Intelligence</h3>\n    ${generateMediaSection(layer3_osint_media)}\n  </div>\n\n  <!-- Risk Assessment -->\n  <div>\n    <h2>ðŸ“ˆ Multi-Dimensional Risk Assessment</h2>\n    \n    <div>\n      <div>\n        <div>Financial Crime</div>\n        <div>${financial_crime_risk}</div>\n      </div>\n      <div>\n        <div>Regulatory Compliance</div>\n        <div>${regulatory_compliance_risk}</div>\n      </div>\n      <div>\n        <div>Reputational</div>\n        <div>${reputational_risk}</div>\n      </div>\n      <div>\n        <div>Sanctions</div>\n        <div>${sanctions_risk}</div>\n      </div>\n      <div>\n        <div>Litigation</div>\n        <div>${litigation_risk}</div>\n      </div>\n    </div>\n\n    <div>\n      <strong>Overall Risk Score:</strong> \n      <span>${overall_risk_score}/10</span>\n    </div> \n\n    ${risk_factors.length > 0 ? `\n    <div>\n      <strong>Key Risk Factors:</strong>\n      <ul>\n        ${risk_factors.map(factor => `<li>${factor}</li>`).join('')}\n      </ul>\n    </div>\n    ` : ''}\n  </div>\n\n  <!-- Entity Network -->\n  ${(associated_companies.length > 0 || associated_persons.length > 0 || beneficial_owners_identified.length > 0 || related_entities_in_adverse_actions.length > 0) ? `\n  <div>\n    <h2>ðŸ•¸ï¸ Entity Network</h2>\n    \n    ${associated_companies.length > 0 ? `\n    <div>\n      <strong>Associated Companies:</strong><br>\n      <span>${associated_companies.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${associated_persons.length > 0 ? `\n    <div>\n      <strong>Associated Persons:</strong><br>\n      <span>${associated_persons.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${beneficial_owners_identified.length > 0 ? `\n    <div>\n      <strong>Beneficial Owners:</strong><br>\n      <span>${beneficial_owners_identified.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${related_entities_in_adverse_actions.length > 0 ? `\n    <div>\n      <strong>âš ï¸ Related Entities in Adverse Actions:</strong><br>\n      <span>${related_entities_in_adverse_actions.join(', ')}</span>\n    </div>\n    ` : ''}\n  </div>\n  ` : ''}\n\n  <!-- Next Steps -->\n  ${next_steps.length > 0 ? `\n  <div>\n    <h2>ðŸ“‹ Recommended Next Steps</h2>\n    <ol>\n      ${next_steps.map(step => `<li>${step}</li>`).join('')}\n    </ol>\n  </div>\n  ` : ''}\n\n  <!-- Gaps & Limitations -->\n  ${gaps_and_limitations.length > 0 ? `\n  <div>\n    <h3>âš ï¸ Investigation Gaps & Limitations</h3>\n    <ul>\n      ${gaps_and_limitations.map(gap => `<li>${gap}</li>`).join('')}\n    </ul>\n  </div>\n  ` : ''}\n\n  <!-- Footer -->\n  <div>\n    <p>This report was generated using automated OSINT and regulatory database searches. All findings should be independently verified.</p>\n    <p>Report generated on ${new Date().toLocaleString()}</p>\n  </div>\n\n</div>\n`;\n\nreturn [{ research_html }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2080,
          -1488
        ],
        "id": "c25e7f85-d9e3-473c-82a6-cc2e3dbce5b1",
        "name": "Code in JavaScript3"
      },
      {
        "parameters": {
          "jsCode": "// Parse Perplexity JSON output and convert it to a comprehensive research_html report\nlet raw =  $input.first().json.message;\n\n// Clean up and normalize the text\nif (typeof raw !== 'string') {\n  raw = JSON.stringify(raw);\n}\n\n// Remove code fences or markdown artifacts like ```json ... ```\nraw = raw\n  .replace(/^```json/i, '')\n  .replace(/^```/, '')\n  .replace(/```$/g, '')\n  .trim();\n\n// Try to find the JSON part if the model added extra text before or after\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (jsonMatch) {\n  raw = jsonMatch[0];\n}\n\n// Safe JSON parse\nlet data;\ntry {\n  data = JSON.parse(raw);\n} catch (e) {\n  return [{ research_html: `<p>âŒ Error parsing JSON: ${e.message}</p><pre>${raw}</pre>` }];\n}\n\n// Extract fields with safe fallback\nconst {\n  metadata = {},\n  executive_summary = {},\n  detailed_findings = {},\n  entity_network = {},\n  risk_assessment = {},\n  gaps_and_limitations = [],\n  next_steps = []\n} = data;\n\n// Extract metadata\nconst {\n  company = \"Unknown Company\",\n  promoters = \"\",\n  investigation_date = \"N/A\",\n  jurisdictions_searched = [],\n  total_sources_checked = 0\n} = metadata;\n\n// Extract executive summary\nconst {\n  adverse_flag = false,\n  risk_level = \"Not Rated\",\n  confidence_overall = 0,\n  key_findings = \"No findings available.\",\n  red_flags_count = {},\n  recommended_action = \"N/A\"\n} = executive_summary;\n\n// Extract risk assessment\nconst {\n  financial_crime_risk = \"N/A\",\n  regulatory_compliance_risk = \"N/A\",\n  reputational_risk = \"N/A\",\n  sanctions_risk = \"N/A\",\n  litigation_risk = \"N/A\",\n  overall_risk_score = 0,\n  risk_factors = []\n} = risk_assessment;\n\n// Extract detailed findings\nconst {\n  layer1_sanctions = [],\n  layer2_legal_regulatory = [],\n  layer3_osint_media = []\n} = detailed_findings;\n\n// Extract entity network\nconst {\n  associated_companies = [],\n  associated_persons = [],\n  beneficial_owners_identified = [],\n  related_entities_in_adverse_actions = []\n} = entity_network;\n\n// Handle promoters array or string gracefully\nconst promoterList = Array.isArray(promoters)\n  ? promoters.map(p => (typeof p === 'object' ? `${p.name || p.full_name || 'Unknown'} (${p.role || 'Unknown Role'})` : String(p))).join(', ')\n  : typeof promoters === 'string'\n  ? promoters\n  : 'Not Available';\n\n// Helper function to get action badge\nconst getActionBadge = (action) => {\n  const badges = {\n    'proceed': { text: 'Proceed'},\n    'proceed_with_caution': { text: 'Proceed with Caution'},\n    'enhanced_due_diligence': { text: 'Enhanced Due Diligence Required'},\n    'do_not_proceed': { text: 'Do Not Proceed' }\n  };\n  const badge = badges[action] || { text: action};\n  return `<span>${badge.text}</span>`;\n};\n\n// Helper for generating sanctions section\nconst generateSanctionsSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No sanctions or debarment records found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>âš ï¸ SANCTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>List:</strong> ${item.list_name || 'N/A'}</p>`;\n    research_html += `<p><strong>Matched Entity:</strong> ${item.matched_entity || 'N/A'}</p>`;\n    research_html += `<p><strong>Role:</strong> ${item.role || 'N/A'}</p>`;\n    research_html += `<p><strong>Reason:</strong> ${item.reason || 'N/A'}</p>`;\n    if (item.action_date) research_html += `<p><strong>Date:</strong> ${item.action_date}</p>`;\n    if (item.document_id) research_html += `<p><strong>Document ID:</strong> ${item.document_id}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url) {\n      research_html += `<p><strong>Source:</strong> <a href=\"${item.source_url}\" target=\"_blank\">${item.source_url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}% | <strong>Status:</strong> ${item.verification_status || 'N/A'}</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating legal/regulatory section\nconst generateLegalSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No legal or regulatory enforcement actions found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>âš–ï¸ LEGAL & REGULATORY ACTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Type:</strong> ${item.action_type || 'N/A'}</p>`;\n    if (item.case_number) research_html += `<p><strong>Case Number:</strong> ${item.case_number}</p>`;\n    if (item.filing_date) research_html += `<p><strong>Filing Date:</strong> ${item.filing_date}</p>`;\n    research_html += `<p><strong>Parties:</strong> ${item.parties || 'N/A'}</p>`;\n    if (item.jurisdiction) research_html += `<p><strong>Jurisdiction:</strong> ${item.jurisdiction}</p>`;\n    research_html += `<p><strong>Allegations:</strong> ${item.allegations || item.summary || 'N/A'}</p>`;\n    if (item.key_findings) research_html += `<p><strong>Key Findings:</strong> ${item.key_findings}</p>`;\n    if (item.penalties) research_html += `<p><strong>Penalties:</strong> ${item.penalties}</p>`;\n    research_html += `<p><strong>Status:</strong> <span>${item.final_disposition || item.disposition || 'N/A'}</span></p>`;\n    if (item.appeal_status) research_html += `<p><strong>Appeal Status:</strong> ${item.appeal_status}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url || item.url) {\n      const url = item.source_url || item.url;\n      research_html += `<p><strong>Source:</strong> <a href=\"${url}\" target=\"_blank\">${url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating OSINT/media section\nconst generateMediaSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>âœ… No adverse media coverage found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>ðŸ“° MEDIA & OSINT FINDINGS</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Headline:</strong> ${item.headline || 'N/A'}</p>`;\n    if (item.publication) research_html += `<p><strong>Publication:</strong> ${item.publication}</p>`;\n    if (item.date) research_html += `<p><strong>Date:</strong> ${item.date}</p>`;\n    research_html += `<p><strong>Summary:</strong> ${item.snippet || item.allegations || 'N/A'}</p>`;\n    research_html += `<p><strong>Source Type:</strong> ${item.source_type || 'N/A'} | `;\n    research_html += `<strong>Risk Level:</strong> <span>${item.risk_label || 'N/A'}</span></p>`;\n    if (item.corroboration) research_html += `<p><strong>Corroboration:</strong> ${item.corroboration}</p>`;\n    if (item.credibility_score !== undefined) {\n      research_html += `<p><strong>Credibility Score:</strong> ${(item.credibility_score * 100).toFixed(0)}%</p>`;\n    }\n    if (item.url) {\n      research_html += `<p><strong>Link:</strong> <a href=\"${item.url}\" target=\"_blank\">${item.url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Build final comprehensive research_html report\nlet research_html = `\n<div>\n  \n  <!-- Header -->\n   <!-- <div>\n    <h1>ðŸ” Adverse Findings Report</h1>\n    <p>Investigation Date: ${new Date(investigation_date).toLocaleString()}</p>\n  </div>  -->\n\n  <!-- Executive Summary Card -->\n  <div>\n    <h2>ðŸ“Š Executive Summary</h2>\n    \n    <div>\n      <div>\n        <div>Company</div>\n        <div>${company}</div>\n      </div>\n      \n      <div>\n        <div>Adverse Flag</div>\n        <div>${adverse_flag ? 'âš ï¸ YES' : 'âœ… NO'}</div>\n      </div>\n      \n      <div>\n        <div>Risk Level</div>\n        <div>${risk_level}</div>\n      </div>\n      \n      <!-- <div>\n        <div>Confidence</div>\n        <div>${(confidence_overall * 100).toFixed(1)}%</div>\n      </div>-->\n    </div>\n\n    <div>\n      <strong>Promoters/Key Persons:</strong><br>\n      <span>${promoterList}</span>\n    </div>\n\n    <div>\n      <strong>Key Findings:</strong><br>\n      <span>${key_findings}</span>\n    </div>\n\n    <div>\n      <strong>Recommended Action:</strong><br>\n      ${getActionBadge(recommended_action)}\n    </div>\n\n    <div>\n      <strong>Red Flags Summary:</strong>\n      <div>\n        <div>ðŸš« Sanctions: <strong>${red_flags_count.sanctions || 0}</strong></div>\n        <div>âš–ï¸ Enforcement Actions: <strong>${red_flags_count.enforcement_actions || 0}</strong></div>\n        <div>ðŸ‘® Criminal Cases: <strong>${red_flags_count.criminal_cases || 0}</strong></div>\n        <div>ðŸ“° High-Risk Media: <strong>${red_flags_count.high_risk_media || 0}</strong></div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Investigation Metadata -->\n  <div>\n    <strong>ðŸ”Ž Investigation Scope:</strong><br>\n    <span>Jurisdictions: ${jurisdictions_searched.join(', ')}</span><br>\n    <span>Total Sources Checked: ${total_sources_checked}</span>\n  </div>\n\n  <!-- Detailed Findings -->\n  <div>\n    <h2>ðŸ” Detailed Findings</h2>\n    \n    <h3>ðŸš« Layer 1: Sanctions & Debarment</h3>\n    ${generateSanctionsSection(layer1_sanctions)}\n    \n    <h3>âš–ï¸ Layer 2: Legal & Regulatory Actions</h3>\n    ${generateLegalSection(layer2_legal_regulatory)}\n    \n    <h3>ðŸ“° Layer 3: OSINT & Media Intelligence</h3>\n    ${generateMediaSection(layer3_osint_media)}\n  </div>\n\n  <!-- Risk Assessment -->\n  <div>\n    <h2>ðŸ“ˆ Multi-Dimensional Risk Assessment</h2>\n    \n    <div>\n      <div>\n        <div>Financial Crime</div>\n        <div>${financial_crime_risk}</div>\n      </div>\n      <div>\n        <div>Regulatory Compliance</div>\n        <div>${regulatory_compliance_risk}</div>\n      </div>\n      <div>\n        <div>Reputational</div>\n        <div>${reputational_risk}</div>\n      </div>\n      <div>\n        <div>Sanctions</div>\n        <div>${sanctions_risk}</div>\n      </div>\n      <div>\n        <div>Litigation</div>\n        <div>${litigation_risk}</div>\n      </div>\n    </div>\n\n    <div>\n      <strong>Overall Risk Score:</strong> \n      <span>${overall_risk_score}/10</span>\n    </div> \n\n    ${risk_factors.length > 0 ? `\n    <div>\n      <strong>Key Risk Factors:</strong>\n      <ul>\n        ${risk_factors.map(factor => `<li>${factor}</li>`).join('')}\n      </ul>\n    </div>\n    ` : ''}\n  </div>\n\n  <!-- Entity Network -->\n  ${(associated_companies.length > 0 || associated_persons.length > 0 || beneficial_owners_identified.length > 0 || related_entities_in_adverse_actions.length > 0) ? `\n  <div>\n    <h2>ðŸ•¸ï¸ Entity Network</h2>\n    \n    ${associated_companies.length > 0 ? `\n    <div>\n      <strong>Associated Companies:</strong><br>\n      <span>${associated_companies.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${associated_persons.length > 0 ? `\n    <div>\n      <strong>Associated Persons:</strong><br>\n      <span>${associated_persons.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${beneficial_owners_identified.length > 0 ? `\n    <div>\n      <strong>Beneficial Owners:</strong><br>\n      <span>${beneficial_owners_identified.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${related_entities_in_adverse_actions.length > 0 ? `\n    <div>\n      <strong>âš ï¸ Related Entities in Adverse Actions:</strong><br>\n      <span>${related_entities_in_adverse_actions.join(', ')}</span>\n    </div>\n    ` : ''}\n  </div>\n  ` : ''}\n\n  <!-- Next Steps -->\n  ${next_steps.length > 0 ? `\n  <div>\n    <h2>ðŸ“‹ Recommended Next Steps</h2>\n    <ol>\n      ${next_steps.map(step => `<li>${step}</li>`).join('')}\n    </ol>\n  </div>\n  ` : ''}\n\n  <!-- Gaps & Limitations -->\n  ${gaps_and_limitations.length > 0 ? `\n  <div>\n    <h3>âš ï¸ Investigation Gaps & Limitations</h3>\n    <ul>\n      ${gaps_and_limitations.map(gap => `<li>${gap}</li>`).join('')}\n    </ul>\n  </div>\n  ` : ''}\n\n  <!-- Footer -->\n  <div>\n    <p>This report was generated using automated OSINT and regulatory database searches. All findings should be independently verified.</p>\n    <p>Report generated on ${new Date().toLocaleString()}</p>\n  </div>\n\n</div>\n`;\n\nreturn [{ research_html }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          512,
          -1488
        ],
        "id": "f92dfbde-4c23-45d6-9acc-0e33fbf39548",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2496,
          -1680
        ],
        "id": "311fdd17-b978-447d-8274-c2a78cdc328f",
        "name": "Code20"
      },
      {
        "parameters": {
          "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (â‚¹)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2240,
          -1680
        ],
        "id": "b15fed6f-76ab-4dbf-92b1-ae219f8c53e4",
        "name": "Code21"
      },
      {
        "parameters": {
          "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (â”, â”â”, etc.)\n  .replace(/^[â”â”€=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2368,
          -1760
        ],
        "id": "4b57459a-2a0e-4b33-bab9-c9f8e1c707f1",
        "name": "Code22"
      },
      {
        "parameters": {
          "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
        },
        "type": "n8n-nodes-base.html",
        "typeVersion": 1.2,
        "position": [
          -1632,
          -1712
        ],
        "id": "2feaec1d-fa6f-44ce-90c3-dfadb2fd7645",
        "name": "HTML"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -2032,
          -1712
        ],
        "id": "35905cef-2b61-43bf-bea0-4ee8cad27979",
        "name": "Merge22",
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          -1808,
          -1712
        ],
        "id": "d70456e5-f8b2-447e-b7c8-2eaaed0eb38d",
        "name": "Aggregate1"
      }
    ],
    "connections": {
      "Download file1": {
        "main": [
          [
            {
              "node": "Extract from File4",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge5",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          []
        ]
      },
      "OpenAI Chat Model11": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI10": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store14",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model12": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent9",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent9": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Markdown3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI11": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone Vector Store16",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File4": {
        "main": [
          [
            {
              "node": "Merge5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge5": {
        "main": [
          [
            {
              "node": "Cleaned text4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI17": {
        "ai_embedding": [
          []
        ]
      },
      "Cleaned text4": {
        "main": [
          []
        ]
      },
      "Pinecone Vector Store1": {
        "ai_tool": [
          [
            {
              "node": "Summary generator Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store10": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI9": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store10",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html1": {
        "main": [
          [
            {
              "node": "PDFco Api2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Summary generator Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI1": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "extractSubQueries1": {
        "main": [
          [
            {
              "node": "Summary generator Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Summary generator Agent1": {
        "main": [
          [
            {
              "node": "mdn to html1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator1": {
        "main": [
          [
            {
              "node": "extractSubQueries1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields3": {
        "main": [
          []
        ]
      },
      "PDFco Api2": {
        "main": [
          []
        ]
      },
      "Embeddings OpenAI20": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "mdn to html5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory11": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI21": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector Store1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector Store1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html5": {
        "main": [
          [
            {
              "node": "sent response to the backend api for create report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields9": {
        "main": [
          [
            {
              "node": "Send Error to Backend5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook6": {
        "main": [
          [
            {
              "node": "Set Execution Info",
              "type": "main",
              "index": 0
            },
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info": {
        "main": [
          [
            {
              "node": "Respond with Execution ID",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sent response to the backend api for create report": {
        "main": [
          [
            {
              "node": "send final response for success report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere1": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere4": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector Store1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Extract from File",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Cleaned text1": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Cleaned text1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields4": {
        "main": [
          [
            {
              "node": "Send Error to Backend3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store5",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI18": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store5",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store5": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook5": {
        "main": [
          [
            {
              "node": "Extract from File1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Cleaned text": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File1": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "Cleaned text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields8": {
        "main": [
          [
            {
              "node": "Send Error to Backend4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter1": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader1",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader1": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store6",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI19": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store6",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store6": {
        "main": [
          [
            {
              "node": "Respond to Webhook10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info5": {
        "main": [
          [
            {
              "node": "Respond with Execution ID5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request6": {
        "main": [
          [
            {
              "node": "Send Error to Backend11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields15": {
        "main": [
          [
            {
              "node": "Send Error to Backend10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Summary generator Agent6",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI7": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store8",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Summary generator Agent6": {
        "main": [
          [
            {
              "node": "mdn to html12",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store8": {
        "ai_tool": [
          [
            {
              "node": "Summary generator Agent6",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Webhook9": {
        "main": [
          [
            {
              "node": "Set Execution Info5",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields16",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere11": {
        "ai_reranker": [
          [
            {
              "node": "Pinecone Vector Store8",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields16": {
        "main": [
          [
            {
              "node": "Summary generator Agent6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model18": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator4",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator4": {
        "main": [
          [
            {
              "node": "mdn to html8",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store18": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator4",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI24": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store18",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere12": {
        "ai_reranker": [
          [
            {
              "node": "Pinecone Vector Store18",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info2": {
        "main": [
          [
            {
              "node": "Respond with Execution ID2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request4": {
        "main": [
          [
            {
              "node": "Send Error to Backend1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Send Error to Backend",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI3": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Summary generator Agent2": {
        "main": [
          [
            {
              "node": "mdn to html2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store2": {
        "ai_tool": [
          [
            {
              "node": "Summary generator Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html2": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook4": {
        "main": [
          [
            {
              "node": "Set Execution Info2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere2": {
        "ai_reranker": [
          [
            {
              "node": "Pinecone Vector Store2",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields11": {
        "main": [
          []
        ]
      },
      "mdn to html8": {
        "main": [
          [
            {
              "node": "Merge3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html11": {
        "main": [
          [
            {
              "node": "HTTP Request6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html12": {
        "main": [
          [
            {
              "node": "Merge3",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Merge3": {
        "main": [
          [
            {
              "node": "mdn to html11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory3": {
        "ai_memory": [
          [
            {
              "node": "Summary generator Agent6",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          []
        ]
      },
      "List Vector IDs": {
        "main": [
          [
            {
              "node": "List Vector IDs1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Batch Vector IDs": {
        "main": [
          [
            {
              "node": "Fetch Vectors with Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Vectors with Data": {
        "main": [
          [
            {
              "node": "Transform Vectors",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Transform Vectors": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upsert to Default Namespace": {
        "main": [
          []
        ]
      },
      "List Vector IDs1": {
        "main": [
          [
            {
              "node": "List Vector IDs2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge8",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "List Vector IDs2": {
        "main": [
          [
            {
              "node": "Merge8",
              "type": "main",
              "index": 2
            },
            {
              "node": "List Vector IDs3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Vector IDs3": {
        "main": [
          [
            {
              "node": "Merge8",
              "type": "main",
              "index": 3
            },
            {
              "node": "List Vector IDs4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Vector IDs4": {
        "main": [
          [
            {
              "node": "List Vector IDs5",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge8",
              "type": "main",
              "index": 4
            }
          ]
        ]
      },
      "Merge8": {
        "main": [
          [
            {
              "node": "Batch Vector IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Upsert to Default Namespace1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Vector IDs5": {
        "main": [
          [
            {
              "node": "Merge8",
              "type": "main",
              "index": 5
            },
            {
              "node": "List Vector IDs6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Vector IDs6": {
        "main": [
          [
            {
              "node": "Merge8",
              "type": "main",
              "index": 6
            },
            {
              "node": "List Vector IDs14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Summary generator Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields21": {
        "main": [
          [
            {
              "node": "List Vector IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "List Vector IDs14": {
        "main": [
          [
            {
              "node": "Merge8",
              "type": "main",
              "index": 7
            }
          ]
        ]
      },
      "Get a document in Google Docs1": {
        "ai_tool": [
          [
            {
              "node": "AI Agent9",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI13": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store15",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone Vector Store16": {
        "ai_tool": [
          [
            {
              "node": "AI Agent9",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store15": {
        "ai_tool": [
          [
            {
              "node": "AI Agent9",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere9": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store14",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields22": {
        "main": [
          [
            {
              "node": "AI Agent9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere13": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store15",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Markdown3": {
        "main": [
          [
            {
              "node": "HTML4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get a document in Google Docs2": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store14": {
        "ai_tool": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model15": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Preview Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI23": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone VectorDB1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model17": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Generator Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html13": {
        "main": [
          [
            {
              "node": "HTML5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI26": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere14": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone VectorDB1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere15": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Webhook10": {
        "main": [
          [
            {
              "node": "Set Execution Info6",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info6": {
        "main": [
          [
            {
              "node": "Respond with Execution ID6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields19": {
        "main": [
          [
            {
              "node": "Send Error to Backend12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields24": {
        "main": [
          [
            {
              "node": "Summary generator Agent2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model21": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Summary Preview Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model22": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Summary Generator Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI31": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone Vector DB2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI32": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector DB1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere18": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector DB1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info7": {
        "main": [
          [
            {
              "node": "Respond with Execution ID7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields23": {
        "main": [
          [
            {
              "node": "Send Error to Backend14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook11": {
        "main": [
          [
            {
              "node": "Set Execution Info7",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields13",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector DB1": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Generator Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone Vector DB2": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Summary Generator Agent": {
        "main": [
          [
            {
              "node": "RHP Summary Preview Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Generator Agent": {
        "main": [
          [
            {
              "node": "DRHP Summary Preview Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Preview Agent": {
        "main": [
          [
            {
              "node": "mdn to html17",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Summary Preview Agent": {
        "main": [
          [
            {
              "node": "mdn to html19",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Generator Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summary Format Doc1": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summary Format Doc2": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Summary In MongoDB": {
        "main": [
          [
            {
              "node": "Response Back To Pollong Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model26": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator2": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser1",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser1": {
        "ai_outputParser": [
          [
            {
              "node": "Subquery generator2",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model13": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Merge6",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Merge6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML7": {
        "main": [
          [
            {
              "node": "Merge9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge6": {
        "main": [
          [
            {
              "node": "Aggregate2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate2": {
        "main": [
          [
            {
              "node": "HTML7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html17": {
        "main": [
          [
            {
              "node": "Merge9",
              "type": "main",
              "index": 1
            }
          ],
          [
            {
              "node": "Edit Fields19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html18": {
        "main": [
          [
            {
              "node": "Update Summary In MongoDB",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge9": {
        "main": [
          [
            {
              "node": "mdn to html18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI33": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB5",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere19": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB5",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB5": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI38": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB6",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere23": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB6",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB6": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model27": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator5",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator5": {
        "main": [
          [
            {
              "node": "Adverse Findings Analyzer",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code20",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser2",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "Subquery generator5",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model28": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html19": {
        "main": [
          [
            {
              "node": "Merge21",
              "type": "main",
              "index": 2
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI39": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone VectorDB7",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere24": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone VectorDB7",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Update in MongoDB": {
        "main": [
          [
            {
              "node": "Response Back to Polling Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone VectorDB7": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator5",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone VectorDB1": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI30": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent2": {
        "main": [
          [
            {
              "node": "mdn to html6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI40": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector Store",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector Store": {
        "ai_tool": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store": {
        "ai_tool": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html6": {
        "main": [
          [
            {
              "node": "sent response to the backend api for create report1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields10": {
        "main": [
          [
            {
              "node": "Send Error to Backend7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook7": {
        "main": [
          [
            {
              "node": "AI Agent2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Set Execution Info1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info1": {
        "main": [
          [
            {
              "node": "Respond with Execution ID1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sent response to the backend api for create report1": {
        "main": [
          [
            {
              "node": "send final response for success report1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere8": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere17": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector Store",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Webhook3": {
        "main": [
          [
            {
              "node": "Extract from File2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge12",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Cleaned text2": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File2": {
        "main": [
          [
            {
              "node": "Merge12",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge12": {
        "main": [
          [
            {
              "node": "Cleaned text2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields12": {
        "main": [
          [
            {
              "node": "Send Error to Backend13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter2": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader2",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader2": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store9",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI41": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store9",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store9": {
        "main": [
          [
            {
              "node": "Respond to Webhook11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook12": {
        "main": [
          [
            {
              "node": "Extract from File3",
              "type": "main",
              "index": 0
            },
            {
              "node": "Merge14",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Cleaned text3": {
        "main": [
          [
            {
              "node": "Pinecone Vector Store16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract from File3": {
        "main": [
          [
            {
              "node": "Merge14",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge14": {
        "main": [
          [
            {
              "node": "Cleaned text3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields18": {
        "main": [
          [
            {
              "node": "Send Error to Backend15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Recursive Character Text Splitter3": {
        "ai_textSplitter": [
          [
            {
              "node": "Default Data Loader3",
              "type": "ai_textSplitter",
              "index": 0
            }
          ]
        ]
      },
      "Default Data Loader3": {
        "ai_document": [
          [
            {
              "node": "Pinecone Vector Store16",
              "type": "ai_document",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI42": {
        "ai_embedding": [
          [
            {
              "node": "Pinecone Vector Store16",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Pinecone Vector Store16": {
        "main": [
          [
            {
              "node": "Respond to Webhook12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model30": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model31": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Preview Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI43": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone VectorDB2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model32": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Generator Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI44": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone VectorDB2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI45": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB1",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere25": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone VectorDB2",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere26": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB1",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Webhook13": {
        "main": [
          [
            {
              "node": "Set Execution Info8",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator6",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info8": {
        "main": [
          [
            {
              "node": "Respond with Execution ID8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields25": {
        "main": [
          [
            {
              "node": "Send Error to Backend16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model33": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Summary Preview Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model34": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Summary Generator Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI46": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone Vector DB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI47": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector DB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere27": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector DB",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info9": {
        "main": [
          [
            {
              "node": "Respond with Execution ID9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields26": {
        "main": [
          [
            {
              "node": "Send Error to Backend17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook14": {
        "main": [
          [
            {
              "node": "Set Execution Info9",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator7",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector DB": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Generator Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone Vector DB": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Summary Generator Agent1": {
        "main": [
          [
            {
              "node": "RHP Summary Preview Agent1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Generator Agent2": {
        "main": [
          [
            {
              "node": "DRHP Summary Preview Agent2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Preview Agent2": {
        "main": [
          [
            {
              "node": "mdn to html23",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Summary Preview Agent1": {
        "main": [
          [
            {
              "node": "mdn to html25",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone VectorDB2": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB1": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Generator Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summary Format Doc": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summary Format Doc3": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Summary In MongoDB1": {
        "main": [
          [
            {
              "node": "Response Back To Pollong Webhook1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model35": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator6",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator6": {
        "main": [
          [
            {
              "node": "Code11",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser3": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser3",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser3": {
        "ai_outputParser": [
          [
            {
              "node": "Subquery generator6",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model36": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code11": {
        "main": [
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Merge15",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "Merge15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML10": {
        "main": [
          [
            {
              "node": "Merge16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge15": {
        "main": [
          [
            {
              "node": "Aggregate4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate4": {
        "main": [
          [
            {
              "node": "HTML10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html23": {
        "main": [
          [
            {
              "node": "Merge16",
              "type": "main",
              "index": 1
            }
          ],
          [
            {
              "node": "Edit Fields25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html24": {
        "main": [
          [
            {
              "node": "Update Summary In MongoDB1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge16": {
        "main": [
          [
            {
              "node": "mdn to html24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI48": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB7",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere28": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB7",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB7": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator6",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI49": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB8",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere29": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB8",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB8": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model37": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator7": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code16",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser4": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser4",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser4": {
        "ai_outputParser": [
          [
            {
              "node": "Subquery generator7",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model38": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser4",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "Code15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code15": {
        "main": [
          [
            {
              "node": "Merge17",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code16": {
        "main": [
          [
            {
              "node": "Merge17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML11": {
        "main": [
          [
            {
              "node": "Merge18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge17": {
        "main": [
          [
            {
              "node": "Aggregate5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate5": {
        "main": [
          [
            {
              "node": "HTML11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html25": {
        "main": [
          [
            {
              "node": "Merge18",
              "type": "main",
              "index": 1
            }
          ],
          [
            {
              "node": "Edit Fields26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html26": {
        "main": [
          [
            {
              "node": "Update in MongoDB1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge18": {
        "main": [
          [
            {
              "node": "mdn to html26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI50": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone VectorDB",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere30": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone VectorDB",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Update in MongoDB1": {
        "main": [
          [
            {
              "node": "Response Back to Polling Webhook1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone VectorDB": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator7",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone VectorDB2": {
        "ai_tool": [
          [
            {
              "node": "RHP Summary Preview Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields2": {
        "main": [
          [
            {
              "node": "DRHP Summary Generator Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields13": {
        "main": [
          [
            {
              "node": "RHP Summary Generator Agent",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook8": {
        "main": [
          []
        ]
      },
      "Embeddings OpenAI51": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone Vector DB3",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone Vector DB3": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI16": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector Store2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields14": {
        "main": [
          [
            {
              "node": "Respond to Webhook13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields17": {
        "main": [
          [
            {
              "node": "Send Error to Backend8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook15": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere5": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector Store2",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model14": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Chat Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI22": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store2",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere6": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store2",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "DRHP Chat Agent2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RHP Chat Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Chat Agent": {
        "main": [
          [
            {
              "node": "Edit Fields14",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Chat Agent2": {
        "main": [
          [
            {
              "node": "Edit Fields14",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store2": {
        "ai_tool": [
          [
            {
              "node": "DRHP Chat Agent2",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector Store2": {
        "ai_tool": [
          [
            {
              "node": "RHP Chat Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat  Model9": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Chat Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI25": {
        "ai_embedding": [
          [
            {
              "node": "RHP Pinecone Vector Store3",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields20": {
        "main": [
          [
            {
              "node": "Respond to Webhook14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields27": {
        "main": [
          [
            {
              "node": "Send Error to Backend18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook16": {
        "main": [
          [
            {
              "node": "Switch1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere10": {
        "ai_reranker": [
          [
            {
              "node": "RHP Pinecone Vector Store3",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model16": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Chat Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI52": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone Vector Store3",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere31": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone Vector Store3",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Switch1": {
        "main": [
          [
            {
              "node": "DRHP Chat Agent3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "RHP Chat Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "RHP Chat Agent1": {
        "main": [
          [
            {
              "node": "Edit Fields20",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Chat Agent3": {
        "main": [
          [
            {
              "node": "Edit Fields20",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone Vector Store3": {
        "ai_tool": [
          [
            {
              "node": "DRHP Chat Agent3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "RHP Pinecone Vector Store3": {
        "ai_tool": [
          [
            {
              "node": "RHP Chat Agent1",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat  Model": {
        "ai_languageModel": [
          [
            {
              "node": "RHP Chat Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "List All Vector IDs - Page 1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "DRHP Summary Generator Agent2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields6": {
        "main": [
          [
            {
              "node": "RHP Summary Generator Agent1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html27": {
        "main": [
          [
            {
              "node": "Update Summary In MongoDB2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge20": {
        "main": [
          [
            {
              "node": "mdn to html27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model29": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Preview Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model39": {
        "ai_languageModel": [
          [
            {
              "node": "DRHP Summary Generator Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI53": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB9",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB9",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "Webhook17": {
        "main": [
          [
            {
              "node": "Set Execution Info10",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields29",
              "type": "main",
              "index": 0
            },
            {
              "node": "Subquery generator3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Execution Info10": {
        "main": [
          [
            {
              "node": "Respond with Execution ID10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields28": {
        "main": [
          [
            {
              "node": "Send Error to Backend19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Generator Agent3": {
        "main": [
          [
            {
              "node": "DRHP Summary Preview Agent3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Summary Preview Agent3": {
        "main": [
          [
            {
              "node": "mdn to html",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB9": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Generator Agent3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Summary Format Doc5": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Update Summary In MongoDB2": {
        "main": [
          [
            {
              "node": "Response Back To Pollong Webhook2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model40": {
        "ai_languageModel": [
          [
            {
              "node": "Subquery generator3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Subquery generator3": {
        "main": [
          [
            {
              "node": "Code17",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            },
            {
              "node": "Adverse Findings Analyzer3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser5": {
        "ai_outputParser": [
          [
            {
              "node": "Auto-fixing Output Parser5",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser5": {
        "ai_outputParser": [
          [
            {
              "node": "Subquery generator3",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model41": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser5",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code17": {
        "main": [
          [
            {
              "node": "Code18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code18": {
        "main": [
          [
            {
              "node": "Merge19",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Merge19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML12": {
        "main": [
          [
            {
              "node": "Merge20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge19": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "HTML12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html": {
        "main": [
          [
            {
              "node": "Merge20",
              "type": "main",
              "index": 2
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI54": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB10",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere32": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB10",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB10": {
        "ai_tool": [
          [
            {
              "node": "Subquery generator3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI55": {
        "ai_embedding": [
          [
            {
              "node": "DRHP Pinecone VectorDB11",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Reranker Cohere33": {
        "ai_reranker": [
          [
            {
              "node": "DRHP Pinecone VectorDB11",
              "type": "ai_reranker",
              "index": 0
            }
          ]
        ]
      },
      "DRHP Pinecone VectorDB11": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields29": {
        "main": [
          [
            {
              "node": "DRHP Summary Generator Agent3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Embeddings OpenAI56": {
        "ai_embedding": [
          [
            {
              "node": "Fund SOP Pinecone Vector DB4",
              "type": "ai_embedding",
              "index": 0
            }
          ]
        ]
      },
      "Fund SOP Pinecone Vector DB4": {
        "ai_tool": [
          [
            {
              "node": "DRHP Summary Preview Agent3",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "mdn to html28": {
        "main": [
          [
            {
              "node": "Update in MongoDB",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge21": {
        "main": [
          [
            {
              "node": "mdn to html28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Adverse Findings Analyzer3": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Adverse Findings Analyzer": {
        "main": [
          [
            {
              "node": "Code in JavaScript3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Edit Fields23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript3": {
        "main": [
          [
            {
              "node": "Merge21",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Merge20",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code20": {
        "main": [
          [
            {
              "node": "Code21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code21": {
        "main": [
          [
            {
              "node": "Merge22",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Code22": {
        "main": [
          [
            {
              "node": "Merge22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTML": {
        "main": [
          [
            {
              "node": "Merge21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge22": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "HTML",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "pinData": {
      "Webhook9": [
        {
          "headers": {
            "accept": "application/json, text/plain, */*",
            "host": "n8n-excollo.azurewebsites.net",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODViYzE2ZTM5MDEwZGQ4OWU3YjRiYzMiLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE3NTkxMTk1NzksImV4cCI6MTc1OTIwNTk3OX0.yRU5bWBSbTksRrzsXmSvwRAW2hs9kSJj6cXowrtr9dg",
            "max-forwards": "10",
            "origin": "https://rhp-document-summarizer.vercel.app",
            "referer": "https://rhp-document-summarizer.vercel.app/",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-ch-ua": "\"Chromium\";v=\"140\", \"Not=A?Brand\";v=\"24\", \"Google Chrome\";v=\"140\"",
            "sec-ch-ua-mobile": "?0",
            "sec-fetch-site": "cross-site",
            "sec-fetch-mode": "cors",
            "sec-fetch-dest": "empty",
            "x-arr-log-id": "940906dd-ef03-4d24-a45c-652dc5e70870",
            "client-ip": "49.36.237.105:50033",
            "disguised-host": "n8n-excollo.azurewebsites.net",
            "x-site-deployment-id": "n8n-excollo",
            "was-default-hostname": "n8n-excollo.azurewebsites.net",
            "x-forwarded-proto": "https",
            "x-appservice-proto": "https",
            "x-arr-ssl": "2048|256|CN=Microsoft Azure RSA TLS Issuing CA 07, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
            "x-forwarded-tlsversion": "1.3",
            "x-forwarded-for": "49.36.237.105:50033",
            "x-original-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_e60970aa-3a00-4562-abcd-74817bb69062&conversation_history=%5B%5D&timestamp=2025-09-29T10%3A39%3A41.862Z&action=summary&namespace=https_www.vgipl.com_documents_VirtualGalaxy-DRHP-29-10-2024.pdf&documentId=session_46208d20-3409-44f2-9184-d9e87f5412a8&domain=gmail.com",
            "x-waws-unencoded-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_e60970aa-3a00-4562-abcd-74817bb69062&conversation_history=%5B%5D&timestamp=2025-09-29T10%3A39%3A41.862Z&action=summary&namespace=https_www.vgipl.com_documents_VirtualGalaxy-DRHP-29-10-2024.pdf&documentId=session_46208d20-3409-44f2-9184-d9e87f5412a8&domain=gmail.com",
            "x-client-ip": "49.36.237.105",
            "x-client-port": "50033"
          },
          "params": {},
          "query": {
            "message": "Generate DRHP Doc Summary",
            "session_id": "session_e60970aa-3a00-4562-abcd-74817bb69062",
            "conversation_history": "[]",
            "timestamp": "2025-09-29T10:39:41.862Z",
            "action": "summary",
            "namespace": "A-One Steel DRHP.pdf",
            "documentId": "session_46208d20-3409-44f2-9184-d9e87f5412a8",
            "domain": "gmail.com"
          },
          "body": {},
          "webhookUrl": "https://n8n-excollo.azurewebsites.net/webhook/3/summary",
          "executionMode": "production"
        }
      ],
      "Webhook4": [
        {
          "headers": {
            "accept": "application/json, text/plain, */*",
            "host": "n8n-excollo.azurewebsites.net",
            "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36",
            "accept-encoding": "gzip, deflate, br, zstd",
            "accept-language": "en-US,en;q=0.9",
            "authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OGFmZTc3NzM2YjFkMzQ3MGYyYWI4ODEiLCJlbWFpbCI6InNvbnV2QGV4Y29sbG8uY29tIiwicm9sZSI6ImFkbWluIiwiZG9tYWluIjoiZXhjb2xsby5jb20iLCJpYXQiOjE3NTk5ODQyMDUsImV4cCI6MTc2MDA3MDYwNX0.5sxo4qDhWnYiI6mqqFLqosdIrBtd8AePgJtIC2KRPfk",
            "max-forwards": "10",
            "origin": "https://rhp-document-summarizer.vercel.app",
            "referer": "https://rhp-document-summarizer.vercel.app/",
            "sec-ch-ua-platform": "\"macOS\"",
            "sec-ch-ua": "\"Chromium\";v=\"140\", \"Not=A?Brand\";v=\"24\", \"Google Chrome\";v=\"140\"",
            "sec-ch-ua-mobile": "?0",
            "sec-fetch-site": "cross-site",
            "sec-fetch-mode": "cors",
            "sec-fetch-dest": "empty",
            "x-arr-log-id": "e8912390-dfbc-413f-a9fa-9cd9561adef4",
            "client-ip": "49.36.237.105:63792",
            "disguised-host": "n8n-excollo.azurewebsites.net",
            "x-site-deployment-id": "n8n-excollo",
            "was-default-hostname": "n8n-excollo.azurewebsites.net",
            "x-forwarded-proto": "https",
            "x-appservice-proto": "https",
            "x-arr-ssl": "2048|256|CN=Microsoft Azure RSA TLS Issuing CA 07, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
            "x-forwarded-tlsversion": "1.3",
            "x-forwarded-for": "49.36.237.105:63792",
            "x-original-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1&conversation_history=%5B%5D&timestamp=2025-10-09T08%3A35%3A13.356Z&action=summary&namespace=A-One+Steel+DRHP.pdf&documentId=1757740616201-A-One+Steel+DRHP.pdf&domain=excollo.com",
            "x-waws-unencoded-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1&conversation_history=%5B%5D&timestamp=2025-10-09T08%3A35%3A13.356Z&action=summary&namespace=A-One+Steel+DRHP.pdf&documentId=1757740616201-A-One+Steel+DRHP.pdf&domain=excollo.com",
            "x-client-ip": "49.36.237.105",
            "x-client-port": "63792"
          },
          "params": {},
          "query": {
            "message": "Generate DRHP Doc Summary",
            "session_id": "session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1",
            "conversation_history": "[]",
            "timestamp": "2025-10-09T08:35:13.356Z",
            "action": "summary",
            "namespace": "A-One Steel DRHP.pdf",
            "documentId": "1757740616201-A-One Steel DRHP.pdf",
            "domain": "excollo.com"
          },
          "body": {},
          "webhookUrl": "https://n8n-excollo.azurewebsites.net/webhook/3/summary",
          "executionMode": "production"
        }
      ]
    },
    "meta": {
      "templateCredsSetupCompleted": true,
      "instanceId": "3fd7699162ed90a852b3862c6bcaec63b4bf632c8811a57ee925967cc60997af"
    }
  }