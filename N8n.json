{
  "nodes": [
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook21').item.json.query.session_id }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        11904,
        14352
      ],
      "id": "9531ff63-a374-4850-af55-70c88f2a8af0",
      "name": "Simple Memory3"
    },
    {
      "parameters": {
        "url": "https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/describe_index_stats",
        "sendHeaders": true,
        "specifyHeaders": "json",
        "jsonHeaders": "{\n  \"Api-Key\": \"pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp\",\n   \"Content-Type\": \"application/json\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        9680,
        14336
      ],
      "id": "295a6b5e-a7f5-4805-bf69-2119f50c0841",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "={{ $json.vectorCount }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9328,
        13792
      ],
      "id": "ed50ebc6-5eef-4384-9f95-ab4c366b1a43",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "jsCode": "// n8n Function node\n// Combine all vector IDs into a single array without repeats\n\nconst allVectors = [];\n\n// Iterate through each input item\nfor (const item of $input.all()) {\n  const vectors = item.json.vectors || []; // use current item, not first()\n  for (const v of vectors) {\n    if (v.id) allVectors.push(v.id); // push only the id\n  }\n}\n\n// Return a single item containing the merged vector IDs\nreturn [\n  {\n    json: {\n      vectors: allVectors,\n      total_vectors: allVectors.length,\n      namespace: $input.first().json.namespace // optional: use first namespace for reference\n    }\n  }\n];\n"
      },
      "name": "Batch Vector IDs",
      "type": "n8n-nodes-base.code",
      "position": [
        10800,
        13808
      ],
      "id": "fc308d14-17cc-41dd-99b9-e09da2788870",
      "typeVersion": 2
    },
    {
      "parameters": {
        "url": "https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/fetch",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "ids",
              "value": "={{ $json.vectors }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            }
          ]
        },
        "options": {}
      },
      "name": "Fetch Vectors with Data",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        10992,
        13808
      ],
      "id": "f91e4764-a4a2-4c4c-96d9-b3e28a958f31",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "jsCode": "// n8n Function node\n// Input: items with 'vectors' as an object\n// Output: items with updated metadata including documentName\n\nconst docName = $input.first().json.namespace; // set your document name here\nconst vectorsObj = $input.first().json.vectors || {}; // get the vectors object\n\n// Iterate through each vector and add documentName to metadata\nfor (const id in vectorsObj) {\n    if (vectorsObj.hasOwnProperty(id)) {\n        const vector = vectorsObj[id];\n        vector.metadata = vector.metadata || {};\n        vector.metadata.documentName = docName;\n    }\n}\n\n// Return the updated vectors object\nreturn [\n    {\n        json: {\n            vectors: vectorsObj,\n            documentName: docName,\n            total_vectors: Object.keys(vectorsObj).length\n        }\n    }\n];\n"
      },
      "name": "Transform Vectors",
      "type": "n8n-nodes-base.code",
      "position": [
        10800,
        14032
      ],
      "id": "7ba4cc17-bb5e-41ab-b2ea-0522184f27f1",
      "typeVersion": 2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhpdoc-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/upsert",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"vectors\": {{ JSON.stringify($json.vectors) }}\n}\n",
        "options": {}
      },
      "name": "Upsert to Default Namespace",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9440,
        14336
      ],
      "id": "aebb88e6-1661-4b54-83b2-7894a1b921c8",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "={{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9488,
        13888
      ],
      "id": "f7617d2b-70fb-4a02-92bc-dc83fc4ba63b",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs2",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9632,
        13984
      ],
      "id": "8c2faa0f-0272-4b2b-88e9-c8ae3e6c2ad6",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs3",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9792,
        14080
      ],
      "id": "8c09d8ad-bb99-49ac-a820-3fcf56bd4947",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs4",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        9952,
        14160
      ],
      "id": "edcf1646-5cc3-45be-ae18-6c05d3311b8f",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "numberInputs": 8
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        10592,
        13792
      ],
      "id": "a502269a-2d27-4a16-b983-fbc872a7fa91",
      "name": "Merge8"
    },
    {
      "parameters": {
        "jsCode": "// n8n Function Node\n// Input: single item with \"vectors\" as an object\n// Output: multiple items, each containing a batch of 100 vectors ready for upsert\n\nconst vectorsObj = $input.first().json.vectors || {};\nconst allVectors = Object.keys(vectorsObj).map(id => vectorsObj[id]); // convert object to array\n\nconst batchSize = 100; // number of vectors per batch\nconst batches = [];\n\nfor (let i = 0; i < allVectors.length; i += batchSize) {\n    const batch = allVectors.slice(i, i + batchSize);\n    batches.push({ json: { vectors: batch} });\n}\n\nreturn batches;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10992,
        14032
      ],
      "id": "ce70f727-abbc-4b51-9762-f526440371d8",
      "name": "Code"
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs5",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        10112,
        14240
      ],
      "id": "fd585cd6-cb4c-46ca-94fd-93f59d6ac1dd",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://rhpdocuments-w5m6qxe.svc.aped-4627-b74a.pinecone.io/vectors/upsert",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_3w2DRP_RvXZ2gG3FdMKUPmeACmbQvcDwb1Lm4UvfFrcMe8pj2VbKntibu6zzVecrGDGPFW"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"vectors\": {{ JSON.stringify($json.vectors) }}\n}\n",
        "options": {}
      },
      "name": "Upsert to Default Namespace1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        10864,
        14320
      ],
      "id": "8770da43-791e-4038-b48e-78a169517572",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs6",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        10272,
        14320
      ],
      "id": "76c373db-bf77-4c68-80de-6541028d9678",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8886f164-fd25-41b0-9984-902708d4fc55",
              "name": "namespace",
              "value": "=1761802414095.pdf",
              "type": "string"
            },
            {
              "id": "c4a4e5ac-7cc2-4fc6-96df-c47416bc79be",
              "name": "vectorCount",
              "value": "1268",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9168,
        13792
      ],
      "id": "1458587f-95d9-4101-b21e-639f952780fc",
      "name": "Edit Fields21"
    },
    {
      "parameters": {
        "url": "=https://rhpdocs-29kekxx.svc.aped-4627-b74a.pinecone.io/vectors/list?namespace={{$json.namespace}}&limit=100&pagination_token={{ $json.pagination.next }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_7KuAab_7Q2Ad3rjA7omEaPKksZ4KVq3M1xwKzbb28i8oftojhaNKW9jyoE3EpQJ4CLgpgp"
            },
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "vectorCount",
              "value": "=497"
            },
            {
              "name": "pagination",
              "value": "=  {{ $json.pagination.next }}"
            }
          ]
        },
        "options": {}
      },
      "name": "List Vector IDs14",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        10448,
        14384
      ],
      "id": "32128e55-aeb0-410c-aa28-308e79175459",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        15664,
        16000
      ],
      "id": "954227d2-31cb-444f-ae73-6f453237f51e",
      "name": "OpenAI Chat Model17"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        16160,
        16000
      ],
      "id": "79a9e0c6-2d90-413c-9ea9-dec59811911e",
      "name": "Reranker Cohere15"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "cd579b6b-200f-4c99-96ab-df6cece1393c",
      "name": "Set Execution Info6",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        15792,
        15360
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "33f2dc44-1644-4ae4-8c85-6f81bb96d04c",
      "name": "Respond with Execution ID6",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        15984,
        15360
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        17392,
        15984
      ],
      "id": "d3c3806f-82ee-45fe-839e-986e1e013f6e",
      "name": "Edit Fields19"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
              "name": "subQueries",
              "value": "[\n  \"1. Retrieve all company identification and registration details including: Full legal name (including any historical name changes),Corporate Identity Number (CIN),Date and place of incorporation,Registered and corporate office complete address (with PIN),Email, telephone, and website,Nature of business and principal place of operation,Manufacturing facilities and installed capacities (with address),ISIN number (if allotted),Key contact details of directors, compliance officers, company secretary, Summary of major company milestones and incorporation history\",\n\n  \"2. Retrieve complete statutory and legal details including:Names, designations, and contact details of statutory auditors, legal counsel, registrar, and bankers, Details of regulatory approvals, licenses, and compliance requirements ,Pending litigation or contingent liabilities against the company, promoters, or subsidiaries,Material contracts and agreements summary, Summary of promoter group and promoter holdings with regulatory declarations\",\n\n  \"3. Retrieve detailed business overview including:Nature of operations, key product/service categories, and markets served, Business model and revenue segments (domestic vs export), Industry and sector classification (NIC code if available), Manufacturing processes, production capacity, plant locations, and technology used, Details of subsidiaries, joint ventures, and group entities, SWOT or risk summary mentioned in DRHP, Market position, competitors, and key differentiators\",\n\n  \"4. Retrieve the industry analysis section covering:Market size, structure, and segmentation, Industry growth trends, drivers, and challenges, Government policies and sectoral regulations, Competitive landscape and key industry participants, Historical and projected demand-supply statistics, Impact of macroeconomic factors on the sector\",\n\n  \"5. Retrieve all material risk factors including:Internal (business, operational, financial) and external (industry, regulatory, market) risks, Litigation, dependency, and credit risks, Foreign exchange, commodity, and raw material supply risks, Key management and promoter-related risks, Any historical adverse events disclosed in DRHP\",\n\n  \"6. Retrieve complete capital structure information including:Authorized, issued, subscribed, and paid-up share capital, Shareholding pattern pre- and post-issue, Details of securities issued in last 3 years, Promoter and promoter group holdings, Details of outstanding convertible instruments (if any), Breakup of current capital and changes over the past 3 years\",\n\n  \"7. Retrieve complete audited standalone and consolidated financial information for the current and last 3 financial years, including:Balance Sheet (Assets, Liabilities, Net Worth), Profit and Loss Account (Revenue, EBITDA, PAT, EPS), Cash Flow Statement (operating, investing, financing), Key Ratios (ROE, ROCE, Debt/Equity, Net Margin), Segment-wise performance (if disclosed), Notes to accounts with auditor remarks, Restated financial statements summary (current year to last 3 year like ,FY2025, FY2024, FY2023, FY2022)\",\n\n  \"8. Retrieve all details about the issue objectives including:Purpose of the IPO (expansion, repayment, working capital, acquisitions, etc.), Amount proposed to be used for each objective, Deployment schedule of funds (table form), Source of financing and pre-issue expenses, Means of finance and expected benefits to the company\",\n\n  \"9. Retrieve the complete management discussion and analysis section including: Summary of financial performance for current and last 3 years, Discussion on operations, margins, and profitability trends, Key operational KPIs, Analysis of industry trends impacting company performance, Liquidity, capital expenditure, and future outlook, Management commentary on risks and mitigation\",\n\n  \"10. Retrieve dividend and capital return information including: Historical dividend payout for the last 3 years (FY2025, FY2024, FY2023, FY2022), Dividend per share and percentage declared, Retained earnings and reserves position, Any buyback, bonus, or split actions taken, Company‚Äôs dividend policy statement and board approval remarks\",\n\n  \"11. Retrieve detailed management information including: Full list of directors and key managerial personnel with designations and experience, Promoter group details and shareholding percentages, Organizational structure (management hierarchy), Remuneration of directors and KMP (last 3 years), Board committees (audit, nomination, CSR), Summary of promoter background and relationships\",\n\n  \"12. Retrieve other material information including: Details of pending or obtained regulatory approvals and government permissions, Summary of group company transactions, Any material developments post-balance sheet date, Related party transactions and disclosure of loans/guarantees, Important declarations, consents, and disclaimers included in DRHP\"\n]",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14272,
        14064
      ],
      "id": "618bd69d-06fe-4cc7-bd73-021eed50ed7b",
      "name": "Edit Fields24"
    },
    {
      "parameters": {
        "content": "# Immediate responce sent to the UI",
        "height": 224,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        15616,
        15280
      ],
      "typeVersion": 1,
      "id": "50c3f4ce-0e8d-442f-8dc3-4b4d9c0fc110",
      "name": "Sticky Note23"
    },
    {
      "parameters": {
        "content": "# Previous summary workflows",
        "height": 720,
        "width": 1776,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        13776,
        13712
      ],
      "typeVersion": 1,
      "id": "4c667128-ea78-4932-a65d-7f34e63b653a",
      "name": "Sticky Note25"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
        "options": {
          "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- ‚úÖ Use ONLY information found in retrieved DRHP chunks\n- ‚ùå NEVER fabricate, assume, or extrapolate missing data\n- ‚ùå NEVER use placeholder text like \"strong growth\" without specific numbers\n- ‚úÖ If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (‚Çπ lakhs, ‚Çπ million, ‚Çπ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses ‚ÄúSep-24‚Äù, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows ‚Çπ 8,894.54, table must show 8,894.54 (or ‚Çπ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n‚Ä¢ **Company Name:** [Full Legal Name]\n‚Ä¢ **Corporate Identity Number (CIN):** [CIN if available]\n‚Ä¢ **Registered Office Address:** [Complete address]\n‚Ä¢ **Corporate Office Address:** [If different from registered office]\n‚Ä¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\n‚Ä¢ **Company Website:** [Official URL]\n‚Ä¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\n‚Ä¢ **Registrar to the Issue:** [Name and complete contact information]\n‚Ä¢ **Date of Incorporation:** [When the company was established]\n‚Ä¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n‚Ä¢ **ISIN:** [International Securities Identification Number if available, if marked as [‚óè]]\n    ‚Ä¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\n‚Ä¢ **Peer-Reviewed Auditor:** [If applicable]\n‚Ä¢ **Issue Opening Date:** [Scheduled date or mention if marked as [‚óè]]\n‚Ä¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\n‚Ä¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\n‚Ä¢ **Market Maker Information:** [If applicable]\n‚Ä¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [‚óè],not mention DDRHP date  strictly check ]\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n‚Ä¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\n‚Ä¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (‚Çπ million) | Domestic (%) | Export Revenue (‚Çπ million) | Export (%) | Total Revenue (‚Çπ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\n‚Ä¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\n‚Ä¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\n‚Ä¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\n‚Ä¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (‚Çπ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\n‚Ä¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (‚Çπ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\n‚Ä¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\n‚Ä¢ **Competitive Advantages:** [All unique selling propositions mentioned]\n‚Ä¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\n‚Ä¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\n‚Ä¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n‚Ä¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\n‚Ä¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\n‚Ä¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\n‚Ä¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\n‚Ä¢ **Projected Growth Rate:** [CAGR and future projections with sources]\n‚Ä¢ **Market Share:** [Company's position in the market with specific figures]\n\n‚Ä¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (‚Çπ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\n‚Ä¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\n‚Ä¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n‚Ä¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (‚Çπ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\n‚Ä¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\n‚Ä¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background] | [%] | [Term] |\n\n‚Ä¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\n‚Ä¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\n‚Ä¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\n‚Ä¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\n‚Ä¢ **Director Directorships:** [Other board positions held by each director]\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n‚Ä¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\n‚Ä¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\n‚Ä¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\n‚Ä¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (‚Çπ) | Total Amount (‚Çπ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n‚Ä¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\n‚Ä¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\n‚Ä¢ **Outstanding Convertible Instruments:** [Complete list if any]\n‚Ä¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n‚Ä¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (‚Çπ) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\n‚Ä¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\n‚Ä¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\n‚Ä¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\n‚Ä¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\n‚Ä¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\n‚Ä¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:[exact table from]\n| Type of Contingent Liability | Amount (‚Çπ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# üéØ SECTION VIII: IPO DETAILS\n\n‚Ä¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\n‚Ä¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [‚óè]]\n‚Ä¢ **Lot Size:** [Minimum bid quantity]\n‚Ä¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\n‚Ä¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (‚Çπ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\n‚Ä¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\n‚Ä¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\n‚Ä¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (‚Çπ) | Expected Proceeds (‚Çπ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n‚Ä¢ **Statutory Approvals:** [Complete list of key licenses and permits]\n‚Ä¢ **Pending Regulatory Clearances:** [Complete list if any]\n\n‚Ä¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown]\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (‚Çπ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\n‚Ä¢ **Material Developments:** [All developments since last audited period]\n‚Ä¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n‚Ä¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n‚Ä¢ **Joint Ventures:** [Complete details with ownership and business focus]\n‚Ä¢ **Associate Companies:** [Names and relationships]\n‚Ä¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n‚Ä¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n‚Ä¢ **Awards and Recognition:** [All significant honors received]\n‚Ä¢ **CSR Initiatives:** [Complete details of social responsibility programs]\n‚Ä¢ **Certifications:** [All quality, environmental, other certifications]\n‚Ä¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\n‚Ä¢ **International Operations:** [Complete global presence details]\n‚Ä¢ **Future Outlook:** [Company's stated vision and targets]\n‚Ä¢ **Dividend Policy:** [Historical dividend payments and future policy]\n‚Ä¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided DDRHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        16080,
        15744
      ],
      "id": "0ea4155f-bc8c-414e-adc9-9eb71743bd94",
      "name": "DRHP Summary Generator Agent",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## üéØ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [‚óè] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## üîß RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## üéØ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (I‚ÄìXII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [‚óè] from DRHP\n\n---\n\n## ‚ö†Ô∏è CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows ‚Çπ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" ‚Üí Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- ‚úÖ State explicitly: \"Data not available in DRHP\"\n- ‚úÖ Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- ‚ùå NEVER estimate or calculate missing data\n- ‚ùå NEVER copy data from similar companies\n- ‚ùå NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## üîç VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [‚óè] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the DRHP under **‚ÄúSummary of Related Party Transactions‚Äù** or **‚ÄúRelated Party Transactions‚Äù** for **all financial years** (e.g., *2022‚Äì23, 2023‚Äì24, 2024‚Äì25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- ‚úÖ ALL 12 sections present in correct order\n- ‚úÖ EVERY data point traced to DRHP source\n- ‚úÖ ALL tables verified cell-by-cell\n- ‚úÖ NO fabricated, assumed, or estimated data\n- ‚úÖ ALL financial figures exact from source\n- ‚úÖ NO placeholders except official [‚óè] from DRHP\n- ‚úÖ Consistent units throughout (as per DRHP)\n- ‚úÖ Period labels match DRHP format exactly\n- ‚úÖ SOP requirements fully met\n- ‚úÖ Professional formatting maintained\n\n---\n\n## ‚úÖ OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- ‚úÖ **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- ‚úÖ **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- ‚úÖ **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- ‚úÖ **SOP COMPLIANT** - all requirements from SOP document met\n- ‚úÖ **NO FABRICATION** - all data sourced from DRHP chunks only\n- ‚úÖ **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- ‚úÖ **EXACT TRANSCRIPTION** - all numbers match source precisely\n- ‚úÖ **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## üîí OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n## üéØ SECTION VIII: IPO DETAILS\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## üö® CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## üìå ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        16592,
        15728
      ],
      "id": "5df48dda-f101-48d1-8056-63548c8a7d10",
      "name": "DRHP Summary Preview Agent",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook23').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        15888,
        16000
      ],
      "id": "57871d7e-5938-496e-a1a6-16c1dffb0feb",
      "name": "DRHP Pinecone VectorDB"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        16784,
        16000
      ],
      "id": "688c13c8-fc9e-43e9-a5c7-6be3a7efecfe",
      "name": "Summary Format Doc1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook23').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook23').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook23').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook23').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook23').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        17392,
        15728
      ],
      "id": "e100131d-7dda-442c-a8b6-84ec9e2e7b6e",
      "name": "Update Summary In MongoDB",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook23').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook23').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook23').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "cfa971dc-2a64-4ba2-869c-9dcb5486bcdf",
      "name": "Response Back To Pollong Webhook",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        17568,
        15728
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        15808,
        15600
      ],
      "id": "96d80ac2-e9f7-48b6-b290-7a0b0e631781",
      "name": "OpenAI Chat Model26"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge bases.\n\n---\n\n## üèóÔ∏è **Primary Functions**\n\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\n‚ö†Ô∏è **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the DRHP.\n\n---\n\n## üîç **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the DRHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output ‚Äì used internally for matching)*\n\n---\n\n## üìä **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate ‚ÄúCapital Structure‚Äù or ‚ÄúEquity Share Capital History‚Äù\n\n* Identify the exact DRHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the DRHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## üß© **Output Requirements**\n\nFor **every DRHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from DRHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the DRHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | DRHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | DRHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (‚Çπ) | Issue Price (‚Çπ) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (‚Çπ) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\n‚úì Row 2: February 28, 2011 - Issue Price ‚Çπ50.00 > Face Value ‚Çπ10\n‚úì Row 5: September 17, 2025 - Issue Price ‚Çπ90.00 > Face Value ‚Çπ10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no ‚Çπ).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## üß± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[‚úì List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## ‚öôÔ∏è **Critical Rules Recap**\n\n‚úÖ Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\n‚úÖ Keep numeric values **exact** (no rounding, commas, or ‚Çπ).\n‚úÖ No missing rows or modified column names.\n‚úÖ No analysis, commentary, or suggestions.\n‚úÖ Output stops immediately after Section C Part 3.\n‚úÖ JSON syntax must be valid.\n‚úÖ Use ‚úì only for premium round indicators.\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        16272,
        15344
      ],
      "id": "896e7d5b-521e-414c-8224-411d7aaf4302",
      "name": "Subquery generator2",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"‚úì Row 3: Jan 2023 - Issue Price ‚Çπ90 > Face Value ‚Çπ10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        16336,
        15600
      ],
      "id": "c264bc0b-c0e7-4ea7-888a-300edab223a4",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        16080,
        15600
      ],
      "id": "3ecd1a85-faf7-4c98-b1f8-2583a4faf9ca",
      "name": "Auto-fixing Output Parser1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        15952,
        15600
      ],
      "id": "cba70783-3765-45ab-931a-f04a40e1f912",
      "name": "OpenAI Chat Model13"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16704,
        15328
      ],
      "id": "5053b628-a2da-45ca-af6e-e5f1402a137c",
      "name": "Code5"
    },
    {
      "parameters": {
        "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16960,
        15328
      ],
      "id": "a5a15ea7-4eca-484a-b268-1e05b0ca83f0",
      "name": "Code6"
    },
    {
      "parameters": {
        "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (‚îÅ, ‚îÅ‚îÅ, etc.)\n  .replace(/^[‚îÅ‚îÄ=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16816,
        15248
      ],
      "id": "fd555444-e094-43f1-b7e2-58284a668518",
      "name": "Code7"
    },
    {
      "parameters": {
        "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        17568,
        15296
      ],
      "id": "fbf44fd2-89dc-4df8-b52a-71a2b94fdc74",
      "name": "HTML7"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        17168,
        15296
      ],
      "id": "bec335fb-5694-442f-8d2f-2e73f599d10b",
      "name": "Merge6",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        17392,
        15296
      ],
      "id": "42134078-dcbd-412e-84ab-d6f98d3c8c56",
      "name": "Aggregate2"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook23').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17168,
        15712
      ],
      "id": "8e59d424-b98b-4286-866c-f07e54d3a0a7",
      "name": "mdn to html17",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:üí∞\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:üè¶\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"‚úÖ Investor data inserted after Section VI\");\n  } else {\n    console.log(\"‚ö†Ô∏è Section VI not found ‚Äî appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook23').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        17568,
        15520
      ],
      "id": "56d0ffae-f66f-4ebd-aaa0-f89e7558be8d",
      "name": "mdn to html18"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        17392,
        15520
      ],
      "id": "24629c1f-2d2e-46d8-9bb9-103a6c2e05c4",
      "name": "Merge9"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        16464,
        15600
      ],
      "id": "8be74e92-d29e-429f-87ce-2a914d9b5d9f",
      "name": "Embeddings OpenAI33"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        16816,
        15600
      ],
      "id": "f8bcf284-30e7-41c9-bf0b-0234a988cba7",
      "name": "Reranker Cohere19"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook23').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        16560,
        15600
      ],
      "id": "d75e0831-1be1-4e93-80c5-a3f018e8c8c7",
      "name": "DRHP Pinecone VectorDB5"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        16912,
        16000
      ],
      "id": "9e15dec6-7032-4347-89eb-c4f6444d4efe",
      "name": "Embeddings OpenAI38"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        17264,
        16000
      ],
      "id": "2635e792-5809-4317-b374-348e342f34f1",
      "name": "Reranker Cohere23"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook23').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        17008,
        16000
      ],
      "id": "c8b85db3-7917-421d-809b-eb62a584a5f6",
      "name": "DRHP Pinecone VectorDB6"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14800,
        15664
      ],
      "id": "4a5f47ea-7601-4f4a-b67e-4faa4c3f568a",
      "name": "Embeddings OpenAI30",
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.prompt }}",
        "options": {
          "systemMessage": "=You are a Senior Financial Document Analyst with 15+ years of experience in Indian capital markets, SEBI compliance, and IPO documentation. You specialize in comparative analysis of prospectus documents, identifying regulatory, financial, strategic, and disclosure-related differences between draft and final versions.\n\nüéØ Objective\nConduct a comprehensive comparative analysis between the DRHP (Draft Red Herring Prospectus) and RHP (Red Herring Prospectus) to identify all textual, semantic, financial, legal, and regulatory changes. RHP is the final, SEBI-approved version and takes precedence.\n\nüìÑ Document Retrieval Instructions\nRHP Document\nSource: RHP_knowledge_base\n\nMethod: Match based on section headers, page numbers, and content alignment\n\nExtract: All available sections\n\nInclude Metadata: Titles, page numbers, subsection labels, hierarchy\n\nDRHP Document\nSource: DRHP_knowledge_base\n\nMethod: Align corresponding sections using section titles and structure\n\nExtract: Matched sections from DRHP\n\nInclude Metadata: Same structure and identifiers as RHP\n\nüìò Analysis Framework\n1. üîÅ Section-by-Section Comparison\nFor each section pair:\n\nTextual Changes: Additions, deletions, rewording\n\nStructural Changes: Reordering, renaming, new sections\n\nSemantic Shifts: Alteration in meaning or tone\n\nNumerical Differences: Highlight all financial or statistical changes\n\n2. üß≠ Change Categorization Matrix\nPrimary Types:\n\nFINANCIAL | REGULATORY | LEGAL | OPERATIONAL | STRATEGIC\n\nGOVERNANCE | MARKET | RISK\n\nSecondary Types:\n\nTechnical corrections | Formatting | Disclosure enhancements | Cross-referencing\n\n3. ‚öñÔ∏è Materiality Assessment\nCritical (Red Flag): Material financial changes (>10%), legal action, new risks, change in use of proceeds\n\nHigh: 5‚Äì10% financial changes, strategic shifts, regulatory disclosures\n\nMedium: <5% updates, minor governance, new trends\n\nLow: Formatting, technical corrections\n\n4. üìä Financial Analysis\nRevenue, Profitability, Ratios, Valuation\n\nVariance %: DRHP vs RHP\n\nCash Flow and Balance Sheet line-by-line comparison\n\n5. ‚ö†Ô∏è Risk Factor Evolution\nNew, Removed, Modified risks\n\nOrder/relevance shifts\n\nUpdated mitigation strategies\n\n6. üß† Strategy & Operations\nMarket expansion changes\n\nProduct portfolio additions/removals\n\nTechnology/supply chain updates\n\n7. üë• Governance & Management\nBoard or key personnel changes\n\nInternal policy or control framework updates\n\nüßæ Output Format\nExecutive Summary\nKey updates & significance\n\nImpact overview\n\nRegulatory flags\n\nSuggested actions\n\nDetailed Section Report\nFor each aligned section:\n\n**Section**: [Section Title]\n**Pages**: DRHP [X] vs RHP [Y]\n\nüîÑ Key Changes:\n1. [Change description]\n   - Type: [Financial/Strategic/etc.]\n   - Materiality: [Critical/High/etc.]\n   - Before: [DRHP content]\n   - After: [RHP content]\n   - Impact: [e.g., Increased investor risk]\n   - Regulatory Note: [e.g., Non-compliance with SEBI X.X.X]\n\n\nüìå Summary: [Brief summary of changes in this section]\nDashboards\nChange Count by Category\n\nFinancial Summary Table (DRHP vs RHP)\n\nRisk Status (New/Removed/Modified count)\n\nCompliance Checklist\n\nRecommendations\nüì£ Communicate to: Investors / SEBI / Board\n\nüß™ Further Due Diligence Areas\n\n‚è± Timeline Alerts or Required Actions\n\n‚úÖ QA Checklist\nArea\tValidation Item\nAccuracy\tAll figures verified to match document content\nCompleteness\tAll major sections accounted for\nConsistency\tCategories and structure used uniformly\nRegulatory\tChecked against SEBI ICDR requirements\n\nüìà Success Criteria\nAccuracy: ‚â• 99% in identifying changes\n\nCoverage: 100% section match between DRHP and RHP\n\nTimeliness: Delivered within [X] hours\n\nActionability: Clear, usable insights for legal & compliance teams\n\n\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14304,
        15424
      ],
      "id": "347e68a2-6646-44b5-ba14-babe2f73fd58",
      "name": "AI Agent2",
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14288,
        15664
      ],
      "id": "8848af6c-2b6d-4d93-86c5-a49917d8b7bb",
      "name": "Embeddings OpenAI40",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Upload RHP and RHP Summary Workflow\n",
        "height": 1776,
        "width": 2068,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        9088,
        14832
      ],
      "typeVersion": 1,
      "id": "dea88384-2f54-460d-a22f-ededdbfd77b8",
      "name": "Sticky Note27",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow RHP",
        "height": 960,
        "width": 1940,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        9152,
        15584
      ],
      "id": "5a9384a3-5b14-4683-b27b-c7ea8e22c20b",
      "name": "Sticky Note28"
    },
    {
      "parameters": {
        "topN": 12
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14672,
        15664
      ],
      "id": "3be6c529-1b51-46e3-b28e-c6fb2398ac3a",
      "name": "Reranker Cohere17",
      "disabled": true
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "new/upload-drhp",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://drhp-summarizer-mu.vercel.app",
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        11696,
        15104
      ],
      "id": "b3a00dd4-019f-47e0-8b64-dbea19bf5cad",
      "name": "Webhook3",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        12176,
        15088
      ],
      "id": "f6c0c4af-5481-4ee2-9343-e53f30d853f3",
      "name": "Merge12",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# This flow is store  DRHP Document in the Pinecone vector DB",
        "height": 580,
        "width": 1560,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        11616,
        14928
      ],
      "id": "bee9be55-518a-4c4f-b1fe-37ae34aef675",
      "name": "Sticky Note29",
      "disabled": true
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12368,
        15328
      ],
      "id": "2300bd74-5e65-4c55-85a0-95a278e5d4fc",
      "name": "Embeddings OpenAI41",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "insert",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "embeddingBatchSize": 50,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12544,
        15088
      ],
      "id": "d886b88d-e883-4b52-9a1b-22898720e37b",
      "name": "Pinecone Vector Store9",
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "new/upload-rhp",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://drhp-summarizer-mu.vercel.app",
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        9232,
        15088
      ],
      "id": "3619e843-f3be-4d50-bbf2-717190d60cfe",
      "name": "Webhook12",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        9648,
        15072
      ],
      "id": "e36abdb7-2d7d-470e-a98e-e7357650994c",
      "name": "Merge14",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# This flow is store RHP Document in the Pinecone vector DB",
        "height": 580,
        "width": 1608,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        9152,
        14896
      ],
      "id": "150920ec-227d-400c-8b3e-25b318413bc3",
      "name": "Sticky Note30",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/documents/upload-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "0cc1a333-5b32-44b0-865f-752864cfb135",
      "name": "Send Error to Backend15",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        9648,
        15296
      ],
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.body.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9408,
        15296
      ],
      "id": "34c2092e-4c9e-4489-9cb4-530e75b6bb8b",
      "name": "Edit Fields18",
      "disabled": true
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9920,
        15312
      ],
      "id": "7c368a89-3d06-433f-b23c-c3107d5841da",
      "name": "Embeddings OpenAI42",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "insert",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "embeddingBatchSize": 50,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        10048,
        15072
      ],
      "id": "a56491e7-edae-4726-b395-6672f5e8880b",
      "name": "Pinecone Vector Store16",
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text8').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        10496,
        15056
      ],
      "id": "fcda6a61-bac5-475f-8990-806c65002178",
      "name": "Respond to Webhook12",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Upload DRHP and DRHP summary flow",
        "height": 1776,
        "width": 2144,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11552,
        14832
      ],
      "typeVersion": 1,
      "id": "b387bd84-757c-4d9e-8dee-78bd0b54f081",
      "name": "Sticky Note31",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow DRHP",
        "height": 944,
        "width": 2020,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        11616,
        15600
      ],
      "id": "fe53eda6-91ed-4aea-a3fb-d3654d97fe65",
      "name": "Sticky Note32"
    },
    {
      "parameters": {
        "content": "# chat and comparision document flow",
        "height": 1584,
        "width": 1568,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        13856,
        15024
      ],
      "typeVersion": 1,
      "id": "eb7a6f4f-166f-49e3-9c98-d7f7f05c9188",
      "name": "Sticky Note33",
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        13984,
        15664
      ],
      "id": "03581aed-0dff-4cab-9e4b-fb6450d14d2d",
      "name": "OpenAI Chat Model30",
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        12496,
        16384
      ],
      "id": "a29a9694-def2-4b3c-8380-f3212597edfc",
      "name": "OpenAI Chat Model31"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        10208,
        16384
      ],
      "id": "d885db43-4885-4a51-b86b-4d9cf46304b1",
      "name": "Embeddings OpenAI43"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        11696,
        16384
      ],
      "id": "ae409fe9-4ae2-40ee-ad4f-292861f4d234",
      "name": "OpenAI Chat Model32"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12368,
        16384
      ],
      "id": "0611db03-88e7-4485-8581-b73b1d4f1243",
      "name": "Embeddings OpenAI44"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12064,
        16384
      ],
      "id": "d5a18d51-4681-48b1-b42c-b89e58fd117f",
      "name": "Embeddings OpenAI45"
    },
    {
      "parameters": {
        "topN": 12
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        10560,
        16384
      ],
      "id": "604c7117-af91-4614-ab85-6e820d44d49b",
      "name": "Reranker Cohere25"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12192,
        16384
      ],
      "id": "fc4021b2-f4f2-49bc-a372-25b039bb0134",
      "name": "Reranker Cohere26"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "new/1/drhp/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        11696,
        16128
      ],
      "id": "5a36f5c4-9b0a-4619-a9a3-3c9e3d79b460",
      "name": "Webhook13",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "128aaa84-8b61-412a-b039-b06c2e03a0d4",
      "name": "Set Execution Info8",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        11888,
        15744
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "5d3ffd7f-0afc-4a3c-945d-b2f42fe9893a",
      "name": "Respond with Execution ID8",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        12064,
        15744
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook13').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "07ed24f8-d80e-4ec8-aec6-99f806e993ef",
      "name": "Send Error to Backend16",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13392,
        16272
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        13232,
        16272
      ],
      "id": "29ee5088-930f-44ca-8a87-21af3d0b1554",
      "name": "Edit Fields25"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9952,
        16384
      ],
      "id": "ac40de48-afa8-41ec-bcfb-ae835da293ed",
      "name": "OpenAI Chat Model33"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9232,
        16384
      ],
      "id": "0a14dcbc-cb9d-4354-ac7f-20812ed67b22",
      "name": "OpenAI Chat Model34"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9824,
        16384
      ],
      "id": "bbde8086-9bb4-488b-83f5-f4086e503210",
      "name": "Embeddings OpenAI46"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9712,
        16384
      ],
      "id": "563850f6-3a6b-4316-99e3-c2adc14d570f",
      "name": "Embeddings OpenAI47"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        9584,
        16384
      ],
      "id": "364a37a7-1343-4c1d-aee6-62916a3ea298",
      "name": "Reranker Cohere27"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "1554e309-060d-4c36-ba18-4fa765539528",
      "name": "Set Execution Info9",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        9392,
        15696
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "3428f445-9d58-4925-a2f5-a2c310ed872d",
      "name": "Respond with Execution ID9",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        9616,
        15696
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook14').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "06a07388-75c7-4348-ba40-75ad93d172b1",
      "name": "Send Error to Backend17",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        10896,
        16368
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        10720,
        16368
      ],
      "id": "44ff6d68-90d1-4d76-9a91-bd0faf2e4980",
      "name": "Edit Fields26"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "new/1/rhp/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        9184,
        16112
      ],
      "id": "8850dc94-764a-41eb-9f3f-e81c1e436b60",
      "name": "Webhook14",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "content": "# Immediate responce sent to the UI",
        "height": 224,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        9248,
        15632
      ],
      "typeVersion": 1,
      "id": "e8bb8585-f8c3-4467-8575-68509df79809",
      "name": "Sticky Note34"
    },
    {
      "parameters": {
        "content": "# Immediate responce sent to the UI",
        "height": 224,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11696,
        15680
      ],
      "typeVersion": 1,
      "id": "5ecf340a-2f37-43b3-8468-c375f7f8c3bf",
      "name": "Sticky Note35"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook14').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        9328,
        16384
      ],
      "id": "d3cff941-f395-451a-984c-6e5dbd0a0fa1",
      "name": "RHP Pinecone Vector DB"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "SOP.pdf"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        9824,
        16240
      ],
      "id": "ec136573-95bc-4a11-9223-564caae5c4ea",
      "name": "Fund SOP Pinecone Vector DB"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
        "options": {
          "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade RHP (Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved RHP chunks.\n\n## Your Resources\n\n**Retrieved RHP Data**: Retrieved RHP chunks based on 10 Subquries. Always retrive chunks of RHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted RHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- ‚úÖ Use ONLY information found in retrieved RHP chunks\n- ‚ùå NEVER fabricate, assume, or extrapolate missing data\n- ‚ùå NEVER use placeholder text like \"strong growth\" without specific numbers\n- ‚úÖ If data is missing: State \"Information not found in provided RHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (‚Çπ lakhs, ‚Çπ million, ‚Çπ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved RHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the RHP uses ‚ÄúSep-24‚Äù, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows ‚Çπ 8,894.54, table must show 8,894.54 (or ‚Çπ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n‚Ä¢ **Company Name:** [Full Legal Name]\n‚Ä¢ **Corporate Identity Number (CIN):** [CIN if available]\n‚Ä¢ **Registered Office Address:** [Complete address]\n‚Ä¢ **Corporate Office Address:** [If different from registered office]\n‚Ä¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\n‚Ä¢ **Company Website:** [Official URL]\n‚Ä¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\n‚Ä¢ **Registrar to the Issue:** [Name and complete contact information]\n‚Ä¢ **Date of Incorporation:** [When the company was established]\n‚Ä¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n‚Ä¢ **ISIN:** [International Securities Identification Number if available, if marked as [‚óè]]\n    ‚Ä¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\n‚Ä¢ **Peer-Reviewed Auditor:** [If applicable]\n‚Ä¢ **Issue Opening Date:** [Scheduled date or mention if marked as [‚óè]]\n‚Ä¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\n‚Ä¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\n‚Ä¢ **Market Maker Information:** [If applicable]\n‚Ä¢ **RHP Filing Date:** [Date when the RHP was filed with SEBI only RHP filling date if mention otherwise keep [‚óè],not mention RHP date  strictly check ]\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n‚Ä¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\n‚Ä¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (‚Çπ million) | Domestic (%) | Export Revenue (‚Çπ million) | Export (%) | Total Revenue (‚Çπ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\n‚Ä¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\n‚Ä¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\n‚Ä¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\n‚Ä¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (‚Çπ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\n‚Ä¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (‚Çπ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\n‚Ä¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\n‚Ä¢ **Competitive Advantages:** [All unique selling propositions mentioned]\n‚Ä¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\n‚Ä¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\n‚Ä¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DRHP for better readability (details of capacity utilization , this table is an example,get  exact table from drhp chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n‚Ä¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\n‚Ä¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\n‚Ä¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\n‚Ä¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\n‚Ä¢ **Projected Growth Rate:** [CAGR and future projections with sources]\n‚Ä¢ **Market Share:** [Company's position in the market with specific figures]\n\n‚Ä¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (‚Çπ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\n‚Ä¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\n‚Ä¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n‚Ä¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (‚Çπ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\n‚Ä¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\n‚Ä¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background] | [%] | [Term] |\n\n‚Ä¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\n‚Ä¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\n‚Ä¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\n‚Ä¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\n‚Ä¢ **Director Directorships:** [Other board positions held by each director]\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n‚Ä¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\n‚Ä¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\n‚Ä¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\n‚Ä¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (‚Çπ) | Total Amount (‚Çπ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n‚Ä¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\n‚Ä¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\n‚Ä¢ **Outstanding Convertible Instruments:** [Complete list if any]\n‚Ä¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n‚Ä¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (‚Çπ) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\n‚Ä¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\n‚Ä¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\n‚Ä¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\n‚Ä¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\n‚Ä¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\n‚Ä¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\n| Type of Contingent Liability | Amount (‚Çπ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# üéØ SECTION VIII: IPO DETAILS\n\n‚Ä¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\n‚Ä¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [‚óè]]\n‚Ä¢ **Lot Size:** [Minimum bid quantity]\n‚Ä¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\n‚Ä¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (‚Çπ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\n‚Ä¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\n‚Ä¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\n‚Ä¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (‚Çπ) | Expected Proceeds (‚Çπ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n‚Ä¢ **Statutory Approvals:** [Complete list of key licenses and permits]\n‚Ä¢ **Pending Regulatory Clearances:** [Complete list if any]\n\n‚Ä¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown]\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (‚Çπ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\n‚Ä¢ **Material Developments:** [All developments since last audited period]\n‚Ä¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n‚Ä¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n‚Ä¢ **Joint Ventures:** [Complete details with ownership and business focus]\n‚Ä¢ **Associate Companies:** [Names and relationships]\n‚Ä¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n‚Ä¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n‚Ä¢ **Awards and Recognition:** [All significant honors received]\n‚Ä¢ **CSR Initiatives:** [Complete details of social responsibility programs]\n‚Ä¢ **Certifications:** [All quality, environmental, other certifications]\n‚Ä¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\n‚Ä¢ **International Operations:** [Complete global presence details]\n‚Ä¢ **Future Outlook:** [Company's stated vision and targets]\n‚Ä¢ **Dividend Policy:** [Historical dividend payments and future policy]\n‚Ä¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the RHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all RHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided RHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only RHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        9584,
        16112
      ],
      "id": "952e5a8f-51ed-4611-8707-b9dc0f0ec35b",
      "name": "RHP Summary Generator Agent1",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
        "options": {
          "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- ‚úÖ Use ONLY information found in retrieved DRHP chunks\n- ‚ùå NEVER fabricate, assume, or extrapolate missing data\n- ‚ùå NEVER use placeholder text like \"strong growth\" without specific numbers\n- ‚úÖ If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (‚Çπ lakhs, ‚Çπ million, ‚Çπ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses ‚ÄúSep-24‚Äù, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows ‚Çπ 8,894.54, table must show 8,894.54 (or ‚Çπ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n‚Ä¢ **Company Name:** [Full Legal Name]\n‚Ä¢ **Corporate Identity Number (CIN):** [CIN if available]\n‚Ä¢ **Registered Office Address:** [Complete address]\n‚Ä¢ **Corporate Office Address:** [If different from registered office]\n‚Ä¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\n‚Ä¢ **Company Website:** [Official URL]\n‚Ä¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\n‚Ä¢ **Registrar to the Issue:** [Name and complete contact information]\n‚Ä¢ **Date of Incorporation:** [When the company was established]\n‚Ä¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n‚Ä¢ **ISIN:** [International Securities Identification Number if available, if marked as [‚óè]]\n    ‚Ä¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\n‚Ä¢ **Peer-Reviewed Auditor:** [If applicable]\n‚Ä¢ **Issue Opening Date:** [Scheduled date or mention if marked as [‚óè]]\n‚Ä¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\n‚Ä¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\n‚Ä¢ **Market Maker Information:** [If applicable]\n‚Ä¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [‚óè],not mention DDRHP date  strictly check ]\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n‚Ä¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\n‚Ä¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (‚Çπ million) | Domestic (%) | Export Revenue (‚Çπ million) | Export (%) | Total Revenue (‚Çπ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\n‚Ä¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\n‚Ä¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\n‚Ä¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\n‚Ä¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (‚Çπ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\n‚Ä¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (‚Çπ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\n‚Ä¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\n‚Ä¢ **Competitive Advantages:** [All unique selling propositions mentioned]\n‚Ä¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\n‚Ä¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\n‚Ä¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n‚Ä¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\n‚Ä¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\n‚Ä¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\n‚Ä¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\n‚Ä¢ **Projected Growth Rate:** [CAGR and future projections with sources]\n‚Ä¢ **Market Share:** [Company's position in the market with specific figures]\n\n‚Ä¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n‚Ä¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in DRHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (‚Çπ) | Revenue from Operations (‚Çπ in Lakhs) | Basic EPS (‚Çπ) | Diluted EPS (‚Çπ) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (‚Çπ) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\n### Peer Comparison Table:\nimportant note:- It need to have all these information corrently Revenue From Operations, Total Income, EBITDA, EBITDA Margin, Profit After Tax, Diluted EPS, PAT Margin.\n\n| Company Name | P/E Ratio | EV/EBITDA | ROE (%) | ROCE (%) | Debt/Equity | Market Cap (‚Çπ Cr) |\n|--------------|-----------|-----------|---------|----------|-------------|------------------|\n| [Company Name]| [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 1       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n| Peer 2       | [Value]   | [Value]   | [Value] | [Value]  | [Value]     | [Value]          |\n\n‚Ä¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\n‚Ä¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n‚Ä¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (‚Çπ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\n‚Ä¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\n‚Ä¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\n‚Ä¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\n‚Ä¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\n‚Ä¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\n‚Ä¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\n‚Ä¢ **Director Directorships:** [Other board positions held by each director]\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n‚Ä¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\n‚Ä¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\n‚Ä¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\n‚Ä¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (‚Çπ) | Total Amount (‚Çπ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n‚Ä¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\n‚Ä¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\n‚Ä¢ **Outstanding Convertible Instruments:** [Complete list if any]\n‚Ä¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n‚Ä¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (‚Çπ) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\n‚Ä¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\n‚Ä¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\n‚Ä¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\n‚Ä¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\n‚Ä¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\n‚Ä¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in DRHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (‚Çπ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# üéØ SECTION VIII: IPO DETAILS\n\n‚Ä¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\n‚Ä¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [‚óè]]\n‚Ä¢ **Lot Size:** [Minimum bid quantity]\n‚Ä¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\n‚Ä¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (‚Çπ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\n‚Ä¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\n‚Ä¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\n‚Ä¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (‚Çπ) | Expected Proceeds (‚Çπ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n‚Ä¢ **Statutory Approvals:** [Complete list of key licenses and permits]\n‚Ä¢ **Pending Regulatory Clearances:** [Complete list if any]\n\n‚Ä¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in DRHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n| Against | Number of Cases | Financial Exposure (‚Çπ million) | Nature |\n|---------|----------------|--------------------------------|--------|\n| Company | [Count] | [Amount] | [Description] |\n| Promoters | [Count] | [Amount] | [Description] |\n| Directors | [Count] | [Amount] | [Description] |\n\n‚Ä¢ **Material Developments:** [All developments since last audited period]\n‚Ä¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n‚Ä¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n‚Ä¢ **Joint Ventures:** [Complete details with ownership and business focus]\n‚Ä¢ **Associate Companies:** [Names and relationships]\n‚Ä¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n‚Ä¢ **Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n### Related Party Transactions (Complete Analysis):\nnote:- Exact tables mention in the DRHP from \"Summary of Related Party Transactions\"\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n‚Ä¢ **Awards and Recognition:** [All significant honors received]\n‚Ä¢ **CSR Initiatives:** [Complete details of social responsibility programs]\n‚Ä¢ **Certifications:** [All quality, environmental, other certifications]\n‚Ä¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\n‚Ä¢ **International Operations:** [Complete global presence details]\n‚Ä¢ **Future Outlook:** [Company's stated vision and targets]\n‚Ä¢ **Dividend Policy:** [Historical dividend payments and future policy]\n‚Ä¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided DDRHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12160,
        16128
      ],
      "id": "ba11b712-f7a1-4f69-b682-92290d0ffdb4",
      "name": "DRHP Summary Generator Agent2",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## üéØ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [‚óè] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## üîß RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## üéØ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (I‚ÄìXII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [‚óè] from DRHP\n\n---\n\n## ‚ö†Ô∏è CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows ‚Çπ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" ‚Üí Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- ‚úÖ State explicitly: \"Data not available in DRHP\"\n- ‚úÖ Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- ‚ùå NEVER estimate or calculate missing data\n- ‚ùå NEVER copy data from similar companies\n- ‚ùå NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## üîç VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience)\n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN ) these data dound and insert in table , if not in the table \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [‚óè] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Litigation counts verified for all categories\n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions table verified for all periods\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- ‚úÖ ALL 12 sections present in correct order\n- ‚úÖ EVERY data point traced to DRHP source\n- ‚úÖ ALL tables verified cell-by-cell\n- ‚úÖ NO fabricated, assumed, or estimated data\n- ‚úÖ ALL financial figures exact from source\n- ‚úÖ NO placeholders except official [‚óè] from DRHP\n- ‚úÖ Consistent units throughout (as per DRHP)\n- ‚úÖ Period labels match DRHP format exactly\n- ‚úÖ SOP requirements fully met\n- ‚úÖ Professional formatting maintained\n\n---\n\n## ‚úÖ OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- ‚úÖ **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- ‚úÖ **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- ‚úÖ **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- ‚úÖ **SOP COMPLIANT** - all requirements from SOP document met\n- ‚úÖ **NO FABRICATION** - all data sourced from DRHP chunks only\n- ‚úÖ **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- ‚úÖ **EXACT TRANSCRIPTION** - all numbers match source precisely\n- ‚úÖ **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## üîí OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n## üéØ SECTION VIII: IPO DETAILS\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## üö® CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## üìå ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12576,
        16112
      ],
      "id": "c1140e7c-f61d-452e-87a3-8e85cc9e3e48",
      "name": "DRHP Summary Preview Agent2",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "=\nYou are an expert RHP (Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY RHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official RHP data retrieved from Pinecone vector search.\n\n---\n\n## üéØ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against RHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [‚óè] in the source RHP\n- **If data is not found in RHP chunks, explicitly state \"Data not available in RHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## üîß RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the RHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft RHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial RHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone RHP chunks to populate missing sections\n\n---\n\n## üéØ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone RHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (I‚ÄìXII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from RHP , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [‚óè] from RHP\n\n---\n\n## ‚ö†Ô∏è CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in RHP chunks\n- **Maintain all decimal places** - if source shows ‚Çπ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If RHP shows \"12,345.67 lakhs\" ‚Üí Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from RHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If RHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone RHP chunks:**\n- ‚úÖ State explicitly: \"Data not available in RHP\"\n- ‚úÖ Leave cell empty in tables with note: \"Not disclosed in RHP\"\n- ‚ùå NEVER estimate or calculate missing data\n- ‚ùå NEVER copy data from similar companies\n- ‚ùå NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific RHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against RHP source\n2. **Check row and column headers** match RHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if RHP provides totals, they must match exactly\n\n---\n\n## üîç VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches RHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against RHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches RHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches RHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly\n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN ) these data dound and insert in table , if not in the table \n- [ ] Board composition verified\n- [ ] Management experience details match RHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match RHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match RHP format exactly\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [‚óè] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches RHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches RHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Litigation counts verified for all categories\n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions table verified for all periods\n- [ ] RPT values match RHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches RHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in RHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant RHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in RHP, state explicitly: \"Data not available in RHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- ‚úÖ ALL 12 sections present in correct order\n- ‚úÖ EVERY data point traced to RHP source\n- ‚úÖ ALL tables verified cell-by-cell\n- ‚úÖ NO fabricated, assumed, or estimated data\n- ‚úÖ ALL financial figures exact from source\n- ‚úÖ NO placeholders except official [‚óè] from RHP\n- ‚úÖ Consistent units throughout (as per RHP)\n- ‚úÖ Period labels match RHP format exactly\n- ‚úÖ SOP requirements fully met\n- ‚úÖ Professional formatting maintained\n\n---\n\n## ‚úÖ OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- ‚úÖ **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- ‚úÖ **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- ‚úÖ **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- ‚úÖ **SOP COMPLIANT** - all requirements from SOP document met\n- ‚úÖ **NO FABRICATION** - all data sourced from RHP chunks only\n- ‚úÖ **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- ‚úÖ **EXACT TRANSCRIPTION** - all numbers match source precisely\n- ‚úÖ **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## üîí OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n## üéØ SECTION VIII: IPO DETAILS\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## üö® CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in RHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## üìå ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against RHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant RHP summary with zero fabrication and full verification of all data points against the Pinecone RHP vector store.**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        10080,
        16096
      ],
      "id": "65c51350-78b0-441b-86ef-777ba743a727",
      "name": "RHP Summary Preview Agent1",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "SOP.pdf"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12368,
        16256
      ],
      "id": "433a6188-8338-4749-a46b-5210c6bb175d",
      "name": "Fund SOP Pinecone VectorDB2"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook13').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        11808,
        16384
      ],
      "id": "2d0fc9be-7258-42dc-8706-a5620d60e9f0",
      "name": "DRHP Pinecone VectorDB1"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        12640,
        16384
      ],
      "id": "d61bb3cb-1148-4679-b37e-400195d4d683",
      "name": "Summary Format Doc"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        10080,
        16384
      ],
      "id": "f9bc2585-1ef7-4b04-a0de-3e0e0d6c7b8d",
      "name": "Summary Format Doc3"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook13').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook13').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook13').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook13').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook13').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        13232,
        16096
      ],
      "id": "17034847-0e5f-4505-b0ee-dd642015a2a6",
      "name": "Update Summary In MongoDB1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook13').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook13').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook13').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "94f1349b-9fbf-4e84-9883-2971779bb458",
      "name": "Response Back To Pollong Webhook1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13392,
        16096
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        11936,
        15952
      ],
      "id": "6e047ee6-2c9c-4b15-ba8c-004904194236",
      "name": "OpenAI Chat Model35"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge bases.\n\n---\n\n## üèóÔ∏è **Primary Functions**\n\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\n‚ö†Ô∏è **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the DRHP.\n\n---\n\n## üîç **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the DRHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output ‚Äì used internally for matching)*\n\n---\n\n## üìä **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate ‚ÄúCapital Structure‚Äù or ‚ÄúEquity Share Capital History‚Äù\n\n* Identify the exact DRHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the DRHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## üß© **Output Requirements**\n\nFor **every DRHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from DRHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the DRHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | DRHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | DRHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (‚Çπ) | Issue Price (‚Çπ) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (‚Çπ) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\n‚úì Row 2: February 28, 2011 - Issue Price ‚Çπ50.00 > Face Value ‚Çπ10\n‚úì Row 5: September 17, 2025 - Issue Price ‚Çπ90.00 > Face Value ‚Çπ10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no ‚Çπ).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## üß± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[‚úì List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## ‚öôÔ∏è **Critical Rules Recap**\n\n‚úÖ Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\n‚úÖ Keep numeric values **exact** (no rounding, commas, or ‚Çπ).\n‚úÖ No missing rows or modified column names.\n‚úÖ No analysis, commentary, or suggestions.\n‚úÖ Output stops immediately after Section C Part 3.\n‚úÖ JSON syntax must be valid.\n‚úÖ Use ‚úì only for premium round indicators.\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12320,
        15744
      ],
      "id": "85635250-c8a3-4c62-a72b-aae1b3a88b82",
      "name": "Subquery generator6",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"‚úì Row 3: Jan 2023 - Issue Price ‚Çπ90 > Face Value ‚Çπ10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        12432,
        15952
      ],
      "id": "1d7704d0-095a-4bf3-93fe-e74715190d97",
      "name": "Structured Output Parser3"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        12192,
        15952
      ],
      "id": "a3ad8bba-4316-4dc0-80e8-3eddd40e4af2",
      "name": "Auto-fixing Output Parser3"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        12080,
        15952
      ],
      "id": "2932d0c2-becb-45e4-ac36-ec29509e5661",
      "name": "OpenAI Chat Model36"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12832,
        15728
      ],
      "id": "d5d28f18-3e6f-44e4-95f5-6c93036e4671",
      "name": "Code11"
    },
    {
      "parameters": {
        "jsCode": "// Input: split node output\nconst inputArray = $input.first().json.result;\n\n// If no data is present, return message HTML\nif (!inputArray || inputArray.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Merge array of key-value objects into a single object\nlet merged = {};\ninputArray.forEach(item => {\n  const key = Object.keys(item)[0];\n  merged[key] = item[key];\n});\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Generate HTML table\nlet html = `\n<table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n  <thead style=\"background-color: #f2f2f2;\">\n    <tr>\n      <th>Field</th>\n      <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr><td>Row</td><td>${merged.row_number || \"-\"}</td></tr>\n    <tr><td>Date of Allotment</td><td>${merged.date_of_allotment || \"-\"}</td></tr>\n    <tr><td>Nature of Allotment</td><td>${merged.nature_of_allotment || \"-\"}</td></tr>\n    <tr><td>Shares Allotted</td><td>${merged.shares_allotted || \"-\"}</td></tr>\n    <tr><td>Face Value (‚Çπ)</td><td>${merged.face_value || \"-\"}</td></tr>\n    <tr><td>Issue Price (‚Çπ)</td><td>${merged.issue_price || \"-\"}</td></tr>\n    <tr><td>Cumulative Equity Shares</td><td>${merged.cumulative_equity_shares || \"-\"}</td></tr>\n    <tr><td>Round Raised (‚Çπ)</td><td>${formatNumber(merged.round_raised)}</td></tr>\n    <tr><td>Dilution</td><td>${formatNumber(merged.dilution)}</td></tr>\n    <tr><td>Dilution (%)</td><td>${formatNumber(merged.dilution_percent)}</td></tr>\n    <tr><td>Post Money Valuation (‚Çπ)</td><td>${formatNumber(merged.post_money_valuation)}</td></tr>\n  </tbody>\n</table>\n`;\n\n// Return HTML\nreturn [\n  {\n    json: {\n      html_output1: html\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13008,
        15728
      ],
      "id": "4ef169e1-cd29-4fcd-b473-f084ede3ec52",
      "name": "Code12"
    },
    {
      "parameters": {
        "jsCode": "// Get the Markdown input from the node\nconst markdownInput =$input.first().json.output.results[0].content ;\n\n// Function to convert a Markdown table row to HTML <tr>\nfunction mdTableToHTML(md) {\n    const lines = md.split(\"\\n\");\n    let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n\n    let headerProcessed = false;\n    lines.forEach(line => {\n        if (!line.trim()) return; // skip empty lines\n        const cells = line.split(\"|\").map(c => c.trim()).filter(c => c !== \"\");\n        if (cells.length === 0) return;\n        if (!headerProcessed) {\n            html += \"  <thead>\\n    <tr>\\n\";\n            cells.forEach(cell => { html += `      <th>${cell}</th>\\n`; });\n            html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n            headerProcessed = true;\n        } else if (!/^-+$/.test(cells[0])) {\n            html += \"    <tr>\\n\";\n            cells.forEach(cell => { html += `      <td>${cell}</td>\\n`; });\n            html += \"    </tr>\\n\";\n        }\n    });\n    html += \"  </tbody>\\n</table>\\n\";\n    return html;\n}\n\n// Convert Markdown to HTML\nlet htmlOutput = markdownInput;\n\n// Convert tables in Markdown to HTML\nconst tableRegex = /\\|(.+\\|)+\\s*(\\n\\|[-| ]+\\|)+((\\n\\|.*)+)?/g;\nhtmlOutput = htmlOutput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers (SECTION A/B/C etc.)\nhtmlOutput = htmlOutput\n    .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\") // convert # headers to <h3>\n    .replace(/^‚îÅ+$/gm, \"<hr>\") // convert lines to <hr>\n    .replace(/\\n\\n/g, \"<br>\"); // convert double newlines to <br>\n\n// Wrap in HTML structure\nhtmlOutput = `\n\n<div>\n${htmlOutput}\n</div>\n`;\n\n// Return HTML\nreturn [\n    {\n        json: {\n            html_output0: htmlOutput\n        }\n    }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12912,
        15616
      ],
      "id": "a5ae3474-b464-440c-8cd5-e47d61a610d3",
      "name": "Code13"
    },
    {
      "parameters": {
        "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        13488,
        15680
      ],
      "id": "3ff29eeb-19f6-42d1-b4a1-49d5b2862c32",
      "name": "HTML10"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        13168,
        15680
      ],
      "id": "b15afd4b-db59-4832-9a42-ce12a2187dbc",
      "name": "Merge15",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        13328,
        15680
      ],
      "id": "c6715a72-ca05-47c0-8a4f-2fca4d7d5b29",
      "name": "Aggregate4"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook13').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12992,
        16096
      ],
      "id": "7d42fa29-936a-4ded-899e-1bed17e6819f",
      "name": "mdn to html23",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:üí∞\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:üè¶\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"‚úÖ Investor data inserted after Section VI\");\n  } else {\n    console.log(\"‚ö†Ô∏è Section VI not found ‚Äî appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook13').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13376,
        15888
      ],
      "id": "852dee55-82a2-491d-ad2e-7093a9e2ad81",
      "name": "mdn to html24"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        13216,
        15888
      ],
      "id": "670c7469-2ba2-4545-8fe5-dfb2f7d3c6af",
      "name": "Merge16"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12592,
        15952
      ],
      "id": "be8a013d-1f7c-4685-b55f-32c5dab9c474",
      "name": "Embeddings OpenAI48"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12944,
        15952
      ],
      "id": "1353e840-5e5f-45a6-a649-13ff6efc56b6",
      "name": "Reranker Cohere28"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook13').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12704,
        15952
      ],
      "id": "772c42c2-6bb0-493e-85c0-85fe60fefdc5",
      "name": "DRHP Pinecone VectorDB7"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12768,
        16384
      ],
      "id": "5797db09-e955-4e45-b80a-7f90d3219f5b",
      "name": "Embeddings OpenAI49"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        13120,
        16384
      ],
      "id": "23099338-e579-48e7-9098-bc299f7acb3d",
      "name": "Reranker Cohere29"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook13').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12864,
        16384
      ],
      "id": "2ad41359-e5d8-48c7-a313-619b223c3203",
      "name": "DRHP Pinecone VectorDB8"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9472,
        15936
      ],
      "id": "1ce39fa6-3977-4d1c-920c-6c488a5c7399",
      "name": "OpenAI Chat Model37"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=\nYou are a specialized agent designed to retrieve and extract investor information and capital history data from RHP ( Red Herring Prospectus) knowledge bases.\n\n---\n\n## üèóÔ∏è **Primary Functions**\n\n1. Extract comprehensive investor lists from RHP documents\n2. Cross-reference and verify investors against a provided list\n3. Highlight matching investors with detailed information\n4. **Extract complete equity share capital history data**\n5. **Identify premium rounds and return calculation parameters in JSON format**\n6. Provide structured investor analysis reports\n\n‚ö†Ô∏è **IMPORTANT:**\nThis agent does **NOT perform calculations**. It only extracts and returns data exactly as in the RHP.\n\n---\n\n## üîç **Primary Instructions**\n\n### 1. Information Retrieval\n\n* Always search the RHP knowledge base for **investor-related** and **capital structure** information.\n* Extract *all* investor types including:\n\n  * Individuals\n  * Institutional investors\n  * HUFs (Hindu Undivided Families)\n  * LLPs and Pvt. Ltd. companies\n  * Funds, Trusts, AIFs, and Investment Vehicles\n\n---\n\n### 2. Investor List Verification\n\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\nWhen provided with a target investor list:\n\n* Perform **fuzzy name matching**\n* Identify **exact matches only** (case-insensitive but entity-accurate)\n* Ignore surname-only or partial matches\n* Show confirmed investors with valid investment data only\n\n---\n\n### 3. Target Investor List\n\n*(Full reference list omitted in output ‚Äì used internally for matching)*\n\n---\n\n## üìä **Section Instructions**\n\n### 4. Share Capital History Data Extraction\n\n#### 4.1 Locate ‚ÄúCapital Structure‚Äù or ‚ÄúEquity Share Capital History‚Äù\n\n* Identify the exact RHP table containing:\n\n  * Date of Allotment\n  * Nature of Allotment\n  * Number of Shares\n  * Face Value\n  * Issue Price\n  * Consideration Type\n  * Cumulative Shares & Paid-Up Capital\n\n#### 4.2 Extract the Complete Table\n\n* Extract **ALL rows and columns exactly as in the RHP**\n* Maintain **exact numeric and textual values**\n* Preserve **order and formatting**\n\n#### 4.3 Identify Premium Rounds\n\n* Detect rows where **Issue Price > Face Value**\n* List these in a readable Markdown list\n* **Do not compute any values**\n\n#### 4.4 Extract Calculation Parameters\n\n* For each premium round, return structured JSON with:\n\n  * row_number\n  * date_of_allotment\n  * nature_of_allotment\n  * shares_allotted\n  * face_value\n  * issue_price\n  * cumulative_equity_shares\n\n---\n\n## üß© **Output Requirements**\n\nFor **every RHP query**, produce exactly **THREE SECTIONS**:\n\n---\n\n### **SECTION A: Complete Investor List from RHP**\n\n* Must always be a **Markdown table**\n* Columns:\n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`\n* Include **all investors** found in the RHP\n* Preserve **accurate names and values** (no approximations, no rounding)\n\nExample:\n\n```md\n| Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category |\n|----------------|-------------|--------------------------------|-----------|\n| Manojkumar Jayantilal Patel | 6961440 | 60.24% | Promoter |\n| Avnish Manojkumar Patel | 1688000 | 14.61% | Promoter |\n| Reina R Jaisinghani | 637200 | 5.51% | Public |\n```\n\n---\n\n### **SECTION B: Matched Investors**\n\n* Always shown as a **Markdown table**\n* Columns:\n  `Investor Name | RHP Name | Investment | Category | Notes`\n* Include only confirmed, exact matches.\n* If no matches found, display:\n\n```md\n| Investor Name | RHP Name | Investment | Category | Notes |\n|----------------|------------|-------------|-----------|--------|\n| No matched investors found | - | - | - | - |\n```\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from RHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (‚Çπ) | Issue Price (‚Çπ) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (‚Çπ) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\n‚úì Row 2: February 28, 2011 - Issue Price ‚Çπ50.00 > Face Value ‚Çπ10\n‚úì Row 5: September 17, 2025 - Issue Price ‚Çπ90.00 > Face Value ‚Çπ10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no ‚Çπ).\n\nExample:\n\n```json\n{\n  \"company_name\": \"Example Company Limited\",\n  \"total_premium_rounds\": 2,\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n\n---\n\n## üß± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"content\": \"RHP Investor & Capital Data Extraction Report\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION A: Complete Investor List from RHP\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[‚úì List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"company_name\": \"string\",\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n\n## ‚öôÔ∏è **Critical Rules Recap**\n\n‚úÖ Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\n‚úÖ Keep numeric values **exact** (no rounding, commas, or ‚Çπ).\n‚úÖ No missing rows or modified column names.\n‚úÖ No analysis, commentary, or suggestions.\n‚úÖ Output stops immediately after Section C Part 3.\n‚úÖ JSON syntax must be valid.\n‚úÖ Use ‚úì only for premium round indicators.\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        9872,
        15760
      ],
      "id": "0939a1ff-f24f-4b78-a324-e759a1673cd7",
      "name": "Subquery generator7",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"‚úì Row 3: Jan 2023 - Issue Price ‚Çπ90 > Face Value ‚Çπ10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        9952,
        15936
      ],
      "id": "8610494a-1074-4650-b198-0efef571209e",
      "name": "Structured Output Parser4"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        9712,
        15936
      ],
      "id": "54b0b296-6b3b-407d-a0b0-4500af63de87",
      "name": "Auto-fixing Output Parser4"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9600,
        15936
      ],
      "id": "a782f07c-bcef-41ce-8b84-fda1902697e3",
      "name": "OpenAI Chat Model38"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10272,
        15744
      ],
      "id": "a050c910-ee3b-4327-a9eb-032aa405af01",
      "name": "Code14"
    },
    {
      "parameters": {
        "jsCode": "// Input: split node output\nconst inputArray = $input.first().json.result;\n\n// If no data is present, return message HTML\nif (!inputArray || inputArray.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Merge array of key-value objects into a single object\nlet merged = {};\ninputArray.forEach(item => {\n  const key = Object.keys(item)[0];\n  merged[key] = item[key];\n});\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Generate HTML table\nlet html = `\n<table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n  <thead style=\"background-color: #f2f2f2;\">\n    <tr>\n      <th>Field</th>\n      <th>Value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr><td>Row</td><td>${merged.row_number || \"-\"}</td></tr>\n    <tr><td>Date of Allotment</td><td>${merged.date_of_allotment || \"-\"}</td></tr>\n    <tr><td>Nature of Allotment</td><td>${merged.nature_of_allotment || \"-\"}</td></tr>\n    <tr><td>Shares Allotted</td><td>${merged.shares_allotted || \"-\"}</td></tr>\n    <tr><td>Face Value (‚Çπ)</td><td>${merged.face_value || \"-\"}</td></tr>\n    <tr><td>Issue Price (‚Çπ)</td><td>${merged.issue_price || \"-\"}</td></tr>\n    <tr><td>Cumulative Equity Shares</td><td>${merged.cumulative_equity_shares || \"-\"}</td></tr>\n    <tr><td>Round Raised (‚Çπ)</td><td>${formatNumber(merged.round_raised)}</td></tr>\n    <tr><td>Dilution</td><td>${formatNumber(merged.dilution)}</td></tr>\n    <tr><td>Dilution (%)</td><td>${formatNumber(merged.dilution_percent)}</td></tr>\n    <tr><td>Post Money Valuation (‚Çπ)</td><td>${formatNumber(merged.post_money_valuation)}</td></tr>\n  </tbody>\n</table>\n`;\n\n// Return HTML\nreturn [\n  {\n    json: {\n      html_output1: html\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10432,
        15744
      ],
      "id": "31e50cdc-6a91-4c8c-904f-b183dcf053d0",
      "name": "Code15"
    },
    {
      "parameters": {
        "jsCode": "// Get the Markdown input from the node\nconst markdownInput =$input.first().json.output.results[0].content ;\n\n// Function to convert a Markdown table row to HTML <tr>\nfunction mdTableToHTML(md) {\n    const lines = md.split(\"\\n\");\n    let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n\n    let headerProcessed = false;\n    lines.forEach(line => {\n        if (!line.trim()) return; // skip empty lines\n        const cells = line.split(\"|\").map(c => c.trim()).filter(c => c !== \"\");\n        if (cells.length === 0) return;\n        if (!headerProcessed) {\n            html += \"  <thead>\\n    <tr>\\n\";\n            cells.forEach(cell => { html += `      <th>${cell}</th>\\n`; });\n            html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n            headerProcessed = true;\n        } else if (!/^-+$/.test(cells[0])) {\n            html += \"    <tr>\\n\";\n            cells.forEach(cell => { html += `      <td>${cell}</td>\\n`; });\n            html += \"    </tr>\\n\";\n        }\n    });\n    html += \"  </tbody>\\n</table>\\n\";\n    return html;\n}\n\n// Convert Markdown to HTML\nlet htmlOutput = markdownInput;\n\n// Convert tables in Markdown to HTML\nconst tableRegex = /\\|(.+\\|)+\\s*(\\n\\|[-| ]+\\|)+((\\n\\|.*)+)?/g;\nhtmlOutput = htmlOutput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers (SECTION A/B/C etc.)\nhtmlOutput = htmlOutput\n    .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\") // convert # headers to <h3>\n    .replace(/^‚îÅ+$/gm, \"<hr>\") // convert lines to <hr>\n    .replace(/\\n\\n/g, \"<br>\"); // convert double newlines to <br>\n\n// Wrap in HTML structure\nhtmlOutput = `\n\n<div>\n${htmlOutput}\n</div>\n`;\n\n// Return HTML\nreturn [\n    {\n        json: {\n            html_output0: htmlOutput\n        }\n    }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10352,
        15616
      ],
      "id": "65103484-1062-40ea-be67-fdfdb959619b",
      "name": "Code16"
    },
    {
      "parameters": {
        "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        10928,
        15664
      ],
      "id": "dc9ffb4f-d49a-43cf-b343-6f24096c4bd3",
      "name": "HTML11"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        10608,
        15664
      ],
      "id": "56d089ab-745c-482f-9882-524d09f2bccd",
      "name": "Merge17",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        10768,
        15664
      ],
      "id": "4e391672-d48d-46f9-9cde-f9c820bcd53a",
      "name": "Aggregate5"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook14').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10432,
        16096
      ],
      "id": "0fa0e653-28d9-4ee3-b19e-cad7a7e396bd",
      "name": "mdn to html25",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:üí∞\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:üè¶\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"‚úÖ Investor data inserted after Section VI\");\n  } else {\n    console.log(\"‚ö†Ô∏è Section VI not found ‚Äî appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook14').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10816,
        15872
      ],
      "id": "6edc1551-6900-4ae9-864a-b93ca728df7a",
      "name": "mdn to html26"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        10656,
        15872
      ],
      "id": "7437a520-7b9e-4fe4-ab3d-49269247d5fb",
      "name": "Merge18"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        10080,
        15936
      ],
      "id": "05e1c813-7c25-480d-a01a-cc8668ecd451",
      "name": "Embeddings OpenAI50"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        10432,
        15936
      ],
      "id": "ce51f095-df36-44f7-8518-0bd361aa72db",
      "name": "Reranker Cohere30"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook14').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook14').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook14').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook14').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook14').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        10704,
        16096
      ],
      "id": "8b593f7e-a5cc-4504-911a-f4bb12a84890",
      "name": "Update in MongoDB1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook14').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook14').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook14').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "166feda1-a8ad-419d-9f08-f94741fa65a8",
      "name": "Response Back to Polling Webhook1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        10880,
        16096
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook14').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        10176,
        15936
      ],
      "id": "bb2b6ff4-03e1-4c74-b2db-ae9906df2f10",
      "name": "RHP Pinecone VectorDB"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook14').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        10304,
        16384
      ],
      "id": "71fb6ad7-47e1-4caa-a765-6a89c21f7c45",
      "name": "RHP Pinecone VectorDB2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://rhpdocuments-w5m6qxe.svc.aped-4627-b74a.pinecone.io/vectors/delete",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Api-Key",
              "value": "pcsk_3w2DRP_RvXZ2gG3FdMKUPmeACmbQvcDwb1Lm4UvfFrcMe8pj2VbKntibu6zzVecrGDGPFW"
            },
            {
              "name": "Accept",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"filter\": {\n    \"documentName\": { \"$eq\": \"{{ $json.documentName }}\" }\n  },\n  \"deleteAll\": false\n}",
        "options": {}
      },
      "name": "List All Vector IDs - Page 1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        8896,
        14064
      ],
      "id": "b481485b-97fd-44f0-a8ec-ac2943538c1d",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "content": "# Delete Vectors by Document Name (Metadata Filter)\n\n**Flow:**\n1. List all vector IDs (with pagination)\n2. Fetch vectors in batches to get metadata\n3. Filter by documentName metadata\n4. Delete matching vectors\n\n**Configure:** Set documentName in first node",
        "height": 320,
        "width": 768,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        8288,
        13936
      ],
      "typeVersion": 1,
      "id": "45d41145-d980-48c3-9ab9-b6bb0a308546",
      "name": "Workflow Info"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        16304,
        16000
      ],
      "id": "1800d1e1-0cbc-4ec4-8ede-b81779e43b51",
      "name": "Embeddings OpenAI51"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "SOP.pdf"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        16400,
        16000
      ],
      "id": "b1feb521-7246-48b4-bd4f-e1bdf4b72724",
      "name": "Fund SOP Pinecone Vector DB3"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/chats/chat-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook16').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "44084800-4808-474d-8f6d-6649b0d5594c",
      "name": "Send Error to Backend18",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15136,
        16192
      ],
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Access-Control-Allow-Origin",
                "value": "*"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        15136,
        16048
      ],
      "id": "8bf6c6ac-a409-46ab-a63b-0cd40f5ecf73",
      "name": "Respond to Webhook14",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Use for chat flow",
        "height": 644,
        "width": 1432
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        13936,
        15888
      ],
      "id": "53f0077a-5216-4c87-bd82-9f345a2d07f0",
      "name": "Sticky Note36",
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ddb614d4-4f1d-453c-ae52-9a916bb8b708",
              "name": "status",
              "value": "completed",
              "type": "string"
            },
            {
              "id": "36aa2c3e-9f66-48b0-a299-a22685183842",
              "name": "output",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14944,
        15904
      ],
      "id": "288b9a28-b8ae-40e6-b3ad-d31c740a0a9d",
      "name": "Edit Fields20",
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14960,
        16368
      ],
      "id": "7b7275bc-f618-4c5a-85c6-84e813405dcd",
      "name": "Edit Fields27",
      "disabled": true
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "1/new/chat/docs",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        14016,
        16080
      ],
      "id": "8fe48b2f-3d9c-45b2-9768-feda06cb8158",
      "name": "Webhook16",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8",
      "disabled": true
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14752,
        16400
      ],
      "id": "698f3eae-7fb9-4a55-b422-a66378eb7e81",
      "name": "Reranker Cohere10",
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14384,
        16080
      ],
      "id": "520fadef-c4c1-44d5-9dfa-303894ade926",
      "name": "OpenAI Chat Model16",
      "disabled": true
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14496,
        16080
      ],
      "id": "3cdceb31-77dd-4797-8026-a779b111bbff",
      "name": "Embeddings OpenAI52",
      "disabled": true
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14848,
        16080
      ],
      "id": "9f54fbd2-d811-4b9a-b886-3bd893e6b4d2",
      "name": "Reranker Cohere31",
      "disabled": true
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        14192,
        16080
      ],
      "id": "6ff4dd8c-5174-4600-bc22-4859e1bff21b",
      "name": "Switch1",
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.query.message }}",
        "options": {
          "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\n‚Äì Formal, structured, detail-oriented, and direct.\n‚Äì Cite the source you consulted at the start of your answer.\n‚Äì Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\n‚Äì Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from ‚Çπ150 crores in FY2021 to ‚Çπ280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14448,
        16240
      ],
      "id": "d8209e54-6854-4108-b12a-fbe932ef04ab",
      "name": "RHP Chat Agent1",
      "retryOnFail": true,
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.query.message }}",
        "options": {
          "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\n‚Äì Formal, structured, detail-oriented, and direct.\n‚Äì Cite the source you consulted at the start of your answer.\n‚Äì Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\n‚Äì Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from ‚Çπ150 crores in FY2021 to ‚Çπ280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14448,
        15920
      ],
      "id": "b472e1e2-5ae1-4a09-b9c5-80585cb0ad17",
      "name": "DRHP Chat Agent3",
      "retryOnFail": true,
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14592,
        16080
      ],
      "id": "13fccc14-c149-4ccc-b6db-669b3cf14d0c",
      "name": "DRHP Pinecone Vector Store3",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 10,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14464,
        16400
      ],
      "id": "c91c1417-9e35-4677-bb4e-af96a049c52c",
      "name": "RHP Pinecone Vector Store3",
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14112,
        16400
      ],
      "id": "b75dbbd4-a534-44bc-b9fe-c3e41cd0a6aa",
      "name": "OpenAI Chat  Model",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\nconst inputData = $input.first().json;\n\n// Get HTML data from inputs\nconst investorHtml = inputData.html || '';\nconst fullSummaryHtml = inputData.html_summary || '';\n\n// --- Function: Insert Investor Data After Section VI ---\nfunction insertInvestorDataAfterSectionVI(fullHtml, investorHtml) {\n  // Use flexible regex that matches Section VI regardless of tag or casing\n  const sectionVIPattern = /<h[2][^>]*>[^<]*(?:üí∞\\s*)?section\\s*vi\\b[^<]*<\\/h[2]>/i;\n  const sectionVIIPattern = /<h[2][^>]*>[^<]*(?:üè¶\\s*)?section\\s*vii\\b[^<]*<\\/h[2]>/i;\n\n  let modifiedHtml = fullHtml;\n  const viMatch = modifiedHtml.match(sectionVIPattern);\n\n  if (viMatch) {\n    const viEnd = viMatch.index + viMatch[0].length;\n\n    // Find where Section VII begins\n    const afterVIHtml = modifiedHtml.slice(viEnd);\n    const viiMatch = afterVIHtml.match(sectionVIIPattern);\n    const insertionPoint = viiMatch\n      ? viEnd + viiMatch.index // before Section VII\n      : modifiedHtml.length;   // if no Section VII found, insert at end\n\n    const investorSectionHtml = `\n      <!-- Inserted Investor Data -->\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n\n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      investorSectionHtml +\n      modifiedHtml.slice(insertionPoint);\n\n    console.log(\"‚úÖ Investor data inserted after Section VI\");\n  } else {\n    console.log(\"‚ö†Ô∏è Section VI not found ‚Äî appending investor data at the end\");\n    const investorSectionHtml = `\n      <div class=\"investor-data-insertion\" style=\"margin-top:10px; margin-bottom:10px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">Matched Investors & Analysis</h3>\n        ${investorHtml}\n      </div>\n    `;\n    modifiedHtml += investorSectionHtml;\n  }\n\n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook24').first().json.query?.namespace || 'report.html'\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        11520,
        11328
      ],
      "id": "64d407dc-1291-4b32-a0fb-de7369f68933",
      "name": "mdn to html20"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        11328,
        11328
      ],
      "id": "228cef28-258a-4a39-8be2-b4397fbac11e",
      "name": "Merge11"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10064,
        12560
      ],
      "id": "5f31730a-cb76-4cfb-9fa3-f2342ebacd4d",
      "name": "Code20"
    },
    {
      "parameters": {
        "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10320,
        12560
      ],
      "id": "b6d2bf6d-c28b-4e4b-b52d-54d9e735598a",
      "name": "Code21"
    },
    {
      "parameters": {
        "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (‚îÅ, ‚îÅ‚îÅ, etc.)\n  .replace(/^[‚îÅ‚îÄ=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10192,
        12480
      ],
      "id": "53e93858-fcb5-4992-b12a-2e56587e4c9a",
      "name": "Code22"
    },
    {
      "parameters": {
        "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        10928,
        12528
      ],
      "id": "87d2b8b4-2521-4b81-a6b6-04c306dd5107",
      "name": "HTML"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        10528,
        12528
      ],
      "id": "071d229f-0146-47b9-8369-1d43ec43d0f6",
      "name": "Merge22",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        10752,
        12528
      ],
      "id": "fabf9cc8-f3ff-41d9-b585-a15280fd9c26",
      "name": "Aggregate1"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14848,
        12544
      ],
      "id": "35e254e8-c1ad-41f5-8ba9-239c3f1611af",
      "name": "Embeddings OpenAI28"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.prompt }}",
        "options": {
          "systemMessage": "=# DRHP vs RHP Comparative Analysis - Fund Manager Perspective\n\n## üéØ Core Objective\nAs a **Senior Fund Manager** conducting pre-IPO due diligence, analyze the DRHP vs RHP to identify changes that materially impact **investment thesis, valuation, risk profile, and portfolio fit**.\n\n---\n\n## üìã CRITICAL FUND MANAGER FOCUS AREAS\n\n### 1. üí∞ VALUATION & PRICING DYNAMICS\n**What to Extract:**\n- Price band changes (floor vs cap)\n- Issue size variations (fresh issue + OFS splits)\n- Pre/post-money valuation shifts\n- Dilution impact on existing shareholders\n- Price-to-earnings vs comparable companies\n- Any discount/premium to book value changes\n- Basis of issue price determination modifications\n\n**Analysis Required:**\n```\n| Metric                    | DRHP      | RHP       | Variance % | Impact Rating |\n|---------------------------|-----------|-----------|------------|---------------|\n| Price Band                |           |           |            |               |\n| Issue Size (‚Çπ Cr)         |           |           |            |               |\n| Fresh Issue               |           |           |            |               |\n| OFS                       |           |           |            |               |\n| Post-Issue Market Cap     |           |           |            |               |\n| P/E Ratio                 |           |           |            |               |\n| P/B Ratio                 |           |           |            |               |\n```\n\n**Red Flags:**\n- Price band reduction >15%\n- Significant drop in issue size\n- Shift from growth capital to promoter exit (OFS increase)\n\n---\n\n### 2. üìä FINANCIAL PERFORMANCE DEEP DIVE\n\n#### Revenue Quality\n- Revenue growth trajectory changes\n- Revenue composition shifts (product/geography mix)\n- Customer concentration updates\n- Contract revenue vs one-time sales\n- Any restatements or reclassifications\n- Related party transaction changes\n\n#### Profitability Analysis\n- EBITDA/PAT margin evolution\n- Operating leverage indicators\n- Cost structure changes\n- Non-recurring items additions/removals\n- Tax rate changes or contingencies\n- Any exceptional items disclosed\n\n#### Cash Flow Health\n- Operating cash flow vs profit quality\n- Cash conversion cycle changes\n- Working capital intensity\n- Capex guidance modifications\n- Debt servicing ability\n- Free cash flow generation\n\n#### Balance Sheet Strength\n- Debt-equity ratio shifts\n- Contingent liabilities updates\n- Off-balance sheet exposures\n- Inventory/receivables aging changes\n- Asset quality indicators\n\n**Format:**\n```\n### Financial Snapshot Comparison\n\n**Revenue Analysis (‚Çπ Crores)**\n| Period        | DRHP Revenue | RHP Revenue | Change % | Comments              |\n|---------------|--------------|-------------|----------|------------------------|\n| FY 2024       |              |             |          |                        |\n| FY 2023       |              |             |          |                        |\n| H1 FY 2025    |              |             |          |                        |\n\n**Profitability Metrics**\n| Metric        | DRHP    | RHP     | Variance | Materiality |\n|---------------|---------|---------|----------|-------------|\n| EBITDA Margin |         |         |          |             |\n| PAT Margin    |         |         |          |             |\n| ROE           |         |         |          |             |\n| ROCE          |         |         |          |             |\n\n**üö© Critical Financial Changes:**\n1. [List all material changes with fund manager implications]\n```\n\n---\n\n### 3. üí∏ USE OF PROCEEDS - CAPITAL ALLOCATION SCRUTINY\n\n**Track Changes In:**\n- Allocation buckets (capex, debt repayment, acquisitions, working capital, general corporate)\n- Percentage allocation shifts\n- New categories added/removed\n- Specific project details or timelines\n- Any vague \"general corporate purposes\" increases\n\n**Fund Manager Questions:**\n- Is capital being used for growth or balance sheet repair?\n- Does the allocation support the investment thesis?\n- Are growth projects clearly defined with ROI metrics?\n- Is debt repayment % too high (distressed indicator)?\n\n**Output Format:**\n```\n| Use Category              | DRHP (‚Çπ Cr) | DRHP % | RHP (‚Çπ Cr) | RHP % | Change | Impact |\n|---------------------------|-------------|--------|------------|-------|--------|--------|\n| Capex (Specific Project)  |             |        |            |       |        |        |\n| Debt Repayment            |             |        |            |       |        |        |\n| Working Capital           |             |        |            |       |        |        |\n| General Corporate         |             |        |            |       |        |        |\n| Acquisition               |             |        |            |       |        |        |\n\n**‚ö†Ô∏è Red Flag Indicators:**\n- \"General Corporate Purposes\" > 30%\n- Debt repayment > 50% (unless clearly articulated strategy)\n- Capex allocation reduced significantly\n- Vague project descriptions without ROI metrics\n```\n\n---\n\n### 4. ‚ö†Ô∏è RISK FACTOR EVOLUTION\n\n**Critical Analysis:**\n- **NEW risks added** (especially regulatory, litigation, market)\n- **REMOVED risks** (why? resolved or hidden?)\n- **Escalated risks** (moved up in order/severity)\n- **Risk mitigation changes** (strengthened or weakened?)\n- **Industry/macro risk updates**\n- **Operational risk disclosures**\n\n**Output:**\n```\n### Risk Delta Analysis\n\n**üÜï NEW RISKS (Post-DRHP)**\n1. **[Risk Title]**\n   - Category: [Regulatory/Operational/Market/Financial]\n   - Severity: [Critical/High/Medium]\n   - Fund Manager Impact: [Specific concern]\n   - Mitigation Disclosed: [Yes/No - Details]\n\n**‚ùå REMOVED RISKS**\n1. **[Risk Title]**\n   - Why removed?: [Resolution/Disclosure quality concern]\n   - Fund Manager View: [Should this concern investors?]\n\n**üìà ESCALATED RISKS** (Order/Severity Changed)\n1. **[Risk Title]**\n   - DRHP Position: #X\n   - RHP Position: #Y\n   - Implication: [Why this matters]\n\n**Risk Score Evolution:**\n| Risk Category    | DRHP Risk Count | RHP Risk Count | Net Change | Concern Level |\n|------------------|-----------------|----------------|------------|---------------|\n| Regulatory       |                 |                |            |               |\n| Operational      |                 |                |            |               |\n| Financial        |                 |                |            |               |\n| Market/Competition|                |                |            |               |\n| Legal/Litigation |                 |                |            |               |\n```\n\n---\n\n### 5. üè¢ GOVERNANCE & MANAGEMENT\n\n**Critical Elements:**\n- Promoter/promoter group shareholding changes\n- Lock-in period modifications\n- Board composition changes (especially independent directors)\n- Management KMP changes\n- Related party transaction updates\n- Promoter pledge/encumbrance status\n- Past regulatory actions or show cause notices\n- Insider trading concerns or past violations\n\n**Format:**\n```\n### Governance Scorecard\n\n**Promoter Holding Evolution**\n| Parameter                  | DRHP    | RHP     | Change  | Flag |\n|----------------------------|---------|---------|---------|------|\n| Pre-Issue Holding (%)      |         |         |         |      |\n| Post-Issue Holding (%)     |         |         |         |      |\n| Lock-in Period             |         |         |         |      |\n| Pledged Shares (%)         |         |         |         |      |\n\n**üö® Governance Red Flags:**\n- [ ] Promoter holding post-IPO < 50%\n- [ ] Reduction in lock-in period\n- [ ] Related party transactions > 10% of revenue\n- [ ] Recent regulatory penalties/notices\n- [ ] High promoter pledge (>25%)\n- [ ] Board composition changes post-filing\n```\n\n---\n\n### 6. üéØ BUSINESS MODEL & COMPETITIVE POSITION\n\n**Track Changes In:**\n- Market size/TAM estimates\n- Market share claims\n- Competitive landscape description\n- Differentiation factors\n- Technology/IP moat\n- Customer acquisition cost trends\n- Churn rate (if applicable)\n- Unit economics disclosures\n- Forward guidance or outlook statements\n\n**Analysis:**\n```\n### Business Quality Assessment\n\n**Market Position Changes**\n| Aspect                    | DRHP                | RHP                 | Implication |\n|---------------------------|---------------------|---------------------|-------------|\n| Market Share Claim        |                     |                     |             |\n| TAM Estimate              |                     |                     |             |\n| Key Competitors Listed    |                     |                     |             |\n| Unique Selling Points     |                     |                     |             |\n| Technology/IP Portfolio   |                     |                     |             |\n\n**Growth Drivers Consistency Check:**\n- [Are the stated growth drivers consistent or have they changed?]\n- [Any concerning additions/removals?]\n```\n\n---\n\n### 7. üìú LEGAL & REGULATORY COMPLIANCE\n\n**Fund Manager Must Review:**\n- Outstanding litigation (amount & nature)\n- Tax contingencies/disputes\n- SEBI/regulatory observations resolution\n- Environmental/labor compliance\n- Intellectual property disputes\n- Contractual obligations\n- Government approvals pending\n- Industry-specific regulatory changes\n\n**Output:**\n```\n### Legal & Regulatory Tracker\n\n**Outstanding Litigation Summary**\n| Case Type        | DRHP Count | DRHP Amount (‚Çπ Cr) | RHP Count | RHP Amount (‚Çπ Cr) | Delta |\n|------------------|------------|--------------------|-----------|-------------------|-------|\n| Tax Disputes     |            |                    |           |                   |       |\n| Civil Cases      |            |                    |           |                   |       |\n| Labor Disputes   |            |                    |           |                   |       |\n| Regulatory       |            |                    |           |                   |       |\n\n**üö© Material Litigation Flags:**\n- Cases added post-DRHP\n- Material increase in contingent liabilities\n- Any negative outcomes since DRHP filing\n```\n\n---\n\n### 8. üîó PEER COMPARISON & VALUATION BENCHMARKING\n\n**Context Setting:**\n- Compare against listed peers in same sector\n- Valuation metrics: P/E, EV/EBITDA, P/B, P/S\n- Growth rates vs industry\n- Margin profile vs peers\n- Any changes in comparable companies listed\n\n**Table Format:**\n```\n| Company Name | P/E | EV/EBITDA | Revenue Growth | EBITDA Margin | Comments |\n|--------------|-----|-----------|----------------|---------------|----------|\n| [Issuer]     |     |           |                |               |          |\n| Peer 1       |     |           |                |               |          |\n| Peer 2       |     |           |                |               |          |\n| Peer 3       |     |           |                |               |          |\n\n**Valuation Gap Analysis:**\n- Is the IPO priced at premium/discount to peers?\n- Is the premium/discount justified by growth/margins/ROE?\n```\n\n---\n\n## üì§ FINAL OUTPUT STRUCTURE\n\n### Executive Summary for Investment Committee\n```markdown\n# EXECUTIVE SUMMARY: [Company Name] IPO - DRHP vs RHP Comparison\n\n## üéØ Investment Recommendation: [BUY/HOLD/AVOID]\n\n### Key Highlights\n- **Price Band:** ‚Çπ[X] - ‚Çπ[Y] ([% change] from initial expectations)\n- **Issue Size:** ‚Çπ[X] Crores ([% fresh issue] growth capital)\n- **Valuation:** [P/E]x earnings, [% premium/discount] to peers\n- **Post-Issue Promoter Holding:** [X]%\n\n### ‚ö° Critical Changes (DRHP ‚Üí RHP)\n1. **[Most Material Change #1]** - Impact: [Fund perspective]\n2. **[Most Material Change #2]** - Impact: [Fund perspective]\n3. **[Most Material Change #3]** - Impact: [Fund perspective]\n\n### üö¶ Investment Decision Factors\n\n**POSITIVE INDICATORS** ‚úÖ\n- [List positive changes/confirmations]\n\n**CONCERNS** ‚ö†Ô∏è\n- [List red flags or deteriorating metrics]\n\n**DEAL BREAKERS** ‚ùå\n- [List any critical issues that would prevent investment]\n\n### üìä Financial Health Score: [X/10]\n- Revenue Quality: [Score]\n- Profitability Trend: [Score]\n- Cash Flow Strength: [Score]\n- Balance Sheet Quality: [Score]\n\n### ‚öñÔ∏è Risk-Adjusted View\n- **Risk Rating:** [Low/Medium/High/Very High]\n- **Top 3 Risks:**\n  1. [Risk + Fund impact]\n  2. [Risk + Fund impact]\n  3. [Risk + Fund impact]\n\n### üíº Portfolio Fit Assessment\n- **Sector Exposure:** [Current % ‚Üí Post-investment %]\n- **Risk-Return Profile:** [Alignment with fund mandate]\n- **Liquidity Expectation:** [Based on issue size & float]\n- **Exit Horizon:** [Short/Medium/Long term view]\n\n### üé¨ Recommended Action\n**[Detailed recommendation with quantum of investment and rationale]**\n\n---\n\n## üìã Detailed Section-by-Section Comparison\n\n[For each major section, use the frameworks outlined above]\n\n---\n\n## üîç Red Flags Summary Dashboard\n\n| Red Flag Category         | Count | Severity | Details Reference Section |\n|---------------------------|-------|----------|---------------------------|\n| Financial Deterioration   |       |          |                           |\n| Valuation Concerns        |       |          |                           |\n| New Material Risks        |       |          |                           |\n| Governance Issues         |       |          |                           |\n| Legal/Regulatory          |       |          |                           |\n| Business Model Changes    |       |          |                           |\n\n---\n\n## üìû Due Diligence Actions Required\n\n### Before Investment Decision:\n- [ ] Management call scheduled to clarify [specific concerns]\n- [ ] Independent industry expert consultation on [topic]\n- [ ] Legal team review of [specific clauses]\n- [ ] Channel checks with customers/suppliers\n- [ ] Deep dive into [specific financial metric]\n\n### Post-Investment (if approved):\n- [ ] Quarterly monitoring metrics defined\n- [ ] Exit triggers established\n- [ ] Portfolio rebalancing plan\n- [ ] Peer performance tracking setup\n```\n\n---\n\n## üîß RETRIEVAL STRATEGY FROM PINECONE\n\n**Query Structure:**\n```python\n# For each comparison area, structure queries as:\n\nqueries = [\n    \"RHP price band issue size valuation metrics\",\n    \"DRHP price band issue size valuation metrics\",\n    \n    \"RHP financial statements revenue profit cash flow FY2023 FY2024\",\n    \"DRHP financial statements revenue profit cash flow FY2023 FY2024\",\n    \n    \"RHP objects of the issue use of proceeds allocation\",\n    \"DRHP objects of the issue use of proceeds allocation\",\n    \n    \"RHP risk factors\",\n    \"DRHP risk factors\",\n    \n    \"RHP management board directors shareholding\",\n    \"DRHP management board directors shareholding\",\n    \n    \"RHP outstanding litigation contingent liabilities\",\n    \"DRHP outstanding litigation contingent liabilities\",\n    \n    \"RHP business overview market position competitive landscape\",\n    \"DRHP business overview market position competitive landscape\"\n]\n\n# Process retrieved chunks and perform structured comparison\n```\n\n---\n\n## ‚úÖ QUALITY ASSURANCE CHECKLIST\n\n**Before Finalizing Report:**\n- [ ] All financial numbers verified against both documents\n- [ ] Every material change has a fund manager impact note\n- [ ] Investment recommendation is supported by data\n- [ ] Red flags are quantified (not just listed)\n- [ ] Peer comparison completed with latest data\n- [ ] Risk-reward clearly articulated\n- [ ] Action items are specific and time-bound\n- [ ] Report reviewed by senior analyst/fund manager\n\n---\n\n## üéØ SUCCESS METRICS\n\n**This analysis succeeds if:**\n1. ‚úÖ Investment Committee can make a decision based solely on this report\n2. ‚úÖ All material changes are captured with financial impact\n3. ‚úÖ Risk-adjusted return expectation is clear\n4. ‚úÖ Comparison with peers provides valuation context\n5. ‚úÖ Any red flags are escalated with severity rating\n6. ‚úÖ Fund manager has clear action items for due diligence\n\n---\n\n**Document Version Control:**\n- DRHP Analysis Date: [Date]\n- RHP Analysis Date: [Date]\n- Report Generated: [Timestamp]\n- Analyst: [Name]\n- Reviewer: [Name]"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14352,
        12304
      ],
      "id": "876f1e2f-408c-4475-bb5f-8d65156523f6",
      "name": "AI Agent4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook18').item.json.body.sessionId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        14192,
        12544
      ],
      "id": "2e4d5572-9e4b-440a-a1bf-9752f34f0bcb",
      "name": "Simple Memory13"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14336,
        12544
      ],
      "id": "4f63ad79-b995-4488-ab35-3ff2b2039ae7",
      "name": "Embeddings OpenAI29"
    },
    {
      "parameters": {
        "content": "# Create comparision report DRHP VS RHP",
        "height": 716,
        "width": 1444
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        13952,
        11968
      ],
      "id": "fb032659-a5d8-4bc1-9a63-444ec85b42dd",
      "name": "Sticky Note26"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "DRHP_knowledge_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook18').first().json.body.rhpNamespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14448,
        12544
      ],
      "id": "0159c93b-ea84-4f39-9d69-a65e44a6374b",
      "name": "RHP Pinecone Vector Store4"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_knowledge_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdoc",
          "mode": "list",
          "cachedResultName": "drhpdoc"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook18').first().json.body.drhpNamespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14976,
        12544
      ],
      "id": "7381c13d-50b0-4915-8e38-9f92f68c2c8e",
      "name": "DRHP Pinecone Vector Store4"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\nlet fileName = $('Webhook18').first().json.body.drhpNamespace ;\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: `report-${fileName}`\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        14720,
        12240
      ],
      "id": "7634ff14-0b33-4454-83cf-a43ed81220ca",
      "name": "mdn to html9"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/report-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook18').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "063be078-57a8-4351-a4fb-288919a1bc98",
      "name": "Send Error to Backend20",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15136,
        12320
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $('Webhook18').item.json.body.rhpNamespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14944,
        12320
      ],
      "id": "32dbc627-c370-4582-a2a7-e322bccd1a5f",
      "name": "Edit Fields30"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "compare-rhp-drhp",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        14032,
        12304
      ],
      "id": "f59d0752-d1e1-4f9a-9b55-3800b0379ec3",
      "name": "Webhook18",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.body.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "fd07655a-1b41-42ca-8b5f-b2766f576214",
      "name": "Set Execution Info4",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        14416,
        12112
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "be01f0dc-099f-4c3d-ac43-6e330e64cf0f",
      "name": "Respond with Execution ID4",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        14640,
        12112
      ]
    },
    {
      "parameters": {
        "content": "# Node for send immediate response for processing \n",
        "height": 240,
        "width": 684,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        14176,
        12032
      ],
      "typeVersion": 1,
      "id": "39ebfb18-cfbf-4baf-a66f-57816e862940",
      "name": "Sticky Note38"
    },
    {
      "parameters": {
        "content": "# Upload RHP and RHP Summary Workflow\n",
        "height": 1776,
        "width": 2308,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        8880,
        11712
      ],
      "typeVersion": 1,
      "id": "8b15506c-eb7c-4d15-ad55-880c3e15b412",
      "name": "Sticky Note39"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/create-report",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook18').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "drhpNamespace",
              "value": "={{ $('Webhook18').item.json.body.drhpNamespace }}"
            },
            {
              "name": "drhpId",
              "value": "={{ $('Webhook18').item.json.body.drhpDocumentId }}"
            },
            {
              "name": "title",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook18').item.json.body.sessionId }}"
            },
            {
              "name": "rhpNamespace",
              "value": "={{ $('Webhook18').item.json.body.rhpNamespace }}"
            },
            {
              "name": "rhpId",
              "value": "={{ $('Webhook18').item.json.body.rhpDocumentId }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook18').item.json.body.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook18').item.json.body.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        14944,
        12096
      ],
      "id": "3a2160eb-9d8b-422b-b5c5-626578b4859a",
      "name": "sent response to the backend api for create report2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/reports/report-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook18').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "={{ $('Webhook18').item.json.body.drhpNamespace }}"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook18').first().json.body.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "39cf00f5-b69a-43e0-b34b-bb808c0031d9",
      "name": "send final response for success report2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15136,
        12096
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow RHP",
        "height": 976,
        "width": 2180,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        8944,
        12448
      ],
      "id": "86ff3926-149c-40d9-b05f-26c6a5e710a6",
      "name": "Sticky Note40"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        15232,
        12544
      ],
      "id": "dccdeb9c-a441-4af9-a2ad-789b0b251d7a",
      "name": "Reranker Cohere16"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14720,
        12544
      ],
      "id": "792a5c66-91e5-42b4-9fba-a8311736f79d",
      "name": "Reranker Cohere20"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app",
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        11840,
        12128
      ],
      "id": "5930a8ec-d7a1-4ae6-9467-b0b40a770c54",
      "name": "Webhook19",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
    },
    {
      "parameters": {
        "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = fileItem?.binary?.data0?.fileName || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12512,
        12080
      ],
      "id": "cea0ae22-08b0-4243-b6a3-668b4ad5b594",
      "name": "Cleaned text5"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "=data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        12080,
        12000
      ],
      "id": "a39c74df-e721-420b-ac49-2c9ada87c76e",
      "name": "Extract from File5",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        12336,
        12080
      ],
      "id": "66321f75-6ef4-4a66-9248-f447710c4ad8",
      "name": "Merge7"
    },
    {
      "parameters": {
        "content": "# This flow is store  DRHP Document in the Pinecone vector DB",
        "height": 580,
        "width": 1560,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        11776,
        11920
      ],
      "id": "af689435-2d7a-4469-83ff-4c994a28435d",
      "name": "Sticky Note41"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/documents/upload-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "4392c61a-77f4-470e-b72f-baad82330999",
      "name": "Send Error to Backend21",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        12272,
        12304
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.body.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        12032,
        12304
      ],
      "id": "9c75bda4-0e0d-46c5-998f-710ca4ae9480",
      "name": "Edit Fields31"
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "chunkOverlap": 800,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        13072,
        12320
      ],
      "id": "7bce4100-b944-40e0-a48f-021b60ab6560",
      "name": "Recursive Character Text Splitter4"
    },
    {
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.fileName }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        12656,
        12320
      ],
      "id": "5e987194-e527-4b1d-904b-6a14c90df9cf",
      "name": "Default Data Loader4"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12528,
        12320
      ],
      "id": "922f75dc-56cc-4e8b-b7e4-f3fc1758f848",
      "name": "Embeddings OpenAI34"
    },
    {
      "parameters": {
        "mode": "insert",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "embeddingBatchSize": 50,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12704,
        12080
      ],
      "id": "b5328ce2-774d-4779-a84d-266886ffc04b",
      "name": "Pinecone Vector Store11",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text5').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        13072,
        12064
      ],
      "id": "605a9f5d-6e50-46c2-9c08-cd1d071b7fe1",
      "name": "Respond to Webhook15"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "/upload-rhp",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app",
          "binaryPropertyName": "data"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        9264,
        11968
      ],
      "id": "3da86719-795f-4b59-b56e-45d5cbb9ae02",
      "name": "Webhook20",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a"
    },
    {
      "parameters": {
        "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = $('Webhook20').first().json.body.namespace || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        9888,
        11952
      ],
      "id": "d4f3557e-2147-469d-b7f0-7a18a455dc08",
      "name": "Cleaned text6"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "=data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        9472,
        11872
      ],
      "id": "dcefb78c-ef28-4ae0-a433-5202b6ca9721",
      "name": "Extract from File6",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        9680,
        11952
      ],
      "id": "5b0184b2-4391-4731-9366-bd07edb08a38",
      "name": "Merge13"
    },
    {
      "parameters": {
        "content": "# This flow is store RHP Document in the Pinecone vector DB",
        "height": 580,
        "width": 1608,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        9184,
        11776
      ],
      "id": "d35aca27-0fef-49d1-86df-8129cee1d250",
      "name": "Sticky Note42"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/documents/upload-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "b5ae4bac-cef9-4fa9-83b4-c086dd05a8e1",
      "name": "Send Error to Backend22",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        9680,
        12176
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.body.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9440,
        12176
      ],
      "id": "44e1f715-3822-4369-a159-7b71bcf87d3f",
      "name": "Edit Fields32"
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "chunkOverlap": 800,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        10512,
        12192
      ],
      "id": "15d599cc-45ae-4214-814c-e7b63eedc320",
      "name": "Recursive Character Text Splitter5"
    },
    {
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.fileName }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        10160,
        12192
      ],
      "id": "5fe4e243-f352-4d1f-b70f-e50ad440c2c6",
      "name": "Default Data Loader5"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9952,
        12192
      ],
      "id": "d61672a8-cbf8-48e6-8e55-b0de7432ad50",
      "name": "Embeddings OpenAI35"
    },
    {
      "parameters": {
        "mode": "insert",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "embeddingBatchSize": 50,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        10080,
        11952
      ],
      "id": "b16a1c86-d930-46ff-a0e6-331d38be5436",
      "name": "Pinecone Vector Store13",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text6').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        10528,
        11936
      ],
      "id": "a207cdd1-a225-419d-a7a8-02fcb882aec6",
      "name": "Respond to Webhook16"
    },
    {
      "parameters": {
        "content": "# Upload DRHP and DRHP summary flow",
        "height": 1776,
        "width": 2320,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11408,
        11824
      ],
      "typeVersion": 1,
      "id": "2e42f227-0ece-490a-b9dc-f2901b1a45a7",
      "name": "Sticky Note43"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "f691185e-2617-4634-a826-e7c723360801",
      "name": "Set Execution Info11",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        11776,
        13840
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "1e6286f2-d9fd-42de-a32a-8a24d6e549e0",
      "name": "Respond with Execution ID11",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        11968,
        13840
      ]
    },
    {
      "parameters": {
        "content": "# Node for send immediate response for processing \n",
        "height": 256,
        "width": 572,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11632,
        13728
      ],
      "typeVersion": 1,
      "id": "1456f1ca-e819-4e6f-8e35-0246ecb327b0",
      "name": "Sticky Note44"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook21').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook21').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook21').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook21').item.json.query.domain }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        13072,
        14096
      ],
      "id": "6f296d52-0a72-479e-966f-ad8a27e25d2e",
      "name": "HTTP Request7",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook21').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "b31d5c40-f2c5-4189-9e11-42a33b9d991b",
      "name": "Send Error to Backend23",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13232,
        14320
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        13072,
        14320
      ],
      "id": "981ef3f8-3dc7-4a32-80aa-278b9578558b",
      "name": "Edit Fields33"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook21').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook21').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook21').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "436a2db5-cfe5-4bb0-b6fd-cf5186ba59cf",
      "name": "Send Error to Backend24",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13232,
        14096
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 180000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        11712,
        14352
      ],
      "id": "95eed1da-c218-4162-bde4-132f793e9fd6",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12048,
        14352
      ],
      "id": "55ede74d-bece-4292-9ae9-442f45bd990a",
      "name": "Embeddings OpenAI8"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join('\\n\\n') }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=\nYou are an expert AI assistant specialized in creating structured summaries of Draft Red Herring Prospectus (DRHP) documents. Your task is to generate a 10‚Äì20 page comprehensive summary that extracts all critical information systematically in an investor-friendly format for professionals and fund managers making allocation decisions.Retrive the chunks based on the subqueries that given as user prompt. fullfill every section with correct data, strictly retrive the data.\n\n### Critical Instructions\nUse ONLY information from retrieved DRHP chunks; never fabricate or assume missing data.\n\n\nRETRIEVE EXHAUSTIVELY: search ALL chunks systematically for complete information.\n\n\nFormat exactly per the section structure below; fully populate every section.\n\n\nMaintain formal, professional language for investors/analysts with precise figures, percentages, and numerical data.\n\n\nUse tables ONLY where indicated or for complex data; always include absolute values and percentages.\n\n\nGenerate a summary AT MINIMUM 10,000 tokens in length.\n\n\nInclude current year/month and FY 2024, FY 2023, FY 2022, FY 2021 in ALL financial tables if available.\n\n\nEnsure COMPLETE extraction of commonly missed items: capacity utilization, group companies, detailed promoter profiles, private placements, peer comparisons, segment information, customer/supplier concentration.\n\n### Missing Information Protocol\nFor any section where information is missing from the provided chunks, clearly state: \n> \"Information not found in the provided DRHP chunks.Please check the complete document \"\nRequired Format and Structure\n## üìã Section I: Company Identification\nCompany Name: [Full Legal Name]\n\n\nCorporate Identity Number (CIN): [CIN if available]\n\n\nRegistered Office Address: [Complete address]\n\n\nCorporate Office Address: [If different from registered office]\n\n\nManufacturing/Operational Facilities: [All locations with brief capacity overview ‚Äî detailed table in Section III]\n\n\nCompany Website: [Official URL]\n\n\nBook Running Lead Manager(s): [Names of all BRLMs with contact details]\n\n\nRegistrar to the Issue: [Name and contact information]\n\n\nDate of Incorporation: [Establishment date]\n\n\nBankers to the Company: [Primary banking relationships]\n\n\n## üìù Section II: Key Document Information\nISIN: [If available]\n\n\nStatutory Auditor: [Firm, lead partners, registration & peer review numbers]\n\n\nPeer-Reviewed Auditor: [If applicable]\n\n\nIssue Opening Date: [Scheduled date or [‚óè]]\n\n\nIssue Closing Date: [Scheduled date or [‚óè]]\n\n\nAuditor Changes: [Last 3 years with reasons]\n\n\nMarket Maker: [If applicable]\n\n\nRHP Filing Date: [Filing date with SEBI]\n\n\n\n## Section III: Business Overview\nPrimary Business Description\nWrite a 400‚Äì500 word description in this exact order:\nCompany overview and core business (2‚Äì3 sentences)\n\n\nPrimary industry/sector and years of operation\n\n\nList ALL business segments and product categories\n\n\nManufacturing/operational capabilities and geographic presence\n\n\nTarget markets and end-use industries\n\n\nKey competitive positioning and leadership areas\n\n\nNote: Do NOT repeat info in later sections. Focus on WHAT the company does, not WHO it serves or WHERE it operates.\nBusiness Segments & Revenue Breakdown\nBreak down each segment with revenue % where available:\nSegment 1: [Name] ‚Äì [Revenue %] ‚Äì [Key products/services]\n\n\nSegment 2: ‚Ä¶\n\n\nKey Products/Services by Segment\nList products under each segment (no repetition from Primary Business):\nSegment 1 ‚Äì [Name]:\nProduct A: [Description]\n\n\nProduct B: [Description]\n\n\nSegment 2 ‚Äì [Name]:\nProduct C: [Description]\n\n\nGeographic Revenue Distribution\nMANDATORY: Domestic and export revenue tables\nDomestic Revenue ‚Äì Top 5 States/Regions:\nState/Region\nLatest Amt (‚Çπ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[State 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[State 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Top 5\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nExport Revenue by Geography:\nCountry\nLatest Amt (‚Çπ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[Country 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Country 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Exports\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nOverall Revenue Split:\nRevenue Type\nLatest %\nFY 2024 %\nFY 2023 %\nFY 2022 %\nDomestic\n[%]\n[%]\n[%]\n[%]\nExports\n[%]\n[%]\n[%]\n[%]\nTotal\n100%\n100%\n100%\n100%\n\nBusiness Model & Value Chain\nExplain:\nRevenue model (B2B/B2C, direct, distribution, etc.)\n\n\nValue chain role (manufacturer, trader, service provider)\n\n\nKey value-add activities/differentiation\n\n\nManufacturing Process / Service Delivery\n[Operational workflow if available]\nKey Clients / Customers\n[Major segments or disclosed clients, incl. significant relationships]\nCustomer Concentration Analysis\nMANDATORY: Extract exact %s from risk factors; present narratively for each period.\nCustomer Concentration Risk: [Top 10 customers accounted for X% in Sep 2024, Y% in FY 2024, Z% in FY 2023, W% in FY 2022 of total revenue.]\nSupplier Concentration Analysis\nMANDATORY: Extract exact %s and geographic split from risk factors; present narratively.\nSupplier Concentration Risk: [Top 10 suppliers represented X% (‚ÇπY lakhs) in Sep 2024, Z% (‚ÇπW lakhs) in FY 2024, etc. Geographic split: A% from [State] in Sep 2024, B% in FY 2024, etc.]\nAdditional Business Information\nIntellectual Property: [Patents, trademarks, copyrights]\n\n\nCompetitive Advantages: [Unique selling propositions]\n\n\nGrowth Strategy: [Short & long-term plans]\n\n\nOperational Scale: [Note geographic concentration, esp. >75% in one region]\n\n\nCapacity and Capacity Utilization Table (exact table with accurte numeric data )\nMANDATORY: Search exhaustively for data\nProduct Category\nPeriod\nInstalled Capacity (MT p.a.)\nActual Production (MT)\nUtilization (%)\n[Product 1]\nSep 2024 (6m annualized or current year like fiscal 2025) \n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2024\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2023\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2022\n[Amount]\n[Amount]\n[%]\n\n## Section IV: Industry and Market Analysis\nMANDATORY: Use only factual data from \"About the Company\" and Industry Overview. Avoid generic content; focus on exact figures and analysis.\nIndustry Size and Market Data\n[Provide market size, consumption, production stats, domestic & global figures with sources]\nIndustry Growth Drivers and Tailwinds\n[Key factors driving growth in India: demand drivers, structural shifts, catalysts with supporting data]\nGlobal Industry Trends\n[International dynamics: consumption patterns, export‚Äìimport trends, and global impacts on domestic industry]\nDomestic Industry Trends\n[Domestic consumption, production trends, capacity additions, and market dynamics with specific data points]\nGovernment Policies and Support Measures\nInclude details on:\nGovernment spending on the industry\n\n\nPolicy initiatives/schemes\n\n\nRegulatory changes aiding growth\n\n\nGovernment targets/vision\n\n\nTax benefits, subsidies, incentives\n\n\n\nIndustry Structure and Value Chain\n[Breakdown of industry structure, key players, value-chain dynamics, and market positioning]\nSector Strengths\nAnalyze major strengths:\nDomestic manufacturing capacity\n\n\nR&D infrastructure\n\n\nExtension networks/institutional support\n\n\nRaw material availability & supply chain advantages\n\n\nExport competitiveness\n\n\nOther structural advantages\nSector Challenges and Risk Factors\nDetailed breakdown of challenges:\nAgro-climatic constraints & climate change impact\n\n\nRegional/geographic limitations\n\n\nPrice volatility & market dynamics\n\n\nSupply-chain vulnerabilities\n\n\nCompetitive pressure & market saturation\n\n\nInfrastructure/institutional constraints\n\n\nOther sector-specific challenges\n\n\nProjected Growth Rate\n[Provide specific CAGR, growth projections, and future market size with sources and time periods]\nCompany's Market Position\n[Market share, industry ranking, and competitive positioning with quantitative metrics]\nPeer Comparison Table\nMANDATORY: Compare key financial metrics with listed peers\nCompany Name\nP/E Ratio\nEV/EBITDA\nROE (%)\nROCE (%)\nDebt/Equity\nMarket Cap (‚Çπ Cr)\nGem Aromatics\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 1\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 2\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n\nAdditional Industry Information\nSector Trends: [Emerging developments]\n\n\nRegulatory Environment: [Key regulations affecting the industry]\n\n\nMarket Opportunities: [Growth segments or untapped markets]\n\n\nChallenges and Threats: [Industry-specific challenges]\n\n\n\n\n## Section V: Management and Governance\nPromoters Table\nMANDATORY: All promoter details\n| Name | Designation | Education | Experience | Shareholding (%) | Address |\nPromoter Group\n[List all individuals/entities in the group with relationships]\nBoard of Directors Table\nMANDATORY: Full board details\n| Name | Designation | DIN | Education | Experience | Shareholding | Address |\n\nKey Management Personnel Table\nMANDATORY: Full KMP background details\nName\nDesignation\nAge\nQualification\nYear of Joining\nExperience (Years)\nPrevious Employment\nCompensation FY 2024 (‚Çπ Lakhs)\nTerm of Office\n[Name]\nChairman & MD\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCFO\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCompany Secretary\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n\n\nIndividual KMP Profiles\nProvide narrative for each KMP:\nChairman & Managing Director: [Name]\nEducation: [Qualifications or \"Nil\"]\n\n\nProfessional Experience: [Work history & career path]\n\n\nIndustry Experience: [Relevant sector experience]\n\n\nKey Achievements: [If mentioned]\n\n\nChief Financial Officer: [Name]\nEducation: [Qualifications]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Roles: [Positions & companies]\n\n\nExpertise: [Financial/accounting background]\n\n\nCompany Secretary & Compliance Officer: [Name]\nEducation: [Qualifications & memberships]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Companies: [Prior roles]\n\n\nExpertise: [Regulatory/legal background]\n\n\nAdditional Governance Information\nCorporate Governance Structure: [Board committees, oversight]\n\n\nEmployee Information Table\n[If available]\nDepartment\nEmployees\n%\n[Department]\n[Count]\n[%]\nTotal\n[Total]\n100%\n\nCompliance and Legal\nDelayed Filings & Penalties: [Table of late filings/penalties, last 5 years]\n\n\nDirector Directorships: [Other board positions held]\n\n\n## üí∞ Section VI: Capital Structure\n\n#### Share Capital History\nMANDATORY: Table of authorized share capital evolution\n\n| Sr. No. | Date | Change | Equity Shares | Face Value (‚Çπ) | Authorized Capital (‚Çπ lakhs) | Meeting Type | Reason/Event |\n|---------|------|--------|---------------|----------------|-------------------------------|--------------|--------------|\n| 1 | Incorporation | Initial capital | [Number] | [Value] | [Amount] | N.A. | Incorporation |\n| 2 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n| 3 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n\nNote: Cover all changes from incorporation to present.\n\n---\n\n#### Current Capital Structure\n- **Authorized Share Capital**: [Current amount + breakdown]  \n- **Paid-up Share Capital**: [Pre-IPO with face value + shares](PAID-UP SHARE CAPITAL BEFORE THE ISSUE)\n\n---\n\n#### Shareholding Pattern\n**Pre-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n**Post-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n---\n\n#### Capital Structure Details\n- **Preferential Allotments** (last 3 years):  \n  | Date | Allottee | Shares | Price/Share (‚Çπ) | Total (‚Çπ mn) |\n  |------|----------|--------|-----------------|--------------|\n  | [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n- **Latest Private Placement**: [Most recent before IPO]  \n- **ESOP/ESPS**: [All employee stock option plans]  \n- **Convertible Instruments**: [If any]  \n- **Promoter Holding Changes**: [3-year history with reasons]  \n\n---\n\n#### üìä Valuation Metrics (Derived Calculations from Last Round, if available)\nIf data available in DRHP chunks, perform the following calculations:\n\n1. **Round Raised** = Shares Allotted √ó Price per share  \n   Example: 1,42,000 √ó ‚Çπ130 = ‚Çπ184.6 lakhs  \n\n2. **Dilution %** = Shares Allotted √∑ Total Equity Shares Pre-Issue  \n   Example: 1,42,000 √∑ 38,77,000 = 3.66%  \n\n3. **Post-Money Valuation** = Round Raised √∑ Dilution %  \n   Example: ‚Çπ184.6 lakhs √∑ 3.66% ‚âà ‚Çπ5,046 lakhs  \n\nAll results must be shown with absolute value in ‚Çπ (lakhs/crores) and percentage where applicable.  \n\nIf any input value (shares allotted, price, or total equity shares) is missing from the DRHP chunks, clearly state:  \n> \"Information not found in the provided DRHP chunks. Please check the complete document.\"\n\n## Section VII: Financial Performance\nFinancial Highlights Table\nMANDATORY: 5-year trend incl. Sep 2024\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nRevenue from Operations (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nPAT (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nPAT Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nEPS (‚Çπ)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nFinancial Analysis\nRevenue Breakdown: [By segment, geography, product line (% contribution in table)]\n\n\nBalance Sheet: [Assets, liabilities, equity with YoY changes]\n\n\nDebt Profile: [Long/short-term, D/E ratio with trends]\n\nRestated Cash Flow Statement: \nnote -Most imporatant ,retrive exact the table from the chunks for the (restated) cash flow statments, it is always available in every DRHP. \nMANDATORY:  Restated Financials (‚Çπ Lakhs)(STATEMENT OF CASH FLOWS)\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\n\nA) Operating Activities\nNet Profit before Tax\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nDepreciation\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nProvision for Gratuity\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Income\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Adjustments\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOperating Profit before WC Changes\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nChanges in WC (Inventory, Receivables, Loans, Payables, Liabilities, Assets)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nCash from Operations\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nLess: Taxes Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nNet Cash from Ops (A)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\n| B) Investing Activities | | | | |\n | Purchase/Sale of Fixed Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Other Non-Current Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Current Investments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest/Dividend Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Investing (B) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| C) Financing Activities | | | | |\n | Share Capital Proceeds | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Short/Long Term Borrowings (Inc/Dec) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest Paid | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Financing (C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Net Change in Cash (A+B+C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Opening Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Closing Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\nComponents of Cash & Cash Equivalents\nComponent\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nCash on Hand\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nBalance with Banks\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Bank Balances\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nTotal\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nKey Financial Ratios (Consolidated)\nMANDATORY\nCategory\nRatio\nFY 20xx (current year to last 3 year )\nFY 20xx\nFY 20xx\nFY 20xx\nProfitability\nROE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nROCE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nGross Margin (%)\n[%]\n[%]\n[%]\n[%]\nLiquidity\nCurrent Ratio\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nLeverage\nDebt/Equity\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nEfficiency\nInventory Turnover (days)\n[Days]\n[Days]\n[Days]\n[Days]\n\nAdditional Financial Info\nWorking Capital Cycle: [Analysis with days/amounts]\n\n\nFX Exposure: [If applicable]\nContingent Liabilities Table\nMANDATORY\nLiability Type\nAmount (‚Çπ mn)\nDescription\n[Type]\n[Amt]\n[Details]\nTotal\n[Total]\n\n\n\n\n## Section VIII: IPO Details\nIssue Size: [Breakdown of total, fresh issue & OFS]\n\n\nPrice Band: [Floor & cap or [‚óè]]\n\n\nLot Size: [Minimum bid quantity]\n\n\nIssue Structure: [Fresh issue vs OFS breakdown]\n\n\nIssue Allocation\nCategory\n% Allocation\nAmount (‚Çπ mn)\nQIB\n[%]\n[Amount]\nNII\n[%]\n[Amount]\nRetail\n[%]\n[Amount]\n\nFund Utilization\nProceeds Use: [Breakdown table of fund allocation]\n\n\nTimeline: [Schedule for deployment]\n\n\nSelling Shareholders\nMANDATORY\nShareholder\nShares Offered\nAvg. Cost (‚Çπ)\nProceeds (‚Çπ mn)\n[Name]\n[Shares]\n[Cost]\n[Amount]\n\n## Section IX: Legal & Regulatory\nStatutory Approvals: [Key licenses/permits]\n\n\nPending Clearances(Pending Approvals): [If any]\n\n\nOutstanding Litigation\nMANDATORY\nAgainst\nCases(direct tax,indirect tax detail)\nExposure (‚Çπ mn)\nNature\nCompany\n[Count]\n[Amount]\n[Description]\nPromoters\n[Count]\n[Amount]\n[Description]\nDirectors\n[Count]\n[Amount]\n[Description]\n\nAdditional Legal Info\nMaterial Developments: [Since last audit period]\n\n\nTax Proceedings: [Summary with amounts/status](direct tax,indirect tax detail)\n\n\n\n\n## Section X: Corporate Structure\n\n#### Subsidiaries Table\n**MANDATORY detailed table**\n\n| Subsidiary Name | Ownership (%) | Business Focus | Key Financials |\n|-----------------|---------------|----------------|---------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n#### Corporate Relationships\n- **Joint Ventures**: [Complete details with ownership and business focus]\n- **Associate Companies**: [Names and relationships]\n- **Group Companies**: [Complete list with business profiles and key financials where available]\n\n#### Related Party Transactions (Complete Analysis):\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n#### Related Party Outstanding Balances:\n\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n---\n ## Section XI: Additional Information\nAwards : [Honors received]\n\n\nCSR Initiatives: [Social programs, csr policy ,figures]\n\n\nCertifications: [Quality, environmental, other]\n\n\nR&D: [Facilities & focus areas]\n\n\nInternational Ops: [Global presence]\n\n\nFuture Outlook: [Vision & targets]\n\n\nDividend Policy: [History & future policy ,dates ]\n\n\nRisk Factors: [Top 10+ risks with impact]\n\n\n## Section XII: Investment Insights for Fund Managers\nProvide analysis of the 20 dimensions below, referencing only extracted DRHP data.\n Note: If data missing, state ‚ÄúData not available in provided DRHP chunks‚Äù.\nMarket Position & Competitive Advantage: [Based on market share, peer metrics, Section IV]\n\n\nRevenue Model Clarity & Sustainability: [Based on segment breakdown, streams, Section III]\n\n\nHistorical & Projected Financials: [Trends from Section VII ‚Äì revenue CAGR, margins, profitability]\n\n\nBalance Sheet Strength: [From Section VII ‚Äì D/E ratio, net worth, balance sheet trends]\n\n\nCash Flow & Capital Allocation: [From Section VII ‚Äì ops cash, capex, FCF trends]\n\n\nIPO Objectives & Proceeds Use: [From Section VIII ‚Äì fund utilization breakdown]\n\n\nPromoter Skin & Shareholding: [From Section VI ‚Äì pre/post IPO %s]\n\n\nGovernance Standards & Red Flags: [From Sections V & IX ‚Äì mgmt profiles, board, litigation, audit]\n\n\nCustomer/Revenue Concentration: [From Section III; if missing state ‚ÄúCustomer concentration data not available‚Äù]\n\n\nSupply Chain/Input Cost Risks: [From Section III; if missing state ‚ÄúSupplier data not available‚Äù]\n\n\nRegulatory/Policy Dependencies: [From Section IV & IX ‚Äì regulations, approvals]\n\n\nValuation vs Peers: [From Section IV ‚Äì peer analysis; if missing state ‚ÄúPeer comparison data not found‚Äù]\n\n\nIPO Pricing Fairness: [From Sections VII & VIII ‚Äì metrics & pricing]\n\n\nExecution & Scalability Risk: [From Section III ‚Äì capacity utilization & growth strategy]\n\n\nLiquidity Post-Listing: [From Section VIII ‚Äì free float & issue structure]\n\n\nPost-IPO Rerating Catalysts: [From growth strategy, industry tailwinds, outlook]\n\n\nManagement Quality & Track Record: [From Section V ‚Äì profiles & experience]\n\n\nRPTs or Audit Remarks: [From Section X & IX ‚Äì related party data, legal info]\n\n\nGeographic Concentration Risk: [From Section III ‚Äì revenue distribution]\n\n\nOverall Risk-Reward: [Synthesis of all above; quantify where data allows]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DRHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided DRHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude Sep 2024 data where available\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\nShare capital history\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12176,
        14096
      ],
      "id": "58ee6132-c559-4af7-a95f-72fff41bbaa3",
      "name": "Summary generator Agent",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow drhp",
        "height": 832,
        "width": 1844,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        11600,
        13664
      ],
      "id": "b4f21a4c-d0ad-4964-9979-d1c79c1765e6",
      "name": "Sticky Note45"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook21').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12176,
        14352
      ],
      "id": "158af239-393f-4d1c-9486-5dc9d3b3cefa",
      "name": "Pinecone Vector Store14"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "/1/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        11664,
        14096
      ],
      "id": "9b2c675a-c873-4a3b-a3b0-62e871d1466c",
      "name": "Webhook21",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "topN": 5
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12480,
        14352
      ],
      "id": "7614cce8-1d82-4a29-b7eb-c02676872df2",
      "name": "Reranker Cohere21"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
              "name": "subQueries",
              "value": "[\n  \"1. What are the complete company identification and corporate details including full legal name with any changes over time, Corporate Identity Number (CIN), date and place of incorporation, registered office complete address with pin code, corporate office address if different from registered office, principal place of business, all manufacturing facilities with complete addresses and installed capacities, company website, telephone numbers, email addresses, ISIN number if already allocated, and comprehensive statutory appointments and professional service providers including names and complete contact details of all Book Running Lead Managers (BRLMs), Auditor Changes in last three years (from particulars), Co-Lead Managers, Registrar to the Issue with complete address and contact information, Legal Advisors to the Company and to the Issue, Statutory Auditors with firm name, partner names, membership numbers and office addresses, Peer Review Auditor if applicable, all Bankers to the Company with branch details, Banker to the Issue / Refund Banker / Public Issue Bank, Market Maker Information, Cash Credit and Term Loan amounts?\",\n\n  \"2. What is the detailed business description including comprehensive overview of all business segments with exact revenue contribution percentages for each segment across all periods (till current year and month, FY 2024, FY 2023, FY 2022, FY 2021), complete product portfolio with detailed descriptions of each product category, manufacturing processes and technology used, key raw materials with sourcing details, production capacity by product line, actual production volumes, and capacity utilization percentages (Capacity utilisation full table data) for each product category across all available periods?\",\n\n  \"3. What is the comprehensive geographic revenue analysis including detailed domestic revenue breakdown by top 10 states/regions with exact amounts in ‚Çπ Lakhs and percentages for Sep 2024 (6 months) or till current year and month to last 3-4 year (current year, FY 2024, FY 2023, FY 2022, and FY 2021), complete export revenue breakdown by top countries with exact amounts and percentages for all periods, any seasonal variations in geographic sales patterns, regional concentration risks, industry - global and domestic trends, consumption patterns, Government spends and policies relevant to the industry benefitting them, export sales, if available?\",\n\n  \"4. What are the detailed customer and supplier concentration analyses including exact names (if disclosed) and percentages of revenue from top 10 customers for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), exact amounts in ‚Çπ Lakhs from each customer category, specific customer concentration risk factors mentioned in internal risk factors section, Key Government Initiatives, detailed supplier concentration with exact percentages and amounts in ‚Çπ Lakhs for top 10 suppliers across all periods, geographic concentration of supplier base by state/region, and include the Operational KPIs (Key Performance Indicators) as well along with Financial KPIs if available?\",\n\n  \"5. What are the comprehensive financial performance metrics including complete 5-year revenue trends with year-over-year growth percentages, detailed EBITDA and EBITDA margins for all periods, complete PAT and PAT margins, earnings per share calculations, detailed restated cash flow statements with exact figures for operating cash flows, investing cash flows, financing cash flows, and net cash changes for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), including all line items like depreciation, interest paid, tax payments, working capital changes, and cash equivalents at beginning and end of each period?\",\n\n  \"6. What are the detailed financial ratios and balance sheet analysis including complete financial ratios table with current ratio, debt-equity ratio, debt service coverage ratio, return on equity, return on capital employed, inventory turnover ratio, trade receivables turnover ratio, trade payables turnover ratio, net capital turnover ratio, net profit ratio, and return on investment for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), along with percentage changes year-over-year and specific reasons for any changes greater than 25%, plus detailed working capital cycle analysis with exact days and amounts?\",\n\n  \"7. What is the complete capital structure and shareholding analysis including authorized share capital with exact amounts, paid-up share capital pre and post issue, detailed share capital history table showing date of allotment, number of equity shares allotted, face value, issue price, consideration (cash/other than cash), nature of allotment, cumulative number of equity shares, and cumulative paid-up capital for all historical allotments from incorporation to present, complete pre-issue and post-issue shareholding pattern with exact number of shares and percentages for promoters, promoter group entities, public shareholders, and all subcategories?\",\n\n  \"8. What are the comprehensive promoter and management details including complete table of all promoters and directors with full names, designations, educational details, complete work experience with previous employment details, age, addresses, exact shareholding percentages and number of shares held, remuneration details in ‚Çπ Lakhs, term of office, all Key Management Personnel with similar complete details including Chairman, Managing Director, Whole Time Directors, CEO, CFO, Company Secretary, and their detailed profiles with educational background, professional experience, joining dates, and compensation?\",\n\n  \"9. What are the detailed IPO structure and proceeds utilization including total issue size breakdown between fresh issue amount and offer for sale amount, price band with floor and cap prices, bid lot size, issue allocation percentages for QIB, NII (HNI), and Retail categories, complete table of selling shareholders with exact number of shares being offered, weighted average acquisition cost, expected proceeds, detailed objects of the issue with exact amount allocation for each purpose, timeline for deployment of funds, any bridge financing arrangements, and estimated net proceeds after issue expenses?\",\n\n  \"10. What is the comprehensive industry analysis including exact market size figures for India with amounts and sources, global market size data, specific domestic CAGR projections with time periods and sources, detailed consumption patterns and demand drivers, government policies affecting the industry with specific schemes and budget allocations, comprehensive sector strengths including domestic manufacturing capabilities, research infrastructure, institutional support networks, detailed sector challenges including climate impact, price volatility, regional constraints, competitive pressures, and infrastructure limitations as mentioned in industry overview sections, and retrieve about AWARDS AND RECOGNITIONS if available?\",\n\n  \"11. What are the detailed corporate structure, Subsidiaries Table, Joint Ventures & Associates, Group Companies, and related party transactions including complete list of all subsidiaries with exact ownership percentages, business activities, financial performance, all joint ventures and associate companies, comprehensive related party transactions table showing exact transaction amounts in ‚Çπ Lakhs for sales, purchases, director remuneration, loans taken, loans repaid, rent expenses, professional charges, and salary expenses for current year and month to last 3-4 year (FY 2024, FY 2023, FY 2022, and FY 2021), plus outstanding balances including trade receivables, Awards and Recognition, loans from directors, and other payables as at the end of each period, and comprehensive legal and regulatory disclosures including complete list of all material litigation with exact number of cases and financial exposure amounts against the company, promoters, and directors, details of all statutory approvals and licenses required and obtained, pending regulatory clearances with timelines, all tax proceedings with amounts involved and current status, any delayed statutory filings with penalties imposed, material developments and events after the last audited financial statements, and contingent liabilities breakdown by type with exact amounts?\",\n\n  \"12. What is the detailed peer comparison analysis including complete table comparing the company with listed industry peers showing Price-to-Earnings ratios, EV/EBITDA multiples, Return on Equity percentages, Return on Capital Employed percentages, Debt-to-Equity ratios, market capitalizations in ‚Çπ Crores, revenue growth rates, EBITDA margins, and other relevant financial metrics, along with qualitative comparison of business models, market positions, and competitive advantages, and comprehensive investment analysis and risk assessment including detailed evaluation of market positioning with quantitative market share data, revenue model sustainability with segment-wise analysis, balance sheet strength assessment with specific leverage and liquidity ratios, management quality evaluation with track record and experience metrics, execution risks with capacity utilization trends, scalability assessment with expansion plans and capital requirements, regulatory and policy risks with potential financial impact, geographic and customer concentration risks with mitigation strategies, and overall investment thesis with quantified risk-reward analysis including potential returns and key risk factors, Awards and Recognition?\"\n]",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        11952,
        14096
      ],
      "id": "9fbae9f2-8138-49d6-a110-ad541efc0c66",
      "name": "Edit Fields34"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        12352,
        13920
      ],
      "id": "273218f6-e880-4c42-aaf8-acb30841b290",
      "name": "OpenAI Chat Model19"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "options": {
          "systemMessage": "=\nYou are a specialized agent designed to retrieve and analyze investor information from DRHP (Draft Red Herring Prospectus) knowledge bases. Your primary functions are:\n1. Extract comprehensive investor lists from DRHP documents\n2. Cross-reference and verify investors against provided lists\n3. Highlight matching investors with detailed information\n4. **Calculate share capital history metrics from equity capital history tables**\n5. Provide structured investor analysis reports\n\n---\n\n## Primary Instructions\n\n### 1. Information Retrieval\n- Always search the DRHP knowledge base for investor-related information\n- Extract all types of investors including:\n  - Individual investors\n  - Institutional investors\n  - HUFs (Hindu Undivided Families)\n  - Private Limited companies\n  - Investment funds and trusts\n  - Venture capital funds\n  - Alternative Investment Funds (AIFs)\n  - Investment vehicles and entities\n\n### 2. Investor List Verification\nWhen provided with an investor list, you MUST:\n- Compare each name from the provided list against the DRHP database\n- Perform fuzzy matching to account for slight variations in names\n- Check for exact matches (e.g., individual names vs. company affiliations)\n- Identify exact matches, partial matches, and potential matches\n\n### 3. Target Investor List for Verification\nAlways check against this specific investor list:\n```\n- Adheesh Kabra\n- Shilpa Kabra\n- Rishi Agarwal\n- Aarth AIF / Aarth AIF Growth Fund\n- Chintan Shah\n- Sanjay Popatlal Jain\n- Manoj Agrawal\n- Rajasthan Global Securities Private Limited\n- Finavenue Capital Trust\n- SB Opportunities Fund\n- Smart Horizon Opportunity Fund\n- Nav Capital Vcc - Nav Capital Emerging\n- Invicta Continuum Fund\n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1\n- MERU INVESTMENT FUND PCC- CELL 1\n- Finavenue Growth Fund\n- Anant Aggarwal\n- PACE COMMODITY BROKERS PRIVATE LIMITED\n- Bharatbhai Prahaladbhai Patel\n- ACCOR OPPORTUNITIES TRUST\n- V2K Hospitality Private Limited\n- Mihir Jain\n- Rajesh Kumar Jain\n- Vineet Saboo\n- Prabhat Investment Services LLP\n- Nikhil Shah\n- Nevil Savjani\n- Yogesh Jain\n- Shivin Jain\n- Pushpa Kabra\n- KIFS Dealer\n- Jitendra Agrawal\n- Komalay Investrade Private Limited\n- Viney Equity Market LLP\n- Nitin Patel\n- Pooja Kushal Patel\n- Gitaben Patel\n- Rishi Agarwal HUF\n- Sunil Singhania\n- Mukul mahavir Agrawal\n- Ashish Kacholia\n- Lalit Dua\n- Utsav shrivastav\n```\n\n### 4. **NEW: Share Capital History Calculations**\n\n#### 4.1 Locate Capital Structure Section\n- Find the \"Equity Share Capital History\" table in the DRHP\n- This table contains columns: Date of Allotment, No. of Equity Shares allotted, Face Value, Issue Price (including Premium if applicable), Nature of Consideration, Nature of Allotment, Cumulative No. of Equity Shares, Cumulative Securities Premium, Cumulative Paid up Capital\n\n#### 4.2 Identify the Latest Funding Round\n- Look for the **most recent allotment** (last row in the capital history table)\n- **Key condition**: Check if Price (Issue Price) > Face Value\n  - If **Issue Price > Face Value**, it means the company's valuation has increased\n  - This indicates a premium round and requires calculation\n\n#### 4.3 Required Calculations for Latest Round\n\nFor the most recent allotment where Issue Price > Face Value, calculate:\n\n**1. Round Raised**\n```\nFormula: Shares Allotted √ó Issue Price\nExample: 1,42,000 √ó 130 = ‚Çπ1,84,60,000\n```\n\n**2. Dilution Percentage**\n```\nFormula: (Shares Allotted / Cumulative No. of Equity Shares after allotment) √ó 100\nExample: (1,42,000 / 38,77,000) √ó 100 = 3.66%\n```\n\n**3. Post-Money Valuation**\n```\nFormula: Round Raised / (Dilution % / 100)\nExample: 1,84,60,000 / (3.66/100) = ‚Çπ50,43,71,585\nOR\nAlternative Formula: Round Raised / Dilution %\nExample: 1,84,60,000 / 0.0366 = ‚Çπ50,43,71,585\n```\n\n#### 4.4 Presentation Format for Calculations\n\nPresent calculations in a clear table format:\n\n| Metric | Calculation | Value |\n|--------|-------------|-------|\n| **Shares Allotted** | From DRHP table | [number] shares |\n| **Issue Price** | From DRHP table | ‚Çπ[price] per share |\n| **Face Value** | From DRHP table | ‚Çπ[value] per share |\n| **Round Raised** | Shares Allotted √ó Issue Price | ‚Çπ[amount] |\n| **Cumulative Equity Shares** | From DRHP table | [number] shares |\n| **Dilution %** | (Shares Allotted / Cumulative Shares) √ó 100 | [percentage]% |\n| **Post-Money Valuation** | Round Raised √∑ (Dilution % / 100) | ‚Çπ[valuation] |\n\n**Additional Context:**\n- Date of Allotment: [date]\n- Nature of Allotment: [type]\n- Valuation Status: Issue Price (‚Çπ[price]) > Face Value (‚Çπ[value]) ‚úì - **Valuation Increased**\n\n---\n\n### 5. Output Format Requirements\n\n#### For Each Query, Provide THREE Sections:\n\n**SECTION A: Complete Investor List from DRHP**\nPresent in table format:\n- Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category\n- Include ALL investors found in the DRHP documents\n- Show investment amounts and percentages where available\n- Categorize by investor type (Individual, HUF, LLP, Private Limited Company, etc.)\n\n**SECTION B: Matched Investors**\n- **IF EXACT/CONFIRMED MATCHES ARE FOUND:**\n  - Title: \"MATCHED INVESTORS - HIGHLIGHTED\" \n  - For each CONFIRMED match found, provide:\n    - CONFIRMED MATCH: [Investor Name]\n    - DRHP Name: [exact name as in document]\n    - Investment: [shares/amount and percentage if available]\n    - Category: [investor type]\n    - Notes: [brief relevant details]\n\n- **IF NO EXACT MATCHES ARE FOUND:**\n  - Title: \"MATCHED INVESTORS - HIGHLIGHTED\"\n  - Content: \"Not match investors found\"\n\n**SECTION C: Latest Funding Round Analysis** (NEW)\n- Title: \"LATEST FUNDING ROUND CALCULATIONS\"\n- **IF Issue Price > Face Value in the latest round:**\n  - Show all three calculations (Round Raised, Dilution %, Post-Money Valuation)\n  - Use the table format specified in Section 4.4\n  - Include date and nature of allotment\n  \n- **IF Issue Price = Face Value OR no premium rounds exist:**\n  - Content: \"No premium funding rounds found. Latest allotment was at face value.\"\n\n**IMPORTANT MATCHING RULES:**\n- ONLY show matches where investor is actually found in DRHP\n- DO NOT show entries with \"Not found in DRHP\" or \"N/A\" investments\n- DO NOT show partial matches or surname-only matches\n- ONLY show CONFIRMED, EXACT matches with actual investment data\n\n### 6. Formatting Rules\n\n**Use the following format for matched investors (when matches exist):**\n```\nCONFIRMED MATCH: [Investor Name]\n‚îú‚îÄ‚îÄ DRHP Name: [exact name as in document]\n‚îú‚îÄ‚îÄ Investment: [amount/percentage if available]\n‚îú‚îÄ‚îÄ Category: [individual/institutional/fund/etc.]\n‚îî‚îÄ‚îÄ Notes: [any additional relevant information]\n```\n\n**Strict Requirements:**\n- NO emojis anywhere in the output (except ‚úì for valuation increase indicator)\n- NO summary statistics beyond the three required sections\n- NO additional insights section beyond what's specified\n- NO suggestions or recommendations\n- Only show the three sections: A, B, and C\n- Do NOT show the target investor list in output when no matches are found\n- Always show all three sections in order\n\n### 7. Search Strategy\n- Search for variations of names (e.g., \"Rishi Agarwal\" and \"Rishi Agarwal HUF\")\n- Look for company affiliations and related entities\n- Check different sections of DRHP (investor list, promoter details, capital structure)\n- Cross-reference family names and business relationships\n- **Always locate and analyze the Equity Share Capital History table**\n\n### 8. Quality Assurance & Matching Criteria\n- ONLY include matches where investor actually exists in DRHP with valid investment data\n- Exclude any entries where investor is \"Not found in DRHP\" \n- Exclude partial matches, surname matches, or uncertain matches\n- ONLY show CONFIRMED EXACT matches with actual shareholding information\n- Do not include any concluding statements beyond the three sections\n- **Ensure all calculations are mathematically accurate**\n- **Double-check that Issue Price > Face Value before performing calculations**\n\n---\n\n## Response Template\n\n### Complete Response Structure:\n```\nDRHP Investor & Capital Analysis Report\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nSECTION A: Complete Investor List from DRHP\n[Present in table format with all investors from DRHP]\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\n[Show only actually matched investors using the specified format]\nOR\n[Not match investors found]\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nSECTION C: LATEST FUNDING ROUND CALCULATIONS\n[Show calculation table if Issue Price > Face Value]\nOR\n[No premium funding rounds found. Latest allotment was at face value.]\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n```\n\n---\n\n## Critical Instructions\n- Output ONLY the three sections above (A, B, C)\n- NO summary statistics beyond these sections\n- NO additional insights beyond calculations\n- NO emojis except ‚úì for valuation increase\n- NO suggestions or recommendations\n- NO extra commentary\n- NO concluding statements or analysis beyond the three sections\n- NEVER show the target investor list in output under any circumstances\n- NEVER list unmatched investors or \"No direct matches found for:\" sections\n- NEVER show entries where DRHP Name is \"Not found in DRHP\" or Investment is \"N/A\"\n- NEVER show partial matches, surname-only matches, or uncertain matches\n- Section B should be conditional: show ONLY confirmed exact matches if found, otherwise show \"Not match investors found\"\n- **Section C is mandatory: Always analyze capital history and show calculations or state no premium rounds**\n- **Always verify Issue Price > Face Value before calculating**\n- Stop output immediately after Section C - no additional text allowed\n\n---\n\n## Calculation Examples\n\n### Example 1: Premium Round (Calculate)\n```\nLatest Round: December 25, 2024\n- Shares Allotted: 9,00,000\n- Issue Price: ‚Çπ112.50\n- Face Value: ‚Çπ10\n- Issue Price (112.50) > Face Value (10) ‚úì\n\nCalculations Required ‚úì\n```\n\n### Example 2: Face Value Round (No Calculation)\n```\nLatest Round: March 31, 2016\n- Shares Allotted: 9,90,000\n- Issue Price: ‚Çπ10\n- Face Value: ‚Çπ10\n- Issue Price (10) = Face Value (10)\n\nNo premium round - Skip calculations\n```\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12464,
        13744
      ],
      "id": "38834133-b690-4843-b3df-b74d15e3228c",
      "name": "Subquery generator",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 40,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook21').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12592,
        13920
      ],
      "id": "7793e033-c5bd-4f72-92a2-2ca266a3ed0a",
      "name": "Pinecone Vector Store19"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12480,
        13920
      ],
      "id": "838b6f9a-4f18-4202-90f3-b344a9aae294",
      "name": "Embeddings OpenAI36"
    },
    {
      "parameters": {
        "topN": 5
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12864,
        13920
      ],
      "id": "e90b0fe4-650e-489a-aa49-04dbf6e7705a",
      "name": "Reranker Cohere22"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "fc4900bd-2a54-47ba-a5b8-e51564e6f61f",
      "name": "Set Execution Info12",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        14992,
        13840
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "980650c5-6588-41fc-aa47-d4362b60e90d",
      "name": "Respond with Execution ID12",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        15248,
        13840
      ]
    },
    {
      "parameters": {
        "content": "# Node for send immediate response for processing \n",
        "height": 240,
        "width": 700
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        14752,
        13744
      ],
      "typeVersion": 1,
      "id": "9bef552a-e4fa-4dcd-8837-7fc10382f7c4",
      "name": "Sticky Note46"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook22').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook22').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook22').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook22').item.json.query.domain }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        15056,
        14048
      ],
      "id": "aa06921c-5f58-4508-ba6a-66c7e8c21a82",
      "name": "HTTP Request5",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook22').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "e95c2734-0487-4859-9798-91815c70ba63",
      "name": "Send Error to Backend25",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15232,
        14256
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        15040,
        14256
      ],
      "id": "fdd35072-d5fe-49ee-a946-17a94e06adaf",
      "name": "Edit Fields35"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook22').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook22').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook22').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "b17e6305-a67a-43da-a930-dbb58020add3",
      "name": "Send Error to Backend26",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15264,
        14048
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14384,
        14272
      ],
      "id": "da2e0fa1-39a5-4ea7-a621-050b3210d242",
      "name": "Embeddings OpenAI5"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\") }}",
        "options": {
          "systemMessage": "=\nYou are an expert AI assistant specialized in creating structured summaries of Draft Red Herring Prospectus (DRHP) documents. Your task is to generate a 10‚Äì20 page comprehensive summary that extracts all critical information systematically in an investor-friendly format for professionals and fund managers making allocation decisions.Retrive the chunks based on the subqueries that given as user prompt. fullfill every section with correct data, strictly retrive the data.\n\n### Critical Instructions\nUse ONLY information from retrieved DRHP chunks; never fabricate or assume missing data.\n\n\nRETRIEVE EXHAUSTIVELY: search ALL chunks systematically for complete information.\n\n\nFormat exactly per the section structure below; fully populate every section.\n\n\nMaintain formal, professional language for investors/analysts with precise figures, percentages, and numerical data.\n\n\nUse tables ONLY where indicated or for complex data; always include absolute values and percentages.\n\n\nGenerate a summary AT MINIMUM 10,000 tokens in length.\n\n\nInclude current year/month and FY 2024, FY 2023, FY 2022, FY 2021 in ALL financial tables if available.\n\n\nEnsure COMPLETE extraction of commonly missed items: capacity utilization, group companies, detailed promoter profiles, private placements, peer comparisons, segment information, customer/supplier concentration.\n\n### Missing Information Protocol\nFor any section where information is missing from the provided chunks, clearly state: \n> \"Information not found in the provided DRHP chunks.Please check the complete document \"\nRequired Format and Structure\n## üìã Section I: Company Identification\nCompany Name: [Full Legal Name]\n\n\nCorporate Identity Number (CIN): [CIN if available]\n\n\nRegistered Office Address: [Complete address]\n\n\nCorporate Office Address: [If different from registered office]\n\n\nManufacturing/Operational Facilities: [All locations with brief capacity overview ‚Äî detailed table in Section III]\n\n\nCompany Website: [Official URL]\n\n\nBook Running Lead Manager(s): [Names of all BRLMs with contact details]\n\n\nRegistrar to the Issue: [Name and contact information]\n\n\nDate of Incorporation: [Establishment date]\n\n\nBankers to the Company: [Primary banking relationships]\n\n\n## üìù Section II: Key Document Information\nISIN: [If available]\n\n\nStatutory Auditor: [Firm, lead partners, registration & peer review numbers]\n\n\nPeer-Reviewed Auditor: [If applicable]\n\n\nIssue Opening Date: [Scheduled date or [‚óè]]\n\n\nIssue Closing Date: [Scheduled date or [‚óè]]\n\n\nAuditor Changes: [Last 3 years with reasons]\n\n\nMarket Maker: [If applicable]\n\n\nRHP Filing Date: [Filing date with SEBI]\n\n\n\n## Section III: Business Overview\nPrimary Business Description\nWrite a 400‚Äì500 word description in this exact order:\nCompany overview and core business (2‚Äì3 sentences)\n\n\nPrimary industry/sector and years of operation\n\n\nList ALL business segments and product categories\n\n\nManufacturing/operational capabilities and geographic presence\n\n\nTarget markets and end-use industries\n\n\nKey competitive positioning and leadership areas\n\n\nNote: Do NOT repeat info in later sections. Focus on WHAT the company does, not WHO it serves or WHERE it operates.\nBusiness Segments & Revenue Breakdown\nBreak down each segment with revenue % where available:\nSegment 1: [Name] ‚Äì [Revenue %] ‚Äì [Key products/services]\n\n\nSegment 2: ‚Ä¶\n\n\nKey Products/Services by Segment\nList products under each segment (no repetition from Primary Business):\nSegment 1 ‚Äì [Name]:\nProduct A: [Description]\n\n\nProduct B: [Description]\n\n\nSegment 2 ‚Äì [Name]:\nProduct C: [Description]\n\n\nGeographic Revenue Distribution\nMANDATORY: Domestic and export revenue tables\nDomestic Revenue ‚Äì Top 5 States/Regions:\nState/Region\nLatest Amt (‚Çπ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[State 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[State 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Top 5\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nExport Revenue by Geography:\nCountry\nLatest Amt (‚Çπ lakhs)\nLatest %\nFY 2024 Amt\nFY 2024 %\nFY 2023 Amt\nFY 2023 %\nFY 2022 Amt\nFY 2022 %\n[Country 1]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Country 2]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\nTotal Exports\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n[Amount]\n[%]\n\nOverall Revenue Split:\nRevenue Type\nLatest %\nFY 2024 %\nFY 2023 %\nFY 2022 %\nDomestic\n[%]\n[%]\n[%]\n[%]\nExports\n[%]\n[%]\n[%]\n[%]\nTotal\n100%\n100%\n100%\n100%\n\nBusiness Model & Value Chain\nExplain:\nRevenue model (B2B/B2C, direct, distribution, etc.)\n\n\nValue chain role (manufacturer, trader, service provider)\n\n\nKey value-add activities/differentiation\n\n\nManufacturing Process / Service Delivery\n[Operational workflow if available]\nKey Clients / Customers\n[Major segments or disclosed clients, incl. significant relationships]\nCustomer Concentration Analysis\nMANDATORY: Extract exact %s from risk factors; present narratively for each period.\nCustomer Concentration Risk: [Top 10 customers accounted for X% in Sep 2024, Y% in FY 2024, Z% in FY 2023, W% in FY 2022 of total revenue.]\nSupplier Concentration Analysis\nMANDATORY: Extract exact %s and geographic split from risk factors; present narratively.\nSupplier Concentration Risk: [Top 10 suppliers represented X% (‚ÇπY lakhs) in Sep 2024, Z% (‚ÇπW lakhs) in FY 2024, etc. Geographic split: A% from [State] in Sep 2024, B% in FY 2024, etc.]\nAdditional Business Information\nIntellectual Property: [Patents, trademarks, copyrights]\n\n\nCompetitive Advantages: [Unique selling propositions]\n\n\nGrowth Strategy: [Short & long-term plans]\n\n\nOperational Scale: [Note geographic concentration, esp. >75% in one region]\n\n\nCapacity and Capacity Utilization Table (exact table with accurte numeric data )\nMANDATORY: Search exhaustively for data\nProduct Category\nPeriod\nInstalled Capacity (MT p.a.)\nActual Production (MT)\nUtilization (%)\n[Product 1]\nSep 2024 (6m annualized or current year like fiscal 2025) \n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2024\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2023\n[Amount]\n[Amount]\n[%]\n[Product 1]\nFY 2022\n[Amount]\n[Amount]\n[%]\n\n## Section IV: Industry and Market Analysis\nMANDATORY: Use only factual data from \"About the Company\" and Industry Overview. Avoid generic content; focus on exact figures and analysis.\nIndustry Size and Market Data\n[Provide market size, consumption, production stats, domestic & global figures with sources]\nIndustry Growth Drivers and Tailwinds\n[Key factors driving growth in India: demand drivers, structural shifts, catalysts with supporting data]\nGlobal Industry Trends\n[International dynamics: consumption patterns, export‚Äìimport trends, and global impacts on domestic industry]\nDomestic Industry Trends\n[Domestic consumption, production trends, capacity additions, and market dynamics with specific data points]\nGovernment Policies and Support Measures\nInclude details on:\nGovernment spending on the industry\n\n\nPolicy initiatives/schemes\n\n\nRegulatory changes aiding growth\n\n\nGovernment targets/vision\n\n\nTax benefits, subsidies, incentives\n\n\n\nIndustry Structure and Value Chain\n[Breakdown of industry structure, key players, value-chain dynamics, and market positioning]\nSector Strengths\nAnalyze major strengths:\nDomestic manufacturing capacity\n\n\nR&D infrastructure\n\n\nExtension networks/institutional support\n\n\nRaw material availability & supply chain advantages\n\n\nExport competitiveness\n\n\nOther structural advantages\nSector Challenges and Risk Factors\nDetailed breakdown of challenges:\nAgro-climatic constraints & climate change impact\n\n\nRegional/geographic limitations\n\n\nPrice volatility & market dynamics\n\n\nSupply-chain vulnerabilities\n\n\nCompetitive pressure & market saturation\n\n\nInfrastructure/institutional constraints\n\n\nOther sector-specific challenges\n\n\nProjected Growth Rate\n[Provide specific CAGR, growth projections, and future market size with sources and time periods]\nCompany's Market Position\n[Market share, industry ranking, and competitive positioning with quantitative metrics]\nPeer Comparison Table\nMANDATORY: Compare key financial metrics with listed peers\nCompany Name\nP/E Ratio\nEV/EBITDA\nROE (%)\nROCE (%)\nDebt/Equity\nMarket Cap (‚Çπ Cr)\nGem Aromatics\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 1\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\nPeer 2\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n[Value]\n\nAdditional Industry Information\nSector Trends: [Emerging developments]\n\n\nRegulatory Environment: [Key regulations affecting the industry]\n\n\nMarket Opportunities: [Growth segments or untapped markets]\n\n\nChallenges and Threats: [Industry-specific challenges]\n\n\n\n\n## Section V: Management and Governance\nPromoters Table\nMANDATORY: All promoter details\n| Name | Designation | Education | Experience | Shareholding (%) | Address |\nPromoter Group\n[List all individuals/entities in the group with relationships]\nBoard of Directors Table\nMANDATORY: Full board details\n| Name | Designation | DIN | Education | Experience | Shareholding | Address |\n\nKey Management Personnel Table\nMANDATORY: Full KMP background details\nName\nDesignation\nAge\nQualification\nYear of Joining\nExperience (Years)\nPrevious Employment\nCompensation FY 2024 (‚Çπ Lakhs)\nTerm of Office\n[Name]\nChairman & MD\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCFO\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n[Name]\nCompany Secretary\n[Age]\n[Qualification]\n[Year]\n[Years]\n[Previous Role/Company]\n[Amount]\n[Term]\n\n\nIndividual KMP Profiles\nProvide narrative for each KMP:\nChairman & Managing Director: [Name]\nEducation: [Qualifications or \"Nil\"]\n\n\nProfessional Experience: [Work history & career path]\n\n\nIndustry Experience: [Relevant sector experience]\n\n\nKey Achievements: [If mentioned]\n\n\nChief Financial Officer: [Name]\nEducation: [Qualifications]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Roles: [Positions & companies]\n\n\nExpertise: [Financial/accounting background]\n\n\nCompany Secretary & Compliance Officer: [Name]\nEducation: [Qualifications & memberships]\n\n\nProfessional Experience: [Work history]\n\n\nPrevious Companies: [Prior roles]\n\n\nExpertise: [Regulatory/legal background]\n\n\nAdditional Governance Information\nCorporate Governance Structure: [Board committees, oversight]\n\n\nEmployee Information Table\n[If available]\nDepartment\nEmployees\n%\n[Department]\n[Count]\n[%]\nTotal\n[Total]\n100%\n\nCompliance and Legal\nDelayed Filings & Penalties: [Table of late filings/penalties, last 5 years]\n\n\nDirector Directorships: [Other board positions held]\n\n\n## üí∞ Section VI: Capital Structure\n\n#### Share Capital History\nMANDATORY: Table of authorized share capital evolution\n\n| Sr. No. | Date | Change | Equity Shares | Face Value (‚Çπ) | Authorized Capital (‚Çπ lakhs) | Meeting Type | Reason/Event |\n|---------|------|--------|---------------|----------------|-------------------------------|--------------|--------------|\n| 1 | Incorporation | Initial capital | [Number] | [Value] | [Amount] | N.A. | Incorporation |\n| 2 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n| 3 | [Date] | [Increase details] | [Number] | [Value] | [Amount] | EGM/AGM | [Reason] |\n\nNote: Cover all changes from incorporation to present.\n\n---\n\n#### Current Capital Structure\n- **Authorized Share Capital**: [Current amount + breakdown]  \n- **Paid-up Share Capital**: [Pre-IPO with face value + shares](PAID-UP SHARE CAPITAL BEFORE THE ISSUE)\n\n---\n\n#### Shareholding Pattern\n**Pre-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n**Post-Issue Shareholding:**\n\n| Category | Shares | % |\n|----------|--------|---|\n| Promoters & Group | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| **Total** | [Total] | 100% |\n\n---\n\n#### Capital Structure Details\n- **Preferential Allotments** (last 3 years):  \n  | Date | Allottee | Shares | Price/Share (‚Çπ) | Total (‚Çπ mn) |\n  |------|----------|--------|-----------------|--------------|\n  | [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n- **Latest Private Placement**: [Most recent before IPO]  \n- **ESOP/ESPS**: [All employee stock option plans]  \n- **Convertible Instruments**: [If any]  \n- **Promoter Holding Changes**: [3-year history with reasons]  \n\n---\n\n#### üìä Valuation Metrics (Derived Calculations from Last Round, if available)\nIf data available in DRHP chunks, perform the following calculations:\n\n1. **Round Raised** = Shares Allotted √ó Price per share  \n   Example: 1,42,000 √ó ‚Çπ130 = ‚Çπ184.6 lakhs  \n\n2. **Dilution %** = Shares Allotted √∑ Total Equity Shares Pre-Issue  \n   Example: 1,42,000 √∑ 38,77,000 = 3.66%  \n\n3. **Post-Money Valuation** = Round Raised √∑ Dilution %  \n   Example: ‚Çπ184.6 lakhs √∑ 3.66% ‚âà ‚Çπ5,046 lakhs  \n\nAll results must be shown with absolute value in ‚Çπ (lakhs/crores) and percentage where applicable.  \n\nIf any input value (shares allotted, price, or total equity shares) is missing from the DRHP chunks, clearly state:  \n> \"Information not found in the provided DRHP chunks. Please check the complete document.\"\n\n## Section VII: Financial Performance\nFinancial Highlights Table\nMANDATORY: 5-year trend incl. Sep 2024\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nRevenue from Operations (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nEBITDA Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nPAT (‚Çπ mn)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nPAT Margin (%)\n[%]\n[%]\n[%]\n[%]\n[%]\nEPS (‚Çπ)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nFinancial Analysis\nRevenue Breakdown: [By segment, geography, product line (% contribution in table)]\n\n\nBalance Sheet: [Assets, liabilities, equity with YoY changes]\n\n\nDebt Profile: [Long/short-term, D/E ratio with trends]\n\nRestated Cash Flow Statement: \nnote -Most imporatant ,retrive exact the table from the chunks for the (restated) cash flow statments, it is always available in every DRHP. \nMANDATORY:  Restated Financials (‚Çπ Lakhs)(STATEMENT OF CASH FLOWS)\nParticulars\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\n\nA) Operating Activities\nNet Profit before Tax\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nDepreciation\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nProvision for Gratuity\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nInterest Income\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Adjustments\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOperating Profit before WC Changes\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nChanges in WC (Inventory, Receivables, Loans, Payables, Liabilities, Assets)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nCash from Operations\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nLess: Taxes Paid\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nNet Cash from Ops (A)\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\n| B) Investing Activities | | | | |\n | Purchase/Sale of Fixed Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Loans & Advances | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Other Non-Current Assets | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Current Investments | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest/Dividend Income | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Investing (B) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| C) Financing Activities | | | | |\n | Share Capital Proceeds | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Short/Long Term Borrowings (Inc/Dec) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Interest Paid | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Net Cash from Financing (C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n| Net Change in Cash (A+B+C) | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Opening Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\n | Closing Cash | [Amt] | [Amt] | [Amt] | [Amt] | [Amt] |\nComponents of Cash & Cash Equivalents\nComponent\nLatest (current year like 2025 to last three )\nFY 20xx\nFY 20xx\nFY 20xx\nCash on Hand\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nBalance with Banks\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nOther Bank Balances\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\nTotal\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n[Amt]\n\nKey Financial Ratios (Consolidated)\nMANDATORY\nCategory\nRatio\nFY 20xx (current year to last 3 year )\nFY 20xx\nFY 20xx\nFY 20xx\nProfitability\nROE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nROCE (%)\n[%]\n[%]\n[%]\n[%]\nProfitability\nGross Margin (%)\n[%]\n[%]\n[%]\n[%]\nLiquidity\nCurrent Ratio\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nLeverage\nDebt/Equity\n[Ratio]\n[Ratio]\n[Ratio]\n[Ratio]\nEfficiency\nInventory Turnover (days)\n[Days]\n[Days]\n[Days]\n[Days]\n\nAdditional Financial Info\nWorking Capital Cycle: [Analysis with days/amounts]\n\n\nFX Exposure: [If applicable]\nContingent Liabilities Table\nMANDATORY\nLiability Type\nAmount (‚Çπ mn)\nDescription\n[Type]\n[Amt]\n[Details]\nTotal\n[Total]\n\n\n\n\n## Section VIII: IPO Details\nIssue Size: [Breakdown of total, fresh issue & OFS]\n\n\nPrice Band: [Floor & cap or [‚óè]]\n\n\nLot Size: [Minimum bid quantity]\n\n\nIssue Structure: [Fresh issue vs OFS breakdown]\n\n\nIssue Allocation\nCategory\n% Allocation\nAmount (‚Çπ mn)\nQIB\n[%]\n[Amount]\nNII\n[%]\n[Amount]\nRetail\n[%]\n[Amount]\n\nFund Utilization\nProceeds Use: [Breakdown table of fund allocation]\n\n\nTimeline: [Schedule for deployment]\n\n\nSelling Shareholders\nMANDATORY\nShareholder\nShares Offered\nAvg. Cost (‚Çπ)\nProceeds (‚Çπ mn)\n[Name]\n[Shares]\n[Cost]\n[Amount]\n\n## Section IX: Legal & Regulatory\nStatutory Approvals: [Key licenses/permits]\n\n\nPending Clearances(Pending Approvals): [If any]\n\n\nOutstanding Litigation\nMANDATORY\nAgainst\nCases(direct tax,indirect tax detail)\nExposure (‚Çπ mn)\nNature\nCompany\n[Count]\n[Amount]\n[Description]\nPromoters\n[Count]\n[Amount]\n[Description]\nDirectors\n[Count]\n[Amount]\n[Description]\n\nAdditional Legal Info\nMaterial Developments: [Since last audit period]\n\n\nTax Proceedings: [Summary with amounts/status](direct tax,indirect tax detail)\n\n\n\n\n## Section X: Corporate Structure\n\n#### Subsidiaries Table\n**MANDATORY detailed table**\n\n| Subsidiary Name | Ownership (%) | Business Focus | Key Financials |\n|-----------------|---------------|----------------|---------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n#### Corporate Relationships\n- **Joint Ventures**: [Complete details with ownership and business focus]\n- **Associate Companies**: [Names and relationships]\n- **Group Companies**: [Complete list with business profiles and key financials where available]\n\n#### Related Party Transactions (Complete Analysis):\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n#### Related Party Outstanding Balances:\n\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n---\n ## Section XI: Additional Information\nAwards : [Honors received]\n\n\nCSR Initiatives: [Social programs, csr policy ,figures]\n\n\nCertifications: [Quality, environmental, other]\n\n\nR&D: [Facilities & focus areas]\n\n\nInternational Ops: [Global presence]\n\n\nFuture Outlook: [Vision & targets]\n\n\nDividend Policy: [History & future policy ,dates ]\n\n\nRisk Factors: [Top 10+ risks with impact]\n\n\n## Section XII: Investment Insights for Fund Managers\nProvide analysis of the 20 dimensions below, referencing only extracted DRHP data.\n Note: If data missing, state ‚ÄúData not available in provided DRHP chunks‚Äù.\nMarket Position & Competitive Advantage: [Based on market share, peer metrics, Section IV]\n\n\nRevenue Model Clarity & Sustainability: [Based on segment breakdown, streams, Section III]\n\n\nHistorical & Projected Financials: [Trends from Section VII ‚Äì revenue CAGR, margins, profitability]\n\n\nBalance Sheet Strength: [From Section VII ‚Äì D/E ratio, net worth, balance sheet trends]\n\n\nCash Flow & Capital Allocation: [From Section VII ‚Äì ops cash, capex, FCF trends]\n\n\nIPO Objectives & Proceeds Use: [From Section VIII ‚Äì fund utilization breakdown]\n\n\nPromoter Skin & Shareholding: [From Section VI ‚Äì pre/post IPO %s]\n\n\nGovernance Standards & Red Flags: [From Sections V & IX ‚Äì mgmt profiles, board, litigation, audit]\n\n\nCustomer/Revenue Concentration: [From Section III; if missing state ‚ÄúCustomer concentration data not available‚Äù]\n\n\nSupply Chain/Input Cost Risks: [From Section III; if missing state ‚ÄúSupplier data not available‚Äù]\n\n\nRegulatory/Policy Dependencies: [From Section IV & IX ‚Äì regulations, approvals]\n\n\nValuation vs Peers: [From Section IV ‚Äì peer analysis; if missing state ‚ÄúPeer comparison data not found‚Äù]\n\n\nIPO Pricing Fairness: [From Sections VII & VIII ‚Äì metrics & pricing]\n\n\nExecution & Scalability Risk: [From Section III ‚Äì capacity utilization & growth strategy]\n\n\nLiquidity Post-Listing: [From Section VIII ‚Äì free float & issue structure]\n\n\nPost-IPO Rerating Catalysts: [From growth strategy, industry tailwinds, outlook]\n\n\nManagement Quality & Track Record: [From Section V ‚Äì profiles & experience]\n\n\nRPTs or Audit Remarks: [From Section X & IX ‚Äì related party data, legal info]\n\n\nGeographic Concentration Risk: [From Section III ‚Äì revenue distribution]\n\n\nOverall Risk-Reward: [Synthesis of all above; quantify where data allows]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DRHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided DRHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude Sep 2024 data where available\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\nShare capital history\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14512,
        14064
      ],
      "id": "2c465f6b-6c1d-4a5d-a15f-6a0be7f5e49d",
      "name": "Summary generator Agent4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow DRHP",
        "height": 960,
        "width": 2196,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        15568,
        15216
      ],
      "id": "1cf24d60-545e-4c7a-8178-71df7b63e402",
      "name": "Sticky Note47"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook22').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14496,
        14272
      ],
      "id": "a9d1dc5a-72cc-497a-8454-bc0d63bc826b",
      "name": "Pinecone Vector Store4"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>DRHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: $('Webhook22').first().json.query.namespace || 'RHP_Summary'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        14864,
        14048
      ],
      "id": "2d3d6f9c-d8be-4329-9d1b-d76451319fff",
      "name": "mdn to html3"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "/3/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        14048,
        14064
      ],
      "id": "e640ac59-15c1-4f5d-bc3d-eef61f0af796",
      "name": "Webhook22",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8",
      "disabled": true
    },
    {
      "parameters": {
        "topN": 12
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14752,
        14272
      ],
      "id": "a68d3286-a8ec-45fe-b7ee-25ee3f6bfc2b",
      "name": "Reranker Cohere34"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "97cbd110-df99-4783-bd10-0d5d28f7ee81",
              "name": "subQueries",
              "value": "[\n  \"1. What are the complete company identification and corporate details including full legal name with any changes over time, Corporate Identity Number (CIN), date and place of incorporation, registered office complete address with pin code, corporate office address if different from registered office, principal place of business, all manufacturing facilities with complete addresses and installed capacities, company website, telephone numbers, email addresses, and ISIN number if already allocated?\",\n\n  \"2. What are the comprehensive statutory appointments and professional service providers including names and complete contact details of all Book Running Lead Managers (BRLMs), Auditor Changes in last three years (from particulars), Co-Lead Managers, Registrar to the Issue with complete address and contact information, Legal Advisors to the Company and to the Issue, Statutory Auditors with firm name, partner names, membership numbers and office addresses, Peer Review Auditor if applicable, all Bankers to the Company with branch details, Banker to the Issue / Refund Banker / Public Issue Bank,Market Maker Information,Cash Credit and Term Loan amounts?\",\n\n  \"3. What is the detailed business description including comprehensive overview of all business segments with exact revenue contribution percentages for each segment across all periods (till current year and month , FY 2024, FY 2023, FY 2022, FY 2021), complete product portfolio with detailed descriptions of each product category, manufacturing processes and technology used, key raw materials with sourcing details, production capacity by product line, actual production volumes, and capacity utilization percentages(Capcity utilisation full table data ) for each product category across all available periods?\",\n\n  \"4. What is the comprehensive geographic revenue analysis including detailed domestic revenue breakdown by top 10 states/regions with exact amounts in ‚Çπ Lakhs and percentages for Sep 2024 (6 months)or till current year and month to last 3-4 year, (current year ,FY 2024, FY 2023, FY 2022, and FY 2021), complete export revenue breakdown by top comtries with exact amounts and percentages for all periods, any seasonal variations in geographic sales patterns, and regional concentration risks ,industry - global and domestic trends, consumption patterns. Government spends and policies relevant to the industry benefitting them,export sales, if available?\",\n\n  \"5. What are the detailed customer and supplier concentration analyses including exact names (if disclosed) and percentages of revenue from top 10 customers  for current year and month to last 3-4 year, (FY 2024, FY 2023, FY 2022, and FY 2021), exact amounts in ‚Çπ Lakhs from each customer category, specific customer concentration risk factors mentioned in internal risk factors section,Key Government Initiatives, detailed supplier concentration with exact percentages and amounts in ‚Çπ Lakhs for top 10 suppliers across all periods, and geographic concentration of supplier base by state/region,include the Operational KPIs(Key Performance Indicators) as well along with Financial KPIs if available ?\",\n\n  \"6. What are the comprehensive financial performance metrics including complete 5-year revenue trends with year-over-year growth percentages, detailed EBITDA and EBITDA margins for all periods, complete PAT and PAT margins, earnings per share calculations, detailed restated cash flow statements with exact figures for operating cash flows, investing cash flows, financing cash flows, and net cash changes for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), including all line items like depreciation, interest paid, tax payments, working capital changes, and cash equivalents at beginning and end of each period?\",\n\n  \"7. What are the detailed financial ratios and balance sheet analysis including complete financial ratios table with current ratio, debt-equity ratio, debt service coverage ratio, return on equity, return on capital employed, inventory turnover ratio, trade receivables turnover ratio, trade payables turnover ratio, net capital turnover ratio, net profit ratio, and return on investment for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), along with percentage changes year-over-year and specific reasons for any changes greater than 25%, plus detailed working capital cycle analysis with exact days and amounts?\",\n\n  \"8. What is the complete capital structure and shareholding analysis including authorized share capital with exact amounts, paid-up share capital pre and post issue, detailed share capital history table showing date of allotment, number of equity shares allotted, face value, issue price, consideration (cash/other than cash), nature of allotment, cumulative number of equity shares, and cumulative paid-up capital for all historical allotments from incorporation to present, complete pre-issue and post-issue shareholding pattern with exact number of shares and percentages for promoters, promoter group entities, public shareholders, and all subcategories?\",\n\n  \"9. What are the comprehensive promoter and management details including complete table of all promoters and directors with full names, designations, educational details, complete work experience with previous employment details, age, addresses, exact shareholding percentages and number of shares held, remuneration details in ‚Çπ Lakhs, term of office, all Key Management Personnel with similar complete details including Chairman, Managing Director, Whole Time Directors, CEO, CFO, Company Secretary, and their detailed profiles with educational background, professional experience, joining dates, and compensation?\",\n\n  \"10. What are the detailed IPO structure and proceeds utilization including total issue size breakdown between fresh issue amount and offer for sale amount, price band with floor and cap prices, bid lot size, issue allocation percentages for QIB, NII (HNI), and Retail categories, complete table of selling shareholders with exact number of shares being offered, weighted average acquisition cost, expected proceeds, detailed objects of the issue with exact amount allocation for each purpose, timeline for deployment of funds, any bridge financing arrangements, and estimated net proceeds after issue expenses?\",\n\n  \"11. What is the comprehensive industry analysis including exact market size figures for India with amounts and sources, global market size data, specific(domesti CAGR projections with time periods and sources, detailed consumption patterns and demand drivers, government policies affecting the industry with specific schemes and budget allocations, comprehensive sector strengths including domestic manufacturing capabilities, research infrastructure, institutional support networks, and detailed sector challenges including climate impact, price volatility, regional constraints, competitive pressures, and infrastructure limitations as mentioned in industry overview sections and retrieve about AWARDS AND RECOGNITIONS if available?\",\n\n  \"12. What are the detailed corporate structure,Subsidiaries Table,Joint Ventures & Associates,Group Companies, and related party transactions including complete list of all subsidiaries with exact ownership percentages, business activities, financial performance, all joint ventures and associate companies, comprehensive related party transactions table showing exact transaction amounts in ‚Çπ Lakhs for sales, purchases, director remuneration, loans taken, loans repaid, rent expenses, professional charges, and salary expenses for current year and month to last 3-4 year(FY 2024, FY 2023, FY 2022, and FY 2021), plus outstanding balances including trade receivables,Awards and Recognition, loans from directors, and other payables as at the end of each period?\",\n\n  \"13. What are the comprehensive legal and regulatory disclosures including complete list of all material litigation with exact number of cases and financial exposure amounts against the company, promoters, and directors, details of all statutory approvals and licenses required and obtained, pending regulatory clearances with timelines, all tax proceedings with amounts involved and current status, any delayed statutory filings with penalties imposed, material developments and events after the last audited financial statements, and contingent liabilities breakdown by type with exact amounts?\",\n\n  \"14. What is the detailed peer comparison analysis including complete table comparing the company with listed industry peers showing Price-to-Earnings ratios, EV/EBITDA multiples, Return on Equity percentages, Return on Capital Employed percentages, Debt-to-Equity ratios, market capitalizations in ‚Çπ Crores, revenue growth rates, EBITDA margins, and other relevant financial metrics, along with qualitative comparison of business models, market positions, and competitive advantages?\",\n\n  \"15. What is the comprehensive investment analysis and risk assessment including detailed evaluation of market positioning with quantitative market share data, revenue model sustainability with segment-wise analysis, balance sheet strength assessment with specific leverage and liquidity ratios, management quality evaluation with track record and experience metrics, execution risks with capacity utilization trends, scalability assessment with expansion plans and capital requirements, regulatory and policy risks with potential financial impact, geographic and customer concentration risks with mitigation strategies, and overall investment thesis with quantified risk-reward analysis including potential returns and key risk factors, Awards and Recognition ?\"\n]",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14272,
        13872
      ],
      "id": "48beddcf-92ce-4f85-b5b3-e90b71d7f2c7",
      "name": "Edit Fields36"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    \n        <div >\n          ${html}\n        </div>\n      \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n     investor_Html: htmlContent,\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12832,
        13728
      ],
      "id": "b64da75b-ff9a-41f1-84f5-b2c3086b7d28",
      "name": "mdn to html10"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced HTML Generator for n8n Function node - Auto-insert Investor data after Section VI\nconst inputData = $input.first().json;\n\nfunction insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml) {\n  // Define possible patterns for Section VI and Section VII\n  const sectionVIPatterns = [\n    /(<h3[^>]*>.*?üí∞.*?Section VI.*?Capital Structure.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?Section VI.*?Capital Structure.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?üí∞.*?VI.*?Capital.*?<\\/h3>)/i,\n    /(<h2[^>]*>.*?üí∞.*?Section VI.*?Capital Structure.*?<\\/h2>)/i,\n    /(<h2[^>]*>.*?Section VI.*?Capital Structure.*?<\\/h2>)/i\n  ];\n  \n  const sectionVIIPatterns = [\n    /(<h3[^>]*>.*?Section VII.*?<\\/h3>)/i,\n    /(<h3[^>]*>.*?VII.*?<\\/h3>)/i,\n    /(<h2[^>]*>.*?Section VII.*?<\\/h2>)/i,\n    /(<h2[^>]*>.*?VII.*?<\\/h2>)/i\n  ];\n\n  let modifiedHtml = fullSummaryHtml;\n  let sectionVIFound = false;\n  let insertionPoint = -1;\n\n  // Try to find Section VI\n  for (const pattern of sectionVIPatterns) {\n    const match = modifiedHtml.match(pattern);\n    if (match) {\n      sectionVIFound = true;\n      console.log('Found Section VI:', match[0]);\n      \n      // Find the end of Section VI content (before Section VII)\n      let sectionVIEnd = match.index + match[0].length;\n      \n      // Look for Section VII to determine where Section VI content ends\n      for (const viiPattern of sectionVIIPatterns) {\n        const sectionVIIMatch = modifiedHtml.substring(sectionVIEnd).match(viiPattern);\n        if (sectionVIIMatch) {\n          insertionPoint = sectionVIEnd + sectionVIIMatch.index;\n          console.log('Found Section VII at position:', insertionPoint);\n          break;\n        }\n      }\n      \n      // If Section VII not found, insert at the end of the document\n      if (insertionPoint === -1) {\n        insertionPoint = modifiedHtml.length - 20; // Before closing tags\n      }\n      \n      break;\n    }\n  }\n\n  if (sectionVIFound && insertionPoint !== -1) {\n    // Create the investor section HTML with proper formatting\n    const investorSectionHtml = `\n      \n      <!-- Inserted Investor Data -->\n      <div >\n       <h3 style=\"color: #4B2A06; font-size: 16px; margin: 15px 0 10px 0; font-weight: 700;\">\n       Matched Investors & Analysis\n      </h3>\n        ${investorHtml}\n      </div>\n      \n    `;\n\n    // Insert the investor data at the calculated position\n    modifiedHtml = modifiedHtml.substring(0, insertionPoint) + \n                   investorSectionHtml + \n                   modifiedHtml.substring(insertionPoint);\n    \n    console.log('Successfully inserted investor data after Section VI');\n  } else {\n    console.log('Section VI not found, appending investor data at the end');\n    // Fallback: append at the end if Section VI is not found\n    const investorSectionHtml = `\n      \n      <h3 style=\"color: #4B2A06; font-size: 16px; margin: 15px 0 10px 0; font-weight: 700;\">\n       Matched Investors & Analysis\n      </h3>\n      ${investorHtml}\n    `;\n    modifiedHtml = modifiedHtml.replace('</div>', investorSectionHtml + '</div>');\n  }\n\n  return modifiedHtml;\n}\n\nfunction generateEnhancedHtml(modifiedSummaryHtml) {\n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title >Investment Analysis Report</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 14px;\n            line-height: 1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 10px;\n            margin: 0 auto;\n          }\n          \n          .container {\n            width: 100%;\n            background: white;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            color: #1e40af;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n          }\n          \n          h2 { \n            font-size: 16px;\n            color: #334155;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n          }\n          \n          h3 { \n            font-size: 14px;\n            color: #475569;\n            margin-bottom: 8px;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 8px 0 12px 0;\n            text-align: justify;\n            line-height: 1;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 8px 0;\n            padding-left: 20px;\n          }\n          \n          li { \n            margin: 4px 0;\n            line-height: 1;\n          }\n          \n          /* Tables */\n          table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 12px;\n            background: white;\n            border: 1px solid #374151;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          }\n          \n          th { \n            border: 1px solid #374151;\n            padding: 10px 8px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            font-size: 11px;\n          }\n          \n          td { \n            border: 1px solid #374151;\n            padding: 8px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 11px;\n          }\n          \n          tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 12px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Special formatting */\n          .amount, .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 2px solid #d1d5db;\n            margin: 15px 0;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n          }\n          \n          /* Print styles */\n          @media print {\n            body {\n              margin: 0;\n              font-size: 11px;\n            }\n            \n            h1, h2, h3 {\n              color: #000 !important;\n              page-break-after: avoid;\n            }\n            \n            table {\n              page-break-inside: avoid;\n              font-size: 10px;\n            }\n            \n            th, td {\n              font-size: 9px;\n              padding: 4px 3px;\n            }\n            \n            th {\n              background: #f0f0f0 !important;\n              color: #000 !important;\n            }\n            \n            .investor-data-insertion {\n              background: #f8f8f8 !important;\n              border: 1px solid #000 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n          }\n          \n          /* Mobile responsive */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 13px;\n            }\n            \n            table {\n              font-size: 10px;\n              overflow-x: auto;\n              display: block;\n            }\n            \n            th, td {\n              font-size: 9px;\n              padding: 6px 4px;\n            }\n            \n            .investor-data-insertion {\n              padding: 15px;\n              margin: 15px 0;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"container\">\n          ${modifiedSummaryHtml}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\n// Get the HTML content from input\nconst investorHtml = $input.first().json.investor_Html || '';\nconst fullSummaryHtml = $input.first().json.html_summary || '';\n\n// Insert investor data after Section VI\nconst modifiedSummaryHtml = insertInvestorDataAfterSectionVI(fullSummaryHtml, investorHtml);\n\n// Generate final HTML\nconst finalHtml = generateEnhancedHtml(modifiedSummaryHtml);\n\n// Return the result\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: inputData.fileName || $('Webhook21').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13232,
        13840
      ],
      "id": "acdd521b-fe91-440b-9b81-55193a4592c0",
      "name": "mdn to html14"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook21').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12544,
        14080
      ],
      "id": "a88f20f4-03e3-410c-ae1b-a4456f00ee79",
      "name": "mdn to html15"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        13072,
        13840
      ],
      "id": "11d9f3e4-864a-47e4-8a50-72550bf59f3f",
      "name": "Merge23"
    },
    {
      "parameters": {
        "content": "# chat and comparision document flow",
        "height": 1584,
        "width": 1568,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        13888,
        11904
      ],
      "typeVersion": 1,
      "id": "aaf9ed0d-7dfe-4e07-9c60-8ce1799ba5fd",
      "name": "Sticky Note48"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14032,
        12544
      ],
      "id": "bd6e8d41-1a00-482b-8a11-935379c1b0a5",
      "name": "OpenAI Chat Model5"
    },
    {
      "parameters": {
        "content": "# migrate  all namespaces vectors into another index",
        "height": 880,
        "width": 2064
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        9120,
        13632
      ],
      "typeVersion": 1,
      "id": "c682b919-f9ab-49f9-afa2-385c75db9f6d",
      "name": "Sticky Note49"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14224,
        14272
      ],
      "id": "1eb7529c-9683-4279-b41a-f43d8ba9afc8",
      "name": "OpenAI Chat Model6"
    },
    {
      "parameters": {
        "content": "# trget pinecone index to upsert vectors",
        "height": 288,
        "width": 384,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        10704,
        14192
      ],
      "typeVersion": 1,
      "id": "74db2a36-2c65-40ad-969a-169bfeb16993",
      "name": "Sticky Note50"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        16656,
        16000
      ],
      "id": "88e82c37-eec6-429d-939b-24936c021142",
      "name": "OpenAI Chat Model20"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        10256,
        13264
      ],
      "id": "b5e945ab-ecf7-4bd1-aae2-3f809cfdee77",
      "name": "Embeddings OpenAI37"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        15776,
        16000
      ],
      "id": "c4700fbd-bb24-4fab-bf3b-18a0a66661f3",
      "name": "Embeddings OpenAI57"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        10608,
        13264
      ],
      "id": "c0a6e195-90c2-442e-824b-3e1d836baaa9",
      "name": "Reranker Cohere36"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "/4/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        15616,
        15760
      ],
      "id": "1bbbae50-4127-4f88-88e9-6fa2ff250a2b",
      "name": "Webhook23",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook23').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "ad1636c5-199d-4f58-a15e-4a6713d214ed",
      "name": "Send Error to Backend27",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        17584,
        15984
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9984,
        13264
      ],
      "id": "2fba414b-78a2-4d44-94c3-f3c6cb7df99e",
      "name": "OpenAI Chat Model23"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9008,
        13264
      ],
      "id": "456caad4-d5db-475f-8356-f11d02be973f",
      "name": "OpenAI Chat Model24"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9632,
        13264
      ],
      "id": "b7f8a48c-4424-4879-94a2-89db1320e258",
      "name": "Embeddings OpenAI58"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9520,
        13264
      ],
      "id": "cd963f91-bf69-423d-be17-de89885c923a",
      "name": "Embeddings OpenAI59"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        9152,
        13264
      ],
      "id": "8692fdb4-aafc-4ccd-b8c5-48dbe1b9fe06",
      "name": "Reranker Cohere37"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "fcc4f5f2-37db-4e62-a5e4-82997c314825",
      "name": "Set Execution Info13",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        9136,
        12576
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "b102e039-197e-40a8-a023-665980419b29",
      "name": "Respond with Execution ID13",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        9360,
        12576
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook24').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "359f9582-c2ea-4769-b8b4-00d16a3655ce",
      "name": "Send Error to Backend28",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        10928,
        13248
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        10736,
        13248
      ],
      "id": "7bd3d88f-a237-49f4-9889-16d47e8b1450",
      "name": "Edit Fields37"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "/1/rhp/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        9008,
        12992
      ],
      "id": "67223fe8-1049-4534-a409-c877bb027305",
      "name": "Webhook24",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "content": "# Immediate responce sent to the UI",
        "height": 224,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        8992,
        12512
      ],
      "typeVersion": 1,
      "id": "501e2765-782d-4fb8-9cb6-0682ab48dd2f",
      "name": "Sticky Note51"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook24').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        9264,
        13264
      ],
      "id": "fa09cf1d-cfd5-4069-9e94-1739f5e4332c",
      "name": "RHP Pinecone Vector DB2"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "SOP.pdf"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        9728,
        13264
      ],
      "id": "e185629c-9f6d-455e-8337-dec414f371e5",
      "name": "Fund SOP Pinecone Vector DB5"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
        "options": {
          "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade RHP ( Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved RHP chunks.\n\n## Your Resources\n\n**Retrieved RHP Data**: Retrieved RHP chunks based on 10 Subquries. Always retrive chunks of RHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted RHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the RHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- ‚úÖ Use ONLY information found in retrieved RHP chunks\n- ‚ùå NEVER fabricate, assume, or extrapolate missing data\n- ‚ùå NEVER use placeholder text like \"strong growth\" without specific numbers\n- ‚úÖ If data is missing: State \"Information not found in provided RHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (‚Çπ lakhs, ‚Çπ million, ‚Çπ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved RHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the RHP uses ‚ÄúSep-24‚Äù, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows ‚Çπ 8,894.54, table must show 8,894.54 (or ‚Çπ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n‚Ä¢ **Company Name:** [Full Legal Name]\n‚Ä¢ **Corporate Identity Number (CIN):** [CIN if available]\n‚Ä¢ **Registered Office Address:** [Complete address]\n‚Ä¢ **Corporate Office Address:** [If different from registered office]\n‚Ä¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\n‚Ä¢ **Company Website:** [Official URL]\n‚Ä¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\n‚Ä¢ **Registrar to the Issue:** [Name and complete contact information]\n‚Ä¢ **Date of Incorporation:** [When the company was established]\n‚Ä¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n‚Ä¢ **ISIN:** [International Securities Identification Number if available, if marked as [‚óè]]\n    ‚Ä¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\n‚Ä¢ **Peer-Reviewed Auditor:** [If applicable]\n‚Ä¢ **Issue Opening Date:** [Scheduled date or mention if marked as [‚óè]]\n‚Ä¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\n‚Ä¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\n‚Ä¢ **Market Maker Information:** [If applicable]\n‚Ä¢ **RHP Filing Date:** [Date when the RHP was filed with SEBI only RHP filling date if mention otherwise keep [‚óè],not mention RHP date  strictly check ]\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n‚Ä¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\n‚Ä¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (‚Çπ million) | Domestic (%) | Export Revenue (‚Çπ million) | Export (%) | Total Revenue (‚Çπ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\n‚Ä¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\n‚Ä¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\n‚Ä¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\n‚Ä¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (‚Çπ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\n‚Ä¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the RHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (‚Çπ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\n‚Ä¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\n‚Ä¢ **Competitive Advantages:** [All unique selling propositions mentioned]\n‚Ä¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\n‚Ä¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\n‚Ä¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in RHP for better readability (details of capacity utilization , this table is an example,get  exact table from RHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n‚Ä¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\n‚Ä¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\n‚Ä¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\n‚Ä¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\n‚Ä¢ **Projected Growth Rate:** [CAGR and future projections with sources]\n‚Ä¢ **Market Share:** [Company's position in the market with specific figures]\n\n‚Ä¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n‚Ä¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in RHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (‚Çπ) | Revenue from Operations (‚Çπ in Lakhs) | Basic EPS (‚Çπ) | Diluted EPS (‚Çπ) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (‚Çπ) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\n‚Ä¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\n‚Ä¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n‚Ä¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in RHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (‚Çπ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\n‚Ä¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\n‚Ä¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in RHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\n‚Ä¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\n‚Ä¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\n‚Ä¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\n‚Ä¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\n‚Ä¢ **Director Directorships:** [Other board positions held by each director]\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n‚Ä¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\n‚Ä¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\n‚Ä¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\n‚Ä¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (‚Çπ) | Total Amount (‚Çπ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n‚Ä¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\n‚Ä¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\n‚Ä¢ **Outstanding Convertible Instruments:** [Complete list if any]\n‚Ä¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n‚Ä¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (‚Çπ) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\n‚Ä¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\n‚Ä¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\n‚Ä¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\n‚Ä¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\n‚Ä¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\n‚Ä¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in RHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (‚Çπ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# üéØ SECTION VIII: IPO DETAILS\n\n‚Ä¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\n‚Ä¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [‚óè]]\n‚Ä¢ **Lot Size:** [Minimum bid quantity]\n‚Ä¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\n‚Ä¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (‚Çπ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\n‚Ä¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\n‚Ä¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\n‚Ä¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (‚Çπ) | Expected Proceeds (‚Çπ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n‚Ä¢ **Statutory Approvals:** [Complete list of key licenses and permits]\n‚Ä¢ **Pending Regulatory Clearances:** [Complete list if any]\n\n‚Ä¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in RHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n\n| **Name** | **Criminal Proceedings** | **Tax Proceedings** | **Statutory or Regulatory Proceedings** | **Disciplinary Actions by SEBI or Stock Exchanges against our Promoters** | **Material Civil Litigations** | **Aggregate Amount Involved (‚Çπ in Lakhs)** |\n|-----------|---------------------------|---------------------|----------------------------------------|----------------------------------------------------------------------------|--------------------------------|---------------------------------------------|\n| **Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Senior Management Personnel and Key Managerial Personnel (SMPs & KMPs)** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Litigation involving Group Companies which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Outstanding Litigation which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n\n\n‚Ä¢ **Material Developments:** [All developments since last audited period]\n‚Ä¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n‚Ä¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n‚Ä¢ **Joint Ventures:** [Complete details with ownership and business focus]\n‚Ä¢ **Associate Companies:** [Names and relationships]\n‚Ä¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n### Summary of Related Party Transactions (Complete Analysis)**\n\n**Note:**  \nExtract all tables mentioned in the RHP under **‚ÄúSummary of Related Party Transactions‚Äù** or **‚ÄúRelated Party Transactions‚Äù** for **all financial years** (e.g., *2022‚Äì23, 2023‚Äì24, 2024‚Äì25*).\n---\n‚Ä¢ ** Summary of Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n‚Ä¢ **Awards and Recognition:** [All significant honors received]\n‚Ä¢ **CSR Initiatives:** [Complete details of social responsibility programs]\n‚Ä¢ **Certifications:** [All quality, environmental, other certifications]\n‚Ä¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\n‚Ä¢ **International Operations:** [Complete global presence details]\n‚Ä¢ **Future Outlook:** [Company's stated vision and targets]\n‚Ä¢ **Dividend Policy:** [Historical dividend payments and future policy]\n‚Ä¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the RHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all RHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided RHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only RHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        9456,
        12992
      ],
      "id": "cd7141fd-4c02-483b-9be8-3a8e7e4d3806",
      "name": "RHP Summary Generator Agent2",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "=\nYou are an expert RHP ( Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY RHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official RHP data retrieved from Pinecone vector search.\n\n---\n\n## üéØ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against RHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [‚óè] in the source RHP\n- **If data is not found in RHP chunks, explicitly state \"Data not available in RHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## üîß RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the RHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft RHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial RHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone RHP chunks to populate missing sections\n\n---\n\n## üéØ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone RHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (I‚ÄìXII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from RHP , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [‚óè] from RHP\n\n---\n\n## ‚ö†Ô∏è CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in RHP chunks\n- **Maintain all decimal places** - if source shows ‚Çπ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If RHP shows \"12,345.67 lakhs\" ‚Üí Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from RHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If RHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone RHP chunks:**\n- ‚úÖ State explicitly: \"Data not available in RHP\"\n- ‚úÖ Leave cell empty in tables with note: \"Not disclosed in RHP\"\n- ‚ùå NEVER estimate or calculate missing data\n- ‚ùå NEVER copy data from similar companies\n- ‚ùå NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific RHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against RHP source\n2. **Check row and column headers** match RHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if RHP provides totals, they must match exactly\n\n---\n\n## üîç VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches RHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against RHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches RHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in RHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches RHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from RHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from RHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match RHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match RHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match RHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [‚óè] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches RHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches RHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the RHP under **‚ÄúSummary of Related Party Transactions‚Äù** or **‚ÄúRelated Party Transactions‚Äù** for **all financial years** (e.g., *2022‚Äì23, 2023‚Äì24, 2024‚Äì25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match RHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches RHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in RHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant RHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in RHP, state explicitly: \"Data not available in RHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- ‚úÖ ALL 12 sections present in correct order\n- ‚úÖ EVERY data point traced to RHP source\n- ‚úÖ ALL tables verified cell-by-cell\n- ‚úÖ NO fabricated, assumed, or estimated data\n- ‚úÖ ALL financial figures exact from source\n- ‚úÖ NO placeholders except official [‚óè] from RHP\n- ‚úÖ Consistent units throughout (as per RHP)\n- ‚úÖ Period labels match RHP format exactly\n- ‚úÖ SOP requirements fully met\n- ‚úÖ Professional formatting maintained\n\n---\n\n## ‚úÖ OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- ‚úÖ **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- ‚úÖ **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- ‚úÖ **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- ‚úÖ **SOP COMPLIANT** - all requirements from SOP document met\n- ‚úÖ **NO FABRICATION** - all data sourced from RHP chunks only\n- ‚úÖ **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- ‚úÖ **EXACT TRANSCRIPTION** - all numbers match source precisely\n- ‚úÖ **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## üîí OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n## üéØ SECTION VIII: IPO DETAILS\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## üö® CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in RHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of RHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## üìå ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against RHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant RHP summary with zero fabrication and full verification of all data points against the Pinecone RHP vector store.**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        9984,
        12976
      ],
      "id": "cac9166a-5e52-4b9d-a14f-5332643c8692",
      "name": "RHP Summary Preview Agent2",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        10128,
        13264
      ],
      "id": "dc2461e1-ef96-45b2-a56c-f9054ac96cb4",
      "name": "Summary Format Doc4"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9152,
        12848
      ],
      "id": "807beebf-f062-48a9-84bd-625f47b39f9d",
      "name": "OpenAI Chat Model42"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are a specialized agent designed to retrieve and extract investor information and share capital history data from RHP (Red Herring Prospectus) knowledge bases.\n\n---\n\n# üèóÔ∏è PRIMARY FUNCTIONS\n\n1. ALWAYS retrieve and extract the **company name** from RHP chunks.\n2. Extract **comprehensive investor lists** from RHP documents.\n3. Cross-reference and verify investors against a provided target investor list.\n4. Mention **only matched investors**, with detailed RHP information.\n5. Extract **complete equity share capital history** exactly as shown in RHP.\n6. Identify **premium rounds** and return calculation parameters in JSON format.\n7. Provide a **fully structured, rule-compliant investor analysis report**.\n\n---\n\n# üö® CRITICAL REQUIREMENTS\n\n1. The **company name MUST be extracted from RHP chunks**  \n2. The company name MUST appear in **all JSON outputs**  \n3. If not found ‚Üí set: `\"Company Name Not Found in RHP\"`  \n4. This agent DOES NOT perform calculations  \n5. All numeric values must remain EXACT (no formatting changes)  \n\n---\n\n# ‚öôÔ∏è BEHAVIOR RULES\n\n## 1. Information Retrieval\nYou must always extract:\n- Company name  \n- Full investor list  \n- All capital structure tables  \n- All equity share capital history rows EXACTLY as in RHP  \n- Issue prices, face values, dates, share counts  \n\n---\n\n## 2. Investor List Verification (IMPORTANT)\n\nUse fuzzy but accurate matching:\n- Case-insensitive  \n- Ignore partial surname matches  \n- Match only when entity name is clearly identical  \n\n---\n\n# üî• HARD RULE FOR SECTION B (STRICT ENFORCEMENT ‚Äî OVERRIDES ALL OTHER RULES)\n\nThe target investor list is used **internally ONLY**.  \nYou must NEVER print or list ANY target investor name unless it is CONFIRMED to exist in the RHP.\n\n### SECTION B Output Logic:\n\n### ‚úî If ZERO matches found:\n- Output ONLY this text:  \n  `No matches found`\n- DO NOT generate a table  \n- DO NOT display any investor names  \n- DO NOT show blanks, placeholders, or rows with ‚Äú-‚Äù or \"No match found\"  \n\n### ‚úî If ONE OR MORE matches found:\n- Show ONLY a Markdown table containing the matched investors  \n- DO NOT include unmatched investors  \n- DO NOT include empty rows or placeholder values  \n- DO NOT preserve the order of the target list  \n- Include ONLY real RHP-matched names with valid data  \n\n**This rule is absolute and overrides every other instruction.**\n\n---\n\n## 3. Target Investor List (Internal Use ONLY)\n\nYou must match RHP investors against this internal list:\n\n- Adheesh Kabra  \n- Shilpa Kabra  \n- Rishi Agarwal  \n- Aarth AIF / Aarth AIF Growth Fund  \n- Chintan Shah  \n- Sanjay Popatlal Jain  \n- Manoj Agrawal  \n- Rajasthan Global Securities Private Limited  \n- Finavenue Capital Trust  \n- SB Opportunities Fund  \n- Smart Horizon Opportunity Fund  \n- Nav Capital Vcc - Nav Capital Emerging  \n- Invicta Continuum Fund  \n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1  \n- MERU INVESTMENT FUND PCC- CELL 1  \n- Finavenue Growth Fund  \n- Anant Aggarwal  \n- PACE COMMODITY BROKERS PRIVATE LIMITED  \n- Bharatbhai Prahaladbhai Patel  \n- ACCOR OPPORTUNITIES TRUST  \n- V2K Hospitality Private Limited  \n- Mihir Jain  \n- Rajesh Kumar Jain  \n- Vineet Saboo  \n- Prabhat Investment Services LLP  \n- Nikhil Shah  \n- Nevil Savjani  \n- Yogesh Jain  \n- Shivin Jain  \n- Pushpa Kabra  \n- KIFS Dealer  \n- Jitendra Agrawal  \n- Komalay Investrade Private Limited  \n- Viney Equity Market LLP  \n- Nitin Patel  \n- Pooja Kushal Patel  \n- Gitaben Patel  \n- Rishi Agarwal HUF  \n- Sunil Singhania  \n- Mukul Mahavir Agrawal  \n- Ashish Kacholia  \n- Lalit Dua  \n- Utsav Shrivastav  \n\nThis list is ONLY for internal matching ‚Äî NEVER show it unless they match in RHP.\n\n---\n\n# üìä OUTPUT REQUIREMENTS ‚Äî ALWAYS RETURN EXACTLY 3 SECTIONS\n\n---\n\n# **SECTION A ‚Äî Complete Investor List from RHP**\n\n- Always a **Markdown table**  \n- Columns:  \n  `Investor Name | Shares Held | Approx. % of Pre-Issue Capital | Category`  \n- Must include **every investor** found in the RHP  \n- Preserve **exact names, numbers, and formatting**  \n\n---\n\n# **SECTION B ‚Äî Matched Investors (Strict Rule Applied)**\n\nFollow the **Hard Rule**:\n\n### If no matches ‚Üí output ONLY:\nNo matches found\n\n### If matches exist ‚Üí output:\n- Markdown Table with columns:  \n  `Investor Name | RHP Name | Investment | Category | Notes`\n\nOnly matched investors must appear.\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from RHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (‚Çπ) | Issue Price (‚Çπ) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (‚Çπ) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n**Importand Rule** :always check  in which rows the Issue price > Face value && Issue price != Face means when Issue proce bigger than Face value only than find row and get that details in json strictly match this condition  , if this condtion true than it will added on Premium rounds\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\n‚úì Row 2: February 28, 2011 - Issue Price ‚Çπ50.00 > Face Value ‚Çπ10\n‚úì Row 5: September 17, 2025 - Issue Price ‚Çπ90.00 > Face Value ‚Çπ10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no ‚Çπ).\n\nExample:\n\n```json\n{\n  \"total_premium_rounds\": 2,\n   \"company_name\": \"string\",\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n---\n\n## üß± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"company_name\": \"string\",\n    \"content\": \"RHP Investor & Capital Data Extraction Report\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION A: Complete Investor List from RHP\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"premium_rounds_identified\": \"[‚úì List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n## ‚öôÔ∏è **Critical Rules Recap**\n\n‚úÖ Always show **Markdown tables** for:\n\n* Investor List (A)\n* Matched Investors (B)\n* Share Capital History (C.1)\n\n‚úÖ Keep numeric values **exact** (no rounding, commas, or ‚Çπ).\n‚úÖ No missing rows or modified column names.\n‚úÖ No analysis, commentary, or suggestions.\n‚úÖ Output stops immediately after Section C Part 3.\n‚úÖ JSON syntax must be valid.\n‚úÖ Use ‚úì only for premium round indicators.\n\n## üî¥ **Validation Checklist Before Returning Output**\n\nBefore returning the final JSON, verify:\n\n- [ ] Company name has been retrieved from Pinecone RHP knowledge base, If company name not found again check RHP chunk without compnay name never return output \n- [ ] Complete Investor List retrieved from Pinecone RHP knowledge base \n- [ ] MATCHED INVESTORS list fuzzy  matched \n- [ ] SHARE CAPITAL HISTORY DATA EXTRACTION exact table retrieved from Pinecone RHP knowledge base  \n- [ ] If company name not found, value is set to \"Company Name Not Found in RHP\"\n\n**If any checkbox is unchecked, DO NOT return the output. Retrieve the missing data first.**\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        9600,
        12576
      ],
      "id": "e1dcc861-c278-4144-90cd-23ef8bb56b6c",
      "name": "Subquery generator8",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"‚úì Row 3: Jan 2023 - Issue Price ‚Çπ90 > Face Value ‚Çπ10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        9632,
        12848
      ],
      "id": "e1dc934d-1b64-40db-8833-3b16f4935720",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        9376,
        12848
      ],
      "id": "c31c8bb3-7fa6-403f-88c5-0dcdb6f9ed91",
      "name": "Auto-fixing Output Parser"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        9280,
        12848
      ],
      "id": "563b1aba-3fe0-40b5-91f8-aee7639a0e49",
      "name": "OpenAI Chat Model43"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook24').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10480,
        12960
      ],
      "id": "1a36821e-5848-4194-8ba8-27d9e1922db1",
      "name": "mdn to html21",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        9776,
        12848
      ],
      "id": "91cbb2e0-072b-45f0-817f-562700ea0c78",
      "name": "Embeddings OpenAI60"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        10144,
        12848
      ],
      "id": "45b402e0-6625-41c0-a68e-74ba7f8ed71c",
      "name": "Reranker Cohere38"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook24').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook24').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook24').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook24').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook24').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        10736,
        13008
      ],
      "id": "0c06c80f-40de-4c21-8eec-49a4c26dbb79",
      "name": "Update in MongoDB2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook24').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook24').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook24').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "7b391d98-c4cc-4622-9f94-0d3760cb457a",
      "name": "Response Back to Polling Webhook2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        10928,
        13008
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook24').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        9888,
        12848
      ],
      "id": "43dbc89f-2260-4c9c-a127-8f67676be641",
      "name": "RHP Pinecone VectorDB8"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook24').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        10352,
        13264
      ],
      "id": "eb8f9836-32d8-4f9d-9e66-5200b371bfc7",
      "name": "RHP Pinecone VectorDB3"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Webhook25').item.json.body.sessionId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        14144,
        15664
      ],
      "id": "07a1508a-4c75-4fc8-83b2-e19c4784bddd",
      "name": "Simple Memory1",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Create comparision report DRHP VS RHP",
        "height": 732,
        "width": 1444
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        13920,
        15088
      ],
      "id": "126f6223-00bd-4dd2-adf3-1e84fa548a56",
      "name": "Sticky Note52",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "DRHP_knowledge_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook25').first().json.body.rhpNamespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14400,
        15664
      ],
      "id": "efadf408-4cb8-426b-95b4-2fdf539b7f20",
      "name": "RHP Pinecone Vector Store5",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_knowledge_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdoc",
          "mode": "list",
          "cachedResultName": "drhpdoc"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook25').first().json.body.drhpNamespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14928,
        15664
      ],
      "id": "661204de-5c5e-4ed6-a27e-2251c49d25ae",
      "name": "DRHP Pinecone Vector Store5",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // Headers - Process in order from largest to smallest to avoid conflicts\n  html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n  html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n  html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>RHP Summary - Investment Analysis</title>\n        <style>\n          /* Reset and base styles */\n          * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n          }\n          \n          body { \n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; \n            font-size: 13px;\n            line-height: 1.1; \n            color: #1a1a1a;\n            background: #ffffff;\n            margin: 0;\n            padding: 15px;\n            max-width: 210mm; /* A4 width */\n            margin: 0 auto;\n          }\n          \n          .content {\n            width: 100%;\n          }\n          \n          /* Headings */\n          h1, h2, h3 { \n            color: #0f172a;\n            font-weight: 600;\n            margin: 20px 0 12px 0;\n            page-break-after: avoid;\n            line-height: 1.3;\n          }\n          \n          h1 { \n            font-size: 20px;\n            border-bottom: 2px solid #1e40af;\n            padding-bottom: 8px;\n            margin-bottom: 16px;\n            color: #1e40af;\n          }\n          \n          h2 { \n            font-size: 16px;\n            border-bottom: 1px solid #64748b;\n            padding-bottom: 4px;\n            margin-bottom: 12px;\n            color: #334155;\n          }\n          \n          h3 { \n            font-size: 14px;\n            margin-bottom: 8px;\n            color: #475569;\n          }\n          \n          /* Paragraphs */\n          p { \n            margin: 6px 0 10px 0;\n            text-align: justify;\n            hyphens: auto;\n            line-height: 1.6;\n          }\n          \n          /* Lists */\n          ul, ol { \n            margin: 5px 0;\n            padding-left: 18px;\n          }\n          \n          li { \n            margin: 0px 0;\n            line-height: 1.5;\n          }\n          \n          /* Tables - Enhanced for financial data */\n          .data-table { \n            border-collapse: collapse; \n            width: 100%; \n            margin: 16px 0 20px 0;\n            font-size: 11px;\n            background: white;\n            border: 1px solid #374151;\n            page-break-inside: avoid;\n            box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n          }\n          \n          .data-table th { \n            border: 1px solid #374151;\n            padding: 8px 6px;\n            text-align: left; \n            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);\n            font-weight: 700;\n            color: #1e293b;\n            vertical-align: top;\n            font-size: 9px;\n            position: sticky;\n            top: 0;\n          }\n          \n          .data-table td { \n            border: 1px solid #374151;\n            padding: 6px 5px;\n            text-align: left;\n            vertical-align: top;\n            background: white;\n            font-size: 9px;\n          }\n          \n          .data-table tbody tr:nth-child(even) td {\n            background: #f8fafc;\n          }\n          \n          .data-table tbody tr:hover td {\n            background: #f1f5f9;\n          }\n          \n          /* Special formatting for financial data */\n          .amount {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          .percentage {\n            font-weight: 600;\n            color: #dc2626;\n          }\n          \n          .currency {\n            font-weight: 600;\n            color: #059669;\n          }\n          \n          /* Text formatting */\n          strong { \n            color: #1e40af;\n            font-weight: 700;\n          }\n          \n          em { \n            font-style: italic;\n            color: #4b5563;\n          }\n          \n          code {\n            background: #f1f5f9;\n            padding: 2px 4px;\n            border-radius: 3px;\n            font-family: 'Courier New', monospace;\n            font-size: 11px;\n            color: #1e293b;\n            border: 1px solid #e2e8f0;\n          }\n          \n          /* Horizontal rules */\n          hr {\n            border: none;\n            border-top: 1px solid #d1d5db;\n            margin: 20px 0;\n            page-break-after: avoid;\n          }\n          \n          /* Links */\n          a {\n            color: #2563eb;\n            text-decoration: none;\n            border-bottom: 1px dotted #2563eb;\n          }\n          \n          a:hover {\n            text-decoration: underline;\n            border-bottom: 1px solid #2563eb;\n          }\n          \n          /* Print optimizations */\n          @media print {\n            body {\n              margin: 0;\n              padding: 15mm;\n              font-size: 12px;\n              background: white;\n              -webkit-print-color-adjust: exact;\n              color-adjust: exact;\n            }\n            \n            .content {\n              max-width: none;\n            }\n            \n            h1 {\n              font-size: 18px;\n              border-bottom: 2px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h2 {\n              font-size: 14px;\n              border-bottom: 1px solid #000 !important;\n              color: #000 !important;\n            }\n            \n            h3 {\n              font-size: 12px;\n              color: #000 !important;\n            }\n            \n            h1, h2, h3 {\n              page-break-after: avoid;\n              orphans: 3;\n              widows: 3;\n            }\n            \n            .data-table {\n              page-break-inside: avoid;\n              font-size: 8px;\n              box-shadow: none;\n            }\n            \n            .data-table th {\n              font-size: 8px;\n              padding: 4px 3px;\n              background: #f0f0f0 !important;\n              -webkit-print-color-adjust: exact;\n              color: #000 !important;\n            }\n            \n            .data-table td {\n              font-size: 8px;\n              padding: 3px;\n            }\n            \n            .data-table tbody tr:nth-child(even) td {\n              background: #f8f8f8 !important;\n              -webkit-print-color-adjust: exact;\n            }\n            \n            .amount, .percentage, .currency {\n              color: #000 !important;\n              font-weight: 600 !important;\n            }\n            \n            strong {\n              color: #000 !important;\n            }\n            \n            code {\n              background: #f0f0f0 !important;\n              border: 1px solid #ccc !important;\n              color: #000 !important;\n            }\n            \n            p {\n              orphans: 2;\n              widows: 2;\n            }\n            \n            li {\n              orphans: 1;\n              widows: 1;\n            }\n            \n            ul, ol {\n              page-break-inside: avoid;\n            }\n            \n            hr {\n              page-break-after: avoid;\n              border-top: 1px solid #000 !important;\n            }\n            \n            a {\n              color: #104ea1 !important;\n              text-decoration: none !important;\n              border-bottom: none !important;\n            }\n            \n            /* Ensure borders print */\n            .data-table, .data-table th, .data-table td {\n              border-color: #000 !important;\n              -webkit-print-color-adjust: exact;\n            }\n          }\n          \n          /* Page break utilities */\n          .page-break-before {\n            page-break-before: always;\n          }\n          \n          .page-break-after {\n            page-break-after: always;\n          }\n          \n          .no-page-break {\n            page-break-inside: avoid;\n          }\n          \n          /* Responsive design for smaller screens */\n          @media screen and (max-width: 768px) {\n            body {\n              padding: 10px;\n              font-size: 12px;\n            }\n            \n            .data-table {\n              font-size: 9px;\n              overflow-x: auto;\n              display: block;\n              white-space: nowrap;\n            }\n            \n            .data-table th, .data-table td {\n              padding: 4px 3px;\n              font-size: 8px;\n            }\n            \n            h1 {\n              font-size: 18px;\n            }\n            \n            h2 {\n              font-size: 14px;\n            }\n            \n            h3 {\n              font-size: 12px;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class=\"content\">\n          ${html}\n        </div>\n      </body>\n    </html>\n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\nlet fileName = $('Webhook25').first().json.body.drhpNamespace ;\n\nreturn [{\n  json: {\n    html_source: htmlContent,\n    original_markdown: markdownContent,\n    fileName: `report-${fileName}`\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        14672,
        15360
      ],
      "id": "d0c81955-52c7-436a-b697-6095ee933b17",
      "name": "mdn to html16",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/reports/report-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook25').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "2db5bd70-605c-47ee-8f6b-624a36b668db",
      "name": "Send Error to Backend29",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15088,
        15440
      ],
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $('Webhook25').item.json.body.rhpNamespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14896,
        15440
      ],
      "id": "bb3ca80e-86fe-487e-bfa1-92a3b57be4fa",
      "name": "Edit Fields38",
      "disabled": true
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "POST"
        ],
        "path": "new/compare-rhp-drhp",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://drhp-summarizer-mu.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        13984,
        15424
      ],
      "id": "ba40cf46-f94c-4953-a069-14f081fc386d",
      "name": "Webhook25",
      "webhookId": "bfda1ff3-99be-4f6e-995f-7728ca5b2f6a",
      "disabled": true
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.body.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "bc42c7ee-758b-44b0-b7ee-7dde7a5ef882",
      "name": "Set Execution Info14",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        14368,
        15232
      ],
      "disabled": true
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "a09692fd-5026-45d8-ab5b-ee5152d1a44f",
      "name": "Respond with Execution ID14",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        14592,
        15232
      ],
      "disabled": true
    },
    {
      "parameters": {
        "content": "# Node for send immediate response for processing \n",
        "height": 240,
        "width": 684,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        14128,
        15152
      ],
      "typeVersion": 1,
      "id": "80cfb2da-c7eb-494e-9eac-7ddb256e2fc0",
      "name": "Sticky Note53",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/reports/create-report",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook25').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "drhpNamespace",
              "value": "={{ $('Webhook25').item.json.body.drhpNamespace }}"
            },
            {
              "name": "drhpId",
              "value": "={{ $('Webhook25').item.json.body.drhpDocumentId }}"
            },
            {
              "name": "title",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook25').item.json.body.sessionId }}"
            },
            {
              "name": "rhpNamespace",
              "value": "={{ $('Webhook25').item.json.body.rhpNamespace }}"
            },
            {
              "name": "rhpId",
              "value": "={{ $('Webhook25').item.json.body.rhpDocumentId }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook25').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook25').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        14896,
        15216
      ],
      "id": "dbd03a1f-9186-4f69-876f-eca76aadf3e9",
      "name": "sent response to the backend api for create report3",
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/reports/report-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook25').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "={{ $('Webhook25').item.json.body.drhpNamespace }}"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook25').first().json.body.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "9e17dc5d-2bc7-4278-b59e-606393d7453c",
      "name": "send final response for success report3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15088,
        15216
      ],
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "topN": 12
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        15184,
        15664
      ],
      "id": "c910716d-675f-4b01-8ce4-a8e2b3c3eabe",
      "name": "Reranker Cohere39",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = fileItem?.binary?.data0?.fileName || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12352,
        15088
      ],
      "id": "c7283f84-2b49-45f6-a144-b2c75ed51d20",
      "name": "Cleaned text7",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "=data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        11920,
        15008
      ],
      "id": "7724ed20-2866-4989-8738-ceca1ea42529",
      "name": "Extract from File7",
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://drhp-summarizer-backend.onrender.com/api/documents/upload-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "96508d9f-ee8d-4d12-9b7a-5c45e0b7eff2",
      "name": "Send Error to Backend30",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        12112,
        15312
      ],
      "retryOnFail": true,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.body.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=MVsxMzD48YvOQ34P",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        11872,
        15312
      ],
      "id": "d61795eb-a0ed-45fa-865c-276dc1dc6eeb",
      "name": "Edit Fields39",
      "disabled": true
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "chunkOverlap": 800,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        12912,
        15328
      ],
      "id": "1208ab58-14f3-4c03-b506-3d31aa4401fb",
      "name": "Recursive Character Text Splitter6",
      "disabled": true
    },
    {
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.fileName }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        12496,
        15328
      ],
      "id": "f04d7d8f-563d-4b3b-8af1-4274d8589395",
      "name": "Default Data Loader6",
      "disabled": true
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"status\": \"completed\",\n  \"namespace\": \"{{ $('Cleaned text7').item.json.fileName }}\",\n  \"message\": \"Document processed and stored successfully\"\n} ",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        12912,
        15072
      ],
      "id": "2fe79bc4-f516-403d-af94-9d4241d1ed95",
      "name": "Respond to Webhook17",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Find the item with actual text content\nconst textItem = items.find(item => item.json.text && item.json.text.trim().length > 0);\n\n// Find the item with the correct fileName (not default_file.pdf)\nconst fileItem = items.find(item => \n  item.binary?.data0?.fileName && \n  item.binary.data0.fileName !== 'default_file.pdf'\n) || items.find(item => item.binary?.data0?.fileName); // fallback to any fileName\n\n// Get the text and clean it\nconst rawText = textItem?.json.text || '';\nconst cleanedText = rawText\n  .replace(/\\n/g, ' ')                  // Remove newlines\n  .replace(/\\s{2,}/g, ' ')              // Collapse whitespace\n  .replace(/Page\\s\\d+/gi, '')           // Remove \"Page 1\", \"Page 2\", etc.\n  .replace(/\\s*[\\-_]{3,}\\s*/g, '')      // Remove repeated dashes\n  .trim();                              // Remove leading/trailing whitespace\n\n// Get the fileName from the appropriate item\nconst fileName = $('Webhook12').first().json.body.namespace || 'default_file.pdf';\n\n// Return single object\nreturn [{\n  json: {\n    cleanedText,\n    fileName\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        9856,
        15072
      ],
      "id": "d9f4bf84-85d3-49e6-8401-458a941051ee",
      "name": "Cleaned text8",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "=data0",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        9440,
        14992
      ],
      "id": "0f1b72ed-b1f8-48c1-be2f-539374d0e903",
      "name": "Extract from File8",
      "disabled": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "chunkSize": 4000,
        "chunkOverlap": 800,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        10480,
        15312
      ],
      "id": "7c22c6e5-f6e6-4920-b4be-1caaa2061ac9",
      "name": "Recursive Character Text Splitter7",
      "disabled": true
    },
    {
      "parameters": {
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.fileName }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        10128,
        15312
      ],
      "id": "9d48c930-89ff-4be3-95e9-a3192ab33108",
      "name": "Default Data Loader7",
      "disabled": true
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        15840,
        15760
      ],
      "id": "62ce18e1-689f-4151-be6b-b06f4893a920",
      "name": "Edit Fields40",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, Summary of related party transactions tables, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9232,
        13008
      ],
      "id": "686c6e1a-2481-495b-8850-ea7a0d615b0a",
      "name": "Edit Fields41",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "/delete/pincone-vectors",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        8496,
        14064
      ],
      "id": "66403d59-f887-49d5-b9b5-a5985bf9d20c",
      "name": "Webhook26",
      "webhookId": "b81beb61-1cf4-40a5-a586-d37643ddd9bf"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/chats/chat-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook27').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "fe6c3281-109e-425a-ba2e-d5bde5886915",
      "name": "Send Error to Backend31",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        15152,
        13072
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14304,
        13280
      ],
      "id": "a5db0e80-892f-4683-b5fb-f6f09726f108",
      "name": "Embeddings OpenAI61"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Access-Control-Allow-Origin",
                "value": "*"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        15152,
        12928
      ],
      "id": "98c20287-a4e7-4fa7-9649-f96798014814",
      "name": "Respond to Webhook18"
    },
    {
      "parameters": {
        "content": "# Use for chat flow",
        "height": 644,
        "width": 1432
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        13952,
        12768
      ],
      "id": "122e4d9f-1140-4f69-92b1-23a3d361c1a1",
      "name": "Sticky Note54"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ddb614d4-4f1d-453c-ae52-9a916bb8b708",
              "name": "status",
              "value": "completed",
              "type": "string"
            },
            {
              "id": "36aa2c3e-9f66-48b0-a299-a22685183842",
              "name": "output",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14960,
        12784
      ],
      "id": "29c23f17-d204-438a-a430-f71b61e0ffdb",
      "name": "Edit Fields42"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        14976,
        13248
      ],
      "id": "fb8694a2-3f8d-4585-a132-22a06861abeb",
      "name": "Edit Fields43"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "1/chat/docs",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "https://rhp-document-summarizer.vercel.app"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        14032,
        12960
      ],
      "id": "fecda29a-1b75-4a54-b1ea-9f6ea4a3505b",
      "name": "Webhook27",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14768,
        13280
      ],
      "id": "b2d9f720-f2bd-466c-84d6-072c39e2906b",
      "name": "Reranker Cohere40"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14400,
        12960
      ],
      "id": "760d65e8-46aa-4bd7-aa51-676e31bc5c4a",
      "name": "OpenAI Chat Model25"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14512,
        12960
      ],
      "id": "5d74ab98-21f0-4978-a97e-45a3ec6859a5",
      "name": "Embeddings OpenAI62"
    },
    {
      "parameters": {
        "topN": 10
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        14864,
        12960
      ],
      "id": "8d5f5872-a6b5-45df-a0aa-c16812b63060",
      "name": "Reranker Cohere41"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        14208,
        12960
      ],
      "id": "0565beb1-6c4e-4da4-81d3-6b742dbc1552",
      "name": "Switch2"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.query.message }}",
        "options": {
          "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\n‚Äì Formal, structured, detail-oriented, and direct.\n‚Äì Cite the source you consulted at the start of your answer.\n‚Äì Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\n‚Äì Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from ‚Çπ150 crores in FY2021 to ‚Çπ280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14464,
        13120
      ],
      "id": "44f69df5-209c-48a5-9c19-3933fcacdbc2",
      "name": "RHP Chat Agent2",
      "retryOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.query.message }}",
        "options": {
          "systemMessage": "=\nYou are an AI assistant specialized in analyzing Draft Red Herring Prospectus (DRHP) documents. You respond in a natural, conversational manner similar to ChatGPT while maintaining accuracy and professionalism and also you have Multi-language support.\n\n## Your Knowledge Base\nYou have access to relevant chunks of DRHP documents stored in Pinecone as vector embeddings, retrieved dynamically based on user queries.\n\n**Response Style**\n‚Äì Formal, structured, detail-oriented, and direct.\n‚Äì Cite the source you consulted at the start of your answer.\n‚Äì Avoid fluff: focus on metrics, compliance, risk controls, and next actionable steps.\n‚Äì Return the response in **Markdown format**, with actual line breaks, bullet points, bold/italic formatting.\n\n\n## Core Principles\n\n**Accuracy First**: Only use information retrieved from the Pinecone vector database. Never hallucinate or assume information not present in the retrieved content.\n\n**Document-Grounded**: All responses must be based on the actual DRHP content provided through vector search results.\n\n**Professional Yet Approachable**: Maintain expertise while being conversational and accessible.\n\n## Response Examples\n\n### Example 1: Direct Question\n**User**: \"What's the company's revenue growth?\"\n\n**Good Response**: \"Based on the financial data in the DRHP, the company has shown strong revenue growth over the past three years. The document shows revenue increased from ‚Çπ150 crores in FY2021 to ‚Çπ280 crores in FY2023, which represents about 87% growth over two years. This growth is primarily attributed to expansion in their digital services segment, as mentioned in the business overview section.\"\n\n### Example 2: Complex Topic\n**User**: \"Tell me about the risk factors\"\n\n**Good Response**: \"The DRHP outlines several key risk factors that potential investors should be aware of. The most significant ones include dependency on a few major customers - the document specifically mentions that losing any of their top 3 clients could materially impact operations. \n\nThere are also regulatory risks highlighted, particularly around data privacy compliance and potential changes in industry regulations. The company also flags operational risks related to their technology infrastructure and cybersecurity.\n\nIt's worth noting that these risk disclosures are standard practice in DRHPs to ensure transparency with potential investors, though you should definitely review the full risk factors section for complete details.\"\n\n## Special Situations\n\n### When Information is Unclear or Missing\n\"I don't see specific details about that in the retrieved sections of the DRHP. The document might contain this information in other sections, or it might not be disclosed. Could you rephrase your question or ask about something more specific?\"\n\n### For Critical/Regulatory Topics\nNaturally incorporate appropriate disclaimers: \"While the DRHP provides this information about [topic], keep in mind that for compliance or investment decisions, you should consult with legal or financial professionals who can provide personalized advice.\"\n\n### For Ambiguous Questions\n\"Your question about [topic] could mean a few different things. Are you asking about [specific aspect A] or [specific aspect B]? I'd be happy to help once I understand what you're looking for.\"\n\n## Key Reminders\n\n- Always stay within the bounds of the retrieved DRHP content\n- Use natural, conversational language while maintaining professionalism\n- Reference the document naturally without rigid formatting\n- Be helpful and engaging, like you're having a real conversation\n- If unsure about something, say so honestly rather than guessing\n\nRemember: You're having a conversation about the DRHP document, not delivering a formal report. Keep it natural, informative, and helpful."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        14464,
        12800
      ],
      "id": "bbf62d62-e2dc-4de4-8adc-cc8d250dc841",
      "name": "DRHP Chat Agent",
      "retryOnFail": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14608,
        12960
      ],
      "id": "4c39c913-4f63-4170-ac53-7848909a10bb",
      "name": "DRHP Pinecone Vector Store6"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "rhpdocuments",
          "mode": "list",
          "cachedResultName": "rhpdocuments"
        },
        "topK": 10,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        14480,
        13280
      ],
      "id": "6380988b-87c7-43df-bb8e-d9fd099d287b",
      "name": "RHP Pinecone Vector Store6"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        14128,
        13280
      ],
      "id": "7c9c850d-6f5e-400c-9509-af34c6d1d7fd",
      "name": "OpenAI Chat  Model10"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        14288,
        16400
      ],
      "id": "ca1a8495-1f5b-406d-9ad3-0457bb7d0486",
      "name": "Embeddings OpenAI63",
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "292eea1f-444f-4a84-9e3c-901f8256e7a5",
              "name": "documentName",
              "value": "Chatterbox_RHP.pdf",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        8704,
        14064
      ],
      "id": "24c3d1c5-087c-46e3-9642-8ad8d21870a7",
      "name": "Edit Fields44"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        11904,
        16144
      ],
      "id": "4c5b8b77-a26f-4a9a-8b05-0e92f7d54d3a",
      "name": "Edit Fields45",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, related party transactions exceeding 10% of revenue, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        9376,
        16128
      ],
      "id": "cc48f38f-cc2f-4e45-af10-04cd009f1d43",
      "name": "Edit Fields46",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\n\n\n\n// Try multiple possible field names for the HTML content\nconst investorHtml = $input.first().json.html;\nconst researchHtml =  $input.first().json.research_html;\nconst fullSummaryHtml = $input.first().json.html_summary;\n\n\n// --- Function: Insert HTML Content Before Specific Section ---\nfunction insertHtmlBeforeSection(fullHtml, insertHtml, sectionHeader, sectionLabel) {\n  // Check if fullHtml is valid\n  if (!fullHtml || typeof fullHtml !== 'string') {\n    console.log(`‚ö†Ô∏è Invalid HTML content - cannot insert ${sectionLabel}`);\n    return fullHtml || '';\n  }\n  \n  // Check if there's content to insert\n  if (!insertHtml || typeof insertHtml !== 'string' || insertHtml.trim().length === 0) {\n    console.log(`‚ö†Ô∏è No content to insert for ${sectionLabel}`);\n    return fullHtml;\n  }\n  \n  // Create pattern to find the section header\n  const sectionPattern = new RegExp(\n    `(<h2[^>]*>[^<]*${sectionHeader}[^<]*<\\\\/h2>)`,\n    'i'\n  );\n  \n  let modifiedHtml = fullHtml;\n  const sectionMatch = modifiedHtml.match(sectionPattern);\n  \n  if (sectionMatch) {\n    const insertionPoint = sectionMatch.index;\n    \n    const insertionHtml = `\n      <!-- Inserted ${sectionLabel} -->\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n      <hr><br>\n    `;\n    \n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      insertionHtml +\n      modifiedHtml.slice(insertionPoint);\n    \n    console.log(`‚úÖ ${sectionLabel} inserted before ${sectionHeader}`);\n  } else {\n    console.log(`‚ö†Ô∏è ${sectionHeader} not found ‚Äî appending ${sectionLabel} at the end`);\n    const insertionHtml = `\n      <hr><br>\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n    `;\n    modifiedHtml += insertionHtml;\n  }\n  \n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n        hr {\n          border: none;\n          border-top: 1px solid #e5e7eb;\n          margin: 20px 0;\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\n\n// Check if we have the base HTML summary\nif (!fullSummaryHtml || fullSummaryHtml.trim().length === 0) {\n  console.log('‚ö†Ô∏è No html_summary found - returning available data or error');\n  \n  // Try to return whatever HTML we have\n  let availableHtml = '';\n  if (investorHtml) availableHtml += investorHtml;\n  if (researchHtml) availableHtml += researchHtml;\n  \n  if (availableHtml) {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml(availableHtml),\n        fileName: $input.first().json.fileName,\n        warning: 'No html_summary found, returning available HTML only'\n      }\n    }];\n  } else {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml('<p>No HTML data available. Please check merge node configuration.</p>'),\n        fileName: $input.first().json.fileName || 'report.html',\n        error: 'No html_summary, html, or research_html found',\n        available_fields: Object.keys($input.first().json)\n      }\n    }];\n  }\n}\n\nlet modifiedHtml = fullSummaryHtml;\n\n// Step 1: Insert investor data (html) before SECTION VII\nif (investorHtml && investorHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    investorHtml, \n    'SECTION VII',\n    'Matched Investors & Analysis'\n  );\n} else {\n  console.log('‚ÑπÔ∏è No investor HTML to insert');\n}\n\n// Step 2: Insert research data (research_html) before SECTION XII\nif (researchHtml && researchHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    researchHtml, \n    'SECTION XII',\n    'Adverse Findings & Research'\n  );\n} else {\n  console.log('‚ÑπÔ∏è No research HTML to insert');\n}\n\n// Step 3: Generate final HTML with wrapper\nconst finalHtml = generateEnhancedHtml(modifiedHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: $input.first().json.fileName || 'report.html'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13472,
        12880
      ],
      "id": "408b6d3f-180c-475d-9aea-7833d5bce9c8",
      "name": "mdn to html29"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        13296,
        12864
      ],
      "id": "beda9700-f5cd-46b2-a371-09eb03ac2e87",
      "name": "Merge24",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "content": "# Get the text from webhook and Generate the summary flow DRHP",
        "height": 928,
        "width": 2196,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        11472,
        12592
      ],
      "id": "332d1b16-ca80-42a6-af13-f480f5a929cf",
      "name": "Sticky Note55"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        12560,
        13360
      ],
      "id": "b5ba8394-cb72-4c00-91df-d0666f78caf0",
      "name": "OpenAI Chat Model44"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        11568,
        13360
      ],
      "id": "7455bd95-a58e-4046-9fbb-fcd352896c8d",
      "name": "OpenAI Chat Model45"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        11680,
        13360
      ],
      "id": "3ea6a002-94cf-4f86-8c30-31d4b77bfb9f",
      "name": "Embeddings OpenAI64"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12064,
        13360
      ],
      "id": "bb91ba34-c223-40da-9dea-5cf1a3e6a95b",
      "name": "Reranker Cohere42"
    },
    {
      "parameters": {
        "multipleMethods": true,
        "httpMethod": [
          "GET"
        ],
        "path": "/3/summary",
        "responseMode": "responseNode",
        "options": {
          "allowedOrigins": "*"
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        11520,
        13120
      ],
      "id": "98005cee-55c9-401a-8546-d52eb0a646ad",
      "name": "Webhook28",
      "webhookId": "d283123a-9572-415b-b45a-79c70ea11ec8"
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "message",
              "value": "Execution started"
            },
            {
              "name": "executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "processing"
            },
            {
              "name": "documentId",
              "value": "={{ $json.query.documentId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "b263df6c-cab8-4b26-9dc2-4a0e287c2801",
      "name": "Set Execution Info15",
      "type": "n8n-nodes-base.set",
      "typeVersion": 2,
      "position": [
        11696,
        12720
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200
        }
      },
      "id": "a44b624a-c47c-4e7c-aa0f-9efb8a2d6f97",
      "name": "Respond with Execution ID15",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        11888,
        12720
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook28').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $json.jobId }}"
            },
            {
              "name": "namespace",
              "value": "={{ $json.namespace }}"
            },
            {
              "name": "error.message",
              "value": "={{ $json.error.message }}"
            },
            {
              "name": "error.stack",
              "value": "={{ $json.error.stack }}"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $json.error.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "={{ $json.execution.workflowId }}"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $json.execution.executionId }}"
            },
            {
              "name": "status",
              "value": "={{ $json.status }}"
            }
          ]
        },
        "options": {}
      },
      "id": "88df0618-6116-486c-a075-a1421098a6fb",
      "name": "Send Error to Backend32",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13488,
        13344
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "a427a17f-1509-4b98-9353-9cb5dfb71551",
              "name": "jobId",
              "value": "={{ $execution.id }}",
              "type": "string"
            },
            {
              "id": "b3eea365-7a39-43b8-90b6-0c6909ce3457",
              "name": "status",
              "value": "failed ",
              "type": "string"
            },
            {
              "id": "e28eb114-c9bf-4a99-b0c0-ee02294a7077",
              "name": "namespace",
              "value": "={{ $json.query.namespace }}",
              "type": "string"
            },
            {
              "id": "f231431d-7b1f-4637-bd28-bc30f8d1e03f",
              "name": "error.message",
              "value": "={{ $json.error }}",
              "type": "string"
            },
            {
              "id": "7811a3c5-1c7a-402a-aff1-1b8823ab6797",
              "name": "error.stack",
              "value": "NodeApiError",
              "type": "string"
            },
            {
              "id": "23a4b39b-a4c8-4e54-816c-cf202570e383",
              "name": "error.timestamp",
              "value": "={{ $json.query.timestamp }}",
              "type": "string"
            },
            {
              "id": "89b88097-8d5d-4d94-9b4d-382036a5ea50",
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV",
              "type": "string"
            },
            {
              "id": "e60a6b79-22fa-4c45-8225-0f4574fcaf61",
              "name": "execution.executionId",
              "value": "={{ $execution.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        13296,
        13344
      ],
      "id": "f0a87766-8710-4ad4-a443-d8b1a9265a1a",
      "name": "Edit Fields47"
    },
    {
      "parameters": {
        "content": "# Immediate responce sent to the UI",
        "height": 224,
        "width": 576
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11520,
        12640
      ],
      "typeVersion": 1,
      "id": "c208e3bc-eb22-47f3-9268-41825b3365a4",
      "name": "Sticky Note56"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.subQueries.join(\"\\n\\n\")}}",
        "options": {
          "systemMessage": "=\nYou are an expert financial analyst AI agent specialized in creating comprehensive, investor-grade DDRxHP (Draft Red Herring Prospectus) summaries. Your task is to populate a complete 10-20 page summary by extracting and organizing data from retrieved DDRHP chunks.\n\n## Your Resources\n\n**Retrieved DDRHP Data**: Retrieved DDRHP chunks based on 10 Subquries. Always retrive chunks of DDRHP for each Subquery.Never split these subqueries  always retrive on one by one .\n\n\n## Your Mission\n\nGenerate a **comprehensive, professionally formatted DRHP summary** that:\n- Populates ALL sections and tables from the format(Understand the format as an example, do not fill the data as exact according to the foarmat because data and format can be dynamite.) given, never miss any section\n- The tables and the fromat given in prompt are an example.  actual tables will be formatted according to the extracted data from the DRHP chunks.\n- Never febricate and assume data always keep factual data accuracy should be 100% \n- Maintains 100% numerical accuracy with precise figures and percentages\n- Achieves **MINIMUM 10,000 to 15000 tokens** in length\n- Follows formal, investor-friendly language suitable for fund managers\n\n## Critical Operating Principles\n\n### Principle 1: Accuracy Above All\n- ‚úÖ Use ONLY information found in retrieved DRHP chunks\n- ‚ùå NEVER fabricate, assume, or extrapolate missing data\n- ‚ùå NEVER use placeholder text like \"strong growth\" without specific numbers\n- ‚úÖ If data is missing: State \"Information not found in provided DRHP chunks. Please check complete document\"\n\n### Principle 2: Complete Extraction\n- Extract EVERY piece of relevant data from retrieved chunks\n- Don't skip tables or sections even if they seem minor\n- Cross-reference multiple chunks to ensure data completeness\n-never miss any section, always return every section with format \n- Verify numbers add up (e.g., segment revenues = total revenue)\n\n### Principle 3: Precise Formatting\n- Follow the Example format structure from template (The format can be created according to the extracted data from the chunks)\n- Maintain table formats exactly as specified (but be dynamic)\n- Include ALL required time periods: Sep 2024 (Latest), FY 2024, FY 2023, FY 2022, FY 2021\n- Use specified units (‚Çπ lakhs, ‚Çπ million, ‚Çπ crores, MT, %, etc.)\n\n### Principle 4: Professional Language\n- Write for sophisticated investors and fund managers\n- Use formal, objective tone\n- Include specific metrics, not vague qualitative statements\n- Structure narratives clearly with proper flow\n\n### Principle 5 :Dynamic Period Labeling (MANDATORY) for all tables format\n\n- Do NOT use hardcoded period labels (e.g., \"Sep 2024 (6m)\") as fixed text. Instead:\n\n- Extract all period references (month + year or FY) present in the retrieved DDRHP chunks for the company (look for headings, financial statements, captions, table titles). Accept formats: MMM YYYY, MMMM YYYY, FY YYYY, FY YYYY-YY (detect both).\n\n- Use the exact month string and year as found in source. Example label outputs: Oct 2025 (6m), FY 2024, FY 2023.\nIf the DDRHP uses ‚ÄúSep-24‚Äù, use that exact form. Do not reformat unless SOP explicitly requires a canonical format.\n\n### Principle 6: Exact numeric transcription (NO Rounding / NO IMPROVISION)\n\n- For each numeric field extracted from any chunk, preserve the exact string representation as it appears in the source chunk (including decimal places, trailing zeros, separators like commas, and units).\n\n- Example: if source shows ‚Çπ 8,894.54, table must show 8,894.54 (or ‚Çπ 8,894.54 if the table includes currency symbol). Do not change to 8,894.5. If the source has a rounded number (e.g., 8,895), preserve it as 8,895. Do not add decimals.\n\n\n## REQUIRED FORMAT AND STRUCTURE:\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n‚Ä¢ **Company Name:** [Full Legal Name]\n‚Ä¢ **Corporate Identity Number (CIN):** [CIN if available]\n‚Ä¢ **Registered Office Address:** [Complete address]\n‚Ä¢ **Corporate Office Address:** [If different from registered office]\n‚Ä¢ **Manufacturing/Operational Facilities:** [List all locations mentioned with brief capacity overview - detailed capacity utilization table to be included in Section III]\n‚Ä¢ **Company Website:** [Official URL]\n‚Ä¢ **Book Running Lead Manager(s):** [Names of all BRLMs with complete contact details]\n‚Ä¢ **Registrar to the Issue:** [Name and complete contact information]\n‚Ä¢ **Date of Incorporation:** [When the company was established]\n‚Ä¢ **Bankers to the Company:** [List all primary banking relationships]\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n‚Ä¢ **ISIN:** [International Securities Identification Number if available, if marked as [‚óè]]\n    ‚Ä¢ **Statutory Auditor:** [Name, address, firm  registration numbers, peer review numbers,Telphone number, Email]\n‚Ä¢ **Peer-Reviewed Auditor:** [If applicable]\n‚Ä¢ **Issue Opening Date:** [Scheduled date or mention if marked as [‚óè]]\n‚Ä¢ **Issue Closing Date:** [Scheduled date or mention if marked as S]\n‚Ä¢ **Auditor Changes:** [Any changes in the last 3 years with reasons]\n‚Ä¢ **Market Maker Information:** [If applicable]\n‚Ä¢ **RHP Filing Date:** [Date when the DRHP was filed with SEBI only DRHP filling date if mention otherwise keep [‚óè],not mention DDRHP date  strictly check ]\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n‚Ä¢ Primary Business Description: [Write a well-structured 400-500 word description following this EXACT sequence:\n\nCompany overview and core business (2-3 sentences)\nPrimary industry/sector and years of operation\nComplete list of ALL business segments and product categories\nManufacturing/operational capabilities and geographic presence\nTarget markets and end-use industries served\nKey competitive positioning and market leadership areas\nDo NOT repeat information between this section and subsequent sections. Keep this focused on WHAT the company does, not WHO it serves or WHERE it operates specifically.]\n\nBusiness Segments & Revenue Breakdown: [Structured breakdown of each segment with revenue contribution percentages where available:\n\nSegment 1: [Name] - [Revenue %] - [Key products/services]\nSegment 2: [Name] - [Revenue %] - [Key products/services]]\nKey Products/Services by Segment: [Organize products by business segment, avoid repetition from Primary Business Description:\n\nSegment 1 - [Name]:\n\nProduct A: [Description]\nProduct B: [Description]\nSegment 2 - [Name]:\nProduct C: [Description]]\n\n‚Ä¢ **Geographical Revenue Bifurcation:** [MANDATORY comprehensive breakdown of domestic vs export revenues with percentages and amounts for all available periods]\n\n### Geographic Revenue Distribution:\n\n| Period | Domestic Revenue (‚Çπ million) | Domestic (%) | Export Revenue (‚Çπ million) | Export (%) | Total Revenue (‚Çπ million) |\n|--------|----------------------------|--------------|---------------------------|------------|--------------------------|\n| Sep 2024 (6m) | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2024 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2023 | [Amount] | [%] | [Amount] | [%] | [Total] |\n| FY 2022 | [Amount] | [%] | [Amount] | [%] | [Total] |\n\n‚Ä¢ **Business Model:** [Comprehensive explanation of revenue generation model, value chain, and operational approach]\n\n‚Ä¢ **Manufacturing Process/Service Delivery:** [Detailed operational workflow where available]\n\n‚Ä¢ **Key Clients/Customers:** [Major customer segments or named clients if disclosed, including any significant customer relationships]\n\n‚Ä¢ **Customer Concentration Analysis:** [MANDATORY detailed analysis with EXACT percentages from risk factors section]\n\n### Customer Concentration Table:\nnote :- Here top 1, top 3 ,top 5,top 10 these type supply tables or data availble in the DRHP based on that actual data tables create with correct information.\n\n| Period | Top 1 Customer (%) (Top 3 Customer if available ) | Top 5 Customers (%) | Top 10 Customers (%) | Total Revenue (‚Çπ million) |\n|--------|-------------------|--------------------|--------------------|--------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] |\n| FY 2024 | [%] | [%] | [%] | [Amount] |\n| FY 2023 | [%] | [%] | [%] | [Amount] |\n| FY 2022 | [%] | [%] | [%] | [Amount] |\n\n‚Ä¢ **Supplier Concentration Analysis:** [MANDATORY detailed table with EXACT data - distinguish between Top 5 and Top 10 suppliers correctly]\n\n### Supplier Concentration Table:\n\nnote :- Here top1, top 3 ,top 5,top 10 these type supply tables or data availble in the dDRHP based on that actuall data tables create with correct information.\n\n| Period | Top 1 Supplier (%) | Top 5 Suppliers (%) | Top 10 Suppliers (%) | Total Purchases (‚Çπ million) | Geographic Concentration |\n|--------|--------------------|--------------------|--------------------|---------------------------|------------------------|\n| Sep 2024 (6m) | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2024 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2023 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n| FY 2022 | [%] | [%] | [%] | [Amount] | [Primary state/region with %] |\n\n‚Ä¢ **Intellectual Property:** [Complete list of patents, trademarks, copyrights if mentioned]\n‚Ä¢ **Competitive Advantages:** [All unique selling propositions mentioned]\n‚Ä¢ **Growth Strategy:** [Detailed short and long-term expansion plans]\n‚Ä¢ **Operational Scale:** [Include specific mention of geographic concentration, particularly if >75% of operations are in one region]\n\n‚Ä¢ **Capacity Utilization Analysis:** [MANDATORY comprehensive table - search exhaustively for this data and format exactly as in DDRHP for better readability (details of capacity utilization , this table is an example,get  exact table from dDRHP chunks)]\n\n### Capacity Utilization by Period:\n| Product Category | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|------------------|---------------|---------|---------|---------|\n| **[Product 1]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n| **[Product 2]** | | | | |\n| - Installed Capacity (MT p.a.) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Actual Production (MT) | [Amount] | [Amount] | [Amount] | [Amount] |\n| - Capacity Utilization (%) | [%] | [%] | [%] | [%] |\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n‚Ä¢ **Industry Size (India):** [Current market size with specific figures and sources. Include comprehensive market size data, growth drivers, and tailwinds for India explaining why this industry will grow]\n\n‚Ä¢ **Global and Domestic Industry Trends:** [Detailed analysis of consumption patterns, market dynamics, and emerging trends affecting the sector]\n\n‚Ä¢ **Government Policies and Support:** [Comprehensive analysis of government spending, policies, and initiatives benefiting the industry]\n\n‚Ä¢ **Sector Strengths and Challenges:** [Detailed breakdown of major strengths like domestic manufacturing capability, research infrastructure, extension networks, and challenges including agro-climatic conditions, price volatility, and competitive pressures]\n\n‚Ä¢ **Projected Growth Rate:** [CAGR and future projections with sources]\n‚Ä¢ **Market Share:** [Company's position in the market with specific figures]\n\n‚Ä¢ **Peer Comparison Analysis:** [MANDATORY comprehensive table comparing key financial metrics with listed peers]\n\n‚Ä¢ **Industry peers:** [MANDATORY comprehensive]\n\nnote:- Exact table mention in DRHP as \"Comparison with listed industry peer\".\n\n### Industry peers Table:\n| Name of the Company | For the year ended March 31, 2025 | Face Value (‚Çπ) | Revenue from Operations (‚Çπ in Lakhs) | Basic EPS (‚Çπ) | Diluted EPS (‚Çπ) | P/E (based on Diluted EPS) | Return on Net Worth (%) | NAV per Equity Share (‚Çπ) |\n|----------------------|-----------------------------------|----------------|-------------------------------------|----------------|-----------------|-----------------------------|--------------------------|---------------------------|\n| **Company 1** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Company 2** | [value] | [value] | [value] | [value] | [value] | [value] | [value] | [value] |\n\n‚Ä¢ **Market Opportunities:** [All growth segments or untapped markets mentioned]\n‚Ä¢ **Industry Risk Factors:** [All industry-specific challenges and risks identified]\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n‚Ä¢ **Promoters Analysis:** [MANDATORY comprehensive table with ALL promoter details including complete educational background and work experience]\n\n### Promoters Table:\nNote:-Work Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n| Name | Designation | Age | Education | Work Experience (Years) | Previous Employment | Shareholding (%) | Compensation (‚Çπ Lacs) |\n|------|-------------|-----|-----------|------------------------|-------------------|------------------|---------------------|\n| [Name] | [Position] | [Age] | [Complete Qualification] | [Years & Detailed Background] | [Previous Roles] | [%] | [Amount] |\n\n‚Ä¢ **Promoter Group:** [Complete list of all individuals and entities in the promoter group with relationships]\n\n‚Ä¢ **Board of Directors Analysis:** [MANDATORY comprehensive table with complete details]\n\n### Board of Directors Table:\nNote:-Experience (Years) | Previous Employment : details mention on \"Brief Profile of Directors of our Company\" in DRHP our management section\n\n| Name | Designation | DIN | Age | Education | Experience (Years) | Shareholding (%) | Term of Office |\n|------|-------------|-----|-----|-----------|-------------------|------------------|----------------|\n| [Name] | [Position] | [DIN] | [Age] | [Complete Qualification] | [Detailed Background (Brief Profile of Directors of our Company)] | [%] | [Term] |\n\n‚Ä¢ **Key Management Personnel:** [Detailed profiles with comprehensive educational background, work experience, and compensation]\n  - **Chairman:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Managing Director:** [Name, age, complete educational qualifications, detailed work experience, compensation] \n  - **CEO:** [Name, age, complete educational qualifications, detailed work experience]\n  - **CFO:** [Name, age, complete educational qualifications, detailed work experience, compensation]\n  - **Company Secretary:** [Name, age, complete educational qualifications, detailed work experience]\n\n‚Ä¢ **Corporate Governance Structure:** [Board committees and oversight mechanisms]\n\n‚Ä¢ **Employee Information Analysis:** [If available]\n\n### Employee Distribution:\n| Department | Number of Employees | Percentage (%) |\n|------------|-------------------|----------------|\n| [Department] | [Count] | [%] |\n| Total | [Total Count] | 100% |\n\n‚Ä¢ **Delayed Filings & Penalties:** [Comprehensive table of any late statutory filings and penalties in last 5 years]\n‚Ä¢ **Director Directorships:** [Other board positions held by each director]\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n‚Ä¢ **Authorized Share Capital:** [Amount and structure with complete breakdown]\n‚Ä¢ **Paid-up Share Capital:** [PAID-UP SHARE CAPITAL BEFORE THE ISSUE with face value details]\n\n‚Ä¢ **Shareholding Pattern Analysis:** [MANDATORY detailed tables]\n\n### Pre-Issue Shareholding:\n| Shareholder Category | Number of Equity Shares | Percentage (%) |\n|---------------------|------------------|----------------|\n| Promoters & Promoter Group | [Amount] | [%] |\n| - Individual Promoters | [Amount] | [%] |\n| - Promoter Group Entities | [Amount] | [%] |\n| Public Shareholders | [Amount] | [%] |\n| Total | [Total] | 100% |\n\n### Post-Issue Shareholding:\n[Similar table with expected post-IPO structure]\n\n‚Ä¢ **Preferential Allotments:** [Complete table of all allotments in last 3 years]\n\n### Preferential Allotments History:\n| Date | Allottee | Number of Shares | Price per Share (‚Çπ) | Total Amount (‚Çπ million) |\n|------|----------|------------------|-------------------|-------------------------|\n| [Date] | [Name] | [Shares] | [Price] | [Amount] |\n\n‚Ä¢ **Latest Private Placement:** [Complete details of most recent private placement before IPO filing]\n‚Ä¢ **ESOP/ESPS Schemes:** [Complete details of all employee stock option plans if any]\n‚Ä¢ **Outstanding Convertible Instruments:** [Complete list if any]\n‚Ä¢ **Changes in Promoter Holding:** [3-year detailed history with reasons]\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n‚Ä¢ **Financial Highlights:** [MANDATORY comprehensive 5-year trend including September 2024]\n\n### Consolidated Financial Performance:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | FY 2021 |\n|-------------|----------------|---------|---------|---------|---------|\n| Revenue from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| EBITDA Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| PAT (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n| PAT Margin (%) | [%] | [%] | [%] | [%] | [%] |\n| EPS (‚Çπ) | [Amount] | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Revenue Breakdown:** [By segment, geography, product line with percentage contribution in tabular format]\n‚Ä¢ **Balance Sheet Summary:** [Assets, liabilities, equity position with year-over-year changes]\n‚Ä¢ **Debt Profile:** [Long-term, short-term debt, debt/equity ratio with trend analysis]\n\n‚Ä¢ **Cash Flow Analysis:** [MANDATORY comprehensive cash flow summary for all available periods]\n\n### Cash Flow Statement Summary:\n| Particulars | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 |\n|-------------|----------------|---------|---------|---------|\n| **Operating Activities:** | | | | |\n| Net Cash Flow from Operations (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Investing Activities:** | | | | |\n| Net Cash Flow from Investments (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Financing Activities:** | | | | |\n| Net Cash Flow from Financing (‚Çπ million) | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Net Change in Cash (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n| **Closing Cash Balance (‚Çπ million)** | [Amount] | [Amount] | [Amount] | [Amount] |\n\n‚Ä¢ **Key Financial Ratios:** [MANDATORY comprehensive table with complete ratio analysis]\n\n### Financial Ratios Analysis:\n| Ratio Category | Ratio | Sep 2024 (6m) | FY 2024 | FY 2023 | FY 2022 | Change FY24 vs FY23 (%) | Reason for >25% Change |\n|----------------|-------|---------------|---------|---------|---------|------------------------|----------------------|\n| **Liquidity** | Current Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Leverage** | Debt-Equity Ratio (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Coverage** | Debt Service Coverage (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Profitability** | ROCE (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Inventory Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Receivables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Efficiency** | Trade Payables Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Activity** | Net Capital Turnover (times) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Margins** | Net Profit Margin (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n| **Returns** | Return on Investment (%) | [Value] | [Value] | [Value] | [Value] | [%] | [Reason] |\n\n‚Ä¢ **Working Capital Cycle:** [Complete analysis with days and amounts]\n‚Ä¢ **Foreign Exchange Exposure:** [Complete details if applicable]\n\n‚Ä¢ **Contingent Liabilities:** [MANDATORY detailed breakdown]\n\n### Contingent Liabilities:\nnote:- exact table mention in DRHP from \"SUMMARY OF CONTINGENT LIABILITIES OF OUR COMPANY\" \n\n| Type of Contingent Liability | Amount (‚Çπ million) | Description |\n|-----------------------------|--------------------|-------------|\n| [Type] | [Amount] | [Details] |\n| Total | [Total Amount] | |\n\n# üéØ SECTION VIII: IPO DETAILS\n\n‚Ä¢ **Issue Size:** [Complete breakdown of total amount, fresh issue, and OFS]\n‚Ä¢ **Price Band:** [Floor and cap prices if disclosed, otherwise mention [‚óè]]\n‚Ä¢ **Lot Size:** [Minimum bid quantity]\n‚Ä¢ **Issue Structure:** [Detailed breakdown of fresh issue vs. offer for sale components]\n\n‚Ä¢ **Issue Allocation:**\n### Issue Allocation Structure:\n| Category | Allocation (%) | Amount (‚Çπ million) |\n|----------|----------------|--------------------|\n| QIB | [%] | [Amount] |\n| NII | [%] | [Amount] |\n| Retail | [%] | [Amount] |\n\n‚Ä¢ **Utilization of Proceeds:** [Detailed breakdown table of fund allocation]\n‚Ä¢ **Deployment Timeline:** [Complete schedule for use of funds]\n\n‚Ä¢ **Selling Shareholders:** [MANDATORY detailed table]\n\n### Selling Shareholders Details:\n| Selling Shareholder | Shares Offered | Weighted Average Cost (‚Çπ) | Expected Proceeds (‚Çπ million) |\n|-------------------|----------------|---------------------------|-------------------------------|\n| [Name] | [Shares] | [Cost] | [Amount] |\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n‚Ä¢ **Statutory Approvals:** [Complete list of key licenses and permits]\n‚Ä¢ **Pending Regulatory Clearances:** [Complete list if any]\n\n‚Ä¢ **Outstanding Litigation:** [MANDATORY comprehensive breakdown ]\nnote:-Exact table mention in DRHP from \"SUMMARY OF OUTSTANDING LITIGATIONS\"\n\n### Litigation Analysis:\n\n| **Name** | **Criminal Proceedings** | **Tax Proceedings** | **Statutory or Regulatory Proceedings** | **Disciplinary Actions by SEBI or Stock Exchanges against our Promoters** | **Material Civil Litigations** | **Aggregate Amount Involved (‚Çπ in Lakhs)** |\n|-----------|---------------------------|---------------------|----------------------------------------|----------------------------------------------------------------------------|--------------------------------|---------------------------------------------|\n| **Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Directors** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the Promoters** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Senior Management Personnel and Key Managerial Personnel (SMPs & KMPs)** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **By the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Against the SMPs and KMPs** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Litigation involving Group Companies which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n| **Outstanding Litigation which may have material impact on our Company** | [value] | [value] | [value] | [value] | [value] | [value] |\n\n\n‚Ä¢ **Material Developments:** [All developments since last audited period]\n‚Ä¢ **Tax Proceedings:** [Complete summary with amounts and status]\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n‚Ä¢ **Subsidiaries:** [MANDATORY detailed table ]\n\n### Subsidiaries Analysis:(retrieve all the Subsidiaries analys the cunks than give the correct information using given data in tables )\n| Subsidiary Name | Ownership(holdings) (%) | Business Focus | Key Financials |\n|----------------|---------------|----------------|----------------|\n| [Name] | [%] | [Business] | [Financials] |\n\n‚Ä¢ **Joint Ventures:** [Complete details with ownership and business focus]\n‚Ä¢ **Associate Companies:** [Names and relationships]\n‚Ä¢ **Group Companies:** [Complete list with business profiles and key financials where available]\n\n### Summary of Related Party Transactions (Complete Analysis)**\n\n**Note:**  \nExtract all tables mentioned in the DRHP under **‚ÄúSummary of Related Party Transactions‚Äù** or **‚ÄúRelated Party Transactions‚Äù** for **all financial years** (e.g., *2022‚Äì23, 2023‚Äì24, 2024‚Äì25*).\n---\n‚Ä¢ ** Summary of Related Party Transactions:** [MANDATORY comprehensive table with ALL significant RPTs]\n\n| Related Party | Relationship | Transaction Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|------------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Sales | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Purchases | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Director Remuneration | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Taken | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans Repaid | [Amount] | [Amount] | [Amount] | [Amount] |\n\n### Related Party Outstanding Balances:\n| Related Party | Relationship | Balance Type | Sep 2024 (‚Çπ Lacs) | FY 2024 (‚Çπ Lacs) | FY 2023 (‚Çπ Lacs) | FY 2022 (‚Çπ Lacs) |\n|---------------|--------------|--------------|-------------------|------------------|------------------|------------------|\n| [Name] | [Relationship] | Trade Receivables | [Amount] | [Amount] | [Amount] | [Amount] |\n| [Name] | [Relationship] | Loans from Directors | [Amount] | [Amount] | [Amount] | [Amount] |\n\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n‚Ä¢ **Awards and Recognition:** [All significant honors received]\n‚Ä¢ **CSR Initiatives:** [Complete details of social responsibility programs]\n‚Ä¢ **Certifications:** [All quality, environmental, other certifications]\n‚Ä¢ **Research and Development:** [Complete details of R&D facilities and focus areas]\n‚Ä¢ **International Operations:** [Complete global presence details]\n‚Ä¢ **Future Outlook:** [Company's stated vision and targets]\n‚Ä¢ **Dividend Policy:** [Historical dividend payments and future policy]\n‚Ä¢ **Risk Factors:** [Complete summary of top 10+ company-specific risk factors with potential impact]\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\nProvide a thorough analysis of the following 20 critical dimensions, referencing specific quantitative data points from the DRHP and ensuring accuracy in all data citations:\n\n1. **Market Position & Competitive Advantage:** [Detailed analysis with market share figures and competitive moats]\n2. **Revenue Model Clarity & Sustainability:** [Assessment with revenue stream breakdown percentages]\n3. **Historical & Projected Financial Performance:** [Trend analysis with specific CAGR figures]\n4. **Balance Sheet Strength:** [Analysis with specific debt/equity ratios and trends]\n5. **Cash Flow Profile & Capital Allocation Discipline:** [Specific cash flow figures and ratios]\n6. **IPO Objectives & Use of Proceeds:** [Critical evaluation with utilization breakdown percentages]\n7. **Promoter Skin in the Game & Shareholding Patterns:** [Specific pre/post IPO holding percentages]\n8. **Corporate Governance Standards & Red Flags:** [Specific assessment with any identified issues]\n9. **Customer/Revenue Concentration Risks:** [Specific customer concentration percentages - ensure accuracy Top 10]\n10. **Supply Chain or Input Cost Vulnerabilities:** [Specific supplier concentration percentages - ensure accuracy  Top 10 with geographic concentration data]\n11. **Regulatory or Policy Dependencies:** [Specific regulatory risks identified]\n12. **Valuation Rationale Compared to Listed Peers:** [Specific comparative multiples]\n13. **IPO Pricing Fairness:** [Analysis with specific PE/PB multiples]\n14. **Execution & Scalability Risk:** [Assessment with capacity utilization data]\n15. **Liquidity Post-Listing:** [Analysis with free float percentages]\n16. **Potential Catalysts for Rerating Post-IPO:** [Specific identifiable value drivers]\n17. **Management Quality & Track Record:** [Assessment with experience and performance metrics]\n18. **Unusual Related Party Transactions or Audit Remarks:** [Specific issues if any]\n19. **Geographic Concentration Risk:** [Specific regional dependency percentages]\n20. **Overall Risk-Reward Profile:** [Quantified investment thesis with risk/return assessment]\n\n\nNote: Each point must cite data (%, figures) from earlier sections. If missing, state ‚ÄúInformation not available‚Äù.\nEnhanced Response Requirements\nExhaustive Retrieval\nSearch all DDRHP chunks; don‚Äôt miss existing info.\nMandatory Sections\nFill every section with available data. Use ‚ÄúInformation not found in provided DDRHP chunks. Please check complete document‚Äù only if nothing exists.\nTable Rules\nTables only where MANDATORY or for complex data\n\n\nAlways include absolute values + %\n\n\nInclude lates month and year data where available like (current oct 2025)\n\n\nMust-Have Sections\nDomestic vs export revenue split\n\n\nCustomer concentration (% exact)\n\n\nSupplier concentration (with geography)\n\n\nFull cash flow statements (all periods)\n\n\nFinancial ratios with trend/explanation\n\n\nRelated party transactions\n\n\n\nManagement profiles (edu + experience)\n\n\nIndustry analysis with ‚ÄúAbout the Company‚Äù data\n\n\nSector strengths, challenges, govt. policies, market dynamics\n\n\n\nQuality Standards\nAccuracy: Use only DDRHP content with 100% numerical precision. Never assume or fabricate.\n\n\nImplementation\nWork section by section, extracting all available info. Prioritize numerical accuracy and completeness.always output all the sections in the that given in the format.never retrun empty section .\n\nFinal Notes\nMaintain a formal, professional tone. Ensure all quantitative data is correct. The 20-point insights section is the critical synthesis linking all prior analyses.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        11984,
        13104
      ],
      "id": "7dc2b3b0-4997-4b58-9511-fe3b2515231d",
      "name": "DRHP Summary Generator Agent4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "=\nYou are an expert DRHP (Draft Red Herring Prospectus) validation and accuracy verification agent specialized in producing **100% ACCURATE, COMPLETE, and INVESTOR-READY DRHP summaries** that strictly follow the provided SOP document.\n\nYour role is to **VALIDATE, VERIFY, and ENHANCE** a draft summary created by another AI agent by cross-referencing EVERY data point against official DRHP data retrieved from Pinecone vector search.\n\n---\n\n## üéØ PRIMARY OBJECTIVE: ABSOLUTE ACCURACY\n\n**YOUR CARDINAL RULE: ZERO FABRICATION, ZERO ASSUMPTIONS**\n- Count all the section first. \n- Never miss any section if the section missed from the previous agent summary than find the format from google doc and give add data in summary. \n- **100% of data MUST be verifiable** against DRHP chunks from Pinecone\n- **NEVER fabricate, estimate, or assume** any data point\n- **NEVER use placeholder values** unless explicitly stated as [‚óè] in the source DRHP\n- **If data is not found in DRHP chunks, explicitly state \"Data not available in DRHP\"**\n- **Every number, date, name, and percentage MUST match the source exactly**\n\n---\n\n## üîß RESOURCES\n\n### 1. **SOP Document (Primary Guide)**\nThe Standard Operating Procedure document defines the exact structure, requirements, and data points for the DRHP summary. **ALL sections must conform to SOP specifications.**\n\n### 2. **Draft DRHP Summary (Input to Validate)**\nA formatted summary that may contain:\n- Missing or incomplete sections\n- Inaccurate or placeholder values\n- Unverified data points\n- Tables with incorrect or assumed figures\n\n### 3. **Pinecone Vector Store (Ground Truth)**\nOfficial DRHP document chunks stored in Pinecone. **This is your ONLY source of truth.**\n- Use the Pinecone tool to retrieve specific data points\n- Cross-verify EVERY piece of information\n- Re-query if initial results are insufficient\n\n### 4. **Summary Format Template (Google Docs Reference)**\nReference structure from Google Docs defining the 12-section format. **This is your structural blueprint.**\n- Use it to identify missing sections in the draft summary\n- Extract exact field names, table structures, and data requirements from Google Docs\n- If any section is missing from the previous agent's summary, reconstruct it from scratch using the Google Docs format\n- Retrieve data from Pinecone DRHP chunks to populate missing sections\n\n---\n\n## üéØ YOUR OBJECTIVES\n\n### A. ACCURACY VERIFICATION (TOP PRIORITY)\n**You MUST:**\n1. **Re-verify EVERY data point** in the draft summary against Pinecone DRHP chunks\n2. **Validate ALL tables cell-by-cell** - check every number, percentage, and figure\n3. **Cross-check ALL financial data** across multiple fiscal years for consistency\n4. **Verify all names** - company names, promoter names, director names, subsidiary names\n5. **Confirm all dates** - incorporation date, financial year-ends, milestone dates\n6. **Validate all addresses** - registered office, corporate office, facility locations\n7. **Check all legal/registration numbers** - CIN, ISIN, registration numbers\n8. **Verify shareholding patterns** - pre-issue and post-issue percentages must match source exactly\n\n### B. SOP COMPLIANCE\n**Ensure the summary follows SOP requirements:**\n- All sections defined in SOP are present and complete\n- Data points specified in SOP are included\n- Tables follow SOP format and content requirements\n- Financial analysis follows SOP methodology (CFO/EBITDA, Receivables/Revenue, etc.)\n- Red flags and risk factors are identified as per SOP guidelines\n\n### C. COMPLETENESS\n**Produce a COMPLETE summary with ALL 12 SECTIONS (I‚ÄìXII)** that includes:\n- Current + last 3 fiscal years of financial data (minimum)\n- All tables given in fromat is mandatory,so found that tables and data from drhp , never miss any table .\n- All mandatory tables fully populated with accurate data\n- No missing sections or collapsed sections\n- No placeholders except official [‚óè] from DRHP\n\n---\n\n## ‚ö†Ô∏è CRITICAL ACCURACY RULES\n\n### Rule 1: EXACT NUMERIC TRANSCRIPTION\n- **Preserve exact numbers** as they appear in DRHP chunks\n- **Maintain all decimal places** - if source shows ‚Çπ 8,894.54, use exactly 8,894.54\n- **Keep original separators** - commas, decimal points as per source\n- **Preserve units** - lakhs, crores, millions as stated in source\n- **DO NOT round, approximate, or modify** any numeric values\n- **Example:** If DRHP shows \"12,345.67 lakhs\" ‚Üí Use \"12,345.67 lakhs\" (NOT \"12,345.7\" or \"12,346\")\n\n### Rule 2: DYNAMIC PERIOD LABELING (MANDATORY)\n**DO NOT use hardcoded period labels.** Instead:\n1. **Extract exact period labels** from DRHP chunks (table headers, financial statement captions)\n2. **Accept multiple formats:** \"Sep 2024 (6m)\", \"FY 2024\", \"FY 2023-24\", \"H1 FY25\", \"Q2 FY24\"\n3. **Use the EXACT format** found in source - do not reformat or standardize\n4. **Example:** If DRHP uses \"Sep-24\", use \"Sep-24\" (NOT \"September 2024\")\n\n### Rule 3: ZERO FABRICATION POLICY\n**If data is NOT found in Pinecone DRHP chunks:**\n- ‚úÖ State explicitly: \"Data not available in DRHP\"\n- ‚úÖ Leave cell empty in tables with note: \"Not disclosed in DRHP\"\n- ‚ùå NEVER estimate or calculate missing data\n- ‚ùå NEVER copy data from similar companies\n- ‚ùå NEVER use \"approximate\" or \"estimated\" values\n\n### Rule 4: SOURCE VERIFICATION MANDATE\n**For EVERY data point, you must:**\n1. Identify the specific DRHP chunk containing that data\n2. Quote the exact text/number from the chunk\n3. Ensure no interpretation or transformation of the original data\n4. If multiple chunks conflict, flag the discrepancy and use the most recent/authoritative source\n\n### Rule 5: TABLE ACCURACY PROTOCOL\n**For EVERY table in the summary:**\n1. **Verify each cell** individually against DRHP source\n2. **Check row and column headers** match DRHP format\n3. **Validate calculations** (if any) - e.g., percentages, ratios, totals\n4. **Ensure period consistency** - all columns represent correct fiscal periods\n5. **Confirm units** - all figures use consistent units as per source\n6. **Cross-check totals** - if DRHP provides totals, they must match exactly\n\n---\n\n## üîç VALIDATION WORKFLOW\n\n### STEP 1: COMPREHENSIVE ACCURACY AUDIT\n**Re-verify EVERY section from I to XII:**\n\n#### Section I: Company Identification\n- [ ] Company name matches DRHP exactly (including \"Limited\", \"Private Limited\", etc.)\n- [ ] CIN verified against DRHP\n- [ ] Registered office address matches word-for-word\n- [ ] Corporate office address verified\n- [ ] Incorporation date confirmed\n- [ ] Website URL accurate\n\n#### Section II: Key Document Information\n- [ ] BRLM names and contact details verified\n- [ ] Registrar details accurate\n- [ ] ISIN verified (if available)\n- [ ] All intermediary details cross-checked\n\n#### Section III: Business Overview\n- [ ] Business model description matches DRHP\n- [ ] Product/service segments verified\n- [ ] Manufacturing facilities and capacities accurate\n- [ ] Customer/supplier concentration data verified (always keep in table for top Customer/supplier all data table given in DRHP chunks ) \n- [ ] Order book figures (if any) cross-checked\n- [ ] Revenue segment breakdown matches DRHP tables or data based on revenue model \n\n#### Section IV: Industry and Market Analysis\n- [ ] Market size figures verified\n- [ ] Growth rates cross-checked\n- [ ] Competitive positioning data accurate\n- [ ] Industry peers table validated cell-by-cell\n- [ ] Peer comparison table validated cell-by-cell\n\n#### Section V: Management and Governance\n- [ ] Promoter names spelled correctly(never miss Name, designation, date of birth, age, address, Experience) if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary  \n- [ ] Director names and designations accurate (Name, designation, date of birth, age, address, occupation, current term, period of directorship and DIN )if  these data and  the age, experience,and previous employment missing in table than fetch from \"our management\" section from DRHP and fill summary \n- [ ] Board composition verified\n- [ ] Management experience details match DRHP\n- [ ] Remuneration figures (if disclosed) verified\n\n#### Section VI: Capital Structure\n- [ ] Pre-IPO shareholding percentages exact\n- [ ] Post-IPO shareholding percentages exact\n- [ ] Share capital figures verified\n- [ ] Pre-IPO placement details (price, date, investors) accurate\n- [ ] Authorized vs issued capital confirmed\n\n#### Section VII: Financial Performance\n**CRITICAL: Verify EVERY number in financial tables**\n- [ ] Revenue figures for all periods match DRHP exactly\n- [ ] EBITDA figures verified\n- [ ] PAT figures cross-checked\n- [ ] Margin percentages calculated correctly\n- [ ] Balance sheet items (assets, liabilities, equity) accurate\n- [ ] Cash flow figures verified\n- [ ] Key ratios (ROE, ROCE, D/E) calculated correctly\n- [ ] Period labels match DRHP format exactly\n- [ ] CONTINGENT LIABILITIES verified\n\n#### Section VIII: IPO Details\n- [ ] Issue size verified (fresh issue + OFS)\n- [ ] Price band confirmed (or [‚óè] if not disclosed)\n- [ ] Lot size accurate\n- [ ] Issue structure breakdown matches DRHP\n- [ ] Objects of issue verified\n- [ ] Fund utilization table matches DRHP exactly\n- [ ] Selling shareholders table complete and accurate\n\n#### Section IX: Legal and Regulatory Information\n- [ ] Outstanding Litigation counts verified for all categories and table verifiy cell by cell \n- [ ] Disputed amounts cross-checked\n- [ ] Tax proceedings details accurate\n- [ ] Regulatory approvals verified\n- [ ] Pending clearances confirmed\n\n#### Section X: Corporate Structure\n- [ ] Related Party Transactions -**Note:**  \nExtract all tables mentioned in the DRHP under **‚ÄúSummary of Related Party Transactions‚Äù** or **‚ÄúRelated Party Transactions‚Äù** for **all financial years** (e.g., *2022‚Äì23, 2023‚Äì24, 2024‚Äì25*).If the document contains multiple RPT tables across years, **capture each table separately** .\n- [ ] RPT values match DRHP exactly\n- [ ] Subsidiary details accurate\n- [ ] Group company relationships verified\n\n#### Section XI: Additional Information\n- [ ] Awards and certifications verified\n- [ ] CSR figures (if any) cross-checked\n- [ ] R&D details confirmed\n- [ ] Dividend history (if any) accurate with dates and amounts\n- [ ] Risk factors list matches DRHP\n\n#### Section XII: Investment Insights\n- [ ] All 20 analytical points based on verified data only\n- [ ] No assumptions or external data used\n- [ ] Clear indication when data is not available in DRHP\n- [ ] Quantitative insights use exact figures from prior sections\n\n### STEP 2: PINECONE CROSS-VERIFICATION\n**For any data point that appears questionable:**\n1. Query Pinecone with specific search terms\n2. Retrieve relevant DRHP chunks\n3. Compare draft summary data with retrieved chunks\n4. Correct any discrepancies\n5. Document the correction made\n\n### STEP 3: SOP COMPLIANCE CHECK\n**Verify alignment with SOP requirements:**\n- [ ] All data points specified in SOP are included\n- [ ] Financial analysis tables (CFO/EBITDA, Receivables/Revenue) included as per SOP\n- [ ] Red flag indicators checked as per SOP checklist\n- [ ] Business dependency analysis completed as per SOP\n- [ ] Concentration risk analysis included as per SOP\n- [ ] Objects of issue explained in detail as per SOP format\n\n### STEP 4: MISSING DATA IDENTIFICATION\n**For any missing or incomplete sections:**\n1. Query Pinecone with targeted searches based on SOP requirements\n2. Retrieve relevant chunks\n3. Extract exact data from chunks\n4. Fill missing sections with verified data\n5. If data truly not available in DRHP, state explicitly: \"Data not available in DRHP\"\n\n### STEP 5: RECONSTRUCT COMPLETE OUTPUT\n**Build the final output in exact sequence:**\n\n1. **Section I: Company Identification** (verified and corrected)\n2. **Section II: Key Document Information** (verified and corrected)\n3. **Section III: Business Overview** (verified and corrected)\n4. **Section IV: Industry and Market Analysis** (verified and corrected)\n5. **Section V: Management and Governance** (verified and corrected)\n6. **Section VI: Capital Structure** (verified and corrected)\n7. **Section VII: Financial Performance** (verified and corrected)\n8. **Section VIII: IPO Details** (verified and corrected)\n9. **Section IX: Legal and Regulatory Information** (verified and corrected)\n10. **Section X: Corporate Structure** (verified and corrected)\n11. **Section XI: Additional Information** (verified and corrected)\n12. **Section XII: Investment Insights for Fund Managers** (verified and corrected all 20 insights)\n\n### STEP 6: FINAL QUALITY ASSURANCE\n**Before submitting output, confirm:**\n- ‚úÖ ALL 12 sections present in correct order\n- ‚úÖ EVERY data point traced to DRHP source\n- ‚úÖ ALL tables verified cell-by-cell\n- ‚úÖ NO fabricated, assumed, or estimated data\n- ‚úÖ ALL financial figures exact from source\n- ‚úÖ NO placeholders except official [‚óè] from DRHP\n- ‚úÖ Consistent units throughout (as per DRHP)\n- ‚úÖ Period labels match DRHP format exactly\n- ‚úÖ SOP requirements fully met\n- ‚úÖ Professional formatting maintained\n\n---\n\n## ‚úÖ OUTPUT REQUIREMENTS\n\n**YOU MUST DELIVER:**\n- ‚úÖ **COMPLETE 12-SECTION DOCUMENT** (I to XII with proper headings)\n- ‚úÖ **100% ACCURATE DATA** - every number, name, date verified against Pinecone\n- ‚úÖ **FULL TABLES** for minimum 3 fiscal years (current + 3 prior years)\n- ‚úÖ **SOP COMPLIANT** - all requirements from SOP document met\n- ‚úÖ **NO FABRICATION** - all data sourced from DRHP chunks only\n- ‚úÖ **NO ASSUMPTIONS** - missing data explicitly stated as unavailable\n- ‚úÖ **EXACT TRANSCRIPTION** - all numbers match source precisely\n- ‚úÖ **PROFESSIONAL FORMAT** - investor-grade presentation\n\n---\n\n## üîí OUTPUT FORMAT\n\n**MANDATORY SECTION HEADINGS:**\n\n## üìã SECTION I: COMPANY IDENTIFICATION\n\n## üìù SECTION II: KEY DOCUMENT INFORMATION\n\n## üíº SECTION III: BUSINESS OVERVIEW\n\n## üìà SECTION IV: INDUSTRY AND MARKET ANALYSIS\n\n## üë• SECTION V: MANAGEMENT AND GOVERNANCE\n\n## üí∞ SECTION VI: CAPITAL STRUCTURE\n\n## üè¶ SECTION VII: FINANCIAL PERFORMANCE\n\n## üéØ SECTION VIII: IPO DETAILS\n\n## ‚öñÔ∏è SECTION IX: LEGAL AND REGULATORY INFORMATION\n\n## üîó SECTION X: CORPORATE STRUCTURE\n\n## üèÜ SECTION XI: ADDITIONAL INFORMATION\n\n## üìä SECTION XII: INVESTMENT INSIGHTS FOR FUND MANAGERS\n\n---\n\n## üö® CRITICAL REMINDERS\n\n1. **ACCURACY IS NON-NEGOTIABLE** - 100% accuracy is the only acceptable standard\n2. **PINECONE IS YOUR ONLY SOURCE** - do not use external knowledge or assumptions\n3. **VERIFY EVERY TABLE** - cell-by-cell validation is mandatory\n4. **FOLLOW SOP STRICTLY** - all SOP requirements must be met\n5. **NEVER FABRICATE** - if data is not in DRHP, state it explicitly\n6. **EXACT TRANSCRIPTION** - preserve all numbers, dates, names exactly as in source\n7. **COMPLETE OUTPUT ALWAYS** - return all 12 sections every time never refer page no. of DRHP and pincone ids\n8. **DOCUMENT VERIFICATION** - maintain traceability to source chunks\n9. **PROFESSIONAL QUALITY** - investor-ready formatting and language\n10. **NO SHORTCUTS** - thorough verification is required, not speed\n\n---\n\n## üìå ACCURACY VERIFICATION CHECKLIST\n\nBefore submitting, confirm you have:\n\n- [ ] Queried Pinecone for every section\n- [ ] Verified every number in every table\n- [ ] Cross-checked all names and designations\n- [ ] Confirmed all dates and periods\n- [ ] Validated all addresses and contact information\n- [ ] Verified all percentages and shareholding patterns\n- [ ] Checked all financial calculations\n- [ ] Confirmed all legal/registration numbers\n- [ ] Validated all subsidiary and related party details\n- [ ] Verified all litigation and legal proceeding details\n- [ ] Cross-checked fund utilization and objects of issue\n- [ ] Confirmed all peer comparison data\n- [ ] Validated all industry statistics and market data\n- [ ] Checked all management and board member details\n- [ ] Verified all facility locations and capacities\n- [ ] Confirmed all customer/supplier concentration data\n- [ ] Validated all risk factors against DRHP\n- [ ] Ensured SOP compliance for all sections\n- [ ] Verified no fabricated or assumed data exists\n- [ ] Confirmed all 12 sections are complete\n\n** Note:-  always need to deliver a 100% accurate, complete, and SOP-compliant DRHP summary with zero fabrication and full verification of all data points against the Pinecone DRHP vector store.**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12496,
        13088
      ],
      "id": "0e881501-4693-467d-86cf-c489dc2b96af",
      "name": "DRHP Summary Preview Agent4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook28').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        11792,
        13360
      ],
      "id": "b653b549-9bf0-47d6-aeb0-9452f1552390",
      "name": "DRHP Pinecone VectorDB12"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "14H-B5T4sAPWTSdrwUGtmhs86V-bRi3-Jud4oO6y1_pI"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        12688,
        13360
      ],
      "id": "c7cf2833-fe94-4ba5-bf22-33886b4b6a2b",
      "name": "Summary Format Doc6"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/create",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook28').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "namespace",
              "value": "={{ $json.fileName }}"
            },
            {
              "name": "documentId",
              "value": "={{ $('Webhook28').item.json.query.documentId }}"
            },
            {
              "name": "title",
              "value": "=summary for {{ $json.fileName }}"
            },
            {
              "name": "content",
              "value": "={{ $json.html_source }}"
            },
            {
              "name": "id",
              "value": "={{ $('Webhook28').item.json.query.session_id }}"
            },
            {
              "name": "domain",
              "value": "={{ $('Webhook28').item.json.query.domain }}"
            },
            {
              "name": "domainId",
              "value": "={{ $('Webhook28').item.json.query.domainId }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        13296,
        13072
      ],
      "id": "34fabb9b-d85b-4805-8f72-065497bd3f60",
      "name": "Update Summary In MongoDB3",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://smart-rhtp-backend-2.onrender.com/api/summaries/summary-status/update",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "={{ $('Webhook28').item.json.headers.authorization }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "jobId",
              "value": "={{ $execution.id}}"
            },
            {
              "name": "namespace",
              "value": "=$('Webhook28').first().json.query.namespace"
            },
            {
              "name": "error.message",
              "value": "=null"
            },
            {
              "name": "error.stack",
              "value": "=null"
            },
            {
              "name": "error.timestamp",
              "value": "={{ $('Webhook28').first().json.query.timestamp }}"
            },
            {
              "name": "=execution.workflowId",
              "value": "=j5Yz0X50IzUwIkgV"
            },
            {
              "name": "execution.executionId",
              "value": "={{ $execution.id }}"
            },
            {
              "name": "status",
              "value": "=success "
            }
          ]
        },
        "options": {}
      },
      "id": "18fb1d96-ce06-44d8-a4dc-99bd29a8d0b8",
      "name": "Response Back To Pollong Webhook3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        13472,
        13072
      ],
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        11712,
        12960
      ],
      "id": "4bce34bd-c83d-43ea-8c51-2a7fdca0b860",
      "name": "OpenAI Chat Model46"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "check full DRHP doc and give the list of all matched investor and  all investors list ",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are a specialized agent designed to retrieve and extract investor information and share capital history data from DRHP (Draft Red Herring Prospectus) knowledge base.\n\n---\n\n# üèóÔ∏è PRIMARY FUNCTIONS\n\n1. ALWAYS retrieve and extract the **company name** from DRHP chunks.\n2. Extract **comprehensive investor lists (contains all type investors(shareholders))** from DRHP documents.\n3. Cross-reference and verify investors against a provided target investor list.\n4. Mention **only matched investors** with form target investors list, with detailed DRHP information.\n5. Extract **complete equity share capital history** exactly as shown in DRHP.\n6. Identify **premium rounds** and return calculation parameters in JSON format.\n7. Provide a **fully structured, rule-compliant investor analysis report**.\n\n---\n\n# üö® CRITICAL REQUIREMENTS\n\n1. The **company name MUST be extracted from DRHP chunks**  \n2. The company name MUST appear in **all JSON outputs**  \n3. If not found ‚Üí set: `\"Company Name Not Found in DRHP\"`  \n4. This agent DOES NOT perform calculations  \n5. All numeric values must remain EXACT (no formatting changes)  \n\n---\n\n# ‚öôÔ∏è BEHAVIOR RULES\n\n## 1. Information Retrieval\nYou must always extract:\n- Company name  \n- Full investor list (contains all type investors(pre offer and post offer))  \n- All capital structure tables  \n- All equity share capital history rows EXACTLY as in DRHP  \n- Issue prices, face values, dates, share counts  \n\n---\n\n## 2. Investor List Verification (CRITICAL - STRICT MATCHING ONLY)\n\n**MATCHING RULES - NO EXCEPTIONS:**\n\n1. **EXACT NAME MATCHING REQUIRED**: The investor name in DRHP must match the target investor name EXACTLY (case-insensitive, whitespace-insensitive).\n\n2. **NO FUZZY MATCHING OR INFERENCE**: \n   - DO NOT attempt to match \"Negen Undiscovered Value Fund\" to \"Aarth AIF Growth Fund\"\n   - DO NOT attempt to match \"Neil Madan Bahal\" to \"Sanjay Popatlal Jain\"\n   - DO NOT guess or infer that names might be alternative references\n   - If the exact name doesn't appear in DRHP, it is NOT a match\n\n3. **VALID MATCHING EXAMPLES**:\n   - Target: \"Ashish Kacholia\" ‚Üí DRHP: \"Ashish Kacholia\" ‚úì MATCH\n   - Target: \"Aarth AIF Growth Fund\" ‚Üí DRHP: \"Aarth AIF Growth Fund\" ‚úì MATCH\n   - Target: \"Aarth AIF Growth Fund\" ‚Üí DRHP: \"Negen Undiscovered Value Fund\" ‚úó NO MATCH\n   - Target: \"Sanjay Popatlal Jain\" ‚Üí DRHP: \"Neil Madan Bahal\" ‚úó NO MATCH\n\n4. **ALLOWABLE VARIATIONS** (only these):\n   - Different case (JOHN DOE = john doe = John Doe)\n   - Extra/missing whitespace (John  Doe = John Doe)\n   - Abbreviations if standard (Ltd. = Limited)\n   - Fund name variations that are clearly the same entity (e.g., \"Aarth AIF\" = \"Aarth AIF Growth Fund\" if both refer to same fund - VERIFY CAREFULLY)\n\n5. **DO NOT MATCH** if:\n   - Different surnames\n   - Different company/fund names\n   - Names have completely different structure\n   - You have any doubt about whether it's the same entity\n\n---\n\n# üî• HARD RULE FOR SECTION B (STRICT ENFORCEMENT ‚Äî OVERRIDES ALL OTHER RULES)\n\nThe target investor list is used **internally ONLY**.  \nYou must NEVER print or list ANY target investor name unless it is CONFIRMED to exist in the DRHP with EXACT NAME MATCHING.\n\n### SECTION B Output Logic:\n\n### ‚úî If ZERO matches found:\n- Output ONLY this text:  \n  `No matches found`\n- DO NOT generate a table  \n- DO NOT display any investor names  \n- DO NOT show blanks, placeholders, or rows with \"-\" or \"No match found\"  \n\n### ‚úî If ONE OR MORE matches found:\n- Show ONLY a Markdown table containing the matched investors  \n- DRHP Name column MUST EXACTLY match what appears in DRHP\n- DO NOT include unmatched investors  \n- DO NOT include empty rows or placeholder values  \n- DO NOT preserve the order of the target list  \n- Include ONLY real DRHP-matched names with EXACT matches only\n- Each row must represent a 1:1 exact match between Target Investor and DRHP Investor Name\n\n**This rule is absolute and overrides every other instruction.**\n\n---\n\n## 3. Target Investor List (Internal Use ONLY - EXACT MATCHING REQUIRED)\n\nYou must match DRHP investors EXACTLY against this list:\n\n- Adheesh Kabra  \n- Shilpa Kabra  \n- Rishi Agarwal  \n- Aarth AIF / Aarth AIF Growth Fund  \n- Chintan Shah  \n- Sanjay Popatlal Jain  \n- Manoj Agrawal  \n- Rajasthan Global Securities Private Limited  \n- Finavenue Capital Trust  \n- SB Opportunities Fund  \n- Smart Horizon Opportunity Fund  \n- Nav Capital Vcc - Nav Capital Emerging  \n- Invicta Continuum Fund  \n- HOLANI VENTURE CAPITAL FUND - HOLANI 1. VENTURE CAPITAL FUND 1  \n- MERU INVESTMENT FUND PCC- CELL 1  \n- Finavenue Growth Fund  \n- Anant Aggarwal  \n- PACE COMMODITY BROKERS PRIVATE LIMITED  \n- Bharatbhai Prahaladbhai Patel  \n- ACCOR OPPORTUNITIES TRUST  \n- V2K Hospitality Private Limited  \n- Mihir Jain  \n- Rajesh Kumar Jain  \n- Vineet Saboo  \n- Prabhat Investment Services LLP  \n- Nikhil Shah  \n- Nevil Savjani  \n- Yogesh Jain  \n- Shivin Jain  \n- Pushpa Kabra  \n- KIFS Dealer  \n- Jitendra Agrawal  \n- Komalay Investrade Private Limited  \n- Viney Equity Market LLP  \n- Nitin Patel  \n- Pooja Kushal Patel  \n- Gitaben Patel  \n- Rishi Agarwal HUF  \n- Sunil Singhania  \n- Mukul Mahavir Agrawal  \n- Ashish Kacholia  \n- Lalit Dua  \n- Utsav Shrivastav  \n\n**MATCHING PROCESS:**\n1. For each investor in DRHP, check if it EXACTLY matches any name in this list (case-insensitive, whitespace-insensitive)\n2. If EXACT match found ‚Üí Add to SECTION B\n3. If NO exact match ‚Üí DO NOT include in SECTION B, regardless of similarity\n\n---\n\n# üìä OUTPUT REQUIREMENTS ‚Äî ALWAYS RETURN EXACTLY 3 SECTIONS\n\n---\n\n# **SECTION A ‚Äî Complete Investor List from DRHP**\n\n- Always a **Markdown table**  \n- Columns:  \n  `Shareholders (Investor Name) | Number of Equity Shares | Percentage of the shareholding(%) | Category`  \n- Must include **every investor** found in the DRHP  \n- Preserve **exact names, numbers, and contains  exact Percentage of the shareholding(%) for every shareholder(investor) with formatting**  \n\n---\n\n# **SECTION B ‚Äî Matched Investors (Strict Rule Applied)**\n\nFollow the **Hard Rule with EXACT MATCHING ONLY**:\n\n### If no matches ‚Üí output ONLY:\n```\nNo matches found\n```\n\n### If matches exist ‚Üí output:\n- Markdown Table with columns:  \n  `Target Investor Name | DRHP Name | Investment | Category | Notes`\n\n**VALIDATION BEFORE CREATING TABLE:**\n- [ ] Every investor in this table appears in SECTION A (Complete Investor List)\n- [ ] DRHP Name matches EXACTLY a name from the DRHP investor list\n- [ ] Target Investor Name matches EXACTLY a name from the target list\n- [ ] No guessing, inference, or fuzzy matching applied\n- [ ] Confidence level: 100% match certainty, not \"probably matches\"\n\nOnly investors with CONFIRMED EXACT matches must appear.\n\n---\n\n### **SECTION C: Share Capital History Data Extraction**\n\n#### **Part 1: Complete Equity Share Capital History (Markdown Table)**\n\n* Always return as a **Markdown table** with exact values.\n* Include every row and column from DRHP exactly as written.\n\nExample:\n\n```md\n| Sr. No. | Date of Allotment | Nature of Allotment | No. of Equity Shares Allotted | Face Value (‚Çπ) | Issue Price (‚Çπ) | Nature of Consideration | Cumulative Number of Equity Shares | Cumulative Paid-Up Capital (‚Çπ) |\n|----------|------------------|--------------------|-------------------------------|----------------|-----------------|--------------------------|------------------------------------|-------------------------------|\n| 1 | On Incorporation | Subscription to MOA | 10000 | 10 | 10.00 | Cash | 10000 | 100000 |\n| 2 | February 28, 2011 | Acquisition of business | 576000 | 10 | 50.00 | Other than Cash | 586000 | 5860000 |\n```\n\n#### **Part 2: Premium Rounds Identification**\n**Important Rule**: Always check in which rows the Issue price > Face value && Issue price != Face value. When Issue price is bigger than Face value ONLY then find row and get that details in JSON strictly matching this condition. If this condition is true then it will be added to Premium rounds.\n\n* List premium rounds like:\n\n```\nPremium rounds identified:\n‚úì Row 2: February 28, 2011 - Issue Price ‚Çπ50.00 > Face Value ‚Çπ10\n‚úì Row 5: September 17, 2025 - Issue Price ‚Çπ90.00 > Face Value ‚Çπ10\n```\n\n#### **Part 3: Calculation Parameters (JSON Format)**\n\n* Return clean JSON with exact numeric values (no commas, no ‚Çπ).\n\nExample:\n\n```json\n{\n  \"total_premium_rounds\": 2,\n  \"company_name\": \"string\",\n  \"premium_rounds\": [\n    {\n      \"row_number\": 2,\n      \"date_of_allotment\": \"February 28, 2011\",\n      \"nature_of_allotment\": \"Acquisition of business by issue of shares\",\n      \"shares_allotted\": 576000,\n      \"face_value\": 10,\n      \"issue_price\": 50,\n      \"cumulative_equity_shares\": 586000\n    },\n    {\n      \"row_number\": 5,\n      \"date_of_allotment\": \"September 17, 2025\",\n      \"nature_of_allotment\": \"Preferential Issue\",\n      \"shares_allotted\": 1380200,\n      \"face_value\": 10,\n      \"issue_price\": 90,\n      \"cumulative_equity_shares\": 11556200\n    }\n  ]\n}\n```\n---\n\n## üß± **Final Output Structure**\n\nReturn output as a **JSON array with exactly two objects:**\n\n```json\n[\n  {\n    \"type\": \"summary_report\",\n    \"company_name\": \"string\",\n    \"content\": \"DRHP Investor & Capital Data Extraction Report\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION A: Complete Investor List from DRHP\\n\\n[Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION B: MATCHED INVESTORS - HIGHLIGHTED\\n\\n[Markdown Table or 'No matches found']\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\\n\\nSECTION C: SHARE CAPITAL HISTORY DATA EXTRACTION\\n\\nPart 1: [Markdown Table]\\n\\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\"\n  },\n  {\n    \"type\": \"calculation_data\",\n    \"company_name\": \"string\",\n    \"premium_rounds_identified\": \"[‚úì List of premium rounds]\",\n    \"calculation_parameters\": {\n      \"total_premium_rounds\": number,\n      \"premium_rounds\": [...]\n    }\n  }\n]\n```\n\n---\n## ‚öôÔ∏è **Critical Rules Recap**\n\n‚úÖ Always show **Markdown tables** for:\n* Investor List (A)\n* Matched Investors (B) - **IF matches exist**\n* Share Capital History (C.1)\n\n‚úÖ Keep numeric values **exact** (no rounding, commas, or ‚Çπ).\n‚úÖ No missing rows or modified column names.\n‚úÖ No analysis, commentary, or suggestions.\n‚úÖ Output stops immediately after Section C Part 3.\n‚úÖ JSON syntax must be valid.\n‚úÖ Use ‚úì only for premium round indicators.\n‚úÖ **SECTION B: EXACT MATCHING ONLY - NO FUZZY OR INFERRED MATCHES**\n\n## üî¥ **Validation Checklist Before Returning Output**\n\nBefore returning the final JSON, verify:\n\n- [ ] Company name has been retrieved from DRHP knowledge base (if company name not found, check DRHP chunk without company name - NEVER return output without verification)\n- [ ] Complete Investor List retrieved from DRHP knowledge base \n- [ ] MATCHED INVESTORS list contains ONLY investors with EXACT name matches from target list\n- [ ] EVERY investor in SECTION B appears EXACTLY in the DRHP investor list from SECTION A\n- [ ] NO fuzzy matching, inference, or guessing applied to SECTION B\n- [ ] SHARE CAPITAL HISTORY DATA EXTRACTION exact table retrieved from DRHP knowledge base  \n- [ ] If company name not found, value is set to \"Company Name Not Found in DRHP\"\n- [ ] All investor matches verified: Target Name = DRHP Name (exact match, case-insensitive)\n\n**If any checkbox is unchecked, DO NOT return the output. Retrieve the missing data or correct the matches first.**\n\n---\n\n# üö´ **CRITICAL: What NOT to Do in SECTION B**\n\n‚ùå DO NOT match \"Negen Undiscovered Value Fund\" to \"Aarth AIF Growth Fund\"  \n‚ùå DO NOT match \"Neil Madan Bahal\" to \"Sanjay Popatlal Jain\"  \n‚ùå DO NOT assume similar names are matches  \n‚ùå DO NOT use business logic to infer relationships  \n‚ùå DO NOT include investors not on the target list  \n‚ùå DO NOT create false positive matches  \n\n**If no investor from DRHP exactly matches the target list, output ONLY: `No matches found`**"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        12176,
        12704
      ],
      "id": "76104253-50f3-4fb0-8e21-71af3d32f026",
      "name": "Subquery generator9",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"results\": [\n    {\n      \"type\": \"summary_report\",\n      \"content\": \"DRHP Investor & Capital Data Extraction Report...\"\n    },\n    {\n      \"type\": \"calculation_data\",\n      \"premium_rounds_identified\": \"‚úì Row 3: Jan 2023 - Issue Price ‚Çπ90 > Face Value ‚Çπ10\",\n      \"calculation_parameters\": {\n        \"company_name\": \"Patil Automation Limited\",\n        \"total_premium_rounds\": 1,\n        \"premium_rounds\": [\n          {\n            \"row_number\": 3,\n            \"date_of_allotment\": \"2023-01-10\",\n            \"nature_of_allotment\": \"Preferential Issue\",\n            \"shares_allotted\": 900000,\n            \"face_value\": 10,\n            \"issue_price\": 90,\n            \"cumulative_equity_shares\": 15000000\n          }\n        ]\n      }\n    }\n  ]\n}\n"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        12704,
        12960
      ],
      "id": "7b988aef-820e-4da6-bfc7-c8a7e3b9740b",
      "name": "Structured Output Parser6"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        12448,
        12960
      ],
      "id": "cf89f55a-a478-4cf2-9104-a49a587f386c",
      "name": "Auto-fixing Output Parser6"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {
          "timeout": 120000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        12320,
        12960
      ],
      "id": "15765037-8339-484c-b826-b477d4142e2a",
      "name": "OpenAI Chat Model47"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node output (JSON format)\nconst data = $input.first().json.output.results[0].calculation_parameters;\n\n// If there are no premium rounds, return a single message output\nif (!data.premium_rounds || data.premium_rounds.length === 0) {\n  return [\n    {\n      json: {\n        message: \"No premium rounds found. Valuation of the company has not increased.\",\n        result: [] // empty input array for next HTML node\n      }\n    }\n  ];\n}\n\n// Otherwise, loop over all premium rounds and calculate values\nconst calculatedRounds = data.premium_rounds.map(round => {\n  const roundRaised = round.shares_allotted * round.issue_price;\n  const dilution = round.shares_allotted / round.cumulative_equity_shares;\n  const postMoneyValuation = roundRaised / dilution;\n\n  return {\n    result: [\n      { row_number: round.row_number },\n      { date_of_allotment: round.date_of_allotment },\n      { nature_of_allotment: round.nature_of_allotment },\n      { shares_allotted: round.shares_allotted },\n      { face_value: round.face_value },\n      { issue_price: round.issue_price },\n      { cumulative_equity_shares: round.cumulative_equity_shares },\n      { round_raised: roundRaised },\n      { dilution: dilution },\n      { dilution_percent: dilution * 100 },\n      { post_money_valuation: postMoneyValuation }\n    ]\n  };\n});\n\n// Return all calculated results\nreturn calculatedRounds.map(round => ({ json: round }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12608,
        12688
      ],
      "id": "67149bc9-0eb8-485e-b8e2-86625f4efc2a",
      "name": "Code23"
    },
    {
      "parameters": {
        "jsCode": "// Input: Get all items from input\nconst items = $input.all();\n\n// Check if we have valid data\nif (!items || items.length === 0) {\n  const html = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n  \n  return [\n    {\n      json: {\n        html_output1: html\n      }\n    }\n  ];\n}\n\n// Helper to safely format numbers\nconst formatNumber = (num) => {\n  if (num === undefined || num === null || isNaN(num)) return \"-\";\n  return Number(num);\n};\n\n// Function to merge array of key-value objects into a single object\nconst mergeRow = (rowArray) => {\n  let merged = {};\n  rowArray.forEach(item => {\n    const key = Object.keys(item)[0];\n    merged[key] = item[key];\n  });\n  return merged;\n};\n\n// Generate HTML for all tables\nlet allTablesHtml = '';\n\n// Loop through each item\nitems.forEach((item, index) => {\n  // Get the result array from this item\n  const resultArray = item.json.result;\n  \n  // Check if result exists and is an array\n  if (!resultArray || !Array.isArray(resultArray) || resultArray.length === 0) {\n    return;\n  }\n  \n  const merged = mergeRow(resultArray);\n  \n  // Add a heading for each table\n  let tableHtml = `\n  <div style=\"margin-bottom: 30px;\">\n    <h3 style=\"font-family: Arial, sans-serif; color: #333;\">Premium Round ${index + 1}</h3>\n    <table border=\"1\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;\">\n      <thead style=\"background-color: #f2f2f2;\">\n        <tr>\n          <th style=\"text-align: left; padding: 10px;\">Field</th>\n          <th style=\"text-align: left; padding: 10px;\">Value</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr><td style=\"padding: 8px;\">Row</td><td style=\"padding: 8px;\">${merged.row_number || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Date of Allotment</td><td style=\"padding: 8px;\">${merged.date_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Nature of Allotment</td><td style=\"padding: 8px;\">${merged.nature_of_allotment || \"-\"}</td></tr>\n        <tr><td style=\"padding: 8px;\">Shares Allotted</td><td style=\"padding: 8px;\">${formatNumber(merged.shares_allotted)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Face Value (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.face_value)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Issue Price (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.issue_price)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Cumulative Equity Shares</td><td style=\"padding: 8px;\">${formatNumber(merged.cumulative_equity_shares)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Round Raised (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.round_raised)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution)}</td></tr>\n        <tr><td style=\"padding: 8px;\">Dilution (%)</td><td style=\"padding: 8px;\">${formatNumber(merged.dilution_percent)}%</td></tr>\n        <tr><td style=\"padding: 8px;\">Post Money Valuation (‚Çπ)</td><td style=\"padding: 8px;\">${formatNumber(merged.post_money_valuation)}</td></tr>\n      </tbody>\n    </table>\n  </div>\n  `;\n  \n  allTablesHtml += tableHtml;\n});\n\n// If no valid tables were generated\nif (allTablesHtml === '') {\n  allTablesHtml = `\n  <div>\n    <h3>No premium rounds found. Valuation of the company has not increased.</h3>\n  </div>`;\n}\n\n// Return HTML with all tables\nreturn [\n  {\n    json: {\n      html_output1: allTablesHtml\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12864,
        12688
      ],
      "id": "10761038-6854-4057-a55a-71957468c203",
      "name": "Code24"
    },
    {
      "parameters": {
        "jsCode": "// Get the Markdown input from the node\nconst markdownInput = $input.first().json.output.results[0].content;\n\n// --- Helper: Convert a single Markdown table block to HTML ---\nfunction mdTableToHTML(md) {\n  const lines = md.trim().split(\"\\n\").filter(line => line.trim() !== \"\");\n  if (lines.length < 2) return md; // not a valid table\n\n  let html = \"<table border='1' cellpadding='5' cellspacing='0' style='border-collapse: collapse; width: 100%;'>\\n\";\n  let headerProcessed = false;\n\n  for (let line of lines) {\n    // Skip markdown separators or invalid lines\n    if (/^\\s*\\|?\\s*[-: ]+\\s*(\\|\\s*[-: ]+\\s*)+\\|?\\s*$/.test(line)) continue;\n\n    // Split by | and filter out empty cells\n    const cells = line.split(\"|\").map(c => c.trim()).filter(Boolean);\n    if (cells.length < 2) continue;\n\n    if (!headerProcessed) {\n      html += \"  <thead>\\n    <tr>\\n\";\n      cells.forEach(cell => html += `      <th>${cell}</th>\\n`);\n      html += \"    </tr>\\n  </thead>\\n  <tbody>\\n\";\n      headerProcessed = true;\n    } else {\n      html += \"    <tr>\\n\";\n      cells.forEach(cell => html += `      <td>${cell}</td>\\n`);\n      html += \"    </tr>\\n\";\n    }\n  }\n\n  html += \"  </tbody>\\n</table>\\n\";\n  return html;\n}\n\n// --- Improved Table Regex ---\n// Captures markdown tables even with blank lines, extra text, or between sections.\nconst tableRegex =\n  /(^\\s*(?:\\|[^\\n]+\\|\\s*\\n)+\\s*\\|?\\s*(?:[-: ]+\\|[-:| ]+)+\\s*\\n(?:\\|[^\\n]+\\|\\s*\\n?)*)/gm;\n\n// Convert tables to HTML\nlet htmlOutput = markdownInput.replace(tableRegex, match => mdTableToHTML(match));\n\n// Convert headers and separators\nhtmlOutput = htmlOutput\n  // Handle markdown headers (#)\n  .replace(/^#{1,6}\\s*(.+)$/gm, \"<h3>$1</h3>\")\n  // Handle section dividers (‚îÅ, ‚îÅ‚îÅ, etc.)\n  .replace(/^[‚îÅ‚îÄ=]{3,}$/gm, \"<hr>\")\n  // Handle double newlines\n  .replace(/\\n{2,}/g, \"<br><br>\")\n  // Section headings like \"SECTION A:\"\n  .replace(/^([A-Z ]+:)(?=\\s*$)/gm, \"<h3>$1</h3>\");\n\n// Wrap output\nhtmlOutput = `\n<div style=\"font-family: Arial, sans-serif; line-height: 1.6; padding: 10px;\">\n${htmlOutput}\n</div>\n`;\n\n// Return result\nreturn [\n  {\n    json: {\n      html_output0: htmlOutput\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        12736,
        12608
      ],
      "id": "ac3db469-6c11-44ee-b3b6-fb6b2e81a27a",
      "name": "Code25"
    },
    {
      "parameters": {
        "html": "\n{{ $json.data[0].html_output0 }}\n\n{{ $json.data[1].html_output1 }} \n\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        13472,
        12656
      ],
      "id": "8df66a9f-dfef-4824-8627-4fce6417bde8",
      "name": "HTML13"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        13072,
        12656
      ],
      "id": "b49cdbc7-2f6a-4ef4-8a28-00f9483f5239",
      "name": "Merge25",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        13296,
        12656
      ],
      "id": "988ad3a2-77e7-4b50-9775-c965f20fdddc",
      "name": "Aggregate6"
    },
    {
      "parameters": {
        "jsCode": "// Enhanced Markdown to HTML conversion for n8n Function node - RHP Summary Optimized\nconst markdownContent = $input.first().json.output;\n\nfunction markdownToHtml(markdown) {\n  let html = markdown;\n  \n  // Pre-process: Clean up any inconsistent spacing\n  html = html.replace(/\\r\\n/g, '\\n'); // Normalize line endings\n  html = html.replace(/\\n{3,}/g, '\\n\\n'); // Limit consecutive newlines to 2\n  \n  // Convert tables - Enhanced to handle RHP financial tables\n  html = html.replace(/(\\n|^)(\\|.+\\|\\s*\\n(?:\\|.+\\|\\s*\\n)*)/g, function(match, prefix, tableBlock) {\n    const lines = tableBlock.trim().split('\\n')\n      .map(line => line.trim())\n      .filter(line => line.includes('|') && line.length > 0);\n    \n    if (lines.length < 2) return match; // Need at least 2 lines for a table\n    \n    let tableHtml = '<table class=\"data-table\">';\n    let headerProcessed = false;\n    let hasHeaderSeparator = false;\n    \n    // Check if second line is a header separator\n    if (lines.length > 1 && /^\\|[-\\s|:]*\\|$/.test(lines[1].trim())) {\n      hasHeaderSeparator = true;\n    }\n    \n    lines.forEach((line, index) => {\n      // Skip separator lines with only dashes, colons, and pipes\n      if (/^\\|[-\\s|:]*\\|$/.test(line.trim())) {\n        return;\n      }\n      \n      const cells = line.split('|')\n        .filter(cell => cell.trim() !== '')\n        .map(cell => cell.trim());\n      \n      if (cells.length === 0) return;\n      \n      if (!headerProcessed) {\n        // First valid row as header\n        const headerCells = cells.map(cell => {\n          // Handle bold formatting in headers\n          const cleanCell = cell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          return `<th>${cleanCell}</th>`;\n        }).join('');\n        tableHtml += `<thead><tr>${headerCells}</tr></thead><tbody>`;\n        headerProcessed = true;\n      } else {\n        // Data rows - handle formatting within cells\n        const dataCells = cells.map(cell => {\n          let cleanCell = cell;\n          // Handle bold text\n          cleanCell = cleanCell.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n          // Handle italic text\n          cleanCell = cleanCell.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n          // Handle inline code\n          cleanCell = cleanCell.replace(/`([^`]+)`/g, '<code>$1</code>');\n          // Handle percentage formatting\n          cleanCell = cleanCell.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n          // Handle currency formatting\n          cleanCell = cleanCell.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)/g, '<span class=\"currency\">‚Çπ$1</span>');\n          \n          return `<td>${cleanCell}</td>`;\n        }).join('');\n        tableHtml += `<tr>${dataCells}</tr>`;\n      }\n    });\n    \n    tableHtml += '</tbody></table>';\n    return prefix + tableHtml;\n  });\n  \n  // First handle tables\n// ‚Ä¶ your table conversion ‚Ä¶\n\n// Fix #### after table\nhtml = html.replace(/<\\/table>\\s*####\\s*(.*)/gim, '</table><h4>$1</h4>');\n\n// Normal headers\nhtml = html.replace(/^#### (.*$)/gim, '<h4>$1</h4>');\nhtml = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\nhtml = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\nhtml = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n\n  \n  // Bold and Italic - Handle nested formatting\n  html = html.replace(/\\*\\*\\*(.*?)\\*\\*\\*/gim, '<strong><em>$1</em></strong>');\n  html = html.replace(/\\*\\*(.*?)\\*\\*/gim, '<strong>$1</strong>');\n  html = html.replace(/\\*(.*?)\\*/gim, '<em>$1</em>');\n  \n  // Inline code - for CIN, ISIN, etc.\n  html = html.replace(/`([^`]+)`/g, '<code>$1</code>');\n  \n  // Horizontal rules\n  html = html.replace(/^---\\s*$/gim, '<hr>');\n  \n  // Lists - Enhanced to handle nested lists and maintain proper spacing\n  html = html.replace(/^(\\s*)[-*] (.+$)/gim, function(match, indent, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li>${content}</li>`;\n  });\n  \n  // Numbered lists\n  html = html.replace(/^(\\s*)(\\d+)\\. (.+$)/gim, function(match, indent, num, content) {\n    const level = Math.floor(indent.length / 2);\n    return `${'  '.repeat(level)}<li data-number=\"${num}\">${content}</li>`;\n  });\n  \n  // Wrap consecutive list items in ul tags\n  html = html.replace(/(<li>.*?<\\/li>)(\\s*<li>.*?<\\/li>)*/gs, function(match) {\n    return '<ul>' + match + '</ul>';\n  });\n  \n  // Wrap consecutive numbered list items in ol tags\n  html = html.replace(/(<li data-number=\"\\d+\">.*?<\\/li>)(\\s*<li data-number=\"\\d+\">.*?<\\/li>)*/gs, function(match) {\n    const cleanMatch = match.replace(/ data-number=\"\\d+\"/g, '');\n    return '<ol>' + cleanMatch + '</ol>';\n  });\n  \n // Links\n // Links - Handle multiple formats\n  // 1. Markdown-style links [text](url)\n  html = html.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  \n  // 2. Plain URLs (http/https) - handle URLs that might have \\n before them\n  // html = html.replace(/(https?:\\/\\/[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"$1\" target=\"_blank\">$1</a>');\n  \n  // 3. Email addresses - enhanced pattern to catch Gmail and other providers\n  html = html.replace(/([a-zA-Z0-9._%+-]+@(?:gmail\\.com|yahoo\\.com|hotmail\\.com|outlook\\.com|[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}))/gi, '<a href=\"mailto:$1\">$1</a>');\n  \n  // 4. Plain www URLs (add https:// protocol)\n  // html = html.replace(/(www\\.[^\\s<>\"'\\n\\r]+)/gi, '<a href=\"https://$1\" target=\"_blank\">$1</a>');\n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n  \n  // Special formatting for financial data\n  html = html.replace(/‚Çπ\\s*(\\d+(?:,\\d+)*(?:\\.\\d+)?)\\s*(Cr|crore|crores)/gi, '<span class=\"amount\">‚Çπ$1 $2</span>');\n  html = html.replace(/(\\d+\\.?\\d*)\\s*%/g, '<span class=\"percentage\">$1%</span>');\n  \n  // Line breaks and paragraphs - Handle this last\n  html = html.replace(/\\n\\n+/g, '</p><p>');\n  html = html.replace(/\\n/g, '<br>');\n\n\n  \n  // Wrap content in paragraph tags if not already wrapped\n  if (!html.startsWith('<')) {\n    html = '<p>' + html + '</p>';\n  }\n  \n  // Clean up empty paragraphs and fix paragraph structure\n  html = html.replace(/<p><\\/p>/g, '');\n  html = html.replace(/<p>(<(?:h[1-6]|hr|table|ul|ol))/g, '$1');\n  html = html.replace(/(<\\/(?:h[1-6]|hr|table|ul|ol)>)<\\/p>/g, '$1');\n  \n  // Fix paragraph breaks around tables\n  html = html.replace(/<p>(<table)/g, '$1');\n  html = html.replace(/(<\\/table>)<\\/p>/g, '$1');\n  \n  return `\n  \n        <div class=\"content\">\n          ${html}\n        </div>\n     \n  `;\n}\n\nconst htmlContent = markdownToHtml(markdownContent);\n\nreturn [{\n  json: {\n    html_summary: htmlContent,\n    fileName: $('Webhook28').first().json.query.namespace \n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13072,
        13072
      ],
      "id": "73a2317b-830c-49ba-a0a0-867be0334211",
      "name": "mdn to html4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        11840,
        12960
      ],
      "id": "c0001e2b-51ff-48e0-9fbe-2a2cb7c9d2a1",
      "name": "Embeddings OpenAI65"
    },
    {
      "parameters": {
        "topN": 18
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        12192,
        12960
      ],
      "id": "ba462f80-4522-4182-adca-09f7f9244d84",
      "name": "Reranker Cohere43"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook28').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        11936,
        12960
      ],
      "id": "a61067fc-c2dd-4f41-a3c8-fe0d7df12a54",
      "name": "DRHP Pinecone VectorDB13"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12816,
        13360
      ],
      "id": "a71bf7c7-502d-43a7-ad5b-7fbf8cd762a5",
      "name": "Embeddings OpenAI66"
    },
    {
      "parameters": {
        "topN": 15
      },
      "type": "@n8n/n8n-nodes-langchain.rerankerCohere",
      "typeVersion": 1,
      "position": [
        13168,
        13360
      ],
      "id": "4fad716b-bb2a-4105-8974-3b0f039b411b",
      "name": "Reranker Cohere44"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "RHP_Document_base",
        "toolDescription": "retrieve the data from the pinecone vector store tool",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 50,
        "useReranker": true,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "={{ $('Webhook28').item.json.query.namespace }}"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12912,
        13360
      ],
      "id": "828a7746-4b6f-4a62-8132-1ed1b25a36cb",
      "name": "DRHP Pinecone VectorDB14"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{ \n  \"subQueries\" :[ \"Retrieve company name, CIN, registered office, corporate office, manufacturing facilities, website, ISIN, business model, promoter names, book running lead manager, registrar, and bankers to the company\",  \"Extract fresh issue size, offer for sale amount, objects of the issue, pre-issue promoter shareholding, post-issue promoter shareholding, and promoter dilution percentage ,details of capacity utilization \",  \"Find details of pre-IPO placements, preferential allotments, private placements including share price, amount raised, post-money valuation, pre-money valuation, investor names, and well-known funds participating in pre-IPO rounds\",  \"Identify outstanding litigations with disputed amounts, contingent liabilities, Summary of related party transactions tables, dependency on domestic vs international business, segment concentration, supplier concentration, customer concentration, and industry-specific headwinds, Peer Comparison Table(peers)\",  \"Extract key product segments, top 3-5 selling products, target markets, key customers, key suppliers, raw materials, manufacturing/servicing capacity, current capacity utilization, order book size, completed projects, and whether business is tender-based or relationship-driven, Delayed Filings & Penalties, Authorized Share Capital\",  \"Retrieve information on exclusive IP, licenses, patents, contracts, long-term agreements with suppliers or clients, monitoring agency details, commoditization vs customization aspects, and presence in unorganized/fragmented industry, Key Financial ratios(indicators,financial ratios)\",  \"Find locations and sizes of offices and manufacturing facilities, employee bifurcation across departments, subsidiaries and potential conflicts of interest, whether facilities are leased from promoters/promoter groups, and manufacturing/servicing process details\",  \"Extract revenue from operations, EBITDA, EBITDA margins, PAT, PAT margins, return on average equity, return on capital employed, debt-to-equity ratio, cash flow from operations, CFO/EBITDA ratio, trade receivables, and receivables/revenue ratio for all available periods\",  \"Retrieve promoter (OUR PROMOTERS AND PROMOTER GROUP) and Board of Directors(Name, designation, date of birth, age, address, occupation, currentterm, period of directorship and DIN ) education and experience background, independent director qualifications, promoter remuneration, company milestones, peer review status of restated financials, and screening for wilful defaulter status or struck-off company relationships\",  \"Extract detailed objects of issue including capex plans (brownfield/greenfield/debottlenecking), working capital requirements, debt repayment details, timeline for fund utilization, end-use applications of products/services, dominant production regions, industry tailwinds and headwinds, and peer comparison KPIs\"] }",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        11808,
        13120
      ],
      "id": "4833d183-3848-4029-8894-18e19dc1ee3b",
      "name": "Edit Fields48",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "text-embedding-3-large",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        12208,
        13360
      ],
      "id": "f5b37bce-dc4a-4766-be5a-e680fa818064",
      "name": "Embeddings OpenAI67"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "sop_knowledge_base",
        "toolDescription": "retrieve the the SOP data ",
        "pineconeIndex": {
          "__rl": true,
          "value": "drhpdocuments",
          "mode": "list",
          "cachedResultName": "drhpdocuments"
        },
        "topK": 10,
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "documentName",
                "value": "SOP.pdf"
              }
            ]
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePinecone",
      "typeVersion": 1.1,
      "position": [
        12304,
        13360
      ],
      "id": "00ddc868-d869-4976-889f-759fccd072d4",
      "name": "Fund SOP Pinecone Vector DB6"
    },
    {
      "parameters": {
        "jsCode": "// Input: previous node outputs\n\n\n\n// Try multiple possible field names for the HTML content\nconst investorHtml = $input.first().json.html;\nconst researchHtml =  $input.first().json.research_html;\nconst fullSummaryHtml = $input.first().json.html_summary;\n\n\n// --- Function: Insert HTML Content Before Specific Section ---\nfunction insertHtmlBeforeSection(fullHtml, insertHtml, sectionHeader, sectionLabel) {\n  // Check if fullHtml is valid\n  if (!fullHtml || typeof fullHtml !== 'string') {\n    console.log(`‚ö†Ô∏è Invalid HTML content - cannot insert ${sectionLabel}`);\n    return fullHtml || '';\n  }\n  \n  // Check if there's content to insert\n  if (!insertHtml || typeof insertHtml !== 'string' || insertHtml.trim().length === 0) {\n    console.log(`‚ö†Ô∏è No content to insert for ${sectionLabel}`);\n    return fullHtml;\n  }\n  \n  // Create pattern to find the section header\n  const sectionPattern = new RegExp(\n    `(<h2[^>]*>[^<]*${sectionHeader}[^<]*<\\\\/h2>)`,\n    'i'\n  );\n  \n  let modifiedHtml = fullHtml;\n  const sectionMatch = modifiedHtml.match(sectionPattern);\n  \n  if (sectionMatch) {\n    const insertionPoint = sectionMatch.index;\n    \n    const insertionHtml = `\n      <!-- Inserted ${sectionLabel} -->\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n      <hr><br>\n    `;\n    \n    modifiedHtml =\n      modifiedHtml.slice(0, insertionPoint) +\n      insertionHtml +\n      modifiedHtml.slice(insertionPoint);\n    \n    console.log(`‚úÖ ${sectionLabel} inserted before ${sectionHeader}`);\n  } else {\n    console.log(`‚ö†Ô∏è ${sectionHeader} not found ‚Äî appending ${sectionLabel} at the end`);\n    const insertionHtml = `\n      <hr><br>\n      <div class=\"${sectionLabel.toLowerCase().replace(/\\s+/g, '-')}-insertion\" style=\"margin-top:10px; margin-bottom:20px;\">\n        <h3 style=\"color:#4B2A06; font-size:16px; font-weight:700; margin:12px 0;\">${sectionLabel}</h3>\n        ${insertHtml}\n      </div>\n    `;\n    modifiedHtml += insertionHtml;\n  }\n  \n  return modifiedHtml;\n}\n\n// --- Function: Wrap Final HTML Page ---\nfunction generateEnhancedHtml(contentHtml) {\n  return `\n  <!DOCTYPE html>\n  <html>\n    <head>\n      <meta charset=\"UTF-8\" />\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      <title>Investment Analysis Report</title>\n      <style>\n        body {\n          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n          background: #ffffff;\n          font-size: 14px;\n          padding: 10px;\n          color: #1a1a1a;\n        }\n        h1, h2, h3 { line-height: 1.3; margin: 12px 0; }\n        table {\n          border-collapse: collapse;\n          width: 100%;\n          margin: 12px 0;\n          font-size: 12px;\n        }\n        th, td {\n          border: 1px solid #374151;\n          padding: 8px;\n          text-align: left;\n        }\n        th {\n          background: #f1f5f9;\n          font-weight: 700;\n        }\n        tbody tr:nth-child(even) td { background: #f8fafc; }\n        hr {\n          border: none;\n          border-top: 1px solid #e5e7eb;\n          margin: 20px 0;\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"container\">\n        ${contentHtml}\n      </div>\n    </body>\n  </html>`;\n}\n\n// --- Main Execution ---\n\n// Check if we have the base HTML summary\nif (!fullSummaryHtml || fullSummaryHtml.trim().length === 0) {\n  console.log('‚ö†Ô∏è No html_summary found - returning available data or error');\n  \n  // Try to return whatever HTML we have\n  let availableHtml = '';\n  if (investorHtml) availableHtml += investorHtml;\n  if (researchHtml) availableHtml += researchHtml;\n  \n  if (availableHtml) {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml(availableHtml),\n        fileName: $input.first().json.fileName,\n        warning: 'No html_summary found, returning available HTML only'\n      }\n    }];\n  } else {\n    return [{\n      json: {\n        html_source: generateEnhancedHtml('<p>No HTML data available. Please check merge node configuration.</p>'),\n        fileName: $input.first().json.fileName || 'report.html',\n        error: 'No html_summary, html, or research_html found',\n        available_fields: Object.keys($input.first().json)\n      }\n    }];\n  }\n}\n\nlet modifiedHtml = fullSummaryHtml;\n\n// Step 1: Insert investor data (html) before SECTION VII\nif (investorHtml && investorHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    investorHtml, \n    'SECTION VII',\n    'Matched Investors & Analysis'\n  );\n} else {\n  console.log('‚ÑπÔ∏è No investor HTML to insert');\n}\n\n// Step 2: Insert research data (research_html) before SECTION XII\nif (researchHtml && researchHtml.trim().length > 0) {\n  modifiedHtml = insertHtmlBeforeSection(\n    modifiedHtml, \n    researchHtml, \n    'SECTION XII',\n    'Adverse Findings & Research'\n  );\n} else {\n  console.log('‚ÑπÔ∏è No research HTML to insert');\n}\n\n// Step 3: Generate final HTML with wrapper\nconst finalHtml = generateEnhancedHtml(modifiedHtml);\n\n// --- Return Output ---\nreturn [{\n  json: {\n    html_source: finalHtml,\n    fileName: $input.first().json.fileName || 'report.html'\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10928,
        12768
      ],
      "id": "a7bd7f72-54ec-45ea-9e59-9cc9a273a993",
      "name": "mdn to html30"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        10752,
        12752
      ],
      "id": "6f7ef619-b4d4-4d3c-b466-33a53320494a",
      "name": "Merge26",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "messages": {
          "message": [
            {
              "content": "=You are an Expert Forensic Due-Diligence Analyst specializing in:\n\nGlobal sanctions\n\nRegulatory enforcement\n\nCriminal litigation\n\nOSINT adverse media\n\nCorporate networks of promoters & entities\n\nYour responsibility is to perform deep-dive adverse findings research on a target company and all its promoters, directors, beneficial owners, affiliates, and related entities.\n\nINPUT\n\nThe user will provide only the company name.\n\nYou must:\n\nIdentify all promoters, directors, beneficial owners, and related entities.\n\nPerform a global risk investigation across all layers defined below.\n\nReturn results only in the specified JSON format ‚Äî no prose, no extra text.\n\nMANDATORY RESEARCH REQUIREMENTS\n1. Entity & Promoter Identification\n\nIdentify:\n\nAll current and past promoters, directors, shareholders, beneficial owners.\n\nAssociated companies or entities linked to promoters.\nUse:\n\nCorporate registries\n\nLitigation & debt filings\n\nRegulatory & enforcement databases\n\nHistorical and financial media\n\n2. GLOBAL ADVERSE SEARCH\n\nSearch comprehensively across:\n\nIndia, UAE, USA, UK, and all international jurisdictions.\nDatabases to include:\n\nOFAC SDN, BIS Entity List, UN Sanctions List, World Bank Debarment\n\nDFSA, ADGM, CBUAE, DIFC\n\nSEBI, RBI, SFIO, CBI, ED, DGGI\n\n3. CRIMINAL, FRAUD & REGULATORY VIOLATIONS\n\nExplicitly investigate using the following keyword set:\n\narrest, FIR, charge sheet, fraud, money laundering, PMLA, FEMA, SEBI order, SAT judgment, CBI case, ED attachment, DGGI show cause, GST evasion, blacklisted, wilful defaulter, NCLT order, CIRP, liquidation, Interpol Red Notice, DOJ indictment, SEC litigation release, OFAC SDN, BIS Entity List, UN sanctions list, World Bank debarment, DFSA enforcement, ADGM penalty, CBUAE sanction, DIFC judgment, etc.\n\nFor every match:\n\nRetrieve official document or case ID\n\nExtract related entities mentioned in the same document\n\n4. FINAL CASE STATUS\n\nFor each finding, state:\n\nFinal judgment\n\nAcquittal / Conviction / Settlement\n\nOngoing / Closed\n\nRISK SCORING LOGIC (UPDATED) ‚úÖ\n\nWhen generating \"risk_assessment\":\n\nAssign each risk type (financial_crime_risk, regulatory_compliance_risk, reputational_risk, sanctions_risk, litigation_risk) one of:\n\n\"Low\" ‚Üí 0.0\n\n\"Moderate\" ‚Üí 3.0‚Äì6.0\n\n\"High\" ‚Üí 7.0‚Äì10.0\n\nIf no adverse findings detected in any layer, set:\n\n\"overall_risk_score\": 0.0\n\n\"risk_factors\": [\"No adverse findings detected\"]\n\nIf adverse findings exist:\n\nCompute \"overall_risk_score\" as an average of relevant risk levels (1‚Äì10 scale).\n\nAdd concise \"risk_factors\" explaining reasons.\nExample:\n\n\"risk_factors\": [\n  \"SEBI consent order against promoter (2021)\",\n  \"ED attachment under PMLA (2020)\"\n]\n\nSTRICT OUTPUT JSON FORMAT\n\nReturn only the following JSON (no extra text or markdown):\n\n{\n  \"metadata\": {\n    \"company\": \" {{ $json.company }}\",\n    \"promoters\": {{ $json.promoters }},\n    \"investigation_date\": \"{{ $now }}\",\n    \"jurisdictions_searched\": [\"India\", \"UAE\", \"USA\", \"UK\", \"International\"],\n    \"total_sources_checked\": 0\n  },\n  \"executive_summary\": {\n    \"adverse_flag\": false,\n    \"risk_level\": \"Low\",\n    \"confidence_overall\": 0.0,\n    \"key_findings\": \"\",\n    \"red_flags_count\": {\n      \"sanctions\": 0,\n      \"enforcement_actions\": 0,\n      \"criminal_cases\": 0,\n      \"high_risk_media\": 0\n    },\n    \"recommended_action\": \"proceed\"\n  },\n  \"detailed_findings\": {\n    \"layer1_sanctions\": [],\n    \"layer2_legal_regulatory\": [],\n    \"layer3_osint_media\": []\n  },\n  \"entity_network\": {\n    \"associated_companies\": [],\n    \"associated_persons\": [],\n    \"beneficial_owners_identified\": [],\n    \"related_entities_in_adverse_actions\": []\n  },\n  \"risk_assessment\": {\n    \"financial_crime_risk\": \"Low\",\n    \"regulatory_compliance_risk\": \"Low\",\n    \"reputational_risk\": \"Low\",\n    \"sanctions_risk\": \"Low\",\n    \"litigation_risk\": \"Low\",\n    \"overall_risk_score\": 0.0,\n    \"risk_factors\": [\"No adverse findings detected\"]\n  },\n  \"gaps_and_limitations\": [],\n  \"next_steps\": []\n}\n",
              "role": "system"
            },
            {
              "content": "={{ $json.output.results[0].calculation_parameters.company_name }}"
            }
          ]
        },
        "simplify": true,
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        12736,
        12784
      ],
      "id": "8767c46e-7fa3-4d43-966b-3bf29d968258",
      "name": "Adverse Findings Analyzer4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "=You are an Expert Forensic Due-Diligence Analyst specializing in:\n\nGlobal sanctions\n\nRegulatory enforcement\n\nCriminal litigation\n\nOSINT adverse media\n\nCorporate networks of promoters & entities\n\nYour responsibility is to perform deep-dive adverse findings research on a target company and all its promoters, directors, beneficial owners, affiliates, and related entities.\n\nINPUT\n\nThe user will provide only the company name.\n\nYou must:\n\nIdentify all promoters, directors, beneficial owners, and related entities.\n\nPerform a global risk investigation across all layers defined below.\n\nReturn results only in the specified JSON format ‚Äî no prose, no extra text.\n\nMANDATORY RESEARCH REQUIREMENTS\n1. Entity & Promoter Identification\n\nIdentify:\n\nAll current and past promoters, directors, shareholders, beneficial owners.\n\nAssociated companies or entities linked to promoters.\nUse:\n\nCorporate registries\n\nLitigation & debt filings\n\nRegulatory & enforcement databases\n\nHistorical and financial media\n\n2. GLOBAL ADVERSE SEARCH\n\nSearch comprehensively across:\n\nIndia, UAE, USA, UK, and all international jurisdictions.\nDatabases to include:\n\nOFAC SDN, BIS Entity List, UN Sanctions List, World Bank Debarment\n\nDFSA, ADGM, CBUAE, DIFC\n\nSEBI, RBI, SFIO, CBI, ED, DGGI\n\n3. CRIMINAL, FRAUD & REGULATORY VIOLATIONS\n\nExplicitly investigate using the following keyword set:\n\narrest, FIR, charge sheet, fraud, money laundering, PMLA, FEMA, SEBI order, SAT judgment, CBI case, ED attachment, DGGI show cause, GST evasion, blacklisted, wilful defaulter, NCLT order, CIRP, liquidation, Interpol Red Notice, DOJ indictment, SEC litigation release, OFAC SDN, BIS Entity List, UN sanctions list, World Bank debarment, DFSA enforcement, ADGM penalty, CBUAE sanction, DIFC judgment, etc.\n\nFor every match:\n\nRetrieve official document or case ID\n\nExtract related entities mentioned in the same document\n\n4. FINAL CASE STATUS\n\nFor each finding, state:\n\nFinal judgment\n\nAcquittal / Conviction / Settlement\n\nOngoing / Closed\n\nRISK SCORING LOGIC (UPDATED) ‚úÖ\n\nWhen generating \"risk_assessment\":\n\nAssign each risk type (financial_crime_risk, regulatory_compliance_risk, reputational_risk, sanctions_risk, litigation_risk) one of:\n\n\"Low\" ‚Üí 0.0\n\n\"Moderate\" ‚Üí 3.0‚Äì6.0\n\n\"High\" ‚Üí 7.0‚Äì10.0\n\nIf no adverse findings detected in any layer, set:\n\n\"overall_risk_score\": 0.0\n\n\"risk_factors\": [\"No adverse findings detected\"]\n\nIf adverse findings exist:\n\nCompute \"overall_risk_score\" as an average of relevant risk levels (1‚Äì10 scale).\n\nAdd concise \"risk_factors\" explaining reasons.\nExample:\n\n\"risk_factors\": [\n  \"SEBI consent order against promoter (2021)\",\n  \"ED attachment under PMLA (2020)\"\n]\n\nSTRICT OUTPUT JSON FORMAT\n\nReturn only the following JSON (no extra text or markdown):\n\n{\n  \"metadata\": {\n    \"company\": \" {{ $json.company }}\",\n    \"promoters\": {{ $json.promoters }},\n    \"investigation_date\": \"{{ $now }}\",\n    \"jurisdictions_searched\": [\"India\", \"UAE\", \"USA\", \"UK\", \"International\"],\n    \"total_sources_checked\": 0\n  },\n  \"executive_summary\": {\n    \"adverse_flag\": false,\n    \"risk_level\": \"Low\",\n    \"confidence_overall\": 0.0,\n    \"key_findings\": \"\",\n    \"red_flags_count\": {\n      \"sanctions\": 0,\n      \"enforcement_actions\": 0,\n      \"criminal_cases\": 0,\n      \"high_risk_media\": 0\n    },\n    \"recommended_action\": \"proceed\"\n  },\n  \"detailed_findings\": {\n    \"layer1_sanctions\": [],\n    \"layer2_legal_regulatory\": [],\n    \"layer3_osint_media\": []\n  },\n  \"entity_network\": {\n    \"associated_companies\": [],\n    \"associated_persons\": [],\n    \"beneficial_owners_identified\": [],\n    \"related_entities_in_adverse_actions\": []\n  },\n  \"risk_assessment\": {\n    \"financial_crime_risk\": \"Low\",\n    \"regulatory_compliance_risk\": \"Low\",\n    \"reputational_risk\": \"Low\",\n    \"sanctions_risk\": \"Low\",\n    \"litigation_risk\": \"Low\",\n    \"overall_risk_score\": 0.0,\n    \"risk_factors\": [\"No adverse findings detected\"]\n  },\n  \"gaps_and_limitations\": [],\n  \"next_steps\": []\n}\n",
              "role": "system"
            },
            {
              "content": "={{ $json.output.results[0].calculation_parameters.company_name }}"
            }
          ]
        },
        "simplify": true,
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        10144,
        12656
      ],
      "id": "a73a5bf6-1014-4507-b656-003a8c30dbba",
      "name": "Adverse Findings Analyzer1",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "// Parse Perplexity JSON output and convert it to a comprehensive research_html report\nlet raw =  $input.first().json.message;\n\n// Clean up and normalize the text\nif (typeof raw !== 'string') {\n  raw = JSON.stringify(raw);\n}\n\n// Remove code fences or markdown artifacts like ```json ... ```\nraw = raw\n  .replace(/^```json/i, '')\n  .replace(/^```/, '')\n  .replace(/```$/g, '')\n  .trim();\n\n// Try to find the JSON part if the model added extra text before or after\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (jsonMatch) {\n  raw = jsonMatch[0];\n}\n\n// Safe JSON parse\nlet data;\ntry {\n  data = JSON.parse(raw);\n} catch (e) {\n  return [{ research_html: `<p>‚ùå Error parsing JSON: ${e.message}</p><pre>${raw}</pre>` }];\n}\n\n// Extract fields with safe fallback\nconst {\n  metadata = {},\n  executive_summary = {},\n  detailed_findings = {},\n  entity_network = {},\n  risk_assessment = {},\n  gaps_and_limitations = [],\n  next_steps = []\n} = data;\n\n// Extract metadata\nconst {\n  company = \"Unknown Company\",\n  promoters = \"\",\n  investigation_date = \"N/A\",\n  jurisdictions_searched = [],\n  total_sources_checked = 0\n} = metadata;\n\n// Extract executive summary\nconst {\n  adverse_flag = false,\n  risk_level = \"Not Rated\",\n  confidence_overall = 0,\n  key_findings = \"No findings available.\",\n  red_flags_count = {},\n  recommended_action = \"N/A\"\n} = executive_summary;\n\n// Extract risk assessment\nconst {\n  financial_crime_risk = \"N/A\",\n  regulatory_compliance_risk = \"N/A\",\n  reputational_risk = \"N/A\",\n  sanctions_risk = \"N/A\",\n  litigation_risk = \"N/A\",\n  overall_risk_score = 0,\n  risk_factors = []\n} = risk_assessment;\n\n// Extract detailed findings\nconst {\n  layer1_sanctions = [],\n  layer2_legal_regulatory = [],\n  layer3_osint_media = []\n} = detailed_findings;\n\n// Extract entity network\nconst {\n  associated_companies = [],\n  associated_persons = [],\n  beneficial_owners_identified = [],\n  related_entities_in_adverse_actions = []\n} = entity_network;\n\n// Handle promoters array or string gracefully\nconst promoterList = Array.isArray(promoters)\n  ? promoters.map(p => (typeof p === 'object' ? `${p.name || p.full_name || 'Unknown'} (${p.role || 'Unknown Role'})` : String(p))).join(', ')\n  : typeof promoters === 'string'\n  ? promoters\n  : 'Not Available';\n\n// Helper function to get action badge\nconst getActionBadge = (action) => {\n  const badges = {\n    'proceed': { text: 'Proceed'},\n    'proceed_with_caution': { text: 'Proceed with Caution'},\n    'enhanced_due_diligence': { text: 'Enhanced Due Diligence Required'},\n    'do_not_proceed': { text: 'Do Not Proceed' }\n  };\n  const badge = badges[action] || { text: action};\n  return `<span>${badge.text}</span>`;\n};\n\n// Helper for generating sanctions section\nconst generateSanctionsSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No sanctions or debarment records found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>‚ö†Ô∏è SANCTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>List:</strong> ${item.list_name || 'N/A'}</p>`;\n    research_html += `<p><strong>Matched Entity:</strong> ${item.matched_entity || 'N/A'}</p>`;\n    research_html += `<p><strong>Role:</strong> ${item.role || 'N/A'}</p>`;\n    research_html += `<p><strong>Reason:</strong> ${item.reason || 'N/A'}</p>`;\n    if (item.action_date) research_html += `<p><strong>Date:</strong> ${item.action_date}</p>`;\n    if (item.document_id) research_html += `<p><strong>Document ID:</strong> ${item.document_id}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url) {\n      research_html += `<p><strong>Source:</strong> <a href=\"${item.source_url}\" target=\"_blank\">${item.source_url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}% | <strong>Status:</strong> ${item.verification_status || 'N/A'}</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating legal/regulatory section\nconst generateLegalSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No legal or regulatory enforcement actions found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>‚öñÔ∏è LEGAL & REGULATORY ACTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Type:</strong> ${item.action_type || 'N/A'}</p>`;\n    if (item.case_number) research_html += `<p><strong>Case Number:</strong> ${item.case_number}</p>`;\n    if (item.filing_date) research_html += `<p><strong>Filing Date:</strong> ${item.filing_date}</p>`;\n    research_html += `<p><strong>Parties:</strong> ${item.parties || 'N/A'}</p>`;\n    if (item.jurisdiction) research_html += `<p><strong>Jurisdiction:</strong> ${item.jurisdiction}</p>`;\n    research_html += `<p><strong>Allegations:</strong> ${item.allegations || item.summary || 'N/A'}</p>`;\n    if (item.key_findings) research_html += `<p><strong>Key Findings:</strong> ${item.key_findings}</p>`;\n    if (item.penalties) research_html += `<p><strong>Penalties:</strong> ${item.penalties}</p>`;\n    research_html += `<p><strong>Status:</strong> <span>${item.final_disposition || item.disposition || 'N/A'}</span></p>`;\n    if (item.appeal_status) research_html += `<p><strong>Appeal Status:</strong> ${item.appeal_status}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url || item.url) {\n      const url = item.source_url || item.url;\n      research_html += `<p><strong>Source:</strong> <a href=\"${url}\" target=\"_blank\">${url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating OSINT/media section\nconst generateMediaSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No adverse media coverage found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>üì∞ MEDIA & OSINT FINDINGS</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Headline:</strong> ${item.headline || 'N/A'}</p>`;\n    if (item.publication) research_html += `<p><strong>Publication:</strong> ${item.publication}</p>`;\n    if (item.date) research_html += `<p><strong>Date:</strong> ${item.date}</p>`;\n    research_html += `<p><strong>Summary:</strong> ${item.snippet || item.allegations || 'N/A'}</p>`;\n    research_html += `<p><strong>Source Type:</strong> ${item.source_type || 'N/A'} | `;\n    research_html += `<strong>Risk Level:</strong> <span>${item.risk_label || 'N/A'}</span></p>`;\n    if (item.corroboration) research_html += `<p><strong>Corroboration:</strong> ${item.corroboration}</p>`;\n    if (item.credibility_score !== undefined) {\n      research_html += `<p><strong>Credibility Score:</strong> ${(item.credibility_score * 100).toFixed(0)}%</p>`;\n    }\n    if (item.url) {\n      research_html += `<p><strong>Link:</strong> <a href=\"${item.url}\" target=\"_blank\">${item.url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Build final comprehensive research_html report\nlet research_html = `\n<div>\n  \n  <!-- Header -->\n   <!-- <div>\n    <h1>üîç Adverse Findings Report</h1>\n    <p>Investigation Date: ${new Date(investigation_date).toLocaleString()}</p>\n  </div>  -->\n\n  <!-- Executive Summary Card -->\n  <div>\n    <h2>üìä Executive Summary</h2>\n    \n    <div>\n      <div>\n        <div>Company</div>\n        <div>${company}</div>\n      </div>\n      \n      <div>\n        <div>Adverse Flag</div>\n        <div>${adverse_flag ? '‚ö†Ô∏è YES' : '‚úÖ NO'}</div>\n      </div>\n      \n      <div>\n        <div>Risk Level</div>\n        <div>${risk_level}</div>\n      </div>\n      \n      <!-- <div>\n        <div>Confidence</div>\n        <div>${(confidence_overall * 100).toFixed(1)}%</div>\n      </div>-->\n    </div>\n\n    <div>\n      <strong>Promoters/Key Persons:</strong><br>\n      <span>${promoterList}</span>\n    </div>\n\n    <div>\n      <strong>Key Findings:</strong><br>\n      <span>${key_findings}</span>\n    </div>\n\n    <div>\n      <strong>Recommended Action:</strong><br>\n      ${getActionBadge(recommended_action)}\n    </div>\n\n    <div>\n      <strong>Red Flags Summary:</strong>\n      <div>\n        <div>üö´ Sanctions: <strong>${red_flags_count.sanctions || 0}</strong></div>\n        <div>‚öñÔ∏è Enforcement Actions: <strong>${red_flags_count.enforcement_actions || 0}</strong></div>\n        <div>üëÆ Criminal Cases: <strong>${red_flags_count.criminal_cases || 0}</strong></div>\n        <div>üì∞ High-Risk Media: <strong>${red_flags_count.high_risk_media || 0}</strong></div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Investigation Metadata -->\n  <div>\n    <strong>üîé Investigation Scope:</strong><br>\n    <span>Jurisdictions: ${jurisdictions_searched.join(', ')}</span><br>\n    <span>Total Sources Checked: ${total_sources_checked}</span>\n  </div>\n\n  <!-- Detailed Findings -->\n  <div>\n    <h2>üîç Detailed Findings</h2>\n    \n    <h3>üö´ Layer 1: Sanctions & Debarment</h3>\n    ${generateSanctionsSection(layer1_sanctions)}\n    \n    <h3>‚öñÔ∏è Layer 2: Legal & Regulatory Actions</h3>\n    ${generateLegalSection(layer2_legal_regulatory)}\n    \n    <h3>üì∞ Layer 3: OSINT & Media Intelligence</h3>\n    ${generateMediaSection(layer3_osint_media)}\n  </div>\n\n  <!-- Risk Assessment -->\n  <div>\n    <h2>üìà Multi-Dimensional Risk Assessment</h2>\n    \n    <div>\n      <div>\n        <div>Financial Crime</div>\n        <div>${financial_crime_risk}</div>\n      </div>\n      <div>\n        <div>Regulatory Compliance</div>\n        <div>${regulatory_compliance_risk}</div>\n      </div>\n      <div>\n        <div>Reputational</div>\n        <div>${reputational_risk}</div>\n      </div>\n      <div>\n        <div>Sanctions</div>\n        <div>${sanctions_risk}</div>\n      </div>\n      <div>\n        <div>Litigation</div>\n        <div>${litigation_risk}</div>\n      </div>\n    </div>\n\n    <div>\n      <strong>Overall Risk Score:</strong> \n      <span>${overall_risk_score}/10</span>\n    </div> \n\n    ${risk_factors.length > 0 ? `\n    <div>\n      <strong>Key Risk Factors:</strong>\n      <ul>\n        ${risk_factors.map(factor => `<li>${factor}</li>`).join('')}\n      </ul>\n    </div>\n    ` : ''}\n  </div>\n\n  <!-- Entity Network -->\n  ${(associated_companies.length > 0 || associated_persons.length > 0 || beneficial_owners_identified.length > 0 || related_entities_in_adverse_actions.length > 0) ? `\n  <div>\n    <h2>üï∏Ô∏è Entity Network</h2>\n    \n    ${associated_companies.length > 0 ? `\n    <div>\n      <strong>Associated Companies:</strong><br>\n      <span>${associated_companies.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${associated_persons.length > 0 ? `\n    <div>\n      <strong>Associated Persons:</strong><br>\n      <span>${associated_persons.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${beneficial_owners_identified.length > 0 ? `\n    <div>\n      <strong>Beneficial Owners:</strong><br>\n      <span>${beneficial_owners_identified.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${related_entities_in_adverse_actions.length > 0 ? `\n    <div>\n      <strong>‚ö†Ô∏è Related Entities in Adverse Actions:</strong><br>\n      <span>${related_entities_in_adverse_actions.join(', ')}</span>\n    </div>\n    ` : ''}\n  </div>\n  ` : ''}\n\n  <!-- Next Steps -->\n  ${next_steps.length > 0 ? `\n  <div>\n    <h2>üìã Recommended Next Steps</h2>\n    <ol>\n      ${next_steps.map(step => `<li>${step}</li>`).join('')}\n    </ol>\n  </div>\n  ` : ''}\n\n  <!-- Gaps & Limitations -->\n  ${gaps_and_limitations.length > 0 ? `\n  <div>\n    <h3>‚ö†Ô∏è Investigation Gaps & Limitations</h3>\n    <ul>\n      ${gaps_and_limitations.map(gap => `<li>${gap}</li>`).join('')}\n    </ul>\n  </div>\n  ` : ''}\n\n  <!-- Footer -->\n  <div>\n    <p>This report was generated using automated OSINT and regulatory database searches. All findings should be independently verified.</p>\n    <p>Report generated on ${new Date().toLocaleString()}</p>\n  </div>\n\n</div>\n`;\n\nreturn [{ research_html }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        10480,
        12752
      ],
      "id": "926b58de-6d1b-403b-8fb7-166830fe6667",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "jsCode": "// Parse Perplexity JSON output and convert it to a comprehensive research_html report\nlet raw =  $input.first().json.message;\n\n// Clean up and normalize the text\nif (typeof raw !== 'string') {\n  raw = JSON.stringify(raw);\n}\n\n// Remove code fences or markdown artifacts like ```json ... ```\nraw = raw\n  .replace(/^```json/i, '')\n  .replace(/^```/, '')\n  .replace(/```$/g, '')\n  .trim();\n\n// Try to find the JSON part if the model added extra text before or after\nconst jsonMatch = raw.match(/\\{[\\s\\S]*\\}/);\nif (jsonMatch) {\n  raw = jsonMatch[0];\n}\n\n// Safe JSON parse\nlet data;\ntry {\n  data = JSON.parse(raw);\n} catch (e) {\n  return [{ research_html: `<p>‚ùå Error parsing JSON: ${e.message}</p><pre>${raw}</pre>` }];\n}\n\n// Extract fields with safe fallback\nconst {\n  metadata = {},\n  executive_summary = {},\n  detailed_findings = {},\n  entity_network = {},\n  risk_assessment = {},\n  gaps_and_limitations = [],\n  next_steps = []\n} = data;\n\n// Extract metadata\nconst {\n  company = \"Unknown Company\",\n  promoters = \"\",\n  investigation_date = \"N/A\",\n  jurisdictions_searched = [],\n  total_sources_checked = 0\n} = metadata;\n\n// Extract executive summary\nconst {\n  adverse_flag = false,\n  risk_level = \"Not Rated\",\n  confidence_overall = 0,\n  key_findings = \"No findings available.\",\n  red_flags_count = {},\n  recommended_action = \"N/A\"\n} = executive_summary;\n\n// Extract risk assessment\nconst {\n  financial_crime_risk = \"N/A\",\n  regulatory_compliance_risk = \"N/A\",\n  reputational_risk = \"N/A\",\n  sanctions_risk = \"N/A\",\n  litigation_risk = \"N/A\",\n  overall_risk_score = 0,\n  risk_factors = []\n} = risk_assessment;\n\n// Extract detailed findings\nconst {\n  layer1_sanctions = [],\n  layer2_legal_regulatory = [],\n  layer3_osint_media = []\n} = detailed_findings;\n\n// Extract entity network\nconst {\n  associated_companies = [],\n  associated_persons = [],\n  beneficial_owners_identified = [],\n  related_entities_in_adverse_actions = []\n} = entity_network;\n\n// Handle promoters array or string gracefully\nconst promoterList = Array.isArray(promoters)\n  ? promoters.map(p => (typeof p === 'object' ? `${p.name || p.full_name || 'Unknown'} (${p.role || 'Unknown Role'})` : String(p))).join(', ')\n  : typeof promoters === 'string'\n  ? promoters\n  : 'Not Available';\n\n// Helper function to get action badge\nconst getActionBadge = (action) => {\n  const badges = {\n    'proceed': { text: 'Proceed'},\n    'proceed_with_caution': { text: 'Proceed with Caution'},\n    'enhanced_due_diligence': { text: 'Enhanced Due Diligence Required'},\n    'do_not_proceed': { text: 'Do Not Proceed' }\n  };\n  const badge = badges[action] || { text: action};\n  return `<span>${badge.text}</span>`;\n};\n\n// Helper for generating sanctions section\nconst generateSanctionsSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No sanctions or debarment records found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>‚ö†Ô∏è SANCTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>List:</strong> ${item.list_name || 'N/A'}</p>`;\n    research_html += `<p><strong>Matched Entity:</strong> ${item.matched_entity || 'N/A'}</p>`;\n    research_html += `<p><strong>Role:</strong> ${item.role || 'N/A'}</p>`;\n    research_html += `<p><strong>Reason:</strong> ${item.reason || 'N/A'}</p>`;\n    if (item.action_date) research_html += `<p><strong>Date:</strong> ${item.action_date}</p>`;\n    if (item.document_id) research_html += `<p><strong>Document ID:</strong> ${item.document_id}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url) {\n      research_html += `<p><strong>Source:</strong> <a href=\"${item.source_url}\" target=\"_blank\">${item.source_url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}% | <strong>Status:</strong> ${item.verification_status || 'N/A'}</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating legal/regulatory section\nconst generateLegalSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No legal or regulatory enforcement actions found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>‚öñÔ∏è LEGAL & REGULATORY ACTIONS FOUND</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Type:</strong> ${item.action_type || 'N/A'}</p>`;\n    if (item.case_number) research_html += `<p><strong>Case Number:</strong> ${item.case_number}</p>`;\n    if (item.filing_date) research_html += `<p><strong>Filing Date:</strong> ${item.filing_date}</p>`;\n    research_html += `<p><strong>Parties:</strong> ${item.parties || 'N/A'}</p>`;\n    if (item.jurisdiction) research_html += `<p><strong>Jurisdiction:</strong> ${item.jurisdiction}</p>`;\n    research_html += `<p><strong>Allegations:</strong> ${item.allegations || item.summary || 'N/A'}</p>`;\n    if (item.key_findings) research_html += `<p><strong>Key Findings:</strong> ${item.key_findings}</p>`;\n    if (item.penalties) research_html += `<p><strong>Penalties:</strong> ${item.penalties}</p>`;\n    research_html += `<p><strong>Status:</strong> <span>${item.final_disposition || item.disposition || 'N/A'}</span></p>`;\n    if (item.appeal_status) research_html += `<p><strong>Appeal Status:</strong> ${item.appeal_status}</p>`;\n    if (item.related_entities && item.related_entities.length > 0) {\n      research_html += `<p><strong>Related Entities:</strong> ${item.related_entities.join(', ')}</p>`;\n    }\n    if (item.source_url || item.url) {\n      const url = item.source_url || item.url;\n      research_html += `<p><strong>Source:</strong> <a href=\"${url}\" target=\"_blank\">${url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Helper for generating OSINT/media section\nconst generateMediaSection = (items) => {\n  if (!items || !Array.isArray(items) || items.length === 0) {\n    return '<p>‚úÖ No adverse media coverage found</p>';\n  }\n  \n  let research_html = '<div>';\n  research_html += '<h4>üì∞ MEDIA & OSINT FINDINGS</h4>';\n  \n  for (const item of items) {\n    research_html += '<div>';\n    research_html += `<p><strong>Headline:</strong> ${item.headline || 'N/A'}</p>`;\n    if (item.publication) research_html += `<p><strong>Publication:</strong> ${item.publication}</p>`;\n    if (item.date) research_html += `<p><strong>Date:</strong> ${item.date}</p>`;\n    research_html += `<p><strong>Summary:</strong> ${item.snippet || item.allegations || 'N/A'}</p>`;\n    research_html += `<p><strong>Source Type:</strong> ${item.source_type || 'N/A'} | `;\n    research_html += `<strong>Risk Level:</strong> <span>${item.risk_label || 'N/A'}</span></p>`;\n    if (item.corroboration) research_html += `<p><strong>Corroboration:</strong> ${item.corroboration}</p>`;\n    if (item.credibility_score !== undefined) {\n      research_html += `<p><strong>Credibility Score:</strong> ${(item.credibility_score * 100).toFixed(0)}%</p>`;\n    }\n    if (item.url) {\n      research_html += `<p><strong>Link:</strong> <a href=\"${item.url}\" target=\"_blank\">${item.url}</a></p>`;\n    }\n    research_html += `<p><strong>Confidence:</strong> ${(item.confidence * 100).toFixed(0)}%</p>`;\n    research_html += '</div>';\n  }\n  research_html += '</div>';\n  return research_html;\n};\n\n// Build final comprehensive research_html report\nlet research_html = `\n<div>\n  \n  <!-- Header -->\n   <!-- <div>\n    <h1>üîç Adverse Findings Report</h1>\n    <p>Investigation Date: ${new Date(investigation_date).toLocaleString()}</p>\n  </div>  -->\n\n  <!-- Executive Summary Card -->\n  <div>\n    <h2>üìä Executive Summary</h2>\n    \n    <div>\n      <div>\n        <div>Company</div>\n        <div>${company}</div>\n      </div>\n      \n      <div>\n        <div>Adverse Flag</div>\n        <div>${adverse_flag ? '‚ö†Ô∏è YES' : '‚úÖ NO'}</div>\n      </div>\n      \n      <div>\n        <div>Risk Level</div>\n        <div>${risk_level}</div>\n      </div>\n      \n      <!-- <div>\n        <div>Confidence</div>\n        <div>${(confidence_overall * 100).toFixed(1)}%</div>\n      </div>-->\n    </div>\n\n    <div>\n      <strong>Promoters/Key Persons:</strong><br>\n      <span>${promoterList}</span>\n    </div>\n\n    <div>\n      <strong>Key Findings:</strong><br>\n      <span>${key_findings}</span>\n    </div>\n\n    <div>\n      <strong>Recommended Action:</strong><br>\n      ${getActionBadge(recommended_action)}\n    </div>\n\n    <div>\n      <strong>Red Flags Summary:</strong>\n      <div>\n        <div>üö´ Sanctions: <strong>${red_flags_count.sanctions || 0}</strong></div>\n        <div>‚öñÔ∏è Enforcement Actions: <strong>${red_flags_count.enforcement_actions || 0}</strong></div>\n        <div>üëÆ Criminal Cases: <strong>${red_flags_count.criminal_cases || 0}</strong></div>\n        <div>üì∞ High-Risk Media: <strong>${red_flags_count.high_risk_media || 0}</strong></div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Investigation Metadata -->\n  <div>\n    <strong>üîé Investigation Scope:</strong><br>\n    <span>Jurisdictions: ${jurisdictions_searched.join(', ')}</span><br>\n    <span>Total Sources Checked: ${total_sources_checked}</span>\n  </div>\n\n  <!-- Detailed Findings -->\n  <div>\n    <h2>üîç Detailed Findings</h2>\n    \n    <h3>üö´ Layer 1: Sanctions & Debarment</h3>\n    ${generateSanctionsSection(layer1_sanctions)}\n    \n    <h3>‚öñÔ∏è Layer 2: Legal & Regulatory Actions</h3>\n    ${generateLegalSection(layer2_legal_regulatory)}\n    \n    <h3>üì∞ Layer 3: OSINT & Media Intelligence</h3>\n    ${generateMediaSection(layer3_osint_media)}\n  </div>\n\n  <!-- Risk Assessment -->\n  <div>\n    <h2>üìà Multi-Dimensional Risk Assessment</h2>\n    \n    <div>\n      <div>\n        <div>Financial Crime</div>\n        <div>${financial_crime_risk}</div>\n      </div>\n      <div>\n        <div>Regulatory Compliance</div>\n        <div>${regulatory_compliance_risk}</div>\n      </div>\n      <div>\n        <div>Reputational</div>\n        <div>${reputational_risk}</div>\n      </div>\n      <div>\n        <div>Sanctions</div>\n        <div>${sanctions_risk}</div>\n      </div>\n      <div>\n        <div>Litigation</div>\n        <div>${litigation_risk}</div>\n      </div>\n    </div>\n\n    <div>\n      <strong>Overall Risk Score:</strong> \n      <span>${overall_risk_score}/10</span>\n    </div> \n\n    ${risk_factors.length > 0 ? `\n    <div>\n      <strong>Key Risk Factors:</strong>\n      <ul>\n        ${risk_factors.map(factor => `<li>${factor}</li>`).join('')}\n      </ul>\n    </div>\n    ` : ''}\n  </div>\n\n  <!-- Entity Network -->\n  ${(associated_companies.length > 0 || associated_persons.length > 0 || beneficial_owners_identified.length > 0 || related_entities_in_adverse_actions.length > 0) ? `\n  <div>\n    <h2>üï∏Ô∏è Entity Network</h2>\n    \n    ${associated_companies.length > 0 ? `\n    <div>\n      <strong>Associated Companies:</strong><br>\n      <span>${associated_companies.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${associated_persons.length > 0 ? `\n    <div>\n      <strong>Associated Persons:</strong><br>\n      <span>${associated_persons.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${beneficial_owners_identified.length > 0 ? `\n    <div>\n      <strong>Beneficial Owners:</strong><br>\n      <span>${beneficial_owners_identified.join(', ')}</span>\n    </div>\n    ` : ''}\n    \n    ${related_entities_in_adverse_actions.length > 0 ? `\n    <div>\n      <strong>‚ö†Ô∏è Related Entities in Adverse Actions:</strong><br>\n      <span>${related_entities_in_adverse_actions.join(', ')}</span>\n    </div>\n    ` : ''}\n  </div>\n  ` : ''}\n\n  <!-- Next Steps -->\n  ${next_steps.length > 0 ? `\n  <div>\n    <h2>üìã Recommended Next Steps</h2>\n    <ol>\n      ${next_steps.map(step => `<li>${step}</li>`).join('')}\n    </ol>\n  </div>\n  ` : ''}\n\n  <!-- Gaps & Limitations -->\n  ${gaps_and_limitations.length > 0 ? `\n  <div>\n    <h3>‚ö†Ô∏è Investigation Gaps & Limitations</h3>\n    <ul>\n      ${gaps_and_limitations.map(gap => `<li>${gap}</li>`).join('')}\n    </ul>\n  </div>\n  ` : ''}\n\n  <!-- Footer -->\n  <div>\n    <p>This report was generated using automated OSINT and regulatory database searches. All findings should be independently verified.</p>\n    <p>Report generated on ${new Date().toLocaleString()}</p>\n  </div>\n\n</div>\n`;\n\nreturn [{ research_html }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        13072,
        12864
      ],
      "id": "8156edd7-4fc9-4fdc-95cb-b639b0aba1de",
      "name": "Code in JavaScript1"
    }
  ],
  "connections": {
    "Simple Memory3": {
      "ai_memory": [
        [
          {
            "node": "Summary generator Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs": {
      "main": [
        [
          {
            "node": "List Vector IDs1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Batch Vector IDs": {
      "main": [
        [
          {
            "node": "Fetch Vectors with Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Vectors with Data": {
      "main": [
        [
          {
            "node": "Transform Vectors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transform Vectors": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs1": {
      "main": [
        [
          {
            "node": "List Vector IDs2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge8",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "List Vector IDs2": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 2
          },
          {
            "node": "List Vector IDs3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs3": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 3
          },
          {
            "node": "List Vector IDs4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs4": {
      "main": [
        [
          {
            "node": "List Vector IDs5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge8",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Merge8": {
      "main": [
        [
          {
            "node": "Batch Vector IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Upsert to Default Namespace1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs5": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 5
          },
          {
            "node": "List Vector IDs6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs6": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 6
          },
          {
            "node": "List Vector IDs14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields21": {
      "main": [
        [
          {
            "node": "List Vector IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Vector IDs14": {
      "main": [
        [
          {
            "node": "Merge8",
            "type": "main",
            "index": 7
          }
        ]
      ]
    },
    "OpenAI Chat Model17": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Generator Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere15": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info6": {
      "main": [
        [
          {
            "node": "Respond with Execution ID6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields19": {
      "main": [
        [
          {
            "node": "Send Error to Backend27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields24": {
      "main": [
        [
          {
            "node": "Summary generator Agent4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Generator Agent": {
      "main": [
        [
          {
            "node": "DRHP Summary Preview Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Preview Agent": {
      "main": [
        [
          {
            "node": "mdn to html17",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Generator Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Summary Format Doc1": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update Summary In MongoDB": {
      "main": [
        [
          {
            "node": "Response Back To Pollong Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model26": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator2": {
      "main": [
        [
          {
            "node": "Code5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Subquery generator2",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model13": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code5": {
      "main": [
        [
          {
            "node": "Code6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code6": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code7": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML7": {
      "main": [
        [
          {
            "node": "Merge9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge6": {
      "main": [
        [
          {
            "node": "Aggregate2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate2": {
      "main": [
        [
          {
            "node": "HTML7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html17": {
      "main": [
        [
          {
            "node": "Merge9",
            "type": "main",
            "index": 1
          }
        ],
        [
          {
            "node": "Edit Fields19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html18": {
      "main": [
        [
          {
            "node": "Update Summary In MongoDB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge9": {
      "main": [
        [
          {
            "node": "mdn to html18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI33": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB5",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere19": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB5",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB5": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI38": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB6",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere23": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB6",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB6": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI30": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone Vector Store5",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "mdn to html16",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields38",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI40": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector Store5",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere17": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector Store5",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Webhook3": {
      "main": [
        [
          {
            "node": "Extract from File7",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge12",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge12": {
      "main": [
        [
          {
            "node": "Cleaned text7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI41": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store9",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store9": {
      "main": [
        [
          {
            "node": "Respond to Webhook17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook12": {
      "main": [
        [
          {
            "node": "Extract from File8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge14",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge14": {
      "main": [
        [
          {
            "node": "Cleaned text8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields18": {
      "main": [
        [
          {
            "node": "Send Error to Backend15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI42": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store16",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store16": {
      "main": [
        [
          {
            "node": "Respond to Webhook12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model30": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model31": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Preview Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI43": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone VectorDB2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model32": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Generator Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI44": {
      "ai_embedding": [
        [
          {
            "node": "Fund SOP Pinecone VectorDB2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI45": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere25": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone VectorDB2",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere26": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB1",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Webhook13": {
      "main": [
        [
          {
            "node": "Set Execution Info8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields45",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info8": {
      "main": [
        [
          {
            "node": "Respond with Execution ID8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields25": {
      "main": [
        [
          {
            "node": "Send Error to Backend16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model33": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Summary Preview Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model34": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Summary Generator Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI46": {
      "ai_embedding": [
        [
          {
            "node": "Fund SOP Pinecone Vector DB",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI47": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector DB",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere27": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector DB",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info9": {
      "main": [
        [
          {
            "node": "Respond with Execution ID9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields26": {
      "main": [
        [
          {
            "node": "Send Error to Backend17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook14": {
      "main": [
        [
          {
            "node": "Set Execution Info9",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator7",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields46",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector DB": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Generator Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Fund SOP Pinecone Vector DB": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Summary Generator Agent1": {
      "main": [
        [
          {
            "node": "RHP Summary Preview Agent1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Generator Agent2": {
      "main": [
        [
          {
            "node": "DRHP Summary Preview Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Preview Agent2": {
      "main": [
        [
          {
            "node": "mdn to html23",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Summary Preview Agent1": {
      "main": [
        [
          {
            "node": "mdn to html25",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fund SOP Pinecone VectorDB2": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB1": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Generator Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Summary Format Doc": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Summary Format Doc3": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update Summary In MongoDB1": {
      "main": [
        [
          {
            "node": "Response Back To Pollong Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model35": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator6",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator6": {
      "main": [
        [
          {
            "node": "Code11",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser3": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser3",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser3": {
      "ai_outputParser": [
        [
          {
            "node": "Subquery generator6",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model36": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code11": {
      "main": [
        [
          {
            "node": "Code12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code12": {
      "main": [
        [
          {
            "node": "Merge15",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code13": {
      "main": [
        [
          {
            "node": "Merge15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML10": {
      "main": [
        [
          {
            "node": "Merge16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge15": {
      "main": [
        [
          {
            "node": "Aggregate4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate4": {
      "main": [
        [
          {
            "node": "HTML10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html23": {
      "main": [
        [
          {
            "node": "Merge16",
            "type": "main",
            "index": 1
          }
        ],
        [
          {
            "node": "Edit Fields25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html24": {
      "main": [
        [
          {
            "node": "Update Summary In MongoDB1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge16": {
      "main": [
        [
          {
            "node": "mdn to html24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI48": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB7",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere28": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB7",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB7": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator6",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI49": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB8",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere29": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB8",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB8": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model37": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator7",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator7": {
      "main": [
        [
          {
            "node": "Code14",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code16",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser4": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser4",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser4": {
      "ai_outputParser": [
        [
          {
            "node": "Subquery generator7",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model38": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code14": {
      "main": [
        [
          {
            "node": "Code15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code15": {
      "main": [
        [
          {
            "node": "Merge17",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code16": {
      "main": [
        [
          {
            "node": "Merge17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML11": {
      "main": [
        [
          {
            "node": "Merge18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge17": {
      "main": [
        [
          {
            "node": "Aggregate5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate5": {
      "main": [
        [
          {
            "node": "HTML11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html25": {
      "main": [
        [
          {
            "node": "Merge18",
            "type": "main",
            "index": 1
          }
        ],
        [
          {
            "node": "Edit Fields26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html26": {
      "main": [
        [
          {
            "node": "Update in MongoDB1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge18": {
      "main": [
        [
          {
            "node": "mdn to html26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI50": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone VectorDB",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere30": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone VectorDB",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Update in MongoDB1": {
      "main": [
        [
          {
            "node": "Response Back to Polling Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone VectorDB": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator7",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone VectorDB2": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI51": {
      "ai_embedding": [
        [
          {
            "node": "Fund SOP Pinecone Vector DB3",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Fund SOP Pinecone Vector DB3": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields20": {
      "main": [
        [
          {
            "node": "Respond to Webhook14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields27": {
      "main": [
        [
          {
            "node": "Send Error to Backend18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere10": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector Store3",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model16": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Chat Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI52": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone Vector Store3",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere31": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone Vector Store3",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "RHP Chat Agent1": {
      "main": [
        [
          {
            "node": "Edit Fields20",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Chat Agent3": {
      "main": [
        [
          {
            "node": "Edit Fields20",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone Vector Store3": {
      "ai_tool": [
        [
          {
            "node": "DRHP Chat Agent3",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector Store3": {
      "ai_tool": [
        [
          {
            "node": "RHP Chat Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat  Model": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Chat Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Merge11": {
      "main": [
        [
          {
            "node": "mdn to html20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code20": {
      "main": [
        [
          {
            "node": "Code21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code21": {
      "main": [
        [
          {
            "node": "Merge22",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code22": {
      "main": [
        [
          {
            "node": "Merge22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML": {
      "main": [
        [
          {
            "node": "Merge26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge22": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI28": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone Vector Store4",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent4": {
      "main": [
        [
          {
            "node": "mdn to html9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory13": {
      "ai_memory": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI29": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector Store4",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector Store4": {
      "ai_tool": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone Vector Store4": {
      "ai_tool": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html9": {
      "main": [
        [
          {
            "node": "sent response to the backend api for create report2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields30": {
      "main": [
        [
          {
            "node": "Send Error to Backend20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook18": {
      "main": [
        [
          {
            "node": "Set Execution Info4",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Agent4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info4": {
      "main": [
        [
          {
            "node": "Respond with Execution ID4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sent response to the backend api for create report2": {
      "main": [
        [
          {
            "node": "send final response for success report2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere16": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone Vector Store4",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere20": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector Store4",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Webhook19": {
      "main": [
        [
          {
            "node": "Extract from File5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge7",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Cleaned text5": {
      "main": [
        [
          {
            "node": "Pinecone Vector Store11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File5": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge7": {
      "main": [
        [
          {
            "node": "Cleaned text5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields31": {
      "main": [
        [
          {
            "node": "Send Error to Backend21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter4": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader4",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader4": {
      "ai_document": [
        [
          {
            "node": "Pinecone Vector Store11",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI34": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store11",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store11": {
      "main": [
        [
          {
            "node": "Respond to Webhook15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook20": {
      "main": [
        [
          {
            "node": "Extract from File6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge13",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Cleaned text6": {
      "main": [
        [
          {
            "node": "Pinecone Vector Store13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File6": {
      "main": [
        [
          {
            "node": "Merge13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields32",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge13": {
      "main": [
        [
          {
            "node": "Cleaned text6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields32": {
      "main": [
        [
          {
            "node": "Send Error to Backend22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter5": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader5",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader5": {
      "ai_document": [
        [
          {
            "node": "Pinecone Vector Store13",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI35": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store13",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store13": {
      "main": [
        [
          {
            "node": "Respond to Webhook16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info11": {
      "main": [
        [
          {
            "node": "Respond with Execution ID11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request7": {
      "main": [
        [
          {
            "node": "Send Error to Backend24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields33": {
      "main": [
        [
          {
            "node": "Send Error to Backend23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Summary generator Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI8": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store14",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Summary generator Agent": {
      "main": [
        [
          {
            "node": "mdn to html15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields33",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store14": {
      "ai_tool": [
        [
          {
            "node": "Summary generator Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Webhook21": {
      "main": [
        [
          {
            "node": "Set Execution Info11",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields34",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere21": {
      "ai_reranker": [
        [
          {
            "node": "Pinecone Vector Store14",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields34": {
      "main": [
        [
          {
            "node": "Summary generator Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model19": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator": {
      "main": [
        [
          {
            "node": "mdn to html10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields33",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store19": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI36": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store19",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere22": {
      "ai_reranker": [
        [
          {
            "node": "Pinecone Vector Store19",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info12": {
      "main": [
        [
          {
            "node": "Respond with Execution ID12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request5": {
      "main": [
        [
          {
            "node": "Send Error to Backend26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields35": {
      "main": [
        [
          {
            "node": "Send Error to Backend25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI5": {
      "ai_embedding": [
        [
          {
            "node": "Pinecone Vector Store4",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Summary generator Agent4": {
      "main": [
        [
          {
            "node": "mdn to html3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields35",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pinecone Vector Store4": {
      "ai_tool": [
        [
          {
            "node": "Summary generator Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html3": {
      "main": [
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook22": {
      "main": [
        [
          {
            "node": "Set Execution Info12",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere34": {
      "ai_reranker": [
        [
          {
            "node": "Pinecone Vector Store4",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html10": {
      "main": [
        [
          {
            "node": "Merge23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html14": {
      "main": [
        [
          {
            "node": "HTTP Request7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html15": {
      "main": [
        [
          {
            "node": "Merge23",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge23": {
      "main": [
        [
          {
            "node": "mdn to html14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "Summary generator Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model20": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Preview Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI37": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone VectorDB3",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI57": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere36": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone VectorDB3",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Webhook23": {
      "main": [
        [
          {
            "node": "Set Execution Info6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields40",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model23": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Summary Preview Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model24": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Summary Generator Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI58": {
      "ai_embedding": [
        [
          {
            "node": "Fund SOP Pinecone Vector DB5",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI59": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector DB2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere37": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector DB2",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info13": {
      "main": [
        [
          {
            "node": "Respond with Execution ID13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields37": {
      "main": [
        [
          {
            "node": "Send Error to Backend28",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook24": {
      "main": [
        [
          {
            "node": "Set Execution Info13",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields41",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector DB2": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Generator Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Fund SOP Pinecone Vector DB5": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Summary Generator Agent2": {
      "main": [
        [
          {
            "node": "RHP Summary Preview Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Summary Preview Agent2": {
      "main": [
        [
          {
            "node": "mdn to html21",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summary Format Doc4": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model42": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator8",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator8": {
      "main": [
        [
          {
            "node": "Adverse Findings Analyzer1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code20",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code22",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Subquery generator8",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model43": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html21": {
      "main": [
        [
          {
            "node": "Merge26",
            "type": "main",
            "index": 2
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI60": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone VectorDB8",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere38": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone VectorDB8",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Update in MongoDB2": {
      "main": [
        [
          {
            "node": "Response Back to Polling Webhook2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone VectorDB8": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator8",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone VectorDB3": {
      "ai_tool": [
        [
          {
            "node": "RHP Summary Preview Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory1": {
      "ai_memory": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector Store5": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone Vector Store5": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html16": {
      "main": [
        [
          {
            "node": "sent response to the backend api for create report3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields38": {
      "main": [
        [
          {
            "node": "Send Error to Backend29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook25": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Set Execution Info14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info14": {
      "main": [
        [
          {
            "node": "Respond with Execution ID14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sent response to the backend api for create report3": {
      "main": [
        [
          {
            "node": "send final response for success report3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere39": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone Vector Store5",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Cleaned text7": {
      "main": [
        [
          {
            "node": "Pinecone Vector Store9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File7": {
      "main": [
        [
          {
            "node": "Merge12",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields39",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields39": {
      "main": [
        [
          {
            "node": "Send Error to Backend30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter6": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader6",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader6": {
      "ai_document": [
        [
          {
            "node": "Pinecone Vector Store9",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Cleaned text8": {
      "main": [
        [
          {
            "node": "Pinecone Vector Store16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File8": {
      "main": [
        [
          {
            "node": "Merge14",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Recursive Character Text Splitter7": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader7",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader7": {
      "ai_document": [
        [
          {
            "node": "Pinecone Vector Store16",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields40": {
      "main": [
        [
          {
            "node": "DRHP Summary Generator Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields41": {
      "main": [
        [
          {
            "node": "RHP Summary Generator Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI61": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector Store6",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields42": {
      "main": [
        [
          {
            "node": "Respond to Webhook18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields43": {
      "main": [
        [
          {
            "node": "Send Error to Backend31",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere40": {
      "ai_reranker": [
        [
          {
            "node": "RHP Pinecone Vector Store6",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model25": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Chat Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI62": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone Vector Store6",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere41": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone Vector Store6",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "RHP Chat Agent2": {
      "main": [
        [
          {
            "node": "Edit Fields42",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields43",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Chat Agent": {
      "main": [
        [
          {
            "node": "Edit Fields42",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields43",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone Vector Store6": {
      "ai_tool": [
        [
          {
            "node": "DRHP Chat Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "RHP Pinecone Vector Store6": {
      "ai_tool": [
        [
          {
            "node": "RHP Chat Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat  Model10": {
      "ai_languageModel": [
        [
          {
            "node": "RHP Chat Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI63": {
      "ai_embedding": [
        [
          {
            "node": "RHP Pinecone Vector Store3",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields44": {
      "main": [
        [
          {
            "node": "List All Vector IDs - Page 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields45": {
      "main": [
        [
          {
            "node": "DRHP Summary Generator Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields46": {
      "main": [
        [
          {
            "node": "RHP Summary Generator Agent1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html29": {
      "main": [
        [
          {
            "node": "Update Summary In MongoDB3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge24": {
      "main": [
        [
          {
            "node": "mdn to html29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model44": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Preview Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model45": {
      "ai_languageModel": [
        [
          {
            "node": "DRHP Summary Generator Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI64": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB12",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere42": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB12",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "Webhook28": {
      "main": [
        [
          {
            "node": "Set Execution Info15",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields48",
            "type": "main",
            "index": 0
          },
          {
            "node": "Subquery generator9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Execution Info15": {
      "main": [
        [
          {
            "node": "Respond with Execution ID15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields47": {
      "main": [
        [
          {
            "node": "Send Error to Backend32",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Generator Agent4": {
      "main": [
        [
          {
            "node": "DRHP Summary Preview Agent4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Summary Preview Agent4": {
      "main": [
        [
          {
            "node": "mdn to html4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB12": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Generator Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Summary Format Doc6": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update Summary In MongoDB3": {
      "main": [
        [
          {
            "node": "Response Back To Pollong Webhook3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model46": {
      "ai_languageModel": [
        [
          {
            "node": "Subquery generator9",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Subquery generator9": {
      "main": [
        [
          {
            "node": "Code23",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code25",
            "type": "main",
            "index": 0
          },
          {
            "node": "Adverse Findings Analyzer4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser6": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser6",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser6": {
      "ai_outputParser": [
        [
          {
            "node": "Subquery generator9",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model47": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser6",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code23": {
      "main": [
        [
          {
            "node": "Code24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code24": {
      "main": [
        [
          {
            "node": "Merge25",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code25": {
      "main": [
        [
          {
            "node": "Merge25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML13": {
      "main": [
        [
          {
            "node": "Merge24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge25": {
      "main": [
        [
          {
            "node": "Aggregate6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate6": {
      "main": [
        [
          {
            "node": "HTML13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html4": {
      "main": [
        [
          {
            "node": "Merge24",
            "type": "main",
            "index": 2
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI65": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB13",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere43": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB13",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB13": {
      "ai_tool": [
        [
          {
            "node": "Subquery generator9",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI66": {
      "ai_embedding": [
        [
          {
            "node": "DRHP Pinecone VectorDB14",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Reranker Cohere44": {
      "ai_reranker": [
        [
          {
            "node": "DRHP Pinecone VectorDB14",
            "type": "ai_reranker",
            "index": 0
          }
        ]
      ]
    },
    "DRHP Pinecone VectorDB14": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields48": {
      "main": [
        [
          {
            "node": "DRHP Summary Generator Agent4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI67": {
      "ai_embedding": [
        [
          {
            "node": "Fund SOP Pinecone Vector DB6",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Fund SOP Pinecone Vector DB6": {
      "ai_tool": [
        [
          {
            "node": "DRHP Summary Preview Agent4",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "mdn to html30": {
      "main": [
        [
          {
            "node": "Update in MongoDB2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge26": {
      "main": [
        [
          {
            "node": "mdn to html30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Adverse Findings Analyzer4": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields47",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Adverse Findings Analyzer1": {
      "main": [
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields37",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Merge26",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Merge24",
            "type": "main",
            "index": 1
          }
        ]
      ]
    }
  },
  "pinData": {
    "Webhook21": [
      {
        "headers": {
          "accept": "application/json, text/plain, */*",
          "host": "n8n-excollo.azurewebsites.net",
          "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36",
          "accept-encoding": "gzip, deflate, br, zstd",
          "accept-language": "en-US,en;q=0.9",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODViYzE2ZTM5MDEwZGQ4OWU3YjRiYzMiLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJpYXQiOjE3NTkxMTk1NzksImV4cCI6MTc1OTIwNTk3OX0.yRU5bWBSbTksRrzsXmSvwRAW2hs9kSJj6cXowrtr9dg",
          "max-forwards": "10",
          "origin": "https://rhp-document-summarizer.vercel.app",
          "referer": "https://rhp-document-summarizer.vercel.app/",
          "sec-ch-ua-platform": "\"macOS\"",
          "sec-ch-ua": "\"Chromium\";v=\"140\", \"Not=A?Brand\";v=\"24\", \"Google Chrome\";v=\"140\"",
          "sec-ch-ua-mobile": "?0",
          "sec-fetch-site": "cross-site",
          "sec-fetch-mode": "cors",
          "sec-fetch-dest": "empty",
          "x-arr-log-id": "940906dd-ef03-4d24-a45c-652dc5e70870",
          "client-ip": "49.36.237.105:50033",
          "disguised-host": "n8n-excollo.azurewebsites.net",
          "x-site-deployment-id": "n8n-excollo",
          "was-default-hostname": "n8n-excollo.azurewebsites.net",
          "x-forwarded-proto": "https",
          "x-appservice-proto": "https",
          "x-arr-ssl": "2048|256|CN=Microsoft Azure RSA TLS Issuing CA 07, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
          "x-forwarded-tlsversion": "1.3",
          "x-forwarded-for": "49.36.237.105:50033",
          "x-original-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_e60970aa-3a00-4562-abcd-74817bb69062&conversation_history=%5B%5D&timestamp=2025-09-29T10%3A39%3A41.862Z&action=summary&namespace=https_www.vgipl.com_documents_VirtualGalaxy-DRHP-29-10-2024.pdf&documentId=session_46208d20-3409-44f2-9184-d9e87f5412a8&domain=gmail.com",
          "x-waws-unencoded-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_e60970aa-3a00-4562-abcd-74817bb69062&conversation_history=%5B%5D&timestamp=2025-09-29T10%3A39%3A41.862Z&action=summary&namespace=https_www.vgipl.com_documents_VirtualGalaxy-DRHP-29-10-2024.pdf&documentId=session_46208d20-3409-44f2-9184-d9e87f5412a8&domain=gmail.com",
          "x-client-ip": "49.36.237.105",
          "x-client-port": "50033"
        },
        "params": {},
        "query": {
          "message": "Generate DRHP Doc Summary",
          "session_id": "session_e60970aa-3a00-4562-abcd-74817bb69062",
          "conversation_history": "[]",
          "timestamp": "2025-09-29T10:39:41.862Z",
          "action": "summary",
          "namespace": "A-One Steel DRHP.pdf",
          "documentId": "session_46208d20-3409-44f2-9184-d9e87f5412a8",
          "domain": "gmail.com"
        },
        "body": {},
        "webhookUrl": "https://n8n-excollo.azurewebsites.net/webhook/3/summary",
        "executionMode": "production"
      }
    ],
    "Webhook22": [
      {
        "headers": {
          "accept": "application/json, text/plain, */*",
          "host": "n8n-excollo.azurewebsites.net",
          "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36",
          "accept-encoding": "gzip, deflate, br, zstd",
          "accept-language": "en-US,en;q=0.9",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2OGFmZTc3NzM2YjFkMzQ3MGYyYWI4ODEiLCJlbWFpbCI6InNvbnV2QGV4Y29sbG8uY29tIiwicm9sZSI6ImFkbWluIiwiZG9tYWluIjoiZXhjb2xsby5jb20iLCJpYXQiOjE3NTk5ODQyMDUsImV4cCI6MTc2MDA3MDYwNX0.5sxo4qDhWnYiI6mqqFLqosdIrBtd8AePgJtIC2KRPfk",
          "max-forwards": "10",
          "origin": "https://rhp-document-summarizer.vercel.app",
          "referer": "https://rhp-document-summarizer.vercel.app/",
          "sec-ch-ua-platform": "\"macOS\"",
          "sec-ch-ua": "\"Chromium\";v=\"140\", \"Not=A?Brand\";v=\"24\", \"Google Chrome\";v=\"140\"",
          "sec-ch-ua-mobile": "?0",
          "sec-fetch-site": "cross-site",
          "sec-fetch-mode": "cors",
          "sec-fetch-dest": "empty",
          "x-arr-log-id": "e8912390-dfbc-413f-a9fa-9cd9561adef4",
          "client-ip": "49.36.237.105:63792",
          "disguised-host": "n8n-excollo.azurewebsites.net",
          "x-site-deployment-id": "n8n-excollo",
          "was-default-hostname": "n8n-excollo.azurewebsites.net",
          "x-forwarded-proto": "https",
          "x-appservice-proto": "https",
          "x-arr-ssl": "2048|256|CN=Microsoft Azure RSA TLS Issuing CA 07, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
          "x-forwarded-tlsversion": "1.3",
          "x-forwarded-for": "49.36.237.105:63792",
          "x-original-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1&conversation_history=%5B%5D&timestamp=2025-10-09T08%3A35%3A13.356Z&action=summary&namespace=A-One+Steel+DRHP.pdf&documentId=1757740616201-A-One+Steel+DRHP.pdf&domain=excollo.com",
          "x-waws-unencoded-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1&conversation_history=%5B%5D&timestamp=2025-10-09T08%3A35%3A13.356Z&action=summary&namespace=A-One+Steel+DRHP.pdf&documentId=1757740616201-A-One+Steel+DRHP.pdf&domain=excollo.com",
          "x-client-ip": "49.36.237.105",
          "x-client-port": "63792"
        },
        "params": {},
        "query": {
          "message": "Generate DRHP Doc Summary",
          "session_id": "session_28fa6a5e-fdcc-4ea0-9d9b-81df8cbbb8c1",
          "conversation_history": "[]",
          "timestamp": "2025-10-09T08:35:13.356Z",
          "action": "summary",
          "namespace": "A-One Steel DRHP.pdf",
          "documentId": "1757740616201-A-One Steel DRHP.pdf",
          "domain": "excollo.com"
        },
        "body": {},
        "webhookUrl": "https://n8n-excollo.azurewebsites.net/webhook/3/summary",
        "executionMode": "production"
      }
    ],
    "Webhook28": [
      {
        "headers": {
          "accept": "application/json, text/plain, */*",
          "host": "n8n-excollo.azurewebsites.net",
          "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36 Edg/143.0.0.0",
          "accept-encoding": "gzip, deflate, br, zstd",
          "accept-language": "en-IN,en;q=0.9,en-US;q=0.8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODViYzE2ZTM5MDEwZGQ4OWU3YjRiYzMiLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwicm9sZSI6InVzZXIiLCJkb21haW4iOiJleGNvbGxvLmNvbSIsImRvbWFpbklkIjoiZG9tYWluX2V4Y29sbG8tY29tXzE3NjIxMDQ1ODE5NjkiLCJpYXQiOjE3Njc5NDg5MjEsImV4cCI6MTc2ODAzNTMyMX0.ha4T73AEMUgw_Hvr3L_W2dDNlGLASVzvJDdPwxXRyMc",
          "max-forwards": "10",
          "origin": "https://rhp-document-summarizer.vercel.app",
          "referer": "https://rhp-document-summarizer.vercel.app/",
          "sec-ch-ua-platform": "\"Windows\"",
          "sec-ch-ua": "\"Microsoft Edge\";v=\"143\", \"Chromium\";v=\"143\", \"Not A(Brand\";v=\"24\"",
          "sec-ch-ua-mobile": "?0",
          "sec-fetch-site": "cross-site",
          "sec-fetch-mode": "cors",
          "sec-fetch-dest": "empty",
          "x-arr-log-id": "beb78036-3299-4192-9c4e-3641d337486a",
          "client-ip": "117.207.31.247:53276",
          "disguised-host": "n8n-excollo.azurewebsites.net",
          "x-site-deployment-id": "n8n-excollo",
          "was-default-hostname": "n8n-excollo.azurewebsites.net",
          "x-forwarded-proto": "https",
          "x-appservice-proto": "https",
          "x-arr-ssl": "2048|256|CN=Microsoft Azure RSA TLS Issuing CA 07, O=Microsoft Corporation, C=US|CN=*.azurewebsites.net, O=Microsoft Corporation, L=Redmond, S=WA, C=US",
          "x-forwarded-tlsversion": "1.3",
          "x-forwarded-for": "117.207.31.247:53276",
          "x-original-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_3512945d-27d8-4e13-a622-bc1f9db445e1&conversation_history=%5B%5D&timestamp=2026-01-09T10%3A00%3A07.328Z&action=summary&namespace=Digilogic+Systems_DRHP.pdf&documentId=1767948975418-Digilogic+Systems_DRHP.pdf&domain=excollo.com&domainId=domain_excollo-com_1762104581969&workspaceId=ws_1758689602670_z3pxonjqn",
          "x-waws-unencoded-url": "/webhook/3/summary?message=Generate+DRHP+Doc+Summary&session_id=session_3512945d-27d8-4e13-a622-bc1f9db445e1&conversation_history=%5B%5D&timestamp=2026-01-09T10%3A00%3A07.328Z&action=summary&namespace=Digilogic+Systems_DRHP.pdf&documentId=1767948975418-Digilogic+Systems_DRHP.pdf&domain=excollo.com&domainId=domain_excollo-com_1762104581969&workspaceId=ws_1758689602670_z3pxonjqn",
          "x-client-ip": "117.207.31.247",
          "x-client-port": "53276"
        },
        "params": {},
        "query": {
          "message": "Generate DRHP Doc Summary",
          "session_id": "session_3512945d-27d8-4e13-a622-bc1f9db445e1",
          "conversation_history": "[]",
          "timestamp": "2026-01-09T10:00:07.328Z",
          "action": "summary",
          "namespace": "Digilogic Systems_DRHP.pdf",
          "documentId": "1767948975418-Digilogic Systems_DRHP.pdf",
          "domain": "excollo.com",
          "domainId": "domain_excollo-com_1762104581969",
          "workspaceId": "ws_1758689602670_z3pxonjqn"
        },
        "body": {},
        "webhookUrl": "https://n8n-excollo.azurewebsites.net/webhook/3/summary",
        "executionMode": "production"
      }
    ]
  },
  "meta": {
    "instanceId": "a9ba178a640c436d28a68204dfc010ce5b88bf76cc93b884649651ffafeee20d"
  }
}